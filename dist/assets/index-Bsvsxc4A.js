(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Wa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function HE(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var _v={exports:{}},Pu={},xv={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var da=Symbol.for("react.element"),WE=Symbol.for("react.portal"),qE=Symbol.for("react.fragment"),GE=Symbol.for("react.strict_mode"),KE=Symbol.for("react.profiler"),QE=Symbol.for("react.provider"),YE=Symbol.for("react.context"),XE=Symbol.for("react.forward_ref"),JE=Symbol.for("react.suspense"),ZE=Symbol.for("react.memo"),eb=Symbol.for("react.lazy"),km=Symbol.iterator;function tb(t){return t===null||typeof t!="object"?null:(t=km&&t[km]||t["@@iterator"],typeof t=="function"?t:null)}var wv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ev=Object.assign,bv={};function Pi(t,e,n){this.props=t,this.context=e,this.refs=bv,this.updater=n||wv}Pi.prototype.isReactComponent={};Pi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Pi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Sv(){}Sv.prototype=Pi.prototype;function $h(t,e,n){this.props=t,this.context=e,this.refs=bv,this.updater=n||wv}var Hh=$h.prototype=new Sv;Hh.constructor=$h;Ev(Hh,Pi.prototype);Hh.isPureReactComponent=!0;var Dm=Array.isArray,Tv=Object.prototype.hasOwnProperty,Wh={current:null},Iv={key:!0,ref:!0,__self:!0,__source:!0};function Cv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Tv.call(e,r)&&!Iv.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:da,type:t,key:i,ref:o,props:s,_owner:Wh.current}}function nb(t,e){return{$$typeof:da,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qh(t){return typeof t=="object"&&t!==null&&t.$$typeof===da}function rb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var jm=/\/+/g;function kc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?rb(""+t.key):e.toString(36)}function _l(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case da:case WE:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+kc(o,0):r,Dm(s)?(n="",t!=null&&(n=t.replace(jm,"$&/")+"/"),_l(s,e,n,"",function(d){return d})):s!=null&&(qh(s)&&(s=nb(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(jm,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Dm(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+kc(i,l);o+=_l(i,e,n,u,s)}else if(u=tb(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+kc(i,l++),o+=_l(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function qa(t,e,n){if(t==null)return t;var r=[],s=0;return _l(t,r,"","",function(i){return e.call(n,i,s++)}),r}function sb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ot={current:null},xl={transition:null},ib={ReactCurrentDispatcher:Ot,ReactCurrentBatchConfig:xl,ReactCurrentOwner:Wh};function Av(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:qa,forEach:function(t,e,n){qa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return qa(t,function(){e++}),e},toArray:function(t){return qa(t,function(e){return e})||[]},only:function(t){if(!qh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};le.Component=Pi;le.Fragment=qE;le.Profiler=KE;le.PureComponent=$h;le.StrictMode=GE;le.Suspense=JE;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ib;le.act=Av;le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ev({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Wh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Tv.call(e,u)&&!Iv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:da,type:t.type,key:s,ref:i,props:r,_owner:o}};le.createContext=function(t){return t={$$typeof:YE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:QE,_context:t},t.Consumer=t};le.createElement=Cv;le.createFactory=function(t){var e=Cv.bind(null,t);return e.type=t,e};le.createRef=function(){return{current:null}};le.forwardRef=function(t){return{$$typeof:XE,render:t}};le.isValidElement=qh;le.lazy=function(t){return{$$typeof:eb,_payload:{_status:-1,_result:t},_init:sb}};le.memo=function(t,e){return{$$typeof:ZE,type:t,compare:e===void 0?null:e}};le.startTransition=function(t){var e=xl.transition;xl.transition={};try{t()}finally{xl.transition=e}};le.unstable_act=Av;le.useCallback=function(t,e){return Ot.current.useCallback(t,e)};le.useContext=function(t){return Ot.current.useContext(t)};le.useDebugValue=function(){};le.useDeferredValue=function(t){return Ot.current.useDeferredValue(t)};le.useEffect=function(t,e){return Ot.current.useEffect(t,e)};le.useId=function(){return Ot.current.useId()};le.useImperativeHandle=function(t,e,n){return Ot.current.useImperativeHandle(t,e,n)};le.useInsertionEffect=function(t,e){return Ot.current.useInsertionEffect(t,e)};le.useLayoutEffect=function(t,e){return Ot.current.useLayoutEffect(t,e)};le.useMemo=function(t,e){return Ot.current.useMemo(t,e)};le.useReducer=function(t,e,n){return Ot.current.useReducer(t,e,n)};le.useRef=function(t){return Ot.current.useRef(t)};le.useState=function(t){return Ot.current.useState(t)};le.useSyncExternalStore=function(t,e,n){return Ot.current.useSyncExternalStore(t,e,n)};le.useTransition=function(){return Ot.current.useTransition()};le.version="18.3.1";xv.exports=le;var V=xv.exports;const Pv=Bh(V);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ob=V,ab=Symbol.for("react.element"),lb=Symbol.for("react.fragment"),ub=Object.prototype.hasOwnProperty,cb=ob.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,db={key:!0,ref:!0,__self:!0,__source:!0};function Rv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)ub.call(e,r)&&!db.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ab,type:t,key:i,ref:o,props:s,_owner:cb.current}}Pu.Fragment=lb;Pu.jsx=Rv;Pu.jsxs=Rv;_v.exports=Pu;var c=_v.exports,Sd={},Nv={exports:{}},tn={},kv={exports:{}},Dv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,K){var Q=z.length;z.push(K);e:for(;0<Q;){var Ee=Q-1>>>1,ve=z[Ee];if(0<s(ve,K))z[Ee]=K,z[Q]=ve,Q=Ee;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var K=z[0],Q=z.pop();if(Q!==K){z[0]=Q;e:for(var Ee=0,ve=z.length,Re=ve>>>1;Ee<Re;){var H=2*(Ee+1)-1,Y=z[H],oe=H+1,ue=z[oe];if(0>s(Y,Q))oe<ve&&0>s(ue,Y)?(z[Ee]=ue,z[oe]=Q,Ee=oe):(z[Ee]=Y,z[H]=Q,Ee=H);else if(oe<ve&&0>s(ue,Q))z[Ee]=ue,z[oe]=Q,Ee=oe;else break e}}return K}function s(z,K){var Q=z.sortIndex-K.sortIndex;return Q!==0?Q:z.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,g=null,y=3,C=!1,k=!1,w=!1,N=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(z){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=z)r(d),K.sortIndex=K.expirationTime,e(u,K);else break;K=n(d)}}function S(z){if(w=!1,v(z),!k)if(n(u)!==null)k=!0,ae(P);else{var K=n(d);K!==null&&re(S,K.startTime-z)}}function P(z,K){k=!1,w&&(w=!1,b(p),p=-1),C=!0;var Q=y;try{for(v(K),g=n(u);g!==null&&(!(g.expirationTime>K)||z&&!D());){var Ee=g.callback;if(typeof Ee=="function"){g.callback=null,y=g.priorityLevel;var ve=Ee(g.expirationTime<=K);K=t.unstable_now(),typeof ve=="function"?g.callback=ve:g===n(u)&&r(u),v(K)}else r(u);g=n(u)}if(g!==null)var Re=!0;else{var H=n(d);H!==null&&re(S,H.startTime-K),Re=!1}return Re}finally{g=null,y=Q,C=!1}}var I=!1,_=null,p=-1,x=5,A=-1;function D(){return!(t.unstable_now()-A<x)}function j(){if(_!==null){var z=t.unstable_now();A=z;var K=!0;try{K=_(!0,z)}finally{K?R():(I=!1,_=null)}}else I=!1}var R;if(typeof E=="function")R=function(){E(j)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,ne=q.port2;q.port1.onmessage=j,R=function(){ne.postMessage(null)}}else R=function(){N(j,0)};function ae(z){_=z,I||(I=!0,R())}function re(z,K){p=N(function(){z(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){k||C||(k=!0,ae(P))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(z){switch(y){case 1:case 2:case 3:var K=3;break;default:K=y}var Q=y;y=K;try{return z()}finally{y=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,K){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Q=y;y=z;try{return K()}finally{y=Q}},t.unstable_scheduleCallback=function(z,K,Q){var Ee=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?Ee+Q:Ee):Q=Ee,z){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=Q+ve,z={id:h++,callback:K,priorityLevel:z,startTime:Q,expirationTime:ve,sortIndex:-1},Q>Ee?(z.sortIndex=Q,e(d,z),n(u)===null&&z===n(d)&&(w?(b(p),p=-1):w=!0,re(S,Q-Ee))):(z.sortIndex=ve,e(u,z),k||C||(k=!0,ae(P))),z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(z){var K=y;return function(){var Q=y;y=K;try{return z.apply(this,arguments)}finally{y=Q}}}})(Dv);kv.exports=Dv;var hb=kv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fb=V,en=hb;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jv=new Set,Mo={};function Ts(t,e){fi(t,e),fi(t+"Capture",e)}function fi(t,e){for(Mo[t]=e,t=0;t<e.length;t++)jv.add(e[t])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Td=Object.prototype.hasOwnProperty,pb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Om={},Vm={};function mb(t){return Td.call(Vm,t)?!0:Td.call(Om,t)?!1:pb.test(t)?Vm[t]=!0:(Om[t]=!0,!1)}function gb(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yb(t,e,n,r){if(e===null||typeof e>"u"||gb(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Vt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var pt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){pt[t]=new Vt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];pt[e]=new Vt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){pt[t]=new Vt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){pt[t]=new Vt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){pt[t]=new Vt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){pt[t]=new Vt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){pt[t]=new Vt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){pt[t]=new Vt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){pt[t]=new Vt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gh=/[\-:]([a-z])/g;function Kh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gh,Kh);pt[e]=new Vt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gh,Kh);pt[e]=new Vt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gh,Kh);pt[e]=new Vt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){pt[t]=new Vt(t,1,!1,t.toLowerCase(),null,!1,!1)});pt.xlinkHref=new Vt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){pt[t]=new Vt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Qh(t,e,n,r){var s=pt.hasOwnProperty(e)?pt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yb(e,n,s,r)&&(n=null),r||s===null?mb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ur=fb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ga=Symbol.for("react.element"),$s=Symbol.for("react.portal"),Hs=Symbol.for("react.fragment"),Yh=Symbol.for("react.strict_mode"),Id=Symbol.for("react.profiler"),Ov=Symbol.for("react.provider"),Vv=Symbol.for("react.context"),Xh=Symbol.for("react.forward_ref"),Cd=Symbol.for("react.suspense"),Ad=Symbol.for("react.suspense_list"),Jh=Symbol.for("react.memo"),_r=Symbol.for("react.lazy"),Mv=Symbol.for("react.offscreen"),Mm=Symbol.iterator;function eo(t){return t===null||typeof t!="object"?null:(t=Mm&&t[Mm]||t["@@iterator"],typeof t=="function"?t:null)}var Oe=Object.assign,Dc;function mo(t){if(Dc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Dc=e&&e[1]||""}return`
`+Dc+t}var jc=!1;function Oc(t,e){if(!t||jc)return"";jc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{jc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?mo(t):""}function vb(t){switch(t.tag){case 5:return mo(t.type);case 16:return mo("Lazy");case 13:return mo("Suspense");case 19:return mo("SuspenseList");case 0:case 2:case 15:return t=Oc(t.type,!1),t;case 11:return t=Oc(t.type.render,!1),t;case 1:return t=Oc(t.type,!0),t;default:return""}}function Pd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Hs:return"Fragment";case $s:return"Portal";case Id:return"Profiler";case Yh:return"StrictMode";case Cd:return"Suspense";case Ad:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vv:return(t.displayName||"Context")+".Consumer";case Ov:return(t._context.displayName||"Context")+".Provider";case Xh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jh:return e=t.displayName||null,e!==null?e:Pd(t.type)||"Memo";case _r:e=t._payload,t=t._init;try{return Pd(t(e))}catch{}}return null}function _b(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pd(e);case 8:return e===Yh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Lv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xb(t){var e=Lv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ka(t){t._valueTracker||(t._valueTracker=xb(t))}function Fv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Lv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function zl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Rd(t,e){var n=e.checked;return Oe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Lm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=zr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Uv(t,e){e=e.checked,e!=null&&Qh(t,"checked",e,!1)}function Nd(t,e){Uv(t,e);var n=zr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?kd(t,e.type,n):e.hasOwnProperty("defaultValue")&&kd(t,e.type,zr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Fm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function kd(t,e,n){(e!=="number"||zl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var go=Array.isArray;function ri(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+zr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Dd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Oe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Um(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(go(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:zr(n)}}function zv(t,e){var n=zr(e.value),r=zr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function zm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Bv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Bv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qa,$v=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qa=Qa||document.createElement("div"),Qa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Lo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var bo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wb=["Webkit","ms","Moz","O"];Object.keys(bo).forEach(function(t){wb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bo[e]=bo[t]})});function Hv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||bo.hasOwnProperty(t)&&bo[t]?(""+e).trim():e+"px"}function Wv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Hv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Eb=Oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Od(t,e){if(e){if(Eb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Vd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Md=null;function Zh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ld=null,si=null,ii=null;function Bm(t){if(t=pa(t)){if(typeof Ld!="function")throw Error(U(280));var e=t.stateNode;e&&(e=ju(e),Ld(t.stateNode,t.type,e))}}function qv(t){si?ii?ii.push(t):ii=[t]:si=t}function Gv(){if(si){var t=si,e=ii;if(ii=si=null,Bm(t),e)for(t=0;t<e.length;t++)Bm(e[t])}}function Kv(t,e){return t(e)}function Qv(){}var Vc=!1;function Yv(t,e,n){if(Vc)return t(e,n);Vc=!0;try{return Kv(t,e,n)}finally{Vc=!1,(si!==null||ii!==null)&&(Qv(),Gv())}}function Fo(t,e){var n=t.stateNode;if(n===null)return null;var r=ju(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var Fd=!1;if(tr)try{var to={};Object.defineProperty(to,"passive",{get:function(){Fd=!0}}),window.addEventListener("test",to,to),window.removeEventListener("test",to,to)}catch{Fd=!1}function bb(t,e,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var So=!1,Bl=null,$l=!1,Ud=null,Sb={onError:function(t){So=!0,Bl=t}};function Tb(t,e,n,r,s,i,o,l,u){So=!1,Bl=null,bb.apply(Sb,arguments)}function Ib(t,e,n,r,s,i,o,l,u){if(Tb.apply(this,arguments),So){if(So){var d=Bl;So=!1,Bl=null}else throw Error(U(198));$l||($l=!0,Ud=d)}}function Is(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Xv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $m(t){if(Is(t)!==t)throw Error(U(188))}function Cb(t){var e=t.alternate;if(!e){if(e=Is(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return $m(s),t;if(i===r)return $m(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function Jv(t){return t=Cb(t),t!==null?Zv(t):null}function Zv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Zv(t);if(e!==null)return e;t=t.sibling}return null}var e_=en.unstable_scheduleCallback,Hm=en.unstable_cancelCallback,Ab=en.unstable_shouldYield,Pb=en.unstable_requestPaint,$e=en.unstable_now,Rb=en.unstable_getCurrentPriorityLevel,ef=en.unstable_ImmediatePriority,t_=en.unstable_UserBlockingPriority,Hl=en.unstable_NormalPriority,Nb=en.unstable_LowPriority,n_=en.unstable_IdlePriority,Ru=null,kn=null;function kb(t){if(kn&&typeof kn.onCommitFiberRoot=="function")try{kn.onCommitFiberRoot(Ru,t,void 0,(t.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:Ob,Db=Math.log,jb=Math.LN2;function Ob(t){return t>>>=0,t===0?32:31-(Db(t)/jb|0)|0}var Ya=64,Xa=4194304;function yo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=yo(l):(i&=o,i!==0&&(r=yo(i)))}else o=n&~s,o!==0?r=yo(o):i!==0&&(r=yo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-wn(e),s=1<<n,r|=t[n],e&=~s;return r}function Vb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mb(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-wn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=Vb(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function zd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function r_(){var t=Ya;return Ya<<=1,!(Ya&4194240)&&(Ya=64),t}function Mc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ha(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wn(e),t[e]=n}function Lb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-wn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function tf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-wn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var xe=0;function s_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var i_,nf,o_,a_,l_,Bd=!1,Ja=[],Pr=null,Rr=null,Nr=null,Uo=new Map,zo=new Map,wr=[],Fb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wm(t,e){switch(t){case"focusin":case"focusout":Pr=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":Nr=null;break;case"pointerover":case"pointerout":Uo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zo.delete(e.pointerId)}}function no(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=pa(e),e!==null&&nf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Ub(t,e,n,r,s){switch(e){case"focusin":return Pr=no(Pr,t,e,n,r,s),!0;case"dragenter":return Rr=no(Rr,t,e,n,r,s),!0;case"mouseover":return Nr=no(Nr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Uo.set(i,no(Uo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,zo.set(i,no(zo.get(i)||null,t,e,n,r,s)),!0}return!1}function u_(t){var e=is(t.target);if(e!==null){var n=Is(e);if(n!==null){if(e=n.tag,e===13){if(e=Xv(n),e!==null){t.blockedOn=e,l_(t.priority,function(){o_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=$d(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Md=r,n.target.dispatchEvent(r),Md=null}else return e=pa(n),e!==null&&nf(e),t.blockedOn=n,!1;e.shift()}return!0}function qm(t,e,n){wl(t)&&n.delete(e)}function zb(){Bd=!1,Pr!==null&&wl(Pr)&&(Pr=null),Rr!==null&&wl(Rr)&&(Rr=null),Nr!==null&&wl(Nr)&&(Nr=null),Uo.forEach(qm),zo.forEach(qm)}function ro(t,e){t.blockedOn===e&&(t.blockedOn=null,Bd||(Bd=!0,en.unstable_scheduleCallback(en.unstable_NormalPriority,zb)))}function Bo(t){function e(s){return ro(s,t)}if(0<Ja.length){ro(Ja[0],t);for(var n=1;n<Ja.length;n++){var r=Ja[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Pr!==null&&ro(Pr,t),Rr!==null&&ro(Rr,t),Nr!==null&&ro(Nr,t),Uo.forEach(e),zo.forEach(e),n=0;n<wr.length;n++)r=wr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wr.length&&(n=wr[0],n.blockedOn===null);)u_(n),n.blockedOn===null&&wr.shift()}var oi=ur.ReactCurrentBatchConfig,ql=!0;function Bb(t,e,n,r){var s=xe,i=oi.transition;oi.transition=null;try{xe=1,rf(t,e,n,r)}finally{xe=s,oi.transition=i}}function $b(t,e,n,r){var s=xe,i=oi.transition;oi.transition=null;try{xe=4,rf(t,e,n,r)}finally{xe=s,oi.transition=i}}function rf(t,e,n,r){if(ql){var s=$d(t,e,n,r);if(s===null)Gc(t,e,r,Gl,n),Wm(t,r);else if(Ub(s,t,e,n,r))r.stopPropagation();else if(Wm(t,r),e&4&&-1<Fb.indexOf(t)){for(;s!==null;){var i=pa(s);if(i!==null&&i_(i),i=$d(t,e,n,r),i===null&&Gc(t,e,r,Gl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Gc(t,e,r,null,n)}}var Gl=null;function $d(t,e,n,r){if(Gl=null,t=Zh(r),t=is(t),t!==null)if(e=Is(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Xv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gl=t,null}function c_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rb()){case ef:return 1;case t_:return 4;case Hl:case Nb:return 16;case n_:return 536870912;default:return 16}default:return 16}}var Ir=null,sf=null,El=null;function d_(){if(El)return El;var t,e=sf,n=e.length,r,s="value"in Ir?Ir.value:Ir.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return El=s.slice(t,1<r?1-r:void 0)}function bl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Za(){return!0}function Gm(){return!1}function nn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Za:Gm,this.isPropagationStopped=Gm,this}return Oe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Za)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Za)},persist:function(){},isPersistent:Za}),e}var Ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},of=nn(Ri),fa=Oe({},Ri,{view:0,detail:0}),Hb=nn(fa),Lc,Fc,so,Nu=Oe({},fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:af,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==so&&(so&&t.type==="mousemove"?(Lc=t.screenX-so.screenX,Fc=t.screenY-so.screenY):Fc=Lc=0,so=t),Lc)},movementY:function(t){return"movementY"in t?t.movementY:Fc}}),Km=nn(Nu),Wb=Oe({},Nu,{dataTransfer:0}),qb=nn(Wb),Gb=Oe({},fa,{relatedTarget:0}),Uc=nn(Gb),Kb=Oe({},Ri,{animationName:0,elapsedTime:0,pseudoElement:0}),Qb=nn(Kb),Yb=Oe({},Ri,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Xb=nn(Yb),Jb=Oe({},Ri,{data:0}),Qm=nn(Jb),Zb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=tS[t])?!!e[t]:!1}function af(){return nS}var rS=Oe({},fa,{key:function(t){if(t.key){var e=Zb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:af,charCode:function(t){return t.type==="keypress"?bl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sS=nn(rS),iS=Oe({},Nu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ym=nn(iS),oS=Oe({},fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:af}),aS=nn(oS),lS=Oe({},Ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),uS=nn(lS),cS=Oe({},Nu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dS=nn(cS),hS=[9,13,27,32],lf=tr&&"CompositionEvent"in window,To=null;tr&&"documentMode"in document&&(To=document.documentMode);var fS=tr&&"TextEvent"in window&&!To,h_=tr&&(!lf||To&&8<To&&11>=To),Xm=" ",Jm=!1;function f_(t,e){switch(t){case"keyup":return hS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ws=!1;function pS(t,e){switch(t){case"compositionend":return p_(e);case"keypress":return e.which!==32?null:(Jm=!0,Xm);case"textInput":return t=e.data,t===Xm&&Jm?null:t;default:return null}}function mS(t,e){if(Ws)return t==="compositionend"||!lf&&f_(t,e)?(t=d_(),El=sf=Ir=null,Ws=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return h_&&e.locale!=="ko"?null:e.data;default:return null}}var gS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gS[t.type]:e==="textarea"}function m_(t,e,n,r){qv(r),e=Kl(e,"onChange"),0<e.length&&(n=new of("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Io=null,$o=null;function yS(t){I_(t,0)}function ku(t){var e=Ks(t);if(Fv(e))return t}function vS(t,e){if(t==="change")return e}var g_=!1;if(tr){var zc;if(tr){var Bc="oninput"in document;if(!Bc){var eg=document.createElement("div");eg.setAttribute("oninput","return;"),Bc=typeof eg.oninput=="function"}zc=Bc}else zc=!1;g_=zc&&(!document.documentMode||9<document.documentMode)}function tg(){Io&&(Io.detachEvent("onpropertychange",y_),$o=Io=null)}function y_(t){if(t.propertyName==="value"&&ku($o)){var e=[];m_(e,$o,t,Zh(t)),Yv(yS,e)}}function _S(t,e,n){t==="focusin"?(tg(),Io=e,$o=n,Io.attachEvent("onpropertychange",y_)):t==="focusout"&&tg()}function xS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ku($o)}function wS(t,e){if(t==="click")return ku(e)}function ES(t,e){if(t==="input"||t==="change")return ku(e)}function bS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Tn=typeof Object.is=="function"?Object.is:bS;function Ho(t,e){if(Tn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Td.call(e,s)||!Tn(t[s],e[s]))return!1}return!0}function ng(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function rg(t,e){var n=ng(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ng(n)}}function v_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?v_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function __(){for(var t=window,e=zl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=zl(t.document)}return e}function uf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function SS(t){var e=__(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&v_(n.ownerDocument.documentElement,n)){if(r!==null&&uf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=rg(n,i);var o=rg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var TS=tr&&"documentMode"in document&&11>=document.documentMode,qs=null,Hd=null,Co=null,Wd=!1;function sg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Wd||qs==null||qs!==zl(r)||(r=qs,"selectionStart"in r&&uf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Co&&Ho(Co,r)||(Co=r,r=Kl(Hd,"onSelect"),0<r.length&&(e=new of("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=qs)))}function el(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gs={animationend:el("Animation","AnimationEnd"),animationiteration:el("Animation","AnimationIteration"),animationstart:el("Animation","AnimationStart"),transitionend:el("Transition","TransitionEnd")},$c={},x_={};tr&&(x_=document.createElement("div").style,"AnimationEvent"in window||(delete Gs.animationend.animation,delete Gs.animationiteration.animation,delete Gs.animationstart.animation),"TransitionEvent"in window||delete Gs.transitionend.transition);function Du(t){if($c[t])return $c[t];if(!Gs[t])return t;var e=Gs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in x_)return $c[t]=e[n];return t}var w_=Du("animationend"),E_=Du("animationiteration"),b_=Du("animationstart"),S_=Du("transitionend"),T_=new Map,ig="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gr(t,e){T_.set(t,e),Ts(e,[t])}for(var Hc=0;Hc<ig.length;Hc++){var Wc=ig[Hc],IS=Wc.toLowerCase(),CS=Wc[0].toUpperCase()+Wc.slice(1);Gr(IS,"on"+CS)}Gr(w_,"onAnimationEnd");Gr(E_,"onAnimationIteration");Gr(b_,"onAnimationStart");Gr("dblclick","onDoubleClick");Gr("focusin","onFocus");Gr("focusout","onBlur");Gr(S_,"onTransitionEnd");fi("onMouseEnter",["mouseout","mouseover"]);fi("onMouseLeave",["mouseout","mouseover"]);fi("onPointerEnter",["pointerout","pointerover"]);fi("onPointerLeave",["pointerout","pointerover"]);Ts("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ts("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ts("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ts("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ts("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ts("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AS=new Set("cancel close invalid load scroll toggle".split(" ").concat(vo));function og(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Ib(r,e,void 0,t),t.currentTarget=null}function I_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;og(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;og(s,l,d),i=u}}}if($l)throw t=Ud,$l=!1,Ud=null,t}function Ie(t,e){var n=e[Yd];n===void 0&&(n=e[Yd]=new Set);var r=t+"__bubble";n.has(r)||(C_(e,t,2,!1),n.add(r))}function qc(t,e,n){var r=0;e&&(r|=4),C_(n,t,r,e)}var tl="_reactListening"+Math.random().toString(36).slice(2);function Wo(t){if(!t[tl]){t[tl]=!0,jv.forEach(function(n){n!=="selectionchange"&&(AS.has(n)||qc(n,!1,t),qc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[tl]||(e[tl]=!0,qc("selectionchange",!1,e))}}function C_(t,e,n,r){switch(c_(e)){case 1:var s=Bb;break;case 4:s=$b;break;default:s=rf}n=s.bind(null,e,n,t),s=void 0,!Fd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Gc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=is(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Yv(function(){var d=i,h=Zh(n),g=[];e:{var y=T_.get(t);if(y!==void 0){var C=of,k=t;switch(t){case"keypress":if(bl(n)===0)break e;case"keydown":case"keyup":C=sS;break;case"focusin":k="focus",C=Uc;break;case"focusout":k="blur",C=Uc;break;case"beforeblur":case"afterblur":C=Uc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=Km;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=qb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=aS;break;case w_:case E_:case b_:C=Qb;break;case S_:C=uS;break;case"scroll":C=Hb;break;case"wheel":C=dS;break;case"copy":case"cut":case"paste":C=Xb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=Ym}var w=(e&4)!==0,N=!w&&t==="scroll",b=w?y!==null?y+"Capture":null:y;w=[];for(var E=d,v;E!==null;){v=E;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,b!==null&&(S=Fo(E,b),S!=null&&w.push(qo(E,S,v)))),N)break;E=E.return}0<w.length&&(y=new C(y,k,null,n,h),g.push({event:y,listeners:w}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",y&&n!==Md&&(k=n.relatedTarget||n.fromElement)&&(is(k)||k[nr]))break e;if((C||y)&&(y=h.window===h?h:(y=h.ownerDocument)?y.defaultView||y.parentWindow:window,C?(k=n.relatedTarget||n.toElement,C=d,k=k?is(k):null,k!==null&&(N=Is(k),k!==N||k.tag!==5&&k.tag!==6)&&(k=null)):(C=null,k=d),C!==k)){if(w=Km,S="onMouseLeave",b="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(w=Ym,S="onPointerLeave",b="onPointerEnter",E="pointer"),N=C==null?y:Ks(C),v=k==null?y:Ks(k),y=new w(S,E+"leave",C,n,h),y.target=N,y.relatedTarget=v,S=null,is(h)===d&&(w=new w(b,E+"enter",k,n,h),w.target=v,w.relatedTarget=N,S=w),N=S,C&&k)t:{for(w=C,b=k,E=0,v=w;v;v=Ls(v))E++;for(v=0,S=b;S;S=Ls(S))v++;for(;0<E-v;)w=Ls(w),E--;for(;0<v-E;)b=Ls(b),v--;for(;E--;){if(w===b||b!==null&&w===b.alternate)break t;w=Ls(w),b=Ls(b)}w=null}else w=null;C!==null&&ag(g,y,C,w,!1),k!==null&&N!==null&&ag(g,N,k,w,!0)}}e:{if(y=d?Ks(d):window,C=y.nodeName&&y.nodeName.toLowerCase(),C==="select"||C==="input"&&y.type==="file")var P=vS;else if(Zm(y))if(g_)P=ES;else{P=xS;var I=_S}else(C=y.nodeName)&&C.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(P=wS);if(P&&(P=P(t,d))){m_(g,P,n,h);break e}I&&I(t,y,d),t==="focusout"&&(I=y._wrapperState)&&I.controlled&&y.type==="number"&&kd(y,"number",y.value)}switch(I=d?Ks(d):window,t){case"focusin":(Zm(I)||I.contentEditable==="true")&&(qs=I,Hd=d,Co=null);break;case"focusout":Co=Hd=qs=null;break;case"mousedown":Wd=!0;break;case"contextmenu":case"mouseup":case"dragend":Wd=!1,sg(g,n,h);break;case"selectionchange":if(TS)break;case"keydown":case"keyup":sg(g,n,h)}var _;if(lf)e:{switch(t){case"compositionstart":var p="onCompositionStart";break e;case"compositionend":p="onCompositionEnd";break e;case"compositionupdate":p="onCompositionUpdate";break e}p=void 0}else Ws?f_(t,n)&&(p="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(p="onCompositionStart");p&&(h_&&n.locale!=="ko"&&(Ws||p!=="onCompositionStart"?p==="onCompositionEnd"&&Ws&&(_=d_()):(Ir=h,sf="value"in Ir?Ir.value:Ir.textContent,Ws=!0)),I=Kl(d,p),0<I.length&&(p=new Qm(p,t,null,n,h),g.push({event:p,listeners:I}),_?p.data=_:(_=p_(n),_!==null&&(p.data=_)))),(_=fS?pS(t,n):mS(t,n))&&(d=Kl(d,"onBeforeInput"),0<d.length&&(h=new Qm("onBeforeInput","beforeinput",null,n,h),g.push({event:h,listeners:d}),h.data=_))}I_(g,e)})}function qo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Kl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Fo(t,n),i!=null&&r.unshift(qo(t,i,s)),i=Fo(t,e),i!=null&&r.push(qo(t,i,s))),t=t.return}return r}function Ls(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ag(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=Fo(n,i),u!=null&&o.unshift(qo(n,u,l))):s||(u=Fo(n,i),u!=null&&o.push(qo(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var PS=/\r\n?/g,RS=/\u0000|\uFFFD/g;function lg(t){return(typeof t=="string"?t:""+t).replace(PS,`
`).replace(RS,"")}function nl(t,e,n){if(e=lg(e),lg(t)!==e&&n)throw Error(U(425))}function Ql(){}var qd=null,Gd=null;function Kd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qd=typeof setTimeout=="function"?setTimeout:void 0,NS=typeof clearTimeout=="function"?clearTimeout:void 0,ug=typeof Promise=="function"?Promise:void 0,kS=typeof queueMicrotask=="function"?queueMicrotask:typeof ug<"u"?function(t){return ug.resolve(null).then(t).catch(DS)}:Qd;function DS(t){setTimeout(function(){throw t})}function Kc(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Bo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Bo(e)}function kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function cg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ni=Math.random().toString(36).slice(2),Nn="__reactFiber$"+Ni,Go="__reactProps$"+Ni,nr="__reactContainer$"+Ni,Yd="__reactEvents$"+Ni,jS="__reactListeners$"+Ni,OS="__reactHandles$"+Ni;function is(t){var e=t[Nn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[nr]||n[Nn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=cg(t);t!==null;){if(n=t[Nn])return n;t=cg(t)}return e}t=n,n=t.parentNode}return null}function pa(t){return t=t[Nn]||t[nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ks(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function ju(t){return t[Go]||null}var Xd=[],Qs=-1;function Kr(t){return{current:t}}function Ae(t){0>Qs||(t.current=Xd[Qs],Xd[Qs]=null,Qs--)}function Se(t,e){Qs++,Xd[Qs]=t.current,t.current=e}var Br={},Tt=Kr(Br),Ut=Kr(!1),ms=Br;function pi(t,e){var n=t.type.contextTypes;if(!n)return Br;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function zt(t){return t=t.childContextTypes,t!=null}function Yl(){Ae(Ut),Ae(Tt)}function dg(t,e,n){if(Tt.current!==Br)throw Error(U(168));Se(Tt,e),Se(Ut,n)}function A_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,_b(t)||"Unknown",s));return Oe({},n,r)}function Xl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Br,ms=Tt.current,Se(Tt,t),Se(Ut,Ut.current),!0}function hg(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=A_(t,e,ms),r.__reactInternalMemoizedMergedChildContext=t,Ae(Ut),Ae(Tt),Se(Tt,t)):Ae(Ut),Se(Ut,n)}var Wn=null,Ou=!1,Qc=!1;function P_(t){Wn===null?Wn=[t]:Wn.push(t)}function VS(t){Ou=!0,P_(t)}function Qr(){if(!Qc&&Wn!==null){Qc=!0;var t=0,e=xe;try{var n=Wn;for(xe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Wn=null,Ou=!1}catch(s){throw Wn!==null&&(Wn=Wn.slice(t+1)),e_(ef,Qr),s}finally{xe=e,Qc=!1}}return null}var Ys=[],Xs=0,Jl=null,Zl=0,rn=[],sn=0,gs=null,Gn=1,Kn="";function ns(t,e){Ys[Xs++]=Zl,Ys[Xs++]=Jl,Jl=t,Zl=e}function R_(t,e,n){rn[sn++]=Gn,rn[sn++]=Kn,rn[sn++]=gs,gs=t;var r=Gn;t=Kn;var s=32-wn(r)-1;r&=~(1<<s),n+=1;var i=32-wn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Gn=1<<32-wn(e)+s|n<<s|r,Kn=i+t}else Gn=1<<i|n<<s|r,Kn=t}function cf(t){t.return!==null&&(ns(t,1),R_(t,1,0))}function df(t){for(;t===Jl;)Jl=Ys[--Xs],Ys[Xs]=null,Zl=Ys[--Xs],Ys[Xs]=null;for(;t===gs;)gs=rn[--sn],rn[sn]=null,Kn=rn[--sn],rn[sn]=null,Gn=rn[--sn],rn[sn]=null}var Xt=null,Yt=null,Ne=!1,_n=null;function N_(t,e){var n=an(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xt=t,Yt=kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xt=t,Yt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=gs!==null?{id:Gn,overflow:Kn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=an(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Xt=t,Yt=null,!0):!1;default:return!1}}function Jd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Zd(t){if(Ne){var e=Yt;if(e){var n=e;if(!fg(t,e)){if(Jd(t))throw Error(U(418));e=kr(n.nextSibling);var r=Xt;e&&fg(t,e)?N_(r,n):(t.flags=t.flags&-4097|2,Ne=!1,Xt=t)}}else{if(Jd(t))throw Error(U(418));t.flags=t.flags&-4097|2,Ne=!1,Xt=t}}}function pg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xt=t}function rl(t){if(t!==Xt)return!1;if(!Ne)return pg(t),Ne=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Kd(t.type,t.memoizedProps)),e&&(e=Yt)){if(Jd(t))throw k_(),Error(U(418));for(;e;)N_(t,e),e=kr(e.nextSibling)}if(pg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Yt=kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Yt=null}}else Yt=Xt?kr(t.stateNode.nextSibling):null;return!0}function k_(){for(var t=Yt;t;)t=kr(t.nextSibling)}function mi(){Yt=Xt=null,Ne=!1}function hf(t){_n===null?_n=[t]:_n.push(t)}var MS=ur.ReactCurrentBatchConfig;function io(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function sl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function mg(t){var e=t._init;return e(t._payload)}function D_(t){function e(b,E){if(t){var v=b.deletions;v===null?(b.deletions=[E],b.flags|=16):v.push(E)}}function n(b,E){if(!t)return null;for(;E!==null;)e(b,E),E=E.sibling;return null}function r(b,E){for(b=new Map;E!==null;)E.key!==null?b.set(E.key,E):b.set(E.index,E),E=E.sibling;return b}function s(b,E){return b=Vr(b,E),b.index=0,b.sibling=null,b}function i(b,E,v){return b.index=v,t?(v=b.alternate,v!==null?(v=v.index,v<E?(b.flags|=2,E):v):(b.flags|=2,E)):(b.flags|=1048576,E)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,E,v,S){return E===null||E.tag!==6?(E=nd(v,b.mode,S),E.return=b,E):(E=s(E,v),E.return=b,E)}function u(b,E,v,S){var P=v.type;return P===Hs?h(b,E,v.props.children,S,v.key):E!==null&&(E.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===_r&&mg(P)===E.type)?(S=s(E,v.props),S.ref=io(b,E,v),S.return=b,S):(S=Rl(v.type,v.key,v.props,null,b.mode,S),S.ref=io(b,E,v),S.return=b,S)}function d(b,E,v,S){return E===null||E.tag!==4||E.stateNode.containerInfo!==v.containerInfo||E.stateNode.implementation!==v.implementation?(E=rd(v,b.mode,S),E.return=b,E):(E=s(E,v.children||[]),E.return=b,E)}function h(b,E,v,S,P){return E===null||E.tag!==7?(E=ds(v,b.mode,S,P),E.return=b,E):(E=s(E,v),E.return=b,E)}function g(b,E,v){if(typeof E=="string"&&E!==""||typeof E=="number")return E=nd(""+E,b.mode,v),E.return=b,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ga:return v=Rl(E.type,E.key,E.props,null,b.mode,v),v.ref=io(b,null,E),v.return=b,v;case $s:return E=rd(E,b.mode,v),E.return=b,E;case _r:var S=E._init;return g(b,S(E._payload),v)}if(go(E)||eo(E))return E=ds(E,b.mode,v,null),E.return=b,E;sl(b,E)}return null}function y(b,E,v,S){var P=E!==null?E.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return P!==null?null:l(b,E,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ga:return v.key===P?u(b,E,v,S):null;case $s:return v.key===P?d(b,E,v,S):null;case _r:return P=v._init,y(b,E,P(v._payload),S)}if(go(v)||eo(v))return P!==null?null:h(b,E,v,S,null);sl(b,v)}return null}function C(b,E,v,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(v)||null,l(E,b,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ga:return b=b.get(S.key===null?v:S.key)||null,u(E,b,S,P);case $s:return b=b.get(S.key===null?v:S.key)||null,d(E,b,S,P);case _r:var I=S._init;return C(b,E,v,I(S._payload),P)}if(go(S)||eo(S))return b=b.get(v)||null,h(E,b,S,P,null);sl(E,S)}return null}function k(b,E,v,S){for(var P=null,I=null,_=E,p=E=0,x=null;_!==null&&p<v.length;p++){_.index>p?(x=_,_=null):x=_.sibling;var A=y(b,_,v[p],S);if(A===null){_===null&&(_=x);break}t&&_&&A.alternate===null&&e(b,_),E=i(A,E,p),I===null?P=A:I.sibling=A,I=A,_=x}if(p===v.length)return n(b,_),Ne&&ns(b,p),P;if(_===null){for(;p<v.length;p++)_=g(b,v[p],S),_!==null&&(E=i(_,E,p),I===null?P=_:I.sibling=_,I=_);return Ne&&ns(b,p),P}for(_=r(b,_);p<v.length;p++)x=C(_,b,p,v[p],S),x!==null&&(t&&x.alternate!==null&&_.delete(x.key===null?p:x.key),E=i(x,E,p),I===null?P=x:I.sibling=x,I=x);return t&&_.forEach(function(D){return e(b,D)}),Ne&&ns(b,p),P}function w(b,E,v,S){var P=eo(v);if(typeof P!="function")throw Error(U(150));if(v=P.call(v),v==null)throw Error(U(151));for(var I=P=null,_=E,p=E=0,x=null,A=v.next();_!==null&&!A.done;p++,A=v.next()){_.index>p?(x=_,_=null):x=_.sibling;var D=y(b,_,A.value,S);if(D===null){_===null&&(_=x);break}t&&_&&D.alternate===null&&e(b,_),E=i(D,E,p),I===null?P=D:I.sibling=D,I=D,_=x}if(A.done)return n(b,_),Ne&&ns(b,p),P;if(_===null){for(;!A.done;p++,A=v.next())A=g(b,A.value,S),A!==null&&(E=i(A,E,p),I===null?P=A:I.sibling=A,I=A);return Ne&&ns(b,p),P}for(_=r(b,_);!A.done;p++,A=v.next())A=C(_,b,p,A.value,S),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?p:A.key),E=i(A,E,p),I===null?P=A:I.sibling=A,I=A);return t&&_.forEach(function(j){return e(b,j)}),Ne&&ns(b,p),P}function N(b,E,v,S){if(typeof v=="object"&&v!==null&&v.type===Hs&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Ga:e:{for(var P=v.key,I=E;I!==null;){if(I.key===P){if(P=v.type,P===Hs){if(I.tag===7){n(b,I.sibling),E=s(I,v.props.children),E.return=b,b=E;break e}}else if(I.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===_r&&mg(P)===I.type){n(b,I.sibling),E=s(I,v.props),E.ref=io(b,I,v),E.return=b,b=E;break e}n(b,I);break}else e(b,I);I=I.sibling}v.type===Hs?(E=ds(v.props.children,b.mode,S,v.key),E.return=b,b=E):(S=Rl(v.type,v.key,v.props,null,b.mode,S),S.ref=io(b,E,v),S.return=b,b=S)}return o(b);case $s:e:{for(I=v.key;E!==null;){if(E.key===I)if(E.tag===4&&E.stateNode.containerInfo===v.containerInfo&&E.stateNode.implementation===v.implementation){n(b,E.sibling),E=s(E,v.children||[]),E.return=b,b=E;break e}else{n(b,E);break}else e(b,E);E=E.sibling}E=rd(v,b.mode,S),E.return=b,b=E}return o(b);case _r:return I=v._init,N(b,E,I(v._payload),S)}if(go(v))return k(b,E,v,S);if(eo(v))return w(b,E,v,S);sl(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,E!==null&&E.tag===6?(n(b,E.sibling),E=s(E,v),E.return=b,b=E):(n(b,E),E=nd(v,b.mode,S),E.return=b,b=E),o(b)):n(b,E)}return N}var gi=D_(!0),j_=D_(!1),eu=Kr(null),tu=null,Js=null,ff=null;function pf(){ff=Js=tu=null}function mf(t){var e=eu.current;Ae(eu),t._currentValue=e}function eh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ai(t,e){tu=t,ff=Js=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ft=!0),t.firstContext=null)}function cn(t){var e=t._currentValue;if(ff!==t)if(t={context:t,memoizedValue:e,next:null},Js===null){if(tu===null)throw Error(U(308));Js=t,tu.dependencies={lanes:0,firstContext:t}}else Js=Js.next=t;return e}var os=null;function gf(t){os===null?os=[t]:os.push(t)}function O_(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,gf(e)):(n.next=s.next,s.next=n),e.interleaved=n,rr(t,r)}function rr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xr=!1;function yf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function V_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Dr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,rr(t,n)}return s=r.interleaved,s===null?(e.next=e,gf(r)):(e.next=s.next,s.next=e),r.interleaved=e,rr(t,n)}function Sl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tf(t,n)}}function gg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function nu(t,e,n,r){var s=t.updateQueue;xr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,h=d=u=null,l=i;do{var y=l.lane,C=l.eventTime;if((r&y)===y){h!==null&&(h=h.next={eventTime:C,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var k=t,w=l;switch(y=e,C=n,w.tag){case 1:if(k=w.payload,typeof k=="function"){g=k.call(C,g,y);break e}g=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=w.payload,y=typeof k=="function"?k.call(C,g,y):k,y==null)break e;g=Oe({},g,y);break e;case 2:xr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else C={eventTime:C,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=C,u=g):h=h.next=C,o|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(h===null&&(u=g),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);vs|=o,t.lanes=o,t.memoizedState=g}}function yg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var ma={},Dn=Kr(ma),Ko=Kr(ma),Qo=Kr(ma);function as(t){if(t===ma)throw Error(U(174));return t}function vf(t,e){switch(Se(Qo,e),Se(Ko,t),Se(Dn,ma),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:jd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=jd(e,t)}Ae(Dn),Se(Dn,e)}function yi(){Ae(Dn),Ae(Ko),Ae(Qo)}function M_(t){as(Qo.current);var e=as(Dn.current),n=jd(e,t.type);e!==n&&(Se(Ko,t),Se(Dn,n))}function _f(t){Ko.current===t&&(Ae(Dn),Ae(Ko))}var De=Kr(0);function ru(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yc=[];function xf(){for(var t=0;t<Yc.length;t++)Yc[t]._workInProgressVersionPrimary=null;Yc.length=0}var Tl=ur.ReactCurrentDispatcher,Xc=ur.ReactCurrentBatchConfig,ys=0,je=null,Xe=null,it=null,su=!1,Ao=!1,Yo=0,LS=0;function vt(){throw Error(U(321))}function wf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Tn(t[n],e[n]))return!1;return!0}function Ef(t,e,n,r,s,i){if(ys=i,je=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Tl.current=t===null||t.memoizedState===null?BS:$S,t=n(r,s),Ao){i=0;do{if(Ao=!1,Yo=0,25<=i)throw Error(U(301));i+=1,it=Xe=null,e.updateQueue=null,Tl.current=HS,t=n(r,s)}while(Ao)}if(Tl.current=iu,e=Xe!==null&&Xe.next!==null,ys=0,it=Xe=je=null,su=!1,e)throw Error(U(300));return t}function bf(){var t=Yo!==0;return Yo=0,t}function Pn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?je.memoizedState=it=t:it=it.next=t,it}function dn(){if(Xe===null){var t=je.alternate;t=t!==null?t.memoizedState:null}else t=Xe.next;var e=it===null?je.memoizedState:it.next;if(e!==null)it=e,Xe=t;else{if(t===null)throw Error(U(310));Xe=t,t={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},it===null?je.memoizedState=it=t:it=it.next=t}return it}function Xo(t,e){return typeof e=="function"?e(t):e}function Jc(t){var e=dn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Xe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var h=d.lane;if((ys&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var g={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=g,o=r):u=u.next=g,je.lanes|=h,vs|=h}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,Tn(r,e.memoizedState)||(Ft=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,je.lanes|=i,vs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Zc(t){var e=dn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Tn(i,e.memoizedState)||(Ft=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function L_(){}function F_(t,e){var n=je,r=dn(),s=e(),i=!Tn(r.memoizedState,s);if(i&&(r.memoizedState=s,Ft=!0),r=r.queue,Sf(B_.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||it!==null&&it.memoizedState.tag&1){if(n.flags|=2048,Jo(9,z_.bind(null,n,r,s,e),void 0,null),ot===null)throw Error(U(349));ys&30||U_(n,e,s)}return s}function U_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=je.updateQueue,e===null?(e={lastEffect:null,stores:null},je.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function z_(t,e,n,r){e.value=n,e.getSnapshot=r,$_(e)&&H_(t)}function B_(t,e,n){return n(function(){$_(e)&&H_(t)})}function $_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Tn(t,n)}catch{return!0}}function H_(t){var e=rr(t,1);e!==null&&En(e,t,1,-1)}function vg(t){var e=Pn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:t},e.queue=t,t=t.dispatch=zS.bind(null,je,t),[e.memoizedState,t]}function Jo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=je.updateQueue,e===null?(e={lastEffect:null,stores:null},je.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function W_(){return dn().memoizedState}function Il(t,e,n,r){var s=Pn();je.flags|=t,s.memoizedState=Jo(1|e,n,void 0,r===void 0?null:r)}function Vu(t,e,n,r){var s=dn();r=r===void 0?null:r;var i=void 0;if(Xe!==null){var o=Xe.memoizedState;if(i=o.destroy,r!==null&&wf(r,o.deps)){s.memoizedState=Jo(e,n,i,r);return}}je.flags|=t,s.memoizedState=Jo(1|e,n,i,r)}function _g(t,e){return Il(8390656,8,t,e)}function Sf(t,e){return Vu(2048,8,t,e)}function q_(t,e){return Vu(4,2,t,e)}function G_(t,e){return Vu(4,4,t,e)}function K_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Q_(t,e,n){return n=n!=null?n.concat([t]):null,Vu(4,4,K_.bind(null,e,t),n)}function Tf(){}function Y_(t,e){var n=dn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function X_(t,e){var n=dn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function J_(t,e,n){return ys&21?(Tn(n,e)||(n=r_(),je.lanes|=n,vs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ft=!0),t.memoizedState=n)}function FS(t,e){var n=xe;xe=n!==0&&4>n?n:4,t(!0);var r=Xc.transition;Xc.transition={};try{t(!1),e()}finally{xe=n,Xc.transition=r}}function Z_(){return dn().memoizedState}function US(t,e,n){var r=Or(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ex(t))tx(e,n);else if(n=O_(t,e,n,r),n!==null){var s=kt();En(n,t,r,s),nx(n,e,r)}}function zS(t,e,n){var r=Or(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ex(t))tx(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Tn(l,o)){var u=e.interleaved;u===null?(s.next=s,gf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=O_(t,e,s,r),n!==null&&(s=kt(),En(n,t,r,s),nx(n,e,r))}}function ex(t){var e=t.alternate;return t===je||e!==null&&e===je}function tx(t,e){Ao=su=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function nx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tf(t,n)}}var iu={readContext:cn,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useInsertionEffect:vt,useLayoutEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useMutableSource:vt,useSyncExternalStore:vt,useId:vt,unstable_isNewReconciler:!1},BS={readContext:cn,useCallback:function(t,e){return Pn().memoizedState=[t,e===void 0?null:e],t},useContext:cn,useEffect:_g,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Il(4194308,4,K_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Il(4194308,4,t,e)},useInsertionEffect:function(t,e){return Il(4,2,t,e)},useMemo:function(t,e){var n=Pn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Pn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=US.bind(null,je,t),[r.memoizedState,t]},useRef:function(t){var e=Pn();return t={current:t},e.memoizedState=t},useState:vg,useDebugValue:Tf,useDeferredValue:function(t){return Pn().memoizedState=t},useTransition:function(){var t=vg(!1),e=t[0];return t=FS.bind(null,t[1]),Pn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=je,s=Pn();if(Ne){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),ot===null)throw Error(U(349));ys&30||U_(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,_g(B_.bind(null,r,i,t),[t]),r.flags|=2048,Jo(9,z_.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Pn(),e=ot.identifierPrefix;if(Ne){var n=Kn,r=Gn;n=(r&~(1<<32-wn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Yo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=LS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$S={readContext:cn,useCallback:Y_,useContext:cn,useEffect:Sf,useImperativeHandle:Q_,useInsertionEffect:q_,useLayoutEffect:G_,useMemo:X_,useReducer:Jc,useRef:W_,useState:function(){return Jc(Xo)},useDebugValue:Tf,useDeferredValue:function(t){var e=dn();return J_(e,Xe.memoizedState,t)},useTransition:function(){var t=Jc(Xo)[0],e=dn().memoizedState;return[t,e]},useMutableSource:L_,useSyncExternalStore:F_,useId:Z_,unstable_isNewReconciler:!1},HS={readContext:cn,useCallback:Y_,useContext:cn,useEffect:Sf,useImperativeHandle:Q_,useInsertionEffect:q_,useLayoutEffect:G_,useMemo:X_,useReducer:Zc,useRef:W_,useState:function(){return Zc(Xo)},useDebugValue:Tf,useDeferredValue:function(t){var e=dn();return Xe===null?e.memoizedState=t:J_(e,Xe.memoizedState,t)},useTransition:function(){var t=Zc(Xo)[0],e=dn().memoizedState;return[t,e]},useMutableSource:L_,useSyncExternalStore:F_,useId:Z_,unstable_isNewReconciler:!1};function yn(t,e){if(t&&t.defaultProps){e=Oe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function th(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Oe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Mu={isMounted:function(t){return(t=t._reactInternals)?Is(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=kt(),s=Or(t),i=Zn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Dr(t,i,s),e!==null&&(En(e,t,s,r),Sl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=kt(),s=Or(t),i=Zn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Dr(t,i,s),e!==null&&(En(e,t,s,r),Sl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=kt(),r=Or(t),s=Zn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Dr(t,s,r),e!==null&&(En(e,t,r,n),Sl(e,t,r))}};function xg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ho(n,r)||!Ho(s,i):!0}function rx(t,e,n){var r=!1,s=Br,i=e.contextType;return typeof i=="object"&&i!==null?i=cn(i):(s=zt(e)?ms:Tt.current,r=e.contextTypes,i=(r=r!=null)?pi(t,s):Br),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Mu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function wg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Mu.enqueueReplaceState(e,e.state,null)}function nh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},yf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=cn(i):(i=zt(e)?ms:Tt.current,s.context=pi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(th(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Mu.enqueueReplaceState(s,s.state,null),nu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function vi(t,e){try{var n="",r=e;do n+=vb(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ed(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function rh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WS=typeof WeakMap=="function"?WeakMap:Map;function sx(t,e,n){n=Zn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){au||(au=!0,fh=r),rh(t,e)},n}function ix(t,e,n){n=Zn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){rh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){rh(t,e),typeof r!="function"&&(jr===null?jr=new Set([this]):jr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Eg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=iT.bind(null,t,e,n),e.then(t,t))}function bg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Sg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Zn(-1,1),e.tag=2,Dr(n,e,1))),n.lanes|=1),t)}var qS=ur.ReactCurrentOwner,Ft=!1;function Nt(t,e,n,r){e.child=t===null?j_(e,null,n,r):gi(e,t.child,n,r)}function Tg(t,e,n,r,s){n=n.render;var i=e.ref;return ai(e,s),r=Ef(t,e,n,r,i,s),n=bf(),t!==null&&!Ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(Ne&&n&&cf(e),e.flags|=1,Nt(t,e,r,s),e.child)}function Ig(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Df(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,ox(t,e,i,r,s)):(t=Rl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ho,n(o,r)&&t.ref===e.ref)return sr(t,e,s)}return e.flags|=1,t=Vr(i,r),t.ref=e.ref,t.return=e,e.child=t}function ox(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ho(i,r)&&t.ref===e.ref)if(Ft=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ft=!0);else return e.lanes=t.lanes,sr(t,e,s)}return sh(t,e,n,r,s)}function ax(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(ei,Qt),Qt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Se(ei,Qt),Qt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Se(ei,Qt),Qt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Se(ei,Qt),Qt|=r;return Nt(t,e,s,n),e.child}function lx(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function sh(t,e,n,r,s){var i=zt(n)?ms:Tt.current;return i=pi(e,i),ai(e,s),n=Ef(t,e,n,r,i,s),r=bf(),t!==null&&!Ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(Ne&&r&&cf(e),e.flags|=1,Nt(t,e,n,s),e.child)}function Cg(t,e,n,r,s){if(zt(n)){var i=!0;Xl(e)}else i=!1;if(ai(e,s),e.stateNode===null)Cl(t,e),rx(e,n,r),nh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=cn(d):(d=zt(n)?ms:Tt.current,d=pi(e,d));var h=n.getDerivedStateFromProps,g=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&wg(e,o,r,d),xr=!1;var y=e.memoizedState;o.state=y,nu(e,r,o,s),u=e.memoizedState,l!==r||y!==u||Ut.current||xr?(typeof h=="function"&&(th(e,n,h,r),u=e.memoizedState),(l=xr||xg(e,n,l,r,y,u,d))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,V_(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:yn(e.type,l),o.props=d,g=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=cn(u):(u=zt(n)?ms:Tt.current,u=pi(e,u));var C=n.getDerivedStateFromProps;(h=typeof C=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==g||y!==u)&&wg(e,o,r,u),xr=!1,y=e.memoizedState,o.state=y,nu(e,r,o,s);var k=e.memoizedState;l!==g||y!==k||Ut.current||xr?(typeof C=="function"&&(th(e,n,C,r),k=e.memoizedState),(d=xr||xg(e,n,d,r,y,k,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,k,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,k,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),o.props=r,o.state=k,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return ih(t,e,n,r,i,s)}function ih(t,e,n,r,s,i){lx(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&hg(e,n,!1),sr(t,e,i);r=e.stateNode,qS.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=gi(e,t.child,null,i),e.child=gi(e,null,l,i)):Nt(t,e,l,i),e.memoizedState=r.state,s&&hg(e,n,!0),e.child}function ux(t){var e=t.stateNode;e.pendingContext?dg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&dg(t,e.context,!1),vf(t,e.containerInfo)}function Ag(t,e,n,r,s){return mi(),hf(s),e.flags|=256,Nt(t,e,n,r),e.child}var oh={dehydrated:null,treeContext:null,retryLane:0};function ah(t){return{baseLanes:t,cachePool:null,transitions:null}}function cx(t,e,n){var r=e.pendingProps,s=De.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Se(De,s&1),t===null)return Zd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Uu(o,r,0,null),t=ds(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ah(n),e.memoizedState=oh,t):If(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return GS(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Vr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Vr(l,i):(i=ds(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?ah(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=oh,r}return i=t.child,t=i.sibling,r=Vr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function If(t,e){return e=Uu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function il(t,e,n,r){return r!==null&&hf(r),gi(e,t.child,null,n),t=If(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function GS(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=ed(Error(U(422))),il(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Uu({mode:"visible",children:r.children},s,0,null),i=ds(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&gi(e,t.child,null,o),e.child.memoizedState=ah(o),e.memoizedState=oh,i);if(!(e.mode&1))return il(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(U(419)),r=ed(i,r,void 0),il(t,e,o,r)}if(l=(o&t.childLanes)!==0,Ft||l){if(r=ot,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,rr(t,s),En(r,t,s,-1))}return kf(),r=ed(Error(U(421))),il(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=oT.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Yt=kr(s.nextSibling),Xt=e,Ne=!0,_n=null,t!==null&&(rn[sn++]=Gn,rn[sn++]=Kn,rn[sn++]=gs,Gn=t.id,Kn=t.overflow,gs=e),e=If(e,r.children),e.flags|=4096,e)}function Pg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),eh(t.return,e,n)}function td(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function dx(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Nt(t,e,r.children,n),r=De.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Pg(t,n,e);else if(t.tag===19)Pg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Se(De,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ru(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),td(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ru(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}td(e,!0,n,null,i);break;case"together":td(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Cl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),vs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Vr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Vr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function KS(t,e,n){switch(e.tag){case 3:ux(e),mi();break;case 5:M_(e);break;case 1:zt(e.type)&&Xl(e);break;case 4:vf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Se(eu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Se(De,De.current&1),e.flags|=128,null):n&e.child.childLanes?cx(t,e,n):(Se(De,De.current&1),t=sr(t,e,n),t!==null?t.sibling:null);Se(De,De.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return dx(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Se(De,De.current),r)break;return null;case 22:case 23:return e.lanes=0,ax(t,e,n)}return sr(t,e,n)}var hx,lh,fx,px;hx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};lh=function(){};fx=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,as(Dn.current);var i=null;switch(n){case"input":s=Rd(t,s),r=Rd(t,r),i=[];break;case"select":s=Oe({},s,{value:void 0}),r=Oe({},r,{value:void 0}),i=[];break;case"textarea":s=Dd(t,s),r=Dd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ql)}Od(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Mo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Mo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ie("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};px=function(t,e,n,r){n!==r&&(e.flags|=4)};function oo(t,e){if(!Ne)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function _t(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function QS(t,e,n){var r=e.pendingProps;switch(df(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(e),null;case 1:return zt(e.type)&&Yl(),_t(e),null;case 3:return r=e.stateNode,yi(),Ae(Ut),Ae(Tt),xf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(rl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,_n!==null&&(gh(_n),_n=null))),lh(t,e),_t(e),null;case 5:_f(e);var s=as(Qo.current);if(n=e.type,t!==null&&e.stateNode!=null)fx(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return _t(e),null}if(t=as(Dn.current),rl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Nn]=e,r[Go]=i,t=(e.mode&1)!==0,n){case"dialog":Ie("cancel",r),Ie("close",r);break;case"iframe":case"object":case"embed":Ie("load",r);break;case"video":case"audio":for(s=0;s<vo.length;s++)Ie(vo[s],r);break;case"source":Ie("error",r);break;case"img":case"image":case"link":Ie("error",r),Ie("load",r);break;case"details":Ie("toggle",r);break;case"input":Lm(r,i),Ie("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ie("invalid",r);break;case"textarea":Um(r,i),Ie("invalid",r)}Od(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&nl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&nl(r.textContent,l,t),s=["children",""+l]):Mo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ie("scroll",r)}switch(n){case"input":Ka(r),Fm(r,i,!0);break;case"textarea":Ka(r),zm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ql)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Bv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Nn]=e,t[Go]=r,hx(t,e,!1,!1),e.stateNode=t;e:{switch(o=Vd(n,r),n){case"dialog":Ie("cancel",t),Ie("close",t),s=r;break;case"iframe":case"object":case"embed":Ie("load",t),s=r;break;case"video":case"audio":for(s=0;s<vo.length;s++)Ie(vo[s],t);s=r;break;case"source":Ie("error",t),s=r;break;case"img":case"image":case"link":Ie("error",t),Ie("load",t),s=r;break;case"details":Ie("toggle",t),s=r;break;case"input":Lm(t,r),s=Rd(t,r),Ie("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Oe({},r,{value:void 0}),Ie("invalid",t);break;case"textarea":Um(t,r),s=Dd(t,r),Ie("invalid",t);break;default:s=r}Od(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?Wv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&$v(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Lo(t,u):typeof u=="number"&&Lo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Mo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ie("scroll",t):u!=null&&Qh(t,i,u,o))}switch(n){case"input":Ka(t),Fm(t,r,!1);break;case"textarea":Ka(t),zm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+zr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ri(t,!!r.multiple,i,!1):r.defaultValue!=null&&ri(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ql)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _t(e),null;case 6:if(t&&e.stateNode!=null)px(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=as(Qo.current),as(Dn.current),rl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Nn]=e,(i=r.nodeValue!==n)&&(t=Xt,t!==null))switch(t.tag){case 3:nl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&nl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Nn]=e,e.stateNode=r}return _t(e),null;case 13:if(Ae(De),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ne&&Yt!==null&&e.mode&1&&!(e.flags&128))k_(),mi(),e.flags|=98560,i=!1;else if(i=rl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[Nn]=e}else mi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_t(e),i=!1}else _n!==null&&(gh(_n),_n=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||De.current&1?Je===0&&(Je=3):kf())),e.updateQueue!==null&&(e.flags|=4),_t(e),null);case 4:return yi(),lh(t,e),t===null&&Wo(e.stateNode.containerInfo),_t(e),null;case 10:return mf(e.type._context),_t(e),null;case 17:return zt(e.type)&&Yl(),_t(e),null;case 19:if(Ae(De),i=e.memoizedState,i===null)return _t(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)oo(i,!1);else{if(Je!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ru(t),o!==null){for(e.flags|=128,oo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Se(De,De.current&1|2),e.child}t=t.sibling}i.tail!==null&&$e()>_i&&(e.flags|=128,r=!0,oo(i,!1),e.lanes=4194304)}else{if(!r)if(t=ru(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),oo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ne)return _t(e),null}else 2*$e()-i.renderingStartTime>_i&&n!==1073741824&&(e.flags|=128,r=!0,oo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=$e(),e.sibling=null,n=De.current,Se(De,r?n&1|2:n&1),e):(_t(e),null);case 22:case 23:return Nf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Qt&1073741824&&(_t(e),e.subtreeFlags&6&&(e.flags|=8192)):_t(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function YS(t,e){switch(df(e),e.tag){case 1:return zt(e.type)&&Yl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return yi(),Ae(Ut),Ae(Tt),xf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _f(e),null;case 13:if(Ae(De),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));mi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ae(De),null;case 4:return yi(),null;case 10:return mf(e.type._context),null;case 22:case 23:return Nf(),null;case 24:return null;default:return null}}var ol=!1,bt=!1,XS=typeof WeakSet=="function"?WeakSet:Set,W=null;function Zs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Le(t,e,r)}else n.current=null}function uh(t,e,n){try{n()}catch(r){Le(t,e,r)}}var Rg=!1;function JS(t,e){if(qd=ql,t=__(),uf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,h=0,g=t,y=null;t:for(;;){for(var C;g!==n||s!==0&&g.nodeType!==3||(l=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(C=g.firstChild)!==null;)y=g,g=C;for(;;){if(g===t)break t;if(y===n&&++d===s&&(l=o),y===i&&++h===r&&(u=o),(C=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=C}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Gd={focusedElem:t,selectionRange:n},ql=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var w=k.memoizedProps,N=k.memoizedState,b=e.stateNode,E=b.getSnapshotBeforeUpdate(e.elementType===e.type?w:yn(e.type,w),N);b.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(S){Le(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return k=Rg,Rg=!1,k}function Po(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&uh(e,n,i)}s=s.next}while(s!==r)}}function Lu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ch(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function mx(t){var e=t.alternate;e!==null&&(t.alternate=null,mx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Nn],delete e[Go],delete e[Yd],delete e[jS],delete e[OS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function gx(t){return t.tag===5||t.tag===3||t.tag===4}function Ng(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function dh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ql));else if(r!==4&&(t=t.child,t!==null))for(dh(t,e,n),t=t.sibling;t!==null;)dh(t,e,n),t=t.sibling}function hh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(hh(t,e,n),t=t.sibling;t!==null;)hh(t,e,n),t=t.sibling}var ut=null,vn=!1;function mr(t,e,n){for(n=n.child;n!==null;)yx(t,e,n),n=n.sibling}function yx(t,e,n){if(kn&&typeof kn.onCommitFiberUnmount=="function")try{kn.onCommitFiberUnmount(Ru,n)}catch{}switch(n.tag){case 5:bt||Zs(n,e);case 6:var r=ut,s=vn;ut=null,mr(t,e,n),ut=r,vn=s,ut!==null&&(vn?(t=ut,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ut.removeChild(n.stateNode));break;case 18:ut!==null&&(vn?(t=ut,n=n.stateNode,t.nodeType===8?Kc(t.parentNode,n):t.nodeType===1&&Kc(t,n),Bo(t)):Kc(ut,n.stateNode));break;case 4:r=ut,s=vn,ut=n.stateNode.containerInfo,vn=!0,mr(t,e,n),ut=r,vn=s;break;case 0:case 11:case 14:case 15:if(!bt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&uh(n,e,o),s=s.next}while(s!==r)}mr(t,e,n);break;case 1:if(!bt&&(Zs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Le(n,e,l)}mr(t,e,n);break;case 21:mr(t,e,n);break;case 22:n.mode&1?(bt=(r=bt)||n.memoizedState!==null,mr(t,e,n),bt=r):mr(t,e,n);break;default:mr(t,e,n)}}function kg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new XS),e.forEach(function(r){var s=aT.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function mn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ut=l.stateNode,vn=!1;break e;case 3:ut=l.stateNode.containerInfo,vn=!0;break e;case 4:ut=l.stateNode.containerInfo,vn=!0;break e}l=l.return}if(ut===null)throw Error(U(160));yx(i,o,s),ut=null,vn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Le(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vx(e,t),e=e.sibling}function vx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(mn(e,t),An(t),r&4){try{Po(3,t,t.return),Lu(3,t)}catch(w){Le(t,t.return,w)}try{Po(5,t,t.return)}catch(w){Le(t,t.return,w)}}break;case 1:mn(e,t),An(t),r&512&&n!==null&&Zs(n,n.return);break;case 5:if(mn(e,t),An(t),r&512&&n!==null&&Zs(n,n.return),t.flags&32){var s=t.stateNode;try{Lo(s,"")}catch(w){Le(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Uv(s,i),Vd(l,o);var d=Vd(l,i);for(o=0;o<u.length;o+=2){var h=u[o],g=u[o+1];h==="style"?Wv(s,g):h==="dangerouslySetInnerHTML"?$v(s,g):h==="children"?Lo(s,g):Qh(s,h,g,d)}switch(l){case"input":Nd(s,i);break;case"textarea":zv(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?ri(s,!!i.multiple,C,!1):y!==!!i.multiple&&(i.defaultValue!=null?ri(s,!!i.multiple,i.defaultValue,!0):ri(s,!!i.multiple,i.multiple?[]:"",!1))}s[Go]=i}catch(w){Le(t,t.return,w)}}break;case 6:if(mn(e,t),An(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){Le(t,t.return,w)}}break;case 3:if(mn(e,t),An(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Bo(e.containerInfo)}catch(w){Le(t,t.return,w)}break;case 4:mn(e,t),An(t);break;case 13:mn(e,t),An(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Pf=$e())),r&4&&kg(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(bt=(d=bt)||h,mn(e,t),bt=d):mn(e,t),An(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(W=t,h=t.child;h!==null;){for(g=W=h;W!==null;){switch(y=W,C=y.child,y.tag){case 0:case 11:case 14:case 15:Po(4,y,y.return);break;case 1:Zs(y,y.return);var k=y.stateNode;if(typeof k.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(w){Le(r,n,w)}}break;case 5:Zs(y,y.return);break;case 22:if(y.memoizedState!==null){jg(g);continue}}C!==null?(C.return=y,W=C):jg(g)}h=h.sibling}e:for(h=null,g=t;;){if(g.tag===5){if(h===null){h=g;try{s=g.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Hv("display",o))}catch(w){Le(t,t.return,w)}}}else if(g.tag===6){if(h===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(w){Le(t,t.return,w)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;h===g&&(h=null),g=g.return}h===g&&(h=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:mn(e,t),An(t),r&4&&kg(t);break;case 21:break;default:mn(e,t),An(t)}}function An(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(gx(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Lo(s,""),r.flags&=-33);var i=Ng(t);hh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Ng(t);dh(t,l,o);break;default:throw Error(U(161))}}catch(u){Le(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ZS(t,e,n){W=t,_x(t)}function _x(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var s=W,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||ol;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||bt;l=ol;var d=bt;if(ol=o,(bt=u)&&!d)for(W=s;W!==null;)o=W,u=o.child,o.tag===22&&o.memoizedState!==null?Og(s):u!==null?(u.return=o,W=u):Og(s);for(;i!==null;)W=i,_x(i),i=i.sibling;W=s,ol=l,bt=d}Dg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,W=i):Dg(t)}}function Dg(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bt||Lu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!bt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:yn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&yg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}yg(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var g=h.dehydrated;g!==null&&Bo(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}bt||e.flags&512&&ch(e)}catch(y){Le(e,e.return,y)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function jg(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function Og(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Lu(4,e)}catch(u){Le(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Le(e,s,u)}}var i=e.return;try{ch(e)}catch(u){Le(e,i,u)}break;case 5:var o=e.return;try{ch(e)}catch(u){Le(e,o,u)}}}catch(u){Le(e,e.return,u)}if(e===t){W=null;break}var l=e.sibling;if(l!==null){l.return=e.return,W=l;break}W=e.return}}var eT=Math.ceil,ou=ur.ReactCurrentDispatcher,Cf=ur.ReactCurrentOwner,ln=ur.ReactCurrentBatchConfig,fe=0,ot=null,qe=null,ht=0,Qt=0,ei=Kr(0),Je=0,Zo=null,vs=0,Fu=0,Af=0,Ro=null,Lt=null,Pf=0,_i=1/0,Hn=null,au=!1,fh=null,jr=null,al=!1,Cr=null,lu=0,No=0,ph=null,Al=-1,Pl=0;function kt(){return fe&6?$e():Al!==-1?Al:Al=$e()}function Or(t){return t.mode&1?fe&2&&ht!==0?ht&-ht:MS.transition!==null?(Pl===0&&(Pl=r_()),Pl):(t=xe,t!==0||(t=window.event,t=t===void 0?16:c_(t.type)),t):1}function En(t,e,n,r){if(50<No)throw No=0,ph=null,Error(U(185));ha(t,n,r),(!(fe&2)||t!==ot)&&(t===ot&&(!(fe&2)&&(Fu|=n),Je===4&&Er(t,ht)),Bt(t,r),n===1&&fe===0&&!(e.mode&1)&&(_i=$e()+500,Ou&&Qr()))}function Bt(t,e){var n=t.callbackNode;Mb(t,e);var r=Wl(t,t===ot?ht:0);if(r===0)n!==null&&Hm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Hm(n),e===1)t.tag===0?VS(Vg.bind(null,t)):P_(Vg.bind(null,t)),kS(function(){!(fe&6)&&Qr()}),n=null;else{switch(s_(r)){case 1:n=ef;break;case 4:n=t_;break;case 16:n=Hl;break;case 536870912:n=n_;break;default:n=Hl}n=Cx(n,xx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function xx(t,e){if(Al=-1,Pl=0,fe&6)throw Error(U(327));var n=t.callbackNode;if(li()&&t.callbackNode!==n)return null;var r=Wl(t,t===ot?ht:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=uu(t,r);else{e=r;var s=fe;fe|=2;var i=Ex();(ot!==t||ht!==e)&&(Hn=null,_i=$e()+500,cs(t,e));do try{rT();break}catch(l){wx(t,l)}while(!0);pf(),ou.current=i,fe=s,qe!==null?e=0:(ot=null,ht=0,e=Je)}if(e!==0){if(e===2&&(s=zd(t),s!==0&&(r=s,e=mh(t,s))),e===1)throw n=Zo,cs(t,0),Er(t,r),Bt(t,$e()),n;if(e===6)Er(t,r);else{if(s=t.current.alternate,!(r&30)&&!tT(s)&&(e=uu(t,r),e===2&&(i=zd(t),i!==0&&(r=i,e=mh(t,i))),e===1))throw n=Zo,cs(t,0),Er(t,r),Bt(t,$e()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:rs(t,Lt,Hn);break;case 3:if(Er(t,r),(r&130023424)===r&&(e=Pf+500-$e(),10<e)){if(Wl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){kt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Qd(rs.bind(null,t,Lt,Hn),e);break}rs(t,Lt,Hn);break;case 4:if(Er(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-wn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=$e()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*eT(r/1960))-r,10<r){t.timeoutHandle=Qd(rs.bind(null,t,Lt,Hn),r);break}rs(t,Lt,Hn);break;case 5:rs(t,Lt,Hn);break;default:throw Error(U(329))}}}return Bt(t,$e()),t.callbackNode===n?xx.bind(null,t):null}function mh(t,e){var n=Ro;return t.current.memoizedState.isDehydrated&&(cs(t,e).flags|=256),t=uu(t,e),t!==2&&(e=Lt,Lt=n,e!==null&&gh(e)),t}function gh(t){Lt===null?Lt=t:Lt.push.apply(Lt,t)}function tT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Tn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Er(t,e){for(e&=~Af,e&=~Fu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-wn(e),r=1<<n;t[n]=-1,e&=~r}}function Vg(t){if(fe&6)throw Error(U(327));li();var e=Wl(t,0);if(!(e&1))return Bt(t,$e()),null;var n=uu(t,e);if(t.tag!==0&&n===2){var r=zd(t);r!==0&&(e=r,n=mh(t,r))}if(n===1)throw n=Zo,cs(t,0),Er(t,e),Bt(t,$e()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,rs(t,Lt,Hn),Bt(t,$e()),null}function Rf(t,e){var n=fe;fe|=1;try{return t(e)}finally{fe=n,fe===0&&(_i=$e()+500,Ou&&Qr())}}function _s(t){Cr!==null&&Cr.tag===0&&!(fe&6)&&li();var e=fe;fe|=1;var n=ln.transition,r=xe;try{if(ln.transition=null,xe=1,t)return t()}finally{xe=r,ln.transition=n,fe=e,!(fe&6)&&Qr()}}function Nf(){Qt=ei.current,Ae(ei)}function cs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,NS(n)),qe!==null)for(n=qe.return;n!==null;){var r=n;switch(df(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Yl();break;case 3:yi(),Ae(Ut),Ae(Tt),xf();break;case 5:_f(r);break;case 4:yi();break;case 13:Ae(De);break;case 19:Ae(De);break;case 10:mf(r.type._context);break;case 22:case 23:Nf()}n=n.return}if(ot=t,qe=t=Vr(t.current,null),ht=Qt=e,Je=0,Zo=null,Af=Fu=vs=0,Lt=Ro=null,os!==null){for(e=0;e<os.length;e++)if(n=os[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}os=null}return t}function wx(t,e){do{var n=qe;try{if(pf(),Tl.current=iu,su){for(var r=je.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}su=!1}if(ys=0,it=Xe=je=null,Ao=!1,Yo=0,Cf.current=null,n===null||n.return===null){Je=1,Zo=e,qe=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=ht,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,g=h.tag;if(!(h.mode&1)&&(g===0||g===11||g===15)){var y=h.alternate;y?(h.updateQueue=y.updateQueue,h.memoizedState=y.memoizedState,h.lanes=y.lanes):(h.updateQueue=null,h.memoizedState=null)}var C=bg(o);if(C!==null){C.flags&=-257,Sg(C,o,l,i,e),C.mode&1&&Eg(i,d,e),e=C,u=d;var k=e.updateQueue;if(k===null){var w=new Set;w.add(u),e.updateQueue=w}else k.add(u);break e}else{if(!(e&1)){Eg(i,d,e),kf();break e}u=Error(U(426))}}else if(Ne&&l.mode&1){var N=bg(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Sg(N,o,l,i,e),hf(vi(u,l));break e}}i=u=vi(u,l),Je!==4&&(Je=2),Ro===null?Ro=[i]:Ro.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=sx(i,u,e);gg(i,b);break e;case 1:l=u;var E=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(jr===null||!jr.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=ix(i,l,e);gg(i,S);break e}}i=i.return}while(i!==null)}Sx(n)}catch(P){e=P,qe===n&&n!==null&&(qe=n=n.return);continue}break}while(!0)}function Ex(){var t=ou.current;return ou.current=iu,t===null?iu:t}function kf(){(Je===0||Je===3||Je===2)&&(Je=4),ot===null||!(vs&268435455)&&!(Fu&268435455)||Er(ot,ht)}function uu(t,e){var n=fe;fe|=2;var r=Ex();(ot!==t||ht!==e)&&(Hn=null,cs(t,e));do try{nT();break}catch(s){wx(t,s)}while(!0);if(pf(),fe=n,ou.current=r,qe!==null)throw Error(U(261));return ot=null,ht=0,Je}function nT(){for(;qe!==null;)bx(qe)}function rT(){for(;qe!==null&&!Ab();)bx(qe)}function bx(t){var e=Ix(t.alternate,t,Qt);t.memoizedProps=t.pendingProps,e===null?Sx(t):qe=e,Cf.current=null}function Sx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=YS(n,e),n!==null){n.flags&=32767,qe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Je=6,qe=null;return}}else if(n=QS(n,e,Qt),n!==null){qe=n;return}if(e=e.sibling,e!==null){qe=e;return}qe=e=t}while(e!==null);Je===0&&(Je=5)}function rs(t,e,n){var r=xe,s=ln.transition;try{ln.transition=null,xe=1,sT(t,e,n,r)}finally{ln.transition=s,xe=r}return null}function sT(t,e,n,r){do li();while(Cr!==null);if(fe&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Lb(t,i),t===ot&&(qe=ot=null,ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||al||(al=!0,Cx(Hl,function(){return li(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=ln.transition,ln.transition=null;var o=xe;xe=1;var l=fe;fe|=4,Cf.current=null,JS(t,n),vx(n,t),SS(Gd),ql=!!qd,Gd=qd=null,t.current=n,ZS(n),Pb(),fe=l,xe=o,ln.transition=i}else t.current=n;if(al&&(al=!1,Cr=t,lu=s),i=t.pendingLanes,i===0&&(jr=null),kb(n.stateNode),Bt(t,$e()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(au)throw au=!1,t=fh,fh=null,t;return lu&1&&t.tag!==0&&li(),i=t.pendingLanes,i&1?t===ph?No++:(No=0,ph=t):No=0,Qr(),null}function li(){if(Cr!==null){var t=s_(lu),e=ln.transition,n=xe;try{if(ln.transition=null,xe=16>t?16:t,Cr===null)var r=!1;else{if(t=Cr,Cr=null,lu=0,fe&6)throw Error(U(331));var s=fe;for(fe|=4,W=t.current;W!==null;){var i=W,o=i.child;if(W.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(W=d;W!==null;){var h=W;switch(h.tag){case 0:case 11:case 15:Po(8,h,i)}var g=h.child;if(g!==null)g.return=h,W=g;else for(;W!==null;){h=W;var y=h.sibling,C=h.return;if(mx(h),h===d){W=null;break}if(y!==null){y.return=C,W=y;break}W=C}}}var k=i.alternate;if(k!==null){var w=k.child;if(w!==null){k.child=null;do{var N=w.sibling;w.sibling=null,w=N}while(w!==null)}}W=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,W=o;else e:for(;W!==null;){if(i=W,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Po(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,W=b;break e}W=i.return}}var E=t.current;for(W=E;W!==null;){o=W;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,W=v;else e:for(o=E;W!==null;){if(l=W,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Lu(9,l)}}catch(P){Le(l,l.return,P)}if(l===o){W=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,W=S;break e}W=l.return}}if(fe=s,Qr(),kn&&typeof kn.onPostCommitFiberRoot=="function")try{kn.onPostCommitFiberRoot(Ru,t)}catch{}r=!0}return r}finally{xe=n,ln.transition=e}}return!1}function Mg(t,e,n){e=vi(n,e),e=sx(t,e,1),t=Dr(t,e,1),e=kt(),t!==null&&(ha(t,1,e),Bt(t,e))}function Le(t,e,n){if(t.tag===3)Mg(t,t,n);else for(;e!==null;){if(e.tag===3){Mg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(jr===null||!jr.has(r))){t=vi(n,t),t=ix(e,t,1),e=Dr(e,t,1),t=kt(),e!==null&&(ha(e,1,t),Bt(e,t));break}}e=e.return}}function iT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=kt(),t.pingedLanes|=t.suspendedLanes&n,ot===t&&(ht&n)===n&&(Je===4||Je===3&&(ht&130023424)===ht&&500>$e()-Pf?cs(t,0):Af|=n),Bt(t,e)}function Tx(t,e){e===0&&(t.mode&1?(e=Xa,Xa<<=1,!(Xa&130023424)&&(Xa=4194304)):e=1);var n=kt();t=rr(t,e),t!==null&&(ha(t,e,n),Bt(t,n))}function oT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Tx(t,n)}function aT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),Tx(t,n)}var Ix;Ix=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ut.current)Ft=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ft=!1,KS(t,e,n);Ft=!!(t.flags&131072)}else Ft=!1,Ne&&e.flags&1048576&&R_(e,Zl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Cl(t,e),t=e.pendingProps;var s=pi(e,Tt.current);ai(e,n),s=Ef(null,e,r,t,s,n);var i=bf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,zt(r)?(i=!0,Xl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,yf(e),s.updater=Mu,e.stateNode=s,s._reactInternals=e,nh(e,r,t,n),e=ih(null,e,r,!0,i,n)):(e.tag=0,Ne&&i&&cf(e),Nt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Cl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=uT(r),t=yn(r,t),s){case 0:e=sh(null,e,r,t,n);break e;case 1:e=Cg(null,e,r,t,n);break e;case 11:e=Tg(null,e,r,t,n);break e;case 14:e=Ig(null,e,r,yn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:yn(r,s),sh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:yn(r,s),Cg(t,e,r,s,n);case 3:e:{if(ux(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,V_(t,e),nu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=vi(Error(U(423)),e),e=Ag(t,e,r,n,s);break e}else if(r!==s){s=vi(Error(U(424)),e),e=Ag(t,e,r,n,s);break e}else for(Yt=kr(e.stateNode.containerInfo.firstChild),Xt=e,Ne=!0,_n=null,n=j_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(mi(),r===s){e=sr(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return M_(e),t===null&&Zd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Kd(r,s)?o=null:i!==null&&Kd(r,i)&&(e.flags|=32),lx(t,e),Nt(t,e,o,n),e.child;case 6:return t===null&&Zd(e),null;case 13:return cx(t,e,n);case 4:return vf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=gi(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:yn(r,s),Tg(t,e,r,s,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Se(eu,r._currentValue),r._currentValue=o,i!==null)if(Tn(i.value,o)){if(i.children===s.children&&!Ut.current){e=sr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Zn(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),eh(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),eh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Nt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ai(e,n),s=cn(s),r=r(s),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,s=yn(r,e.pendingProps),s=yn(r.type,s),Ig(t,e,r,s,n);case 15:return ox(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:yn(r,s),Cl(t,e),e.tag=1,zt(r)?(t=!0,Xl(e)):t=!1,ai(e,n),rx(e,r,s),nh(e,r,s,n),ih(null,e,r,!0,t,n);case 19:return dx(t,e,n);case 22:return ax(t,e,n)}throw Error(U(156,e.tag))};function Cx(t,e){return e_(t,e)}function lT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(t,e,n,r){return new lT(t,e,n,r)}function Df(t){return t=t.prototype,!(!t||!t.isReactComponent)}function uT(t){if(typeof t=="function")return Df(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xh)return 11;if(t===Jh)return 14}return 2}function Vr(t,e){var n=t.alternate;return n===null?(n=an(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Rl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Df(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Hs:return ds(n.children,s,i,e);case Yh:o=8,s|=8;break;case Id:return t=an(12,n,e,s|2),t.elementType=Id,t.lanes=i,t;case Cd:return t=an(13,n,e,s),t.elementType=Cd,t.lanes=i,t;case Ad:return t=an(19,n,e,s),t.elementType=Ad,t.lanes=i,t;case Mv:return Uu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ov:o=10;break e;case Vv:o=9;break e;case Xh:o=11;break e;case Jh:o=14;break e;case _r:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=an(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ds(t,e,n,r){return t=an(7,t,r,e),t.lanes=n,t}function Uu(t,e,n,r){return t=an(22,t,r,e),t.elementType=Mv,t.lanes=n,t.stateNode={isHidden:!1},t}function nd(t,e,n){return t=an(6,t,null,e),t.lanes=n,t}function rd(t,e,n){return e=an(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cT(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mc(0),this.expirationTimes=Mc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function jf(t,e,n,r,s,i,o,l,u){return t=new cT(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=an(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yf(i),t}function dT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$s,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Ax(t){if(!t)return Br;t=t._reactInternals;e:{if(Is(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(zt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(zt(n))return A_(t,n,e)}return e}function Px(t,e,n,r,s,i,o,l,u){return t=jf(n,r,!0,t,s,i,o,l,u),t.context=Ax(null),n=t.current,r=kt(),s=Or(n),i=Zn(r,s),i.callback=e??null,Dr(n,i,s),t.current.lanes=s,ha(t,s,r),Bt(t,r),t}function zu(t,e,n,r){var s=e.current,i=kt(),o=Or(s);return n=Ax(n),e.context===null?e.context=n:e.pendingContext=n,e=Zn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Dr(s,e,o),t!==null&&(En(t,s,o,i),Sl(t,s,o)),o}function cu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Lg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Of(t,e){Lg(t,e),(t=t.alternate)&&Lg(t,e)}function hT(){return null}var Rx=typeof reportError=="function"?reportError:function(t){console.error(t)};function Vf(t){this._internalRoot=t}Bu.prototype.render=Vf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));zu(t,e,null,null)};Bu.prototype.unmount=Vf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_s(function(){zu(null,t,null,null)}),e[nr]=null}};function Bu(t){this._internalRoot=t}Bu.prototype.unstable_scheduleHydration=function(t){if(t){var e=a_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wr.length&&e!==0&&e<wr[n].priority;n++);wr.splice(n,0,t),n===0&&u_(t)}};function Mf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $u(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Fg(){}function fT(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=cu(o);i.call(d)}}var o=Px(e,r,t,0,null,!1,!1,"",Fg);return t._reactRootContainer=o,t[nr]=o.current,Wo(t.nodeType===8?t.parentNode:t),_s(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=cu(u);l.call(d)}}var u=jf(t,0,!1,null,null,!1,!1,"",Fg);return t._reactRootContainer=u,t[nr]=u.current,Wo(t.nodeType===8?t.parentNode:t),_s(function(){zu(e,u,n,r)}),u}function Hu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=cu(o);l.call(u)}}zu(e,o,t,s)}else o=fT(n,e,t,s,r);return cu(o)}i_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=yo(e.pendingLanes);n!==0&&(tf(e,n|1),Bt(e,$e()),!(fe&6)&&(_i=$e()+500,Qr()))}break;case 13:_s(function(){var r=rr(t,1);if(r!==null){var s=kt();En(r,t,1,s)}}),Of(t,1)}};nf=function(t){if(t.tag===13){var e=rr(t,134217728);if(e!==null){var n=kt();En(e,t,134217728,n)}Of(t,134217728)}};o_=function(t){if(t.tag===13){var e=Or(t),n=rr(t,e);if(n!==null){var r=kt();En(n,t,e,r)}Of(t,e)}};a_=function(){return xe};l_=function(t,e){var n=xe;try{return xe=t,e()}finally{xe=n}};Ld=function(t,e,n){switch(e){case"input":if(Nd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ju(r);if(!s)throw Error(U(90));Fv(r),Nd(r,s)}}}break;case"textarea":zv(t,n);break;case"select":e=n.value,e!=null&&ri(t,!!n.multiple,e,!1)}};Kv=Rf;Qv=_s;var pT={usingClientEntryPoint:!1,Events:[pa,Ks,ju,qv,Gv,Rf]},ao={findFiberByHostInstance:is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mT={bundleType:ao.bundleType,version:ao.version,rendererPackageName:ao.rendererPackageName,rendererConfig:ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ur.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Jv(t),t===null?null:t.stateNode},findFiberByHostInstance:ao.findFiberByHostInstance||hT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ll.isDisabled&&ll.supportsFiber)try{Ru=ll.inject(mT),kn=ll}catch{}}tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pT;tn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mf(e))throw Error(U(200));return dT(t,e,null,n)};tn.createRoot=function(t,e){if(!Mf(t))throw Error(U(299));var n=!1,r="",s=Rx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=jf(t,1,!1,null,null,n,!1,r,s),t[nr]=e.current,Wo(t.nodeType===8?t.parentNode:t),new Vf(e)};tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=Jv(e),t=t===null?null:t.stateNode,t};tn.flushSync=function(t){return _s(t)};tn.hydrate=function(t,e,n){if(!$u(e))throw Error(U(200));return Hu(null,t,e,!0,n)};tn.hydrateRoot=function(t,e,n){if(!Mf(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Rx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Px(e,null,t,1,n??null,s,!1,i,o),t[nr]=e.current,Wo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Bu(e)};tn.render=function(t,e,n){if(!$u(e))throw Error(U(200));return Hu(null,t,e,!1,n)};tn.unmountComponentAtNode=function(t){if(!$u(t))throw Error(U(40));return t._reactRootContainer?(_s(function(){Hu(null,null,t,!1,function(){t._reactRootContainer=null,t[nr]=null})}),!0):!1};tn.unstable_batchedUpdates=Rf;tn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$u(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return Hu(t,e,n,!1,r)};tn.version="18.3.1-next-f1338f8080-20240426";function Nx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Nx)}catch(t){console.error(t)}}Nx(),Nv.exports=tn;var ga=Nv.exports,Ug=ga;Sd.createRoot=Ug.createRoot,Sd.hydrateRoot=Ug.hydrateRoot;var zg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},gT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Dx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,g=(i&3)<<4|l>>4;let y=(l&15)<<2|d>>6,C=d&63;u||(C=64,o||(y=64)),r.push(n[h],n[g],n[y],n[C])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(kx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||g==null)throw new yT;const y=i<<2|l>>4;if(r.push(y),d!==64){const C=l<<4&240|d>>2;if(r.push(C),g!==64){const k=d<<6&192|g;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vT=function(t){const e=kx(t);return Dx.encodeByteArray(e,!0)},du=function(t){return vT(t).replace(/\./g,"")},jx=function(t){try{return Dx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT=()=>_T().__FIREBASE_DEFAULTS__,wT=()=>{if(typeof process>"u"||typeof zg>"u")return;const t=zg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ET=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&jx(t[1]);return e&&JSON.parse(e)},Wu=()=>{try{return xT()||wT()||ET()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ox=t=>{var e,n;return(n=(e=Wu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},bT=t=>{const e=Ox(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Vx=()=>{var t;return(t=Wu())===null||t===void 0?void 0:t.config},Mx=t=>{var e;return(e=Wu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[du(JSON.stringify(n)),du(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function IT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(It())}function CT(){var t;const e=(t=Wu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function AT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function RT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NT(){const t=It();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function kT(){return!CT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function DT(){try{return typeof indexedDB=="object"}catch{return!1}}function jT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="FirebaseError";class cr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=OT,Object.setPrototypeOf(this,cr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ya.prototype.create)}}class ya{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?VT(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new cr(s,l,r)}}function VT(t,e){return t.replace(MT,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const MT=/\{\$([^}]+)}/g;function LT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function hu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Bg(i)&&Bg(o)){if(!hu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Bg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function va(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function FT(t,e){const n=new UT(t,e);return n.subscribe.bind(n)}class UT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");zT(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=sd),s.error===void 0&&(s.error=sd),s.complete===void 0&&(s.complete=sd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function sd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(t){return t&&t._delegate?t._delegate:t}class xs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ST;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HT(e))try{this.getOrInitializeService({instanceIdentifier:ss})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ss){return this.instances.has(e)}getOptions(e=ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$T(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ss){return this.component?this.component.multipleInstances?e:ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $T(t){return t===ss?void 0:t}function HT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new BT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const qT={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},GT=de.INFO,KT={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},QT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=KT[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Lf{constructor(e){this.name=e,this._logLevel=GT,this._logHandler=QT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}const YT=(t,e)=>e.some(n=>t instanceof n);let $g,Hg;function XT(){return $g||($g=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JT(){return Hg||(Hg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lx=new WeakMap,yh=new WeakMap,Fx=new WeakMap,id=new WeakMap,Ff=new WeakMap;function ZT(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Mr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Lx.set(n,t)}).catch(()=>{}),Ff.set(e,t),e}function eI(t){if(yh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});yh.set(t,e)}let vh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return yh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Fx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Mr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tI(t){vh=t(vh)}function nI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(od(this),e,...n);return Fx.set(r,e.sort?e.sort():[e]),Mr(r)}:JT().includes(t)?function(...e){return t.apply(od(this),e),Mr(Lx.get(this))}:function(...e){return Mr(t.apply(od(this),e))}}function rI(t){return typeof t=="function"?nI(t):(t instanceof IDBTransaction&&eI(t),YT(t,XT())?new Proxy(t,vh):t)}function Mr(t){if(t instanceof IDBRequest)return ZT(t);if(id.has(t))return id.get(t);const e=rI(t);return e!==t&&(id.set(t,e),Ff.set(e,t)),e}const od=t=>Ff.get(t);function sI(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Mr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Mr(o.result),u.oldVersion,u.newVersion,Mr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const iI=["get","getKey","getAll","getAllKeys","count"],oI=["put","add","delete","clear"],ad=new Map;function Wg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ad.get(e))return ad.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=oI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||iI.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return ad.set(e,i),i}tI(t=>({...t,get:(e,n,r)=>Wg(e,n)||t.get(e,n,r),has:(e,n)=>!!Wg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const _h="@firebase/app",qg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir=new Lf("@firebase/app"),uI="@firebase/app-compat",cI="@firebase/analytics-compat",dI="@firebase/analytics",hI="@firebase/app-check-compat",fI="@firebase/app-check",pI="@firebase/auth",mI="@firebase/auth-compat",gI="@firebase/database",yI="@firebase/data-connect",vI="@firebase/database-compat",_I="@firebase/functions",xI="@firebase/functions-compat",wI="@firebase/installations",EI="@firebase/installations-compat",bI="@firebase/messaging",SI="@firebase/messaging-compat",TI="@firebase/performance",II="@firebase/performance-compat",CI="@firebase/remote-config",AI="@firebase/remote-config-compat",PI="@firebase/storage",RI="@firebase/storage-compat",NI="@firebase/firestore",kI="@firebase/vertexai-preview",DI="@firebase/firestore-compat",jI="firebase",OI="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh="[DEFAULT]",VI={[_h]:"fire-core",[uI]:"fire-core-compat",[dI]:"fire-analytics",[cI]:"fire-analytics-compat",[fI]:"fire-app-check",[hI]:"fire-app-check-compat",[pI]:"fire-auth",[mI]:"fire-auth-compat",[gI]:"fire-rtdb",[yI]:"fire-data-connect",[vI]:"fire-rtdb-compat",[_I]:"fire-fn",[xI]:"fire-fn-compat",[wI]:"fire-iid",[EI]:"fire-iid-compat",[bI]:"fire-fcm",[SI]:"fire-fcm-compat",[TI]:"fire-perf",[II]:"fire-perf-compat",[CI]:"fire-rc",[AI]:"fire-rc-compat",[PI]:"fire-gcs",[RI]:"fire-gcs-compat",[NI]:"fire-fst",[DI]:"fire-fst-compat",[kI]:"fire-vertex","fire-js":"fire-js",[jI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu=new Map,MI=new Map,wh=new Map;function Gg(t,e){try{t.container.addComponent(e)}catch(n){ir.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function xi(t){const e=t.name;if(wh.has(e))return ir.debug(`There were multiple attempts to register component ${e}.`),!1;wh.set(e,t);for(const n of fu.values())Gg(n,t);for(const n of MI.values())Gg(n,t);return!0}function Uf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lr=new ya("app","Firebase",LI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new xs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki=OI;function Ux(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:xh,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Lr.create("bad-app-name",{appName:String(s)});if(n||(n=Vx()),!n)throw Lr.create("no-options");const i=fu.get(s);if(i){if(hu(n,i.options)&&hu(r,i.config))return i;throw Lr.create("duplicate-app",{appName:s})}const o=new WT(s);for(const u of wh.values())o.addComponent(u);const l=new FI(n,r,o);return fu.set(s,l),l}function zx(t=xh){const e=fu.get(t);if(!e&&t===xh&&Vx())return Ux();if(!e)throw Lr.create("no-app",{appName:t});return e}function Fr(t,e,n){var r;let s=(r=VI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ir.warn(l.join(" "));return}xi(new xs(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI="firebase-heartbeat-database",zI=1,ea="firebase-heartbeat-store";let ld=null;function Bx(){return ld||(ld=sI(UI,zI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ea)}catch(n){console.warn(n)}}}}).catch(t=>{throw Lr.create("idb-open",{originalErrorMessage:t.message})})),ld}async function BI(t){try{const n=(await Bx()).transaction(ea),r=await n.objectStore(ea).get($x(t));return await n.done,r}catch(e){if(e instanceof cr)ir.warn(e.message);else{const n=Lr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ir.warn(n.message)}}}async function Kg(t,e){try{const r=(await Bx()).transaction(ea,"readwrite");await r.objectStore(ea).put(e,$x(t)),await r.done}catch(n){if(n instanceof cr)ir.warn(n.message);else{const r=Lr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ir.warn(r.message)}}}function $x(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I=1024,HI=30*24*60*60*1e3;class WI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new GI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Qg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=HI}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ir.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Qg(),{heartbeatsToSend:r,unsentEntries:s}=qI(this._heartbeatsCache.heartbeats),i=du(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ir.warn(n),""}}}function Qg(){return new Date().toISOString().substring(0,10)}function qI(t,e=$I){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Yg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Yg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class GI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return DT()?jT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await BI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Kg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Kg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Yg(t){return du(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(t){xi(new xs("platform-logger",e=>new aI(e),"PRIVATE")),xi(new xs("heartbeat",e=>new WI(e),"PRIVATE")),Fr(_h,qg,t),Fr(_h,qg,"esm2017"),Fr("fire-js","")}KI("");function zf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Hx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QI=Hx,Wx=new ya("auth","Firebase",Hx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu=new Lf("@firebase/auth");function YI(t,...e){pu.logLevel<=de.WARN&&pu.warn(`Auth (${ki}): ${t}`,...e)}function Nl(t,...e){pu.logLevel<=de.ERROR&&pu.error(`Auth (${ki}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(t,...e){throw $f(t,...e)}function bn(t,...e){return $f(t,...e)}function Bf(t,e,n){const r=Object.assign(Object.assign({},QI()),{[e]:n});return new ya("auth","Firebase",r).create(e,{appName:t.name})}function hs(t){return Bf(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function XI(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Mn(t,"argument-error"),Bf(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $f(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Wx.create(t,...e)}function ee(t,e,...n){if(!t)throw $f(e,...n)}function Yn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Nl(e),new Error(e)}function or(t,e){t||Yn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function JI(){return Xg()==="http:"||Xg()==="https:"}function Xg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JI()||PT()||"connection"in navigator)?navigator.onLine:!0}function eC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,n){this.shortDelay=e,this.longDelay=n,or(n>e,"Short delay should be less than long delay!"),this.isMobile=IT()||RT()}get(){return ZI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hf(t,e){or(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nC=new _a(3e4,6e4);function Wf(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Di(t,e,n,r,s={}){return Gx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=va(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return AT()||(d.referrerPolicy="no-referrer"),qx.fetch()(Kx(t,t.config.apiHost,n,l),d)})}async function Gx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},tC),e);try{const s=new sC(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ul(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ul(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw ul(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw ul(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Bf(t,h,d);Mn(t,h)}}catch(s){if(s instanceof cr)throw s;Mn(t,"network-request-failed",{message:String(s)})}}async function rC(t,e,n,r,s={}){const i=await Di(t,e,n,r,s);return"mfaPendingCredential"in i&&Mn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Kx(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Hf(t.config,s):`${t.config.apiScheme}://${s}`}class sC{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(bn(this.auth,"network-request-failed")),nC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ul(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=bn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iC(t,e){return Di(t,"POST","/v1/accounts:delete",e)}async function Qx(t,e){return Di(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ko(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oC(t,e=!1){const n=jt(t),r=await n.getIdToken(e),s=qf(r);ee(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ko(ud(s.auth_time)),issuedAtTime:ko(ud(s.iat)),expirationTime:ko(ud(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function ud(t){return Number(t)*1e3}function qf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Nl("JWT malformed, contained fewer than 3 sections"),null;try{const s=jx(n);return s?JSON.parse(s):(Nl("Failed to decode base64 JWT payload"),null)}catch(s){return Nl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Jg(t){const e=qf(t);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ta(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof cr&&aC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function aC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ko(this.lastLoginAt),this.creationTime=ko(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await ta(t,Qx(n,{idToken:r}));ee(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Yx(i.providerUserInfo):[],l=cC(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=u?d:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new bh(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,g)}async function uC(t){const e=jt(t);await mu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function cC(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Yx(t){return t.map(e=>{var{providerId:n}=e,r=zf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dC(t,e){const n=await Gx(t,{},async()=>{const r=va({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=Kx(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",qx.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function hC(t,e){return Di(t,"POST","/v2/accounts:revokeToken",Wf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const n=Jg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await dC(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ui;return r&&(ee(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ee(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ee(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ui,this.toJSON())}_performRefresh(){return Yn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(t,e){ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=zf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new lC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new bh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ta(this,this.stsTokenManager.getToken(this.auth,e));return ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return oC(this,e)}reload(){return uC(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Xn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await mu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qn(this.auth.app))return Promise.reject(hs(this.auth));const e=await this.getIdToken();return await ta(this,iC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,u,d,h;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(s=n.email)!==null&&s!==void 0?s:void 0,C=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,k=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(l=n.tenantId)!==null&&l!==void 0?l:void 0,N=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,b=(d=n.createdAt)!==null&&d!==void 0?d:void 0,E=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:v,emailVerified:S,isAnonymous:P,providerData:I,stsTokenManager:_}=n;ee(v&&_,e,"internal-error");const p=ui.fromJSON(this.name,_);ee(typeof v=="string",e,"internal-error"),gr(g,e.name),gr(y,e.name),ee(typeof S=="boolean",e,"internal-error"),ee(typeof P=="boolean",e,"internal-error"),gr(C,e.name),gr(k,e.name),gr(w,e.name),gr(N,e.name),gr(b,e.name),gr(E,e.name);const x=new Xn({uid:v,auth:e,email:y,emailVerified:S,displayName:g,isAnonymous:P,photoURL:k,phoneNumber:C,tenantId:w,stsTokenManager:p,createdAt:b,lastLoginAt:E});return I&&Array.isArray(I)&&(x.providerData=I.map(A=>Object.assign({},A))),N&&(x._redirectEventId=N),x}static async _fromIdTokenResponse(e,n,r=!1){const s=new ui;s.updateFromServerResponse(n);const i=new Xn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await mu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ee(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Yx(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new ui;l.updateFromIdToken(r);const u=new Xn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new bh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zg=new Map;function Jn(t){or(t instanceof Function,"Expected a class definition");let e=Zg.get(t);return e?(or(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Zg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Xx.type="NONE";const ey=Xx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(t,e,n){return`firebase:${t}:${e}:${n}`}class ci{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=kl(this.userKey,s.apiKey,i),this.fullPersistenceKey=kl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ci(Jn(ey),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Jn(ey);const o=kl(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){const g=Xn._fromJSON(e,h);d!==i&&(l=g),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new ci(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new ci(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(t0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Jx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(r0(e))return"Blackberry";if(s0(e))return"Webos";if(Zx(e))return"Safari";if((e.includes("chrome/")||e0(e))&&!e.includes("edge/"))return"Chrome";if(n0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Jx(t=It()){return/firefox\//i.test(t)}function Zx(t=It()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function e0(t=It()){return/crios\//i.test(t)}function t0(t=It()){return/iemobile/i.test(t)}function n0(t=It()){return/android/i.test(t)}function r0(t=It()){return/blackberry/i.test(t)}function s0(t=It()){return/webos/i.test(t)}function Gf(t=It()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function fC(t=It()){var e;return Gf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function pC(){return NT()&&document.documentMode===10}function i0(t=It()){return Gf(t)||n0(t)||s0(t)||r0(t)||/windows phone/i.test(t)||t0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(t,e=[]){let n;switch(t){case"Browser":n=ty(It());break;case"Worker":n=`${ty(It())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ki}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gC(t,e={}){return Di(t,"GET","/v2/passwordPolicy",Wf(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=6;class vC{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:yC,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ny(this),this.idTokenSubscription=new ny(this),this.beforeStateQueue=new mC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Jn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ci.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Qx(this,{idToken:e}),r=await Xn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Qn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await mu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qn(this.app))return Promise.reject(hs(this));const n=e?jt(e):null;return n&&ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qn(this.app)?Promise.reject(hs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qn(this.app)?Promise.reject(hs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gC(this),n=new vC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ya("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await hC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Jn(e)||this._popupRedirectResolver;ee(n,this,"argument-error"),this.redirectPersistenceManager=await ci.create(this,[Jn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=o0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&YI(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function qu(t){return jt(t)}class ny{constructor(e){this.auth=e,this.observer=null,this.addObserver=FT(n=>this.observer=n)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xC(t){Kf=t}function wC(t){return Kf.loadJS(t)}function EC(){return Kf.gapiScript}function bC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(t,e){const n=Uf(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(hu(i,e??{}))return s;Mn(s,"already-initialized")}return n.initialize({options:e})}function TC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Jn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function IC(t,e,n){const r=qu(t);ee(r._canInitEmulator,r,"emulator-config-failed"),ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=a0(e),{host:o,port:l}=CC(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),AC()}function a0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function CC(t){const e=a0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:ry(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:ry(o)}}}function ry(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function AC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Yn("not implemented")}_getIdTokenResponse(e){return Yn("not implemented")}_linkToIdToken(e,n){return Yn("not implemented")}_getReauthenticationResolver(e){return Yn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function di(t,e){return rC(t,"POST","/v1/accounts:signInWithIdp",Wf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PC="http://localhost";class ws extends l0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ws(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Mn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=zf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new ws(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return di(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,di(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,di(e,n)}buildRequest(){const e={requestUri:PC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=va(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa extends Qf{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends xa{constructor(){super("facebook.com")}static credential(e){return ws._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return br.credential(e.oauthAccessToken)}catch{return null}}}br.FACEBOOK_SIGN_IN_METHOD="facebook.com";br.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn extends xa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ws._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return qn.credential(n,r)}catch{return null}}}qn.GOOGLE_SIGN_IN_METHOD="google.com";qn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr extends xa{constructor(){super("github.com")}static credential(e){return ws._fromParams({providerId:Sr.PROVIDER_ID,signInMethod:Sr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sr.credentialFromTaggedObject(e)}static credentialFromError(e){return Sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sr.credential(e.oauthAccessToken)}catch{return null}}}Sr.GITHUB_SIGN_IN_METHOD="github.com";Sr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr extends xa{constructor(){super("twitter.com")}static credential(e,n){return ws._fromParams({providerId:Tr.PROVIDER_ID,signInMethod:Tr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Tr.credentialFromTaggedObject(e)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Tr.credential(n,r)}catch{return null}}}Tr.TWITTER_SIGN_IN_METHOD="twitter.com";Tr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Xn._fromIdTokenResponse(e,r,s),o=sy(r);return new wi({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=sy(r);return new wi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function sy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu extends cr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,gu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new gu(e,n,r,s)}}function u0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?gu._fromErrorAndOperation(t,i,e,r):i})}async function RC(t,e,n=!1){const r=await ta(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return wi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NC(t,e,n=!1){const{auth:r}=t;if(Qn(r.app))return Promise.reject(hs(r));const s="reauthenticate";try{const i=await ta(t,u0(r,s,e,t),n);ee(i.idToken,r,"internal-error");const o=qf(i.idToken);ee(o,r,"internal-error");const{sub:l}=o;return ee(t.uid===l,r,"user-mismatch"),wi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Mn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kC(t,e,n=!1){if(Qn(t.app))return Promise.reject(hs(t));const r="signIn",s=await u0(t,r,e),i=await wi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function DC(t,e,n,r){return jt(t).onIdTokenChanged(e,n,r)}function jC(t,e,n){return jt(t).beforeAuthStateChanged(e,n)}function OC(t,e,n,r){return jt(t).onAuthStateChanged(e,n,r)}function VC(t){return jt(t).signOut()}const yu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(yu,"1"),this.storage.removeItem(yu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC=1e3,LC=10;class d0 extends c0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=i0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);pC()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,LC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},MC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}d0.type="LOCAL";const FC=d0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0 extends c0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}h0.type="SESSION";const f0=h0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Gu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),u=await UC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Gu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=Yf("",20);s.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const y=g;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(y.data.response);break;default:clearTimeout(h),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(){return window}function BC(t){jn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(){return typeof jn().WorkerGlobalScope<"u"&&typeof jn().importScripts=="function"}async function $C(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function WC(){return p0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0="firebaseLocalStorageDb",qC=1,vu="firebaseLocalStorage",g0="fbase_key";class wa{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ku(t,e){return t.transaction([vu],e?"readwrite":"readonly").objectStore(vu)}function GC(){const t=indexedDB.deleteDatabase(m0);return new wa(t).toPromise()}function Sh(){const t=indexedDB.open(m0,qC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(vu,{keyPath:g0})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(vu)?e(r):(r.close(),await GC(),e(await Sh()))})})}async function iy(t,e,n){const r=Ku(t,!0).put({[g0]:e,value:n});return new wa(r).toPromise()}async function KC(t,e){const n=Ku(t,!1).get(e),r=await new wa(n).toPromise();return r===void 0?null:r.value}function oy(t,e){const n=Ku(t,!0).delete(e);return new wa(n).toPromise()}const QC=800,YC=3;class y0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>YC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return p0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Gu._getInstance(WC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await $C(),!this.activeServiceWorker)return;this.sender=new zC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||HC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sh();return await iy(e,yu,"1"),await oy(e,yu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>iy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>KC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>oy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Ku(s,!1).getAll();return new wa(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}y0.type="LOCAL";const XC=y0;new _a(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t,e){return e?Jn(e):(ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf extends l0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return di(e,this._buildIdpRequest())}_linkToIdToken(e,n){return di(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return di(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function JC(t){return kC(t.auth,new Xf(t),t.bypassAuthState)}function ZC(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),NC(n,new Xf(t),t.bypassAuthState)}async function eA(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),RC(n,new Xf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return JC;case"linkViaPopup":case"linkViaRedirect":return eA;case"reauthViaPopup":case"reauthViaRedirect":return ZC;default:Mn(this.auth,"internal-error")}}resolve(e){or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA=new _a(2e3,1e4);async function nA(t,e,n){if(Qn(t.app))return Promise.reject(bn(t,"operation-not-supported-in-this-environment"));const r=qu(t);XI(t,e,Qf);const s=v0(r,n);return new ls(r,"signInViaPopup",e,s).executeNotNull()}class ls extends _0{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ls.currentPopupAction&&ls.currentPopupAction.cancel(),ls.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){or(this.filter.length===1,"Popup operations only handle one event");const e=Yf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(bn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(bn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ls.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(bn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,tA.get())};e()}}ls.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA="pendingRedirect",Dl=new Map;class sA extends _0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Dl.get(this.auth._key());if(!e){try{const r=await iA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Dl.set(this.auth._key(),e)}return this.bypassAuthState||Dl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function iA(t,e){const n=lA(e),r=aA(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function oA(t,e){Dl.set(t._key(),e)}function aA(t){return Jn(t._redirectPersistence)}function lA(t){return kl(rA,t.config.apiKey,t.name)}async function uA(t,e,n=!1){if(Qn(t.app))return Promise.reject(hs(t));const r=qu(t),s=v0(r,e),o=await new sA(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA=10*60*1e3;class dA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hA(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!x0(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(bn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cA&&this.cachedEventUids.clear(),this.cachedEventUids.has(ay(e))}saveEventToCache(e){this.cachedEventUids.add(ay(e)),this.lastProcessedEventTime=Date.now()}}function ay(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function x0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function hA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return x0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fA(t,e={}){return Di(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mA=/^https?/;async function gA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await fA(t);for(const n of e)try{if(yA(n))return}catch{}Mn(t,"unauthorized-domain")}function yA(t){const e=Eh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!mA.test(n))return!1;if(pA.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=new _a(3e4,6e4);function ly(){const t=jn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function _A(t){return new Promise((e,n)=>{var r,s,i;function o(){ly(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ly(),n(bn(t,"network-request-failed"))},timeout:vA.get()})}if(!((s=(r=jn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=jn().gapi)===null||i===void 0)&&i.load)o();else{const l=bC("iframefcb");return jn()[l]=()=>{gapi.load?o():n(bn(t,"network-request-failed"))},wC(`${EC()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw jl=null,e})}let jl=null;function xA(t){return jl=jl||_A(t),jl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=new _a(5e3,15e3),EA="__/auth/iframe",bA="emulator/auth/iframe",SA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},TA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function IA(t){const e=t.config;ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Hf(e,bA):`https://${t.config.authDomain}/${EA}`,r={apiKey:e.apiKey,appName:t.name,v:ki},s=TA.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${va(r).slice(1)}`}async function CA(t){const e=await xA(t),n=jn().gapi;return ee(n,t,"internal-error"),e.open({where:document.body,url:IA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SA,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=bn(t,"network-request-failed"),l=jn().setTimeout(()=>{i(o)},wA.get());function u(){jn().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},PA=500,RA=600,NA="_blank",kA="http://localhost";class uy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function DA(t,e,n,r=PA,s=RA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},AA),{width:r.toString(),height:s.toString(),top:i,left:o}),d=It().toLowerCase();n&&(l=e0(d)?NA:n),Jx(d)&&(e=e||kA,u.scrollbars="yes");const h=Object.entries(u).reduce((y,[C,k])=>`${y}${C}=${k},`,"");if(fC(d)&&l!=="_self")return jA(e||"",l),new uy(null);const g=window.open(e||"",l,h);ee(g,t,"popup-blocked");try{g.focus()}catch{}return new uy(g)}function jA(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA="__/auth/handler",VA="emulator/auth/handler",MA=encodeURIComponent("fac");async function cy(t,e,n,r,s,i){ee(t.config.authDomain,t,"auth-domain-config-required"),ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ki,eventId:s};if(e instanceof Qf){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",LT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,g]of Object.entries({}))o[h]=g}if(e instanceof xa){const h=e.getScopes().filter(g=>g!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const u=await t._getAppCheckToken(),d=u?`#${MA}=${encodeURIComponent(u)}`:"";return`${LA(t)}?${va(l).slice(1)}${d}`}function LA({config:t}){return t.emulator?Hf(t,VA):`https://${t.authDomain}/${OA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cd="webStorageSupport";class FA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=f0,this._completeRedirectFn=uA,this._overrideRedirectResult=oA}async _openPopup(e,n,r,s){var i;or((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await cy(e,n,r,Eh(),s);return DA(e,o,Yf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await cy(e,n,r,Eh(),s);return BC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(or(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await CA(e),r=new dA(e);return n.register("authEvent",s=>(ee(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(cd,{type:cd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[cd];o!==void 0&&n(!!o),Mn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=gA(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return i0()||Zx()||Gf()}}const UA=FA;var dy="@firebase/auth",hy="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $A(t){xi(new xs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ee(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:o0(t)},d=new _C(r,s,i,u);return TC(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),xi(new xs("auth-internal",e=>{const n=qu(e.getProvider("auth").getImmediate());return(r=>new zA(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fr(dy,hy,BA(t)),Fr(dy,hy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA=5*60,WA=Mx("authIdTokenMaxAge")||HA;let fy=null;const qA=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>WA)return;const s=n==null?void 0:n.token;fy!==s&&(fy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function GA(t=zx()){const e=Uf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=SC(t,{popupRedirectResolver:UA,persistence:[XC,FC,f0]}),r=Mx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=qA(i.toString());jC(n,o,()=>o(n.currentUser)),DC(n,l=>o(l))}}const s=Ox("auth");return s&&IC(n,`http://${s}`),n}function KA(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}xC({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=bn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",KA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$A("Browser");var QA="firebase",YA="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fr(QA,YA,"app");var py=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fs,w0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,p){function x(){}x.prototype=p.prototype,_.D=p.prototype,_.prototype=new x,_.prototype.constructor=_,_.C=function(A,D,j){for(var R=Array(arguments.length-2),q=2;q<arguments.length;q++)R[q-2]=arguments[q];return p.prototype[D].apply(A,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,p,x){x||(x=0);var A=Array(16);if(typeof p=="string")for(var D=0;16>D;++D)A[D]=p.charCodeAt(x++)|p.charCodeAt(x++)<<8|p.charCodeAt(x++)<<16|p.charCodeAt(x++)<<24;else for(D=0;16>D;++D)A[D]=p[x++]|p[x++]<<8|p[x++]<<16|p[x++]<<24;p=_.g[0],x=_.g[1],D=_.g[2];var j=_.g[3],R=p+(j^x&(D^j))+A[0]+3614090360&4294967295;p=x+(R<<7&4294967295|R>>>25),R=j+(D^p&(x^D))+A[1]+3905402710&4294967295,j=p+(R<<12&4294967295|R>>>20),R=D+(x^j&(p^x))+A[2]+606105819&4294967295,D=j+(R<<17&4294967295|R>>>15),R=x+(p^D&(j^p))+A[3]+3250441966&4294967295,x=D+(R<<22&4294967295|R>>>10),R=p+(j^x&(D^j))+A[4]+4118548399&4294967295,p=x+(R<<7&4294967295|R>>>25),R=j+(D^p&(x^D))+A[5]+1200080426&4294967295,j=p+(R<<12&4294967295|R>>>20),R=D+(x^j&(p^x))+A[6]+2821735955&4294967295,D=j+(R<<17&4294967295|R>>>15),R=x+(p^D&(j^p))+A[7]+4249261313&4294967295,x=D+(R<<22&4294967295|R>>>10),R=p+(j^x&(D^j))+A[8]+1770035416&4294967295,p=x+(R<<7&4294967295|R>>>25),R=j+(D^p&(x^D))+A[9]+2336552879&4294967295,j=p+(R<<12&4294967295|R>>>20),R=D+(x^j&(p^x))+A[10]+4294925233&4294967295,D=j+(R<<17&4294967295|R>>>15),R=x+(p^D&(j^p))+A[11]+2304563134&4294967295,x=D+(R<<22&4294967295|R>>>10),R=p+(j^x&(D^j))+A[12]+1804603682&4294967295,p=x+(R<<7&4294967295|R>>>25),R=j+(D^p&(x^D))+A[13]+4254626195&4294967295,j=p+(R<<12&4294967295|R>>>20),R=D+(x^j&(p^x))+A[14]+2792965006&4294967295,D=j+(R<<17&4294967295|R>>>15),R=x+(p^D&(j^p))+A[15]+1236535329&4294967295,x=D+(R<<22&4294967295|R>>>10),R=p+(D^j&(x^D))+A[1]+4129170786&4294967295,p=x+(R<<5&4294967295|R>>>27),R=j+(x^D&(p^x))+A[6]+3225465664&4294967295,j=p+(R<<9&4294967295|R>>>23),R=D+(p^x&(j^p))+A[11]+643717713&4294967295,D=j+(R<<14&4294967295|R>>>18),R=x+(j^p&(D^j))+A[0]+3921069994&4294967295,x=D+(R<<20&4294967295|R>>>12),R=p+(D^j&(x^D))+A[5]+3593408605&4294967295,p=x+(R<<5&4294967295|R>>>27),R=j+(x^D&(p^x))+A[10]+38016083&4294967295,j=p+(R<<9&4294967295|R>>>23),R=D+(p^x&(j^p))+A[15]+3634488961&4294967295,D=j+(R<<14&4294967295|R>>>18),R=x+(j^p&(D^j))+A[4]+3889429448&4294967295,x=D+(R<<20&4294967295|R>>>12),R=p+(D^j&(x^D))+A[9]+568446438&4294967295,p=x+(R<<5&4294967295|R>>>27),R=j+(x^D&(p^x))+A[14]+3275163606&4294967295,j=p+(R<<9&4294967295|R>>>23),R=D+(p^x&(j^p))+A[3]+4107603335&4294967295,D=j+(R<<14&4294967295|R>>>18),R=x+(j^p&(D^j))+A[8]+1163531501&4294967295,x=D+(R<<20&4294967295|R>>>12),R=p+(D^j&(x^D))+A[13]+2850285829&4294967295,p=x+(R<<5&4294967295|R>>>27),R=j+(x^D&(p^x))+A[2]+4243563512&4294967295,j=p+(R<<9&4294967295|R>>>23),R=D+(p^x&(j^p))+A[7]+1735328473&4294967295,D=j+(R<<14&4294967295|R>>>18),R=x+(j^p&(D^j))+A[12]+2368359562&4294967295,x=D+(R<<20&4294967295|R>>>12),R=p+(x^D^j)+A[5]+4294588738&4294967295,p=x+(R<<4&4294967295|R>>>28),R=j+(p^x^D)+A[8]+2272392833&4294967295,j=p+(R<<11&4294967295|R>>>21),R=D+(j^p^x)+A[11]+1839030562&4294967295,D=j+(R<<16&4294967295|R>>>16),R=x+(D^j^p)+A[14]+4259657740&4294967295,x=D+(R<<23&4294967295|R>>>9),R=p+(x^D^j)+A[1]+2763975236&4294967295,p=x+(R<<4&4294967295|R>>>28),R=j+(p^x^D)+A[4]+1272893353&4294967295,j=p+(R<<11&4294967295|R>>>21),R=D+(j^p^x)+A[7]+4139469664&4294967295,D=j+(R<<16&4294967295|R>>>16),R=x+(D^j^p)+A[10]+3200236656&4294967295,x=D+(R<<23&4294967295|R>>>9),R=p+(x^D^j)+A[13]+681279174&4294967295,p=x+(R<<4&4294967295|R>>>28),R=j+(p^x^D)+A[0]+3936430074&4294967295,j=p+(R<<11&4294967295|R>>>21),R=D+(j^p^x)+A[3]+3572445317&4294967295,D=j+(R<<16&4294967295|R>>>16),R=x+(D^j^p)+A[6]+76029189&4294967295,x=D+(R<<23&4294967295|R>>>9),R=p+(x^D^j)+A[9]+3654602809&4294967295,p=x+(R<<4&4294967295|R>>>28),R=j+(p^x^D)+A[12]+3873151461&4294967295,j=p+(R<<11&4294967295|R>>>21),R=D+(j^p^x)+A[15]+530742520&4294967295,D=j+(R<<16&4294967295|R>>>16),R=x+(D^j^p)+A[2]+3299628645&4294967295,x=D+(R<<23&4294967295|R>>>9),R=p+(D^(x|~j))+A[0]+4096336452&4294967295,p=x+(R<<6&4294967295|R>>>26),R=j+(x^(p|~D))+A[7]+1126891415&4294967295,j=p+(R<<10&4294967295|R>>>22),R=D+(p^(j|~x))+A[14]+2878612391&4294967295,D=j+(R<<15&4294967295|R>>>17),R=x+(j^(D|~p))+A[5]+4237533241&4294967295,x=D+(R<<21&4294967295|R>>>11),R=p+(D^(x|~j))+A[12]+1700485571&4294967295,p=x+(R<<6&4294967295|R>>>26),R=j+(x^(p|~D))+A[3]+2399980690&4294967295,j=p+(R<<10&4294967295|R>>>22),R=D+(p^(j|~x))+A[10]+4293915773&4294967295,D=j+(R<<15&4294967295|R>>>17),R=x+(j^(D|~p))+A[1]+2240044497&4294967295,x=D+(R<<21&4294967295|R>>>11),R=p+(D^(x|~j))+A[8]+1873313359&4294967295,p=x+(R<<6&4294967295|R>>>26),R=j+(x^(p|~D))+A[15]+4264355552&4294967295,j=p+(R<<10&4294967295|R>>>22),R=D+(p^(j|~x))+A[6]+2734768916&4294967295,D=j+(R<<15&4294967295|R>>>17),R=x+(j^(D|~p))+A[13]+1309151649&4294967295,x=D+(R<<21&4294967295|R>>>11),R=p+(D^(x|~j))+A[4]+4149444226&4294967295,p=x+(R<<6&4294967295|R>>>26),R=j+(x^(p|~D))+A[11]+3174756917&4294967295,j=p+(R<<10&4294967295|R>>>22),R=D+(p^(j|~x))+A[2]+718787259&4294967295,D=j+(R<<15&4294967295|R>>>17),R=x+(j^(D|~p))+A[9]+3951481745&4294967295,_.g[0]=_.g[0]+p&4294967295,_.g[1]=_.g[1]+(D+(R<<21&4294967295|R>>>11))&4294967295,_.g[2]=_.g[2]+D&4294967295,_.g[3]=_.g[3]+j&4294967295}r.prototype.u=function(_,p){p===void 0&&(p=_.length);for(var x=p-this.blockSize,A=this.B,D=this.h,j=0;j<p;){if(D==0)for(;j<=x;)s(this,_,j),j+=this.blockSize;if(typeof _=="string"){for(;j<p;)if(A[D++]=_.charCodeAt(j++),D==this.blockSize){s(this,A),D=0;break}}else for(;j<p;)if(A[D++]=_[j++],D==this.blockSize){s(this,A),D=0;break}}this.h=D,this.o+=p},r.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var p=1;p<_.length-8;++p)_[p]=0;var x=8*this.o;for(p=_.length-8;p<_.length;++p)_[p]=x&255,x/=256;for(this.u(_),_=Array(16),p=x=0;4>p;++p)for(var A=0;32>A;A+=8)_[x++]=this.g[p]>>>A&255;return _};function i(_,p){var x=l;return Object.prototype.hasOwnProperty.call(x,_)?x[_]:x[_]=p(_)}function o(_,p){this.h=p;for(var x=[],A=!0,D=_.length-1;0<=D;D--){var j=_[D]|0;A&&j==p||(x[D]=j,A=!1)}this.g=x}var l={};function u(_){return-128<=_&&128>_?i(_,function(p){return new o([p|0],0>p?-1:0)}):new o([_|0],0>_?-1:0)}function d(_){if(isNaN(_)||!isFinite(_))return g;if(0>_)return N(d(-_));for(var p=[],x=1,A=0;_>=x;A++)p[A]=_/x|0,x*=4294967296;return new o(p,0)}function h(_,p){if(_.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(_.charAt(0)=="-")return N(h(_.substring(1),p));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=d(Math.pow(p,8)),A=g,D=0;D<_.length;D+=8){var j=Math.min(8,_.length-D),R=parseInt(_.substring(D,D+j),p);8>j?(j=d(Math.pow(p,j)),A=A.j(j).add(d(R))):(A=A.j(x),A=A.add(d(R)))}return A}var g=u(0),y=u(1),C=u(16777216);t=o.prototype,t.m=function(){if(w(this))return-N(this).m();for(var _=0,p=1,x=0;x<this.g.length;x++){var A=this.i(x);_+=(0<=A?A:4294967296+A)*p,p*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(k(this))return"0";if(w(this))return"-"+N(this).toString(_);for(var p=d(Math.pow(_,6)),x=this,A="";;){var D=S(x,p).g;x=b(x,D.j(p));var j=((0<x.g.length?x.g[0]:x.h)>>>0).toString(_);if(x=D,k(x))return j+A;for(;6>j.length;)j="0"+j;A=j+A}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function k(_){if(_.h!=0)return!1;for(var p=0;p<_.g.length;p++)if(_.g[p]!=0)return!1;return!0}function w(_){return _.h==-1}t.l=function(_){return _=b(this,_),w(_)?-1:k(_)?0:1};function N(_){for(var p=_.g.length,x=[],A=0;A<p;A++)x[A]=~_.g[A];return new o(x,~_.h).add(y)}t.abs=function(){return w(this)?N(this):this},t.add=function(_){for(var p=Math.max(this.g.length,_.g.length),x=[],A=0,D=0;D<=p;D++){var j=A+(this.i(D)&65535)+(_.i(D)&65535),R=(j>>>16)+(this.i(D)>>>16)+(_.i(D)>>>16);A=R>>>16,j&=65535,R&=65535,x[D]=R<<16|j}return new o(x,x[x.length-1]&-2147483648?-1:0)};function b(_,p){return _.add(N(p))}t.j=function(_){if(k(this)||k(_))return g;if(w(this))return w(_)?N(this).j(N(_)):N(N(this).j(_));if(w(_))return N(this.j(N(_)));if(0>this.l(C)&&0>_.l(C))return d(this.m()*_.m());for(var p=this.g.length+_.g.length,x=[],A=0;A<2*p;A++)x[A]=0;for(A=0;A<this.g.length;A++)for(var D=0;D<_.g.length;D++){var j=this.i(A)>>>16,R=this.i(A)&65535,q=_.i(D)>>>16,ne=_.i(D)&65535;x[2*A+2*D]+=R*ne,E(x,2*A+2*D),x[2*A+2*D+1]+=j*ne,E(x,2*A+2*D+1),x[2*A+2*D+1]+=R*q,E(x,2*A+2*D+1),x[2*A+2*D+2]+=j*q,E(x,2*A+2*D+2)}for(A=0;A<p;A++)x[A]=x[2*A+1]<<16|x[2*A];for(A=p;A<2*p;A++)x[A]=0;return new o(x,0)};function E(_,p){for(;(_[p]&65535)!=_[p];)_[p+1]+=_[p]>>>16,_[p]&=65535,p++}function v(_,p){this.g=_,this.h=p}function S(_,p){if(k(p))throw Error("division by zero");if(k(_))return new v(g,g);if(w(_))return p=S(N(_),p),new v(N(p.g),N(p.h));if(w(p))return p=S(_,N(p)),new v(N(p.g),p.h);if(30<_.g.length){if(w(_)||w(p))throw Error("slowDivide_ only works with positive integers.");for(var x=y,A=p;0>=A.l(_);)x=P(x),A=P(A);var D=I(x,1),j=I(A,1);for(A=I(A,2),x=I(x,2);!k(A);){var R=j.add(A);0>=R.l(_)&&(D=D.add(x),j=R),A=I(A,1),x=I(x,1)}return p=b(_,D.j(p)),new v(D,p)}for(D=g;0<=_.l(p);){for(x=Math.max(1,Math.floor(_.m()/p.m())),A=Math.ceil(Math.log(x)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),j=d(x),R=j.j(p);w(R)||0<R.l(_);)x-=A,j=d(x),R=j.j(p);k(j)&&(j=y),D=D.add(j),_=b(_,R)}return new v(D,_)}t.A=function(_){return S(this,_).h},t.and=function(_){for(var p=Math.max(this.g.length,_.g.length),x=[],A=0;A<p;A++)x[A]=this.i(A)&_.i(A);return new o(x,this.h&_.h)},t.or=function(_){for(var p=Math.max(this.g.length,_.g.length),x=[],A=0;A<p;A++)x[A]=this.i(A)|_.i(A);return new o(x,this.h|_.h)},t.xor=function(_){for(var p=Math.max(this.g.length,_.g.length),x=[],A=0;A<p;A++)x[A]=this.i(A)^_.i(A);return new o(x,this.h^_.h)};function P(_){for(var p=_.g.length+1,x=[],A=0;A<p;A++)x[A]=_.i(A)<<1|_.i(A-1)>>>31;return new o(x,_.h)}function I(_,p){var x=p>>5;p%=32;for(var A=_.g.length-x,D=[],j=0;j<A;j++)D[j]=0<p?_.i(j+x)>>>p|_.i(j+x+1)<<32-p:_.i(j+x);return new o(D,_.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,w0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,fs=o}).apply(typeof py<"u"?py:typeof self<"u"?self:typeof window<"u"?window:{});var cl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var E0,_o,b0,Ol,Th,S0,T0,I0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,f,m){return a==Array.prototype||a==Object.prototype||(a[f]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof cl=="object"&&cl];for(var f=0;f<a.length;++f){var m=a[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(a,f){if(f)e:{var m=r;a=a.split(".");for(var T=0;T<a.length-1;T++){var O=a[T];if(!(O in m))break e;m=m[O]}a=a[a.length-1],T=m[a],f=f(T),f!=T&&f!=null&&e(m,a,{configurable:!0,writable:!0,value:f})}}function i(a,f){a instanceof String&&(a+="");var m=0,T=!1,O={next:function(){if(!T&&m<a.length){var M=m++;return{value:f(M,a[M]),done:!1}}return T=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}s("Array.prototype.values",function(a){return a||function(){return i(this,function(f,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var f=typeof a;return f=f!="object"?f:a?Array.isArray(a)?"array":f:"null",f=="array"||f=="object"&&typeof a.length=="number"}function d(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function h(a,f,m){return a.call.apply(a.bind,arguments)}function g(a,f,m){if(!a)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,T),a.apply(f,O)}}return function(){return a.apply(f,arguments)}}function y(a,f,m){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:g,y.apply(null,arguments)}function C(a,f){var m=Array.prototype.slice.call(arguments,1);return function(){var T=m.slice();return T.push.apply(T,arguments),a.apply(this,T)}}function k(a,f){function m(){}m.prototype=f.prototype,a.aa=f.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(T,O,M){for(var B=Array(arguments.length-2),be=2;be<arguments.length;be++)B[be-2]=arguments[be];return f.prototype[O].apply(T,B)}}function w(a){const f=a.length;if(0<f){const m=Array(f);for(let T=0;T<f;T++)m[T]=a[T];return m}return[]}function N(a,f){for(let m=1;m<arguments.length;m++){const T=arguments[m];if(u(T)){const O=a.length||0,M=T.length||0;a.length=O+M;for(let B=0;B<M;B++)a[O+B]=T[B]}else a.push(T)}}class b{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function E(a){return/^[\s\xa0]*$/.test(a)}function v(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function S(a){return S[" "](a),a}S[" "]=function(){};var P=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function I(a,f,m){for(const T in a)f.call(m,a[T],T,a)}function _(a,f){for(const m in a)f.call(void 0,a[m],m,a)}function p(a){const f={};for(const m in a)f[m]=a[m];return f}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(a,f){let m,T;for(let O=1;O<arguments.length;O++){T=arguments[O];for(m in T)a[m]=T[m];for(let M=0;M<x.length;M++)m=x[M],Object.prototype.hasOwnProperty.call(T,m)&&(a[m]=T[m])}}function D(a){var f=1;a=a.split(":");const m=[];for(;0<f&&a.length;)m.push(a.shift()),f--;return a.length&&m.push(a.join(":")),m}function j(a){l.setTimeout(()=>{throw a},0)}function R(){var a=K;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class q{constructor(){this.h=this.g=null}add(f,m){const T=ne.get();T.set(f,m),this.h?this.h.next=T:this.g=T,this.h=T}}var ne=new b(()=>new ae,a=>a.reset());class ae{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let re,z=!1,K=new q,Q=()=>{const a=l.Promise.resolve(void 0);re=()=>{a.then(Ee)}};var Ee=()=>{for(var a;a=R();){try{a.h.call(a.g)}catch(m){j(m)}var f=ne;f.j(a),100>f.h&&(f.h++,a.next=f.g,f.g=a)}z=!1};function ve(){this.s=this.s,this.C=this.C}ve.prototype.s=!1,ve.prototype.ma=function(){this.s||(this.s=!0,this.N())},ve.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Re(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}Re.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};l.addEventListener("test",m,f),l.removeEventListener("test",m,f)}catch{}return a}();function Y(a,f){if(Re.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,T=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget){if(P){e:{try{S(f.nodeName);var O=!0;break e}catch{}O=!1}O||(f=null)}}else m=="mouseover"?f=a.fromElement:m=="mouseout"&&(f=a.toElement);this.relatedTarget=f,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:oe[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Y.aa.h.call(this)}}k(Y,Re);var oe={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),_e=0;function Ct(a,f,m,T,O){this.listener=a,this.proxy=null,this.src=f,this.type=m,this.capture=!!T,this.ha=O,this.key=++_e,this.da=this.fa=!1}function At(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ye(a){this.src=a,this.g={},this.h=0}ye.prototype.add=function(a,f,m,T,O){var M=a.toString();a=this.g[M],a||(a=this.g[M]=[],this.h++);var B=et(a,f,T,O);return-1<B?(f=a[B],m||(f.fa=!1)):(f=new Ct(f,this.src,M,!!T,O),f.fa=m,a.push(f)),f};function ze(a,f){var m=f.type;if(m in a.g){var T=a.g[m],O=Array.prototype.indexOf.call(T,f,void 0),M;(M=0<=O)&&Array.prototype.splice.call(T,O,1),M&&(At(f),a.g[m].length==0&&(delete a.g[m],a.h--))}}function et(a,f,m,T){for(var O=0;O<a.length;++O){var M=a[O];if(!M.da&&M.listener==f&&M.capture==!!m&&M.ha==T)return O}return-1}var Wt="closure_lm_"+(1e6*Math.random()|0),hn={};function fn(a,f,m,T,O){if(Array.isArray(f)){for(var M=0;M<f.length;M++)fn(a,f[M],m,T,O);return null}return m=Ds(m),a&&a[ue]?a.K(f,m,d(T)?!!T.capture:!1,O):gc(a,f,m,!1,T,O)}function gc(a,f,m,T,O,M){if(!f)throw Error("Invalid event type");var B=d(O)?!!O.capture:!!O,be=Ui(a);if(be||(a[Wt]=be=new ye(a)),m=be.add(f,m,T,B,M),m.proxy)return m;if(T=yc(),m.proxy=T,T.src=a,T.listener=m,a.addEventListener)H||(O=B),O===void 0&&(O=!1),a.addEventListener(f.toString(),T,O);else if(a.attachEvent)a.attachEvent(zn(f.toString()),T);else if(a.addListener&&a.removeListener)a.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return m}function yc(){function a(m){return f.call(a.src,a.listener,m)}const f=Aa;return a}function Fi(a,f,m,T,O){if(Array.isArray(f))for(var M=0;M<f.length;M++)Fi(a,f[M],m,T,O);else T=d(T)?!!T.capture:!!T,m=Ds(m),a&&a[ue]?(a=a.i,f=String(f).toString(),f in a.g&&(M=a.g[f],m=et(M,m,T,O),-1<m&&(At(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete a.g[f],a.h--)))):a&&(a=Ui(a))&&(f=a.g[f.toString()],a=-1,f&&(a=et(f,m,T,O)),(m=-1<a?f[a]:null)&&ks(m))}function ks(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[ue])ze(f.i,a);else{var m=a.type,T=a.proxy;f.removeEventListener?f.removeEventListener(m,T,a.capture):f.detachEvent?f.detachEvent(zn(m),T):f.addListener&&f.removeListener&&f.removeListener(T),(m=Ui(f))?(ze(m,a),m.h==0&&(m.src=null,f[Wt]=null)):At(a)}}}function zn(a){return a in hn?hn[a]:hn[a]="on"+a}function Aa(a,f){if(a.da)a=!0;else{f=new Y(f,this);var m=a.listener,T=a.ha||a.src;a.fa&&ks(a),a=m.call(T,f)}return a}function Ui(a){return a=a[Wt],a instanceof ye?a:null}var Xr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ds(a){return typeof a=="function"?a:(a[Xr]||(a[Xr]=function(f){return a.handleEvent(f)}),a[Xr])}function tt(){ve.call(this),this.i=new ye(this),this.M=this,this.F=null}k(tt,ve),tt.prototype[ue]=!0,tt.prototype.removeEventListener=function(a,f,m,T){Fi(this,a,f,m,T)};function nt(a,f){var m,T=a.F;if(T)for(m=[];T;T=T.F)m.push(T);if(a=a.M,T=f.type||f,typeof f=="string")f=new Re(f,a);else if(f instanceof Re)f.target=f.target||a;else{var O=f;f=new Re(T,a),A(f,O)}if(O=!0,m)for(var M=m.length-1;0<=M;M--){var B=f.g=m[M];O=X(B,T,!0,f)&&O}if(B=f.g=a,O=X(B,T,!0,f)&&O,O=X(B,T,!1,f)&&O,m)for(M=0;M<m.length;M++)B=f.g=m[M],O=X(B,T,!1,f)&&O}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var a=this.i,f;for(f in a.g){for(var m=a.g[f],T=0;T<m.length;T++)At(m[T]);delete a.g[f],a.h--}}this.F=null},tt.prototype.K=function(a,f,m,T){return this.i.add(String(a),f,!1,m,T)},tt.prototype.L=function(a,f,m,T){return this.i.add(String(a),f,!0,m,T)};function X(a,f,m,T){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();for(var O=!0,M=0;M<f.length;++M){var B=f[M];if(B&&!B.da&&B.capture==m){var be=B.listener,lt=B.ha||B.src;B.fa&&ze(a.i,B),O=be.call(lt,T)!==!1&&O}}return O&&!T.defaultPrevented}function Z(a,f,m){if(typeof a=="function")m&&(a=y(a,m));else if(a&&typeof a.handleEvent=="function")a=y(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:l.setTimeout(a,f||0)}function pe(a){a.g=Z(()=>{a.g=null,a.i&&(a.i=!1,pe(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class ke extends ve{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:pe(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function at(a){ve.call(this),this.h=a,this.g={}}k(at,ve);var rt=[];function Ke(a){I(a.g,function(f,m){this.g.hasOwnProperty(m)&&ks(f)},a),a.g={}}at.prototype.N=function(){at.aa.N.call(this),Ke(this)},at.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qe=l.JSON.stringify,qt=l.JSON.parse,zi=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Cn(){}Cn.prototype.h=null;function Pa(a){return a.h||(a.h=a.i())}function Bi(){}var dr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function vc(){Re.call(this,"d")}k(vc,Re);function _c(){Re.call(this,"c")}k(_c,Re);var Jr={},$p=null;function Ra(){return $p=$p||new tt}Jr.La="serverreachability";function Hp(a){Re.call(this,Jr.La,a)}k(Hp,Re);function $i(a){const f=Ra();nt(f,new Hp(f))}Jr.STAT_EVENT="statevent";function Wp(a,f){Re.call(this,Jr.STAT_EVENT,a),this.stat=f}k(Wp,Re);function Pt(a){const f=Ra();nt(f,new Wp(f,a))}Jr.Ma="timingevent";function qp(a,f){Re.call(this,Jr.Ma,a),this.size=f}k(qp,Re);function Hi(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},f)}function Wi(){this.g=!0}Wi.prototype.xa=function(){this.g=!1};function wE(a,f,m,T,O,M){a.info(function(){if(a.g)if(M)for(var B="",be=M.split("&"),lt=0;lt<be.length;lt++){var me=be[lt].split("=");if(1<me.length){var gt=me[0];me=me[1];var yt=gt.split("_");B=2<=yt.length&&yt[1]=="type"?B+(gt+"="+me+"&"):B+(gt+"=redacted&")}}else B=null;else B=M;return"XMLHTTP REQ ("+T+") [attempt "+O+"]: "+f+`
`+m+`
`+B})}function EE(a,f,m,T,O,M,B){a.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+O+"]: "+f+`
`+m+`
`+M+" "+B})}function js(a,f,m,T){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+SE(a,m)+(T?" "+T:"")})}function bE(a,f){a.info(function(){return"TIMEOUT: "+f})}Wi.prototype.info=function(){};function SE(a,f){if(!a.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var T=m[a];if(!(2>T.length)){var O=T[1];if(Array.isArray(O)&&!(1>O.length)){var M=O[0];if(M!="noop"&&M!="stop"&&M!="close")for(var B=1;B<O.length;B++)O[B]=""}}}}return Qe(m)}catch{return f}}var Na={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Gp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xc;function ka(){}k(ka,Cn),ka.prototype.g=function(){return new XMLHttpRequest},ka.prototype.i=function(){return{}},xc=new ka;function hr(a,f,m,T){this.j=a,this.i=f,this.l=m,this.R=T||1,this.U=new at(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Kp}function Kp(){this.i=null,this.g="",this.h=!1}var Qp={},wc={};function Ec(a,f,m){a.L=1,a.v=Va(Bn(f)),a.m=m,a.P=!0,Yp(a,null)}function Yp(a,f){a.F=Date.now(),Da(a),a.A=Bn(a.v);var m=a.A,T=a.R;Array.isArray(T)||(T=[String(T)]),cm(m.i,"t",T),a.C=0,m=a.j.J,a.h=new Kp,a.g=Am(a.j,m?f:null,!a.m),0<a.O&&(a.M=new ke(y(a.Y,a,a.g),a.O)),f=a.U,m=a.g,T=a.ca;var O="readystatechange";Array.isArray(O)||(O&&(rt[0]=O.toString()),O=rt);for(var M=0;M<O.length;M++){var B=fn(m,O[M],T||f.handleEvent,!1,f.h||f);if(!B)break;f.g[B.key]=B}f=a.H?p(a.H):{},a.m?(a.u||(a.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,f)):(a.u="GET",a.g.ea(a.A,a.u,null,f)),$i(),wE(a.i,a.u,a.A,a.l,a.R,a.m)}hr.prototype.ca=function(a){a=a.target;const f=this.M;f&&$n(a)==3?f.j():this.Y(a)},hr.prototype.Y=function(a){try{if(a==this.g)e:{const yt=$n(this.g);var f=this.g.Ba();const Ms=this.g.Z();if(!(3>yt)&&(yt!=3||this.g&&(this.h.h||this.g.oa()||ym(this.g)))){this.J||yt!=4||f==7||(f==8||0>=Ms?$i(3):$i(2)),bc(this);var m=this.g.Z();this.X=m;t:if(Xp(this)){var T=ym(this.g);a="";var O=T.length,M=$n(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zr(this),qi(this);var B="";break t}this.h.i=new l.TextDecoder}for(f=0;f<O;f++)this.h.h=!0,a+=this.h.i.decode(T[f],{stream:!(M&&f==O-1)});T.length=0,this.h.g+=a,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=m==200,EE(this.i,this.u,this.A,this.l,this.R,yt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var be,lt=this.g;if((be=lt.g?lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(be)){var me=be;break t}}me=null}if(m=me)js(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sc(this,m);else{this.o=!1,this.s=3,Pt(12),Zr(this),qi(this);break e}}if(this.P){m=!0;let pn;for(;!this.J&&this.C<B.length;)if(pn=TE(this,B),pn==wc){yt==4&&(this.s=4,Pt(14),m=!1),js(this.i,this.l,null,"[Incomplete Response]");break}else if(pn==Qp){this.s=4,Pt(15),js(this.i,this.l,B,"[Invalid Chunk]"),m=!1;break}else js(this.i,this.l,pn,null),Sc(this,pn);if(Xp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),yt!=4||B.length!=0||this.h.h||(this.s=1,Pt(16),m=!1),this.o=this.o&&m,!m)js(this.i,this.l,B,"[Invalid Chunked Response]"),Zr(this),qi(this);else if(0<B.length&&!this.W){this.W=!0;var gt=this.j;gt.g==this&&gt.ba&&!gt.M&&(gt.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),Rc(gt),gt.M=!0,Pt(11))}}else js(this.i,this.l,B,null),Sc(this,B);yt==4&&Zr(this),this.o&&!this.J&&(yt==4?Sm(this.j,this):(this.o=!1,Da(this)))}else BE(this.g),m==400&&0<B.indexOf("Unknown SID")?(this.s=3,Pt(12)):(this.s=0,Pt(13)),Zr(this),qi(this)}}}catch{}finally{}};function Xp(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function TE(a,f){var m=a.C,T=f.indexOf(`
`,m);return T==-1?wc:(m=Number(f.substring(m,T)),isNaN(m)?Qp:(T+=1,T+m>f.length?wc:(f=f.slice(T,T+m),a.C=T+m,f)))}hr.prototype.cancel=function(){this.J=!0,Zr(this)};function Da(a){a.S=Date.now()+a.I,Jp(a,a.I)}function Jp(a,f){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Hi(y(a.ba,a),f)}function bc(a){a.B&&(l.clearTimeout(a.B),a.B=null)}hr.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(bE(this.i,this.A),this.L!=2&&($i(),Pt(17)),Zr(this),this.s=2,qi(this)):Jp(this,this.S-a)};function qi(a){a.j.G==0||a.J||Sm(a.j,a)}function Zr(a){bc(a);var f=a.M;f&&typeof f.ma=="function"&&f.ma(),a.M=null,Ke(a.U),a.g&&(f=a.g,a.g=null,f.abort(),f.ma())}function Sc(a,f){try{var m=a.j;if(m.G!=0&&(m.g==a||Tc(m.h,a))){if(!a.K&&Tc(m.h,a)&&m.G==3){try{var T=m.Da.g.parse(f)}catch{T=null}if(Array.isArray(T)&&T.length==3){var O=T;if(O[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)Ba(m),Ua(m);else break e;Pc(m),Pt(18)}}else m.za=O[1],0<m.za-m.T&&37500>O[2]&&m.F&&m.v==0&&!m.C&&(m.C=Hi(y(m.Za,m),6e3));if(1>=tm(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else ts(m,11)}else if((a.K||m.g==a)&&Ba(m),!E(f))for(O=m.Da.g.parse(f),f=0;f<O.length;f++){let me=O[f];if(m.T=me[0],me=me[1],m.G==2)if(me[0]=="c"){m.K=me[1],m.ia=me[2];const gt=me[3];gt!=null&&(m.la=gt,m.j.info("VER="+m.la));const yt=me[4];yt!=null&&(m.Aa=yt,m.j.info("SVER="+m.Aa));const Ms=me[5];Ms!=null&&typeof Ms=="number"&&0<Ms&&(T=1.5*Ms,m.L=T,m.j.info("backChannelRequestTimeoutMs_="+T)),T=m;const pn=a.g;if(pn){const Ha=pn.g?pn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ha){var M=T.h;M.g||Ha.indexOf("spdy")==-1&&Ha.indexOf("quic")==-1&&Ha.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Ic(M,M.h),M.h=null))}if(T.D){const Nc=pn.g?pn.g.getResponseHeader("X-HTTP-Session-Id"):null;Nc&&(T.ya=Nc,Te(T.I,T.D,Nc))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),T=m;var B=a;if(T.qa=Cm(T,T.J?T.ia:null,T.W),B.K){nm(T.h,B);var be=B,lt=T.L;lt&&(be.I=lt),be.B&&(bc(be),Da(be)),T.g=B}else Em(T);0<m.i.length&&za(m)}else me[0]!="stop"&&me[0]!="close"||ts(m,7);else m.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?ts(m,7):Ac(m):me[0]!="noop"&&m.l&&m.l.ta(me),m.v=0)}}$i(4)}catch{}}var IE=class{constructor(a,f){this.g=a,this.map=f}};function Zp(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function em(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function tm(a){return a.h?1:a.g?a.g.size:0}function Tc(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function Ic(a,f){a.g?a.g.add(f):a.h=f}function nm(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}Zp.prototype.cancel=function(){if(this.i=rm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function rm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const m of a.g.values())f=f.concat(m.D);return f}return w(a.i)}function CE(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var f=[],m=a.length,T=0;T<m;T++)f.push(a[T]);return f}f=[],m=0;for(T in a)f[m++]=a[T];return f}function AE(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var f=[];a=a.length;for(var m=0;m<a;m++)f.push(m);return f}f=[],m=0;for(const T in a)f[m++]=T;return f}}}function sm(a,f){if(a.forEach&&typeof a.forEach=="function")a.forEach(f,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,f,void 0);else for(var m=AE(a),T=CE(a),O=T.length,M=0;M<O;M++)f.call(void 0,T[M],m&&m[M],a)}var im=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PE(a,f){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var T=a[m].indexOf("="),O=null;if(0<=T){var M=a[m].substring(0,T);O=a[m].substring(T+1)}else M=a[m];f(M,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function es(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof es){this.h=a.h,ja(this,a.j),this.o=a.o,this.g=a.g,Oa(this,a.s),this.l=a.l;var f=a.i,m=new Qi;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),om(this,m),this.m=a.m}else a&&(f=String(a).match(im))?(this.h=!1,ja(this,f[1]||"",!0),this.o=Gi(f[2]||""),this.g=Gi(f[3]||"",!0),Oa(this,f[4]),this.l=Gi(f[5]||"",!0),om(this,f[6]||"",!0),this.m=Gi(f[7]||"")):(this.h=!1,this.i=new Qi(null,this.h))}es.prototype.toString=function(){var a=[],f=this.j;f&&a.push(Ki(f,am,!0),":");var m=this.g;return(m||f=="file")&&(a.push("//"),(f=this.o)&&a.push(Ki(f,am,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(Ki(m,m.charAt(0)=="/"?kE:NE,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",Ki(m,jE)),a.join("")};function Bn(a){return new es(a)}function ja(a,f,m){a.j=m?Gi(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function Oa(a,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);a.s=f}else a.s=null}function om(a,f,m){f instanceof Qi?(a.i=f,OE(a.i,a.h)):(m||(f=Ki(f,DE)),a.i=new Qi(f,a.h))}function Te(a,f,m){a.i.set(f,m)}function Va(a){return Te(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Gi(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Ki(a,f,m){return typeof a=="string"?(a=encodeURI(a).replace(f,RE),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function RE(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var am=/[#\/\?@]/g,NE=/[#\?:]/g,kE=/[#\?]/g,DE=/[#\?@]/g,jE=/#/g;function Qi(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function fr(a){a.g||(a.g=new Map,a.h=0,a.i&&PE(a.i,function(f,m){a.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}t=Qi.prototype,t.add=function(a,f){fr(this),this.i=null,a=Os(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(f),this.h+=1,this};function lm(a,f){fr(a),f=Os(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function um(a,f){return fr(a),f=Os(a,f),a.g.has(f)}t.forEach=function(a,f){fr(this),this.g.forEach(function(m,T){m.forEach(function(O){a.call(f,O,T,this)},this)},this)},t.na=function(){fr(this);const a=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let T=0;T<f.length;T++){const O=a[T];for(let M=0;M<O.length;M++)m.push(f[T])}return m},t.V=function(a){fr(this);let f=[];if(typeof a=="string")um(this,a)&&(f=f.concat(this.g.get(Os(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)f=f.concat(a[m])}return f},t.set=function(a,f){return fr(this),this.i=null,a=Os(this,a),um(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},t.get=function(a,f){return a?(a=this.V(a),0<a.length?String(a[0]):f):f};function cm(a,f,m){lm(a,f),0<m.length&&(a.i=null,a.g.set(Os(a,f),w(m)),a.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var T=f[m];const M=encodeURIComponent(String(T)),B=this.V(T);for(T=0;T<B.length;T++){var O=M;B[T]!==""&&(O+="="+encodeURIComponent(String(B[T]))),a.push(O)}}return this.i=a.join("&")};function Os(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function OE(a,f){f&&!a.j&&(fr(a),a.i=null,a.g.forEach(function(m,T){var O=T.toLowerCase();T!=O&&(lm(this,T),cm(this,O,m))},a)),a.j=f}function VE(a,f){const m=new Wi;if(l.Image){const T=new Image;T.onload=C(pr,m,"TestLoadImage: loaded",!0,f,T),T.onerror=C(pr,m,"TestLoadImage: error",!1,f,T),T.onabort=C(pr,m,"TestLoadImage: abort",!1,f,T),T.ontimeout=C(pr,m,"TestLoadImage: timeout",!1,f,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=a}else f(!1)}function ME(a,f){const m=new Wi,T=new AbortController,O=setTimeout(()=>{T.abort(),pr(m,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:T.signal}).then(M=>{clearTimeout(O),M.ok?pr(m,"TestPingServer: ok",!0,f):pr(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(O),pr(m,"TestPingServer: error",!1,f)})}function pr(a,f,m,T,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),T(m)}catch{}}function LE(){this.g=new zi}function FE(a,f,m){const T=m||"";try{sm(a,function(O,M){let B=O;d(O)&&(B=Qe(O)),f.push(T+M+"="+encodeURIComponent(B))})}catch(O){throw f.push(T+"type="+encodeURIComponent("_badmap")),O}}function Ma(a){this.l=a.Ub||null,this.j=a.eb||!1}k(Ma,Cn),Ma.prototype.g=function(){return new La(this.l,this.j)},Ma.prototype.i=function(a){return function(){return a}}({});function La(a,f){tt.call(this),this.D=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(La,tt),t=La.prototype,t.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=f,this.readyState=1,Xi(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(f.body=a),(this.D||l).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Yi(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Xi(this)),this.g&&(this.readyState=3,Xi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function dm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?Yi(this):Xi(this),this.readyState==3&&dm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Yi(this))},t.Qa=function(a){this.g&&(this.response=a,Yi(this))},t.ga=function(){this.g&&Yi(this)};function Yi(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Xi(a)}t.setRequestHeader=function(a,f){this.u.append(a,f)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=f.next();return a.join(`\r
`)};function Xi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(La.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function hm(a){let f="";return I(a,function(m,T){f+=T,f+=":",f+=m,f+=`\r
`}),f}function Cc(a,f,m){e:{for(T in m){var T=!1;break e}T=!0}T||(m=hm(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):Te(a,f,m))}function Me(a){tt.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(Me,tt);var UE=/^https?$/i,zE=["POST","PUT"];t=Me.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,f,m,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xc.g(),this.v=this.o?Pa(this.o):Pa(xc),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(M){fm(this,M);return}if(a=m||"",m=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var O in T)m.set(O,T[O]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const M of T.keys())m.set(M,T.get(M));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),O=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(zE,f,void 0))||T||O||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,B]of m)this.g.setRequestHeader(M,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gm(this),this.u=!0,this.g.send(a),this.u=!1}catch(M){fm(this,M)}};function fm(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.m=5,pm(a),Fa(a)}function pm(a){a.A||(a.A=!0,nt(a,"complete"),nt(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,nt(this,"complete"),nt(this,"abort"),Fa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fa(this,!0)),Me.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?mm(this):this.bb())},t.bb=function(){mm(this)};function mm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||$n(a)!=4||a.Z()!=2)){if(a.u&&$n(a)==4)Z(a.Ea,0,a);else if(nt(a,"readystatechange"),$n(a)==4){a.h=!1;try{const B=a.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var T;if(T=B===0){var O=String(a.D).match(im)[1]||null;!O&&l.self&&l.self.location&&(O=l.self.location.protocol.slice(0,-1)),T=!UE.test(O?O.toLowerCase():"")}m=T}if(m)nt(a,"complete"),nt(a,"success");else{a.m=6;try{var M=2<$n(a)?a.g.statusText:""}catch{M=""}a.l=M+" ["+a.Z()+"]",pm(a)}}finally{Fa(a)}}}}function Fa(a,f){if(a.g){gm(a);const m=a.g,T=a.v[0]?()=>{}:null;a.g=null,a.v=null,f||nt(a,"ready");try{m.onreadystatechange=T}catch{}}}function gm(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function $n(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<$n(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),qt(f)}};function ym(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function BE(a){const f={};a=(a.g&&2<=$n(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<a.length;T++){if(E(a[T]))continue;var m=D(a[T]);const O=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const M=f[O]||[];f[O]=M,M.push(m)}_(f,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ji(a,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||f}function vm(a){this.Aa=0,this.i=[],this.j=new Wi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ji("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ji("baseRetryDelayMs",5e3,a),this.cb=Ji("retryDelaySeedMs",1e4,a),this.Wa=Ji("forwardChannelMaxRetries",2,a),this.wa=Ji("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Zp(a&&a.concurrentRequestLimit),this.Da=new LE,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=vm.prototype,t.la=8,t.G=1,t.connect=function(a,f,m,T){Pt(0),this.W=a,this.H=f||{},m&&T!==void 0&&(this.H.OSID=m,this.H.OAID=T),this.F=this.X,this.I=Cm(this,null,this.W),za(this)};function Ac(a){if(_m(a),a.G==3){var f=a.U++,m=Bn(a.I);if(Te(m,"SID",a.K),Te(m,"RID",f),Te(m,"TYPE","terminate"),Zi(a,m),f=new hr(a,a.j,f),f.L=2,f.v=Va(Bn(m)),m=!1,l.navigator&&l.navigator.sendBeacon)try{m=l.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&l.Image&&(new Image().src=f.v,m=!0),m||(f.g=Am(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Da(f)}Im(a)}function Ua(a){a.g&&(Rc(a),a.g.cancel(),a.g=null)}function _m(a){Ua(a),a.u&&(l.clearTimeout(a.u),a.u=null),Ba(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function za(a){if(!em(a.h)&&!a.s){a.s=!0;var f=a.Ga;re||Q(),z||(re(),z=!0),K.add(f,a),a.B=0}}function $E(a,f){return tm(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=f.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Hi(y(a.Ga,a,f),Tm(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const O=new hr(this,this.j,a);let M=this.o;if(this.S&&(M?(M=p(M),A(M,this.S)):M=this.S),this.m!==null||this.O||(O.H=M,M=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var T=this.i[m];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(f+=T,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=wm(this,O,f),m=Bn(this.I),Te(m,"RID",a),Te(m,"CVER",22),this.D&&Te(m,"X-HTTP-Session-Id",this.D),Zi(this,m),M&&(this.O?f="headers="+encodeURIComponent(String(hm(M)))+"&"+f:this.m&&Cc(m,this.m,M)),Ic(this.h,O),this.Ua&&Te(m,"TYPE","init"),this.P?(Te(m,"$req",f),Te(m,"SID","null"),O.T=!0,Ec(O,m,null)):Ec(O,m,f),this.G=2}}else this.G==3&&(a?xm(this,a):this.i.length==0||em(this.h)||xm(this))};function xm(a,f){var m;f?m=f.l:m=a.U++;const T=Bn(a.I);Te(T,"SID",a.K),Te(T,"RID",m),Te(T,"AID",a.T),Zi(a,T),a.m&&a.o&&Cc(T,a.m,a.o),m=new hr(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),f&&(a.i=f.D.concat(a.i)),f=wm(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ic(a.h,m),Ec(m,T,f)}function Zi(a,f){a.H&&I(a.H,function(m,T){Te(f,T,m)}),a.l&&sm({},function(m,T){Te(f,T,m)})}function wm(a,f,m){m=Math.min(a.i.length,m);var T=a.l?y(a.l.Na,a.l,a):null;e:{var O=a.i;let M=-1;for(;;){const B=["count="+m];M==-1?0<m?(M=O[0].g,B.push("ofs="+M)):M=0:B.push("ofs="+M);let be=!0;for(let lt=0;lt<m;lt++){let me=O[lt].g;const gt=O[lt].map;if(me-=M,0>me)M=Math.max(0,O[lt].g-100),be=!1;else try{FE(gt,B,"req"+me+"_")}catch{T&&T(gt)}}if(be){T=B.join("&");break e}}}return a=a.i.splice(0,m),f.D=a,T}function Em(a){if(!a.g&&!a.u){a.Y=1;var f=a.Fa;re||Q(),z||(re(),z=!0),K.add(f,a),a.v=0}}function Pc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Hi(y(a.Fa,a),Tm(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,bm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Hi(y(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pt(10),Ua(this),bm(this))};function Rc(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function bm(a){a.g=new hr(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var f=Bn(a.qa);Te(f,"RID","rpc"),Te(f,"SID",a.K),Te(f,"AID",a.T),Te(f,"CI",a.F?"0":"1"),!a.F&&a.ja&&Te(f,"TO",a.ja),Te(f,"TYPE","xmlhttp"),Zi(a,f),a.m&&a.o&&Cc(f,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=Va(Bn(f)),m.m=null,m.P=!0,Yp(m,a)}t.Za=function(){this.C!=null&&(this.C=null,Ua(this),Pc(this),Pt(19))};function Ba(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Sm(a,f){var m=null;if(a.g==f){Ba(a),Rc(a),a.g=null;var T=2}else if(Tc(a.h,f))m=f.D,nm(a.h,f),T=1;else return;if(a.G!=0){if(f.o)if(T==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var O=a.B;T=Ra(),nt(T,new qp(T,m)),za(a)}else Em(a);else if(O=f.s,O==3||O==0&&0<f.X||!(T==1&&$E(a,f)||T==2&&Pc(a)))switch(m&&0<m.length&&(f=a.h,f.i=f.i.concat(m)),O){case 1:ts(a,5);break;case 4:ts(a,10);break;case 3:ts(a,6);break;default:ts(a,2)}}}function Tm(a,f){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*f}function ts(a,f){if(a.j.info("Error code "+f),f==2){var m=y(a.fb,a),T=a.Xa;const O=!T;T=new es(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ja(T,"https"),Va(T),O?VE(T.toString(),m):ME(T.toString(),m)}else Pt(2);a.G=0,a.l&&a.l.sa(f),Im(a),_m(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function Im(a){if(a.G=0,a.ka=[],a.l){const f=rm(a.h);(f.length!=0||a.i.length!=0)&&(N(a.ka,f),N(a.ka,a.i),a.h.i.length=0,w(a.i),a.i.length=0),a.l.ra()}}function Cm(a,f,m){var T=m instanceof es?Bn(m):new es(m);if(T.g!="")f&&(T.g=f+"."+T.g),Oa(T,T.s);else{var O=l.location;T=O.protocol,f=f?f+"."+O.hostname:O.hostname,O=+O.port;var M=new es(null);T&&ja(M,T),f&&(M.g=f),O&&Oa(M,O),m&&(M.l=m),T=M}return m=a.D,f=a.ya,m&&f&&Te(T,m,f),Te(T,"VER",a.la),Zi(a,T),T}function Am(a,f,m){if(f&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Ca&&!a.pa?new Me(new Ma({eb:m})):new Me(a.pa),f.Ha(a.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pm(){}t=Pm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function $a(){}$a.prototype.g=function(a,f){return new Gt(a,f)};function Gt(a,f){tt.call(this),this.g=new vm(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(a?a["X-WebChannel-Client-Profile"]=f.va:a={"X-WebChannel-Client-Profile":f.va}),this.g.S=a,(a=f&&f.Sb)&&!E(a)&&(this.g.m=a),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!E(f)&&(this.g.D=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new Vs(this)}k(Gt,tt),Gt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Gt.prototype.close=function(){Ac(this.g)},Gt.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=Qe(a),a=m);f.i.push(new IE(f.Ya++,a)),f.G==3&&za(f)},Gt.prototype.N=function(){this.g.l=null,delete this.j,Ac(this.g),delete this.g,Gt.aa.N.call(this)};function Rm(a){vc.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){e:{for(const m in f){a=m;break e}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}k(Rm,vc);function Nm(){_c.call(this),this.status=1}k(Nm,_c);function Vs(a){this.g=a}k(Vs,Pm),Vs.prototype.ua=function(){nt(this.g,"a")},Vs.prototype.ta=function(a){nt(this.g,new Rm(a))},Vs.prototype.sa=function(a){nt(this.g,new Nm)},Vs.prototype.ra=function(){nt(this.g,"b")},$a.prototype.createWebChannel=$a.prototype.g,Gt.prototype.send=Gt.prototype.o,Gt.prototype.open=Gt.prototype.m,Gt.prototype.close=Gt.prototype.close,I0=function(){return new $a},T0=function(){return Ra()},S0=Jr,Th={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Na.NO_ERROR=0,Na.TIMEOUT=8,Na.HTTP_ERROR=6,Ol=Na,Gp.COMPLETE="complete",b0=Gp,Bi.EventType=dr,dr.OPEN="a",dr.CLOSE="b",dr.ERROR="c",dr.MESSAGE="d",tt.prototype.listen=tt.prototype.K,_o=Bi,Me.prototype.listenOnce=Me.prototype.L,Me.prototype.getLastError=Me.prototype.Ka,Me.prototype.getLastErrorCode=Me.prototype.Ba,Me.prototype.getStatus=Me.prototype.Z,Me.prototype.getResponseJson=Me.prototype.Oa,Me.prototype.getResponseText=Me.prototype.oa,Me.prototype.send=Me.prototype.ea,Me.prototype.setWithCredentials=Me.prototype.Ha,E0=Me}).apply(typeof cl<"u"?cl:typeof self<"u"?self:typeof window<"u"?window:{});const my="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Et.UNAUTHENTICATED=new Et(null),Et.GOOGLE_CREDENTIALS=new Et("google-credentials-uid"),Et.FIRST_PARTY=new Et("first-party-uid"),Et.MOCK_USER=new Et("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ji="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es=new Lf("@firebase/firestore");function lo(){return Es.logLevel}function G(t,...e){if(Es.logLevel<=de.DEBUG){const n=e.map(Jf);Es.debug(`Firestore (${ji}): ${t}`,...n)}}function ar(t,...e){if(Es.logLevel<=de.ERROR){const n=e.map(Jf);Es.error(`Firestore (${ji}): ${t}`,...n)}}function Ei(t,...e){if(Es.logLevel<=de.WARN){const n=e.map(Jf);Es.warn(`Firestore (${ji}): ${t}`,...n)}}function Jf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(t="Unexpected state"){const e=`FIRESTORE (${ji}) INTERNAL ASSERTION FAILED: `+t;throw ar(e),new Error(e)}function we(t,e){t||te()}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends cr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class XA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Et.UNAUTHENTICATED))}shutdown(){}}class JA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class ZA{constructor(e){this.t=e,this.currentUser=Et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){we(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{G("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(G("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(G("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(we(typeof r.accessToken=="string"),new C0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return we(e===null||typeof e=="string"),new Et(e)}}class eP{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Et.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class tP{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new eP(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Et.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){we(this.o===void 0);const r=i=>{i.error!=null&&G("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,G("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{G("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):G("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(we(typeof n.token=="string"),this.R=n.token,new nP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=sP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ge(t,e){return t<e?-1:t>e?1:0}function bi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new $(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new $(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ze.fromMillis(Date.now())}static fromDate(e){return Ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ze(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ge(this.nanoseconds,e.nanoseconds):ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.timestamp=e}static fromTimestamp(e){return new se(e)}static min(){return new se(new Ze(0,0))}static max(){return new se(new Ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,n,r){n===void 0?n=0:n>e.length&&te(),r===void 0?r=e.length-n:r>e.length-n&&te(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return na.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof na?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ce extends na{construct(e,n,r){return new Ce(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new $(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ce(n)}static emptyPath(){return new Ce([])}}const iP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends na{construct(e,n,r){return new dt(e,n,r)}static isValidIdentifier(e){return iP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new dt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new $(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new $(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new $(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new $(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dt(n)}static emptyPath(){return new dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.path=e}static fromPath(e){return new J(Ce.fromString(e))}static fromName(e){return new J(Ce.fromString(e).popFirst(5))}static empty(){return new J(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new J(new Ce(e.slice()))}}function oP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=se.fromTimestamp(r===1e9?new Ze(n+1,0):new Ze(n,r));return new $r(s,J.empty(),e)}function aP(t){return new $r(t.readTime,t.key,-1)}class $r{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new $r(se.min(),J.empty(),-1)}static max(){return new $r(se.max(),J.empty(),-1)}}function lP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=J.comparator(t.documentKey,e.documentKey),n!==0?n:ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class cP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ea(t){if(t.code!==L.FAILED_PRECONDITION||t.message!==uP)throw t;G("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&te(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(s=>s?F.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new F((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(h=>{o[d]=h,++l,l===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new F((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function dP(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ba(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Zf.oe=-1;function Qu(t){return t==null}function _u(t){return t===0&&1/t==-1/0}function hP(t){return typeof t=="number"&&Number.isInteger(t)&&!_u(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Oi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function P0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,n){this.comparator=e,this.root=n||ct.EMPTY}insert(e,n){return new Ve(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ct.BLACK,null,null))}remove(e){return new Ve(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ct.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dl(this.root,e,this.comparator,!1)}getReverseIterator(){return new dl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dl(this.root,e,this.comparator,!0)}}class dl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ct{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ct.RED,this.left=s??ct.EMPTY,this.right=i??ct.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ct(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ct.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ct.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw te();const e=this.left.check();if(e!==this.right.check())throw te();return e+(this.isRed()?0:1)}}ct.EMPTY=null,ct.RED=!0,ct.BLACK=!1;ct.EMPTY=new class{constructor(){this.size=0}get key(){throw te()}get value(){throw te()}get color(){throw te()}get left(){throw te()}get right(){throw te()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ct(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.comparator=e,this.data=new Ve(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new yy(this.data.getIterator())}getIteratorFrom(e){return new yy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ft)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ft(this.comparator);return n.data=e,n}}class yy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.fields=e,e.sort(dt.comparator)}static empty(){return new xn([])}unionWith(e){let n=new ft(dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new xn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return bi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new R0("Invalid base64 string: "+i):i}}(e);return new mt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new mt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const fP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hr(t){if(we(!!t),typeof t=="string"){let e=0;const n=fP.exec(t);if(we(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Be(t.seconds),nanos:Be(t.nanos)}}function Be(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function bs(t){return typeof t=="string"?mt.fromBase64String(t):mt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function tp(t){const e=t.mapValue.fields.__previous_value__;return ep(e)?tp(e):e}function ra(t){const e=Hr(t.mapValue.fields.__local_write_time__.timestampValue);return new Ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e,n,r,s,i,o,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}class sa{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new sa("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof sa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hl={mapValue:{}};function Ss(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ep(t)?4:gP(t)?9007199254740991:mP(t)?10:11:te()}function Ln(t,e){if(t===e)return!0;const n=Ss(t);if(n!==Ss(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ra(t).isEqual(ra(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Hr(s.timestampValue),l=Hr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return bs(s.bytesValue).isEqual(bs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Be(s.geoPointValue.latitude)===Be(i.geoPointValue.latitude)&&Be(s.geoPointValue.longitude)===Be(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Be(s.integerValue)===Be(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Be(s.doubleValue),l=Be(i.doubleValue);return o===l?_u(o)===_u(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return bi(t.arrayValue.values||[],e.arrayValue.values||[],Ln);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(gy(o)!==gy(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Ln(o[u],l[u])))return!1;return!0}(t,e);default:return te()}}function ia(t,e){return(t.values||[]).find(n=>Ln(n,e))!==void 0}function Si(t,e){if(t===e)return 0;const n=Ss(t),r=Ss(e);if(n!==r)return ge(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ge(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Be(i.integerValue||i.doubleValue),u=Be(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return vy(t.timestampValue,e.timestampValue);case 4:return vy(ra(t),ra(e));case 5:return ge(t.stringValue,e.stringValue);case 6:return function(i,o){const l=bs(i),u=bs(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const h=ge(l[d],u[d]);if(h!==0)return h}return ge(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=ge(Be(i.latitude),Be(o.latitude));return l!==0?l:ge(Be(i.longitude),Be(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _y(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,d,h;const g=i.fields||{},y=o.fields||{},C=(l=g.value)===null||l===void 0?void 0:l.arrayValue,k=(u=y.value)===null||u===void 0?void 0:u.arrayValue,w=ge(((d=C==null?void 0:C.values)===null||d===void 0?void 0:d.length)||0,((h=k==null?void 0:k.values)===null||h===void 0?void 0:h.length)||0);return w!==0?w:_y(C,k)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===hl.mapValue&&o===hl.mapValue)return 0;if(i===hl.mapValue)return 1;if(o===hl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let g=0;g<u.length&&g<h.length;++g){const y=ge(u[g],h[g]);if(y!==0)return y;const C=Si(l[u[g]],d[h[g]]);if(C!==0)return C}return ge(u.length,h.length)}(t.mapValue,e.mapValue);default:throw te()}}function vy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ge(t,e);const n=Hr(t),r=Hr(e),s=ge(n.seconds,r.seconds);return s!==0?s:ge(n.nanos,r.nanos)}function _y(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Si(n[s],r[s]);if(i)return i}return ge(n.length,r.length)}function Ti(t){return Ih(t)}function Ih(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Hr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return bs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return J.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ih(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Ih(n.fields[o])}`;return s+"}"}(t.mapValue):te()}function xy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ch(t){return!!t&&"integerValue"in t}function np(t){return!!t&&"arrayValue"in t}function wy(t){return!!t&&"nullValue"in t}function Ey(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vl(t){return!!t&&"mapValue"in t}function mP(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Do(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Oi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Do(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Do(t.arrayValue.values[n]);return e}return Object.assign({},t)}function gP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Vl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Do(n)}setAll(e){let n=dt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Do(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Vl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ln(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Vl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Oi(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new on(Do(this.value))}}function N0(t){const e=[];return Oi(t.fields,(n,r)=>{const s=new dt([n]);if(Vl(r)){const i=N0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new xn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new St(e,0,se.min(),se.min(),se.min(),on.empty(),0)}static newFoundDocument(e,n,r,s){return new St(e,1,n,se.min(),r,s,0)}static newNoDocument(e,n){return new St(e,2,n,se.min(),se.min(),on.empty(),0)}static newUnknownDocument(e,n){return new St(e,3,n,se.min(),se.min(),on.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof St&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,n){this.position=e,this.inclusive=n}}function by(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=J.comparator(J.fromName(o.referenceValue),n.key):r=Si(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Sy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ln(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,n="asc"){this.field=e,this.dir=n}}function yP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{}class Ge extends k0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new _P(e,n,r):n==="array-contains"?new EP(e,r):n==="in"?new bP(e,r):n==="not-in"?new SP(e,r):n==="array-contains-any"?new TP(e,r):new Ge(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new xP(e,r):new wP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Si(n,this.value)):n!==null&&Ss(this.value)===Ss(n)&&this.matchesComparison(Si(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return te()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends k0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new In(e,n)}matches(e){return D0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function D0(t){return t.op==="and"}function j0(t){return vP(t)&&D0(t)}function vP(t){for(const e of t.filters)if(e instanceof In)return!1;return!0}function Ah(t){if(t instanceof Ge)return t.field.canonicalString()+t.op.toString()+Ti(t.value);if(j0(t))return t.filters.map(e=>Ah(e)).join(",");{const e=t.filters.map(n=>Ah(n)).join(",");return`${t.op}(${e})`}}function O0(t,e){return t instanceof Ge?function(r,s){return s instanceof Ge&&r.op===s.op&&r.field.isEqual(s.field)&&Ln(r.value,s.value)}(t,e):t instanceof In?function(r,s){return s instanceof In&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&O0(o,s.filters[l]),!0):!1}(t,e):void te()}function V0(t){return t instanceof Ge?function(n){return`${n.field.canonicalString()} ${n.op} ${Ti(n.value)}`}(t):t instanceof In?function(n){return n.op.toString()+" {"+n.getFilters().map(V0).join(" ,")+"}"}(t):"Filter"}class _P extends Ge{constructor(e,n,r){super(e,n,r),this.key=J.fromName(r.referenceValue)}matches(e){const n=J.comparator(e.key,this.key);return this.matchesComparison(n)}}class xP extends Ge{constructor(e,n){super(e,"in",n),this.keys=M0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class wP extends Ge{constructor(e,n){super(e,"not-in",n),this.keys=M0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function M0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>J.fromName(r.referenceValue))}class EP extends Ge{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return np(n)&&ia(n.arrayValue,this.value)}}class bP extends Ge{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ia(this.value.arrayValue,n)}}class SP extends Ge{constructor(e,n){super(e,"not-in",n)}matches(e){if(ia(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ia(this.value.arrayValue,n)}}class TP extends Ge{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!np(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ia(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function Ty(t,e=null,n=[],r=[],s=null,i=null,o=null){return new IP(t,e,n,r,s,i,o)}function rp(t){const e=ie(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ah(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Qu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ti(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ti(r)).join(",")),e.ue=n}return e.ue}function sp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!yP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!O0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Sy(t.startAt,e.startAt)&&Sy(t.endAt,e.endAt)}function Ph(t){return J.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function CP(t,e,n,r,s,i,o,l){return new Vi(t,e,n,r,s,i,o,l)}function Yu(t){return new Vi(t)}function Iy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function L0(t){return t.collectionGroup!==null}function jo(t){const e=ie(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new ft(dt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new oa(i,r))}),n.has(dt.keyField().canonicalString())||e.ce.push(new oa(dt.keyField(),r))}return e.ce}function On(t){const e=ie(t);return e.le||(e.le=AP(e,jo(t))),e.le}function AP(t,e){if(t.limitType==="F")return Ty(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new oa(s.field,i)});const n=t.endAt?new xu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new xu(t.startAt.position,t.startAt.inclusive):null;return Ty(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Rh(t,e){const n=t.filters.concat([e]);return new Vi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Nh(t,e,n){return new Vi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Xu(t,e){return sp(On(t),On(e))&&t.limitType===e.limitType}function F0(t){return`${rp(On(t))}|lt:${t.limitType}`}function Us(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>V0(s)).join(", ")}]`),Qu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ti(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ti(s)).join(",")),`Target(${r})`}(On(t))}; limitType=${t.limitType})`}function Ju(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):J.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of jo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const d=by(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,jo(r),s)||r.endAt&&!function(o,l,u){const d=by(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,jo(r),s))}(t,e)}function PP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function U0(t){return(e,n)=>{let r=!1;for(const s of jo(t)){const i=RP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function RP(t,e,n){const r=t.field.isKeyField()?J.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?Si(u,d):te()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return te()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Oi(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return P0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP=new Ve(J.comparator);function lr(){return NP}const z0=new Ve(J.comparator);function xo(...t){let e=z0;for(const n of t)e=e.insert(n.key,n);return e}function B0(t){let e=z0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function us(){return Oo()}function $0(){return Oo()}function Oo(){return new Mi(t=>t.toString(),(t,e)=>t.isEqual(e))}const kP=new Ve(J.comparator),DP=new ft(J.comparator);function ce(...t){let e=DP;for(const n of t)e=e.add(n);return e}const jP=new ft(ge);function OP(){return jP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_u(e)?"-0":e}}function H0(t){return{integerValue:""+t}}function VP(t,e){return hP(e)?H0(e):ip(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(){this._=void 0}}function MP(t,e,n){return t instanceof aa?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&ep(i)&&(i=tp(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof la?q0(t,e):t instanceof ua?G0(t,e):function(s,i){const o=W0(s,i),l=Cy(o)+Cy(s.Pe);return Ch(o)&&Ch(s.Pe)?H0(l):ip(s.serializer,l)}(t,e)}function LP(t,e,n){return t instanceof la?q0(t,e):t instanceof ua?G0(t,e):n}function W0(t,e){return t instanceof wu?function(r){return Ch(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class aa extends Zu{}class la extends Zu{constructor(e){super(),this.elements=e}}function q0(t,e){const n=K0(e);for(const r of t.elements)n.some(s=>Ln(s,r))||n.push(r);return{arrayValue:{values:n}}}class ua extends Zu{constructor(e){super(),this.elements=e}}function G0(t,e){let n=K0(e);for(const r of t.elements)n=n.filter(s=>!Ln(s,r));return{arrayValue:{values:n}}}class wu extends Zu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Cy(t){return Be(t.integerValue||t.doubleValue)}function K0(t){return np(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,n){this.field=e,this.transform=n}}function UP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof la&&s instanceof la||r instanceof ua&&s instanceof ua?bi(r.elements,s.elements,Ln):r instanceof wu&&s instanceof wu?Ln(r.Pe,s.Pe):r instanceof aa&&s instanceof aa}(t.transform,e.transform)}class zP{constructor(e,n){this.version=e,this.transformResults=n}}class Sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sn}static exists(e){return new Sn(void 0,e)}static updateTime(e){return new Sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ml(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ec{}function Q0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new op(t.key,Sn.none()):new Sa(t.key,t.data,Sn.none());{const n=t.data,r=on.empty();let s=new ft(dt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Cs(t.key,r,new xn(s.toArray()),Sn.none())}}function BP(t,e,n){t instanceof Sa?function(s,i,o){const l=s.value.clone(),u=Py(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Cs?function(s,i,o){if(!Ml(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Py(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Y0(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Vo(t,e,n,r){return t instanceof Sa?function(i,o,l,u){if(!Ml(i.precondition,o))return l;const d=i.value.clone(),h=Ry(i.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Cs?function(i,o,l,u){if(!Ml(i.precondition,o))return l;const d=Ry(i.fieldTransforms,u,o),h=o.data;return h.setAll(Y0(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,l){return Ml(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function $P(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=W0(r.transform,s||null);i!=null&&(n===null&&(n=on.empty()),n.set(r.field,i))}return n||null}function Ay(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&bi(r,s,(i,o)=>UP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Sa extends ec{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Cs extends ec{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Y0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Py(t,e,n){const r=new Map;we(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,LP(o,l,n[s]))}return r}function Ry(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,MP(i,o,e))}return r}class op extends ec{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class HP extends ec{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&BP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Vo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Vo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=$0();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=Q0(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ce())}isEqual(e){return this.batchId===e.batchId&&bi(this.mutations,e.mutations,(n,r)=>Ay(n,r))&&bi(this.baseMutations,e.baseMutations,(n,r)=>Ay(n,r))}}class ap{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){we(e.mutations.length===r.length);let s=function(){return kP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ap(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He,he;function KP(t){switch(t){default:return te();case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0}}function X0(t){if(t===void 0)return ar("GRPC error has no .code"),L.UNKNOWN;switch(t){case He.OK:return L.OK;case He.CANCELLED:return L.CANCELLED;case He.UNKNOWN:return L.UNKNOWN;case He.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case He.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case He.INTERNAL:return L.INTERNAL;case He.UNAVAILABLE:return L.UNAVAILABLE;case He.UNAUTHENTICATED:return L.UNAUTHENTICATED;case He.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case He.NOT_FOUND:return L.NOT_FOUND;case He.ALREADY_EXISTS:return L.ALREADY_EXISTS;case He.PERMISSION_DENIED:return L.PERMISSION_DENIED;case He.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case He.ABORTED:return L.ABORTED;case He.OUT_OF_RANGE:return L.OUT_OF_RANGE;case He.UNIMPLEMENTED:return L.UNIMPLEMENTED;case He.DATA_LOSS:return L.DATA_LOSS;default:return te()}}(he=He||(He={}))[he.OK=0]="OK",he[he.CANCELLED=1]="CANCELLED",he[he.UNKNOWN=2]="UNKNOWN",he[he.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",he[he.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",he[he.NOT_FOUND=5]="NOT_FOUND",he[he.ALREADY_EXISTS=6]="ALREADY_EXISTS",he[he.PERMISSION_DENIED=7]="PERMISSION_DENIED",he[he.UNAUTHENTICATED=16]="UNAUTHENTICATED",he[he.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",he[he.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",he[he.ABORTED=10]="ABORTED",he[he.OUT_OF_RANGE=11]="OUT_OF_RANGE",he[he.UNIMPLEMENTED=12]="UNIMPLEMENTED",he[he.INTERNAL=13]="INTERNAL",he[he.UNAVAILABLE=14]="UNAVAILABLE",he[he.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP=new fs([4294967295,4294967295],0);function Ny(t){const e=QP().encode(t),n=new w0;return n.update(e),new Uint8Array(n.digest())}function ky(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new fs([n,r],0),new fs([s,i],0)]}class lp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new wo(`Invalid padding: ${n}`);if(r<0)throw new wo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new wo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new wo(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=fs.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(fs.fromNumber(r)));return s.compare(YP)===1&&(s=new fs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Ny(e),[r,s]=ky(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new lp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Ny(e),[r,s]=ky(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class wo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ta.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new tc(se.min(),s,new Ve(ge),lr(),ce())}}class Ta{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ta(r,n,ce(),ce(),ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class J0{constructor(e,n){this.targetId=e,this.me=n}}class Z0{constructor(e,n,r=mt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Dy{constructor(){this.fe=0,this.ge=Oy(),this.pe=mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ce(),n=ce(),r=ce();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:te()}}),new Ta(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Oy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,we(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class XP{constructor(e){this.Le=e,this.Be=new Map,this.ke=lr(),this.qe=jy(),this.Qe=new Ve(ge)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:te()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Ph(i))if(r===0){const o=new J(i.path);this.Ue(n,o,St.newNoDocument(o,se.min()))}else we(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=bs(r).toUint8Array()}catch(u){if(u instanceof R0)return Ei("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new lp(o,s,i)}catch(u){return Ei(u instanceof wo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&Ph(l.target)){const u=new J(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,St.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=ce();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new tc(e,n,this.Qe,this.ke,r);return this.ke=lr(),this.qe=jy(),this.Qe=new Ve(ge),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Dy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ft(ge),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||G("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Dy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function jy(){return new Ve(J.comparator)}function Oy(){return new Ve(J.comparator)}const JP={asc:"ASCENDING",desc:"DESCENDING"},ZP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eR={and:"AND",or:"OR"};class tR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function kh(t,e){return t.useProto3Json||Qu(e)?e:{value:e}}function Eu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ew(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function nR(t,e){return Eu(t,e.toTimestamp())}function Vn(t){return we(!!t),se.fromTimestamp(function(n){const r=Hr(n);return new Ze(r.seconds,r.nanos)}(t))}function up(t,e){return Dh(t,e).canonicalString()}function Dh(t,e){const n=function(s){return new Ce(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function tw(t){const e=Ce.fromString(t);return we(ow(e)),e}function jh(t,e){return up(t.databaseId,e.path)}function dd(t,e){const n=tw(e);if(n.get(1)!==t.databaseId.projectId)throw new $(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new $(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new J(rw(n))}function nw(t,e){return up(t.databaseId,e)}function rR(t){const e=tw(t);return e.length===4?Ce.emptyPath():rw(e)}function Oh(t){return new Ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function rw(t){return we(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Vy(t,e,n){return{name:jh(t,e),fields:n.value.mapValue.fields}}function sR(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:te()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(we(h===void 0||typeof h=="string"),mt.fromBase64String(h||"")):(we(h===void 0||h instanceof Buffer||h instanceof Uint8Array),mt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?L.UNKNOWN:X0(d.code);return new $(h,d.message||"")}(o);n=new Z0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=dd(t,r.document.name),i=Vn(r.document.updateTime),o=r.document.createTime?Vn(r.document.createTime):se.min(),l=new on({mapValue:{fields:r.document.fields}}),u=St.newFoundDocument(s,i,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Ll(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=dd(t,r.document),i=r.readTime?Vn(r.readTime):se.min(),o=St.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Ll([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=dd(t,r.document),i=r.removedTargetIds||[];n=new Ll([],i,s,null)}else{if(!("filter"in e))return te();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new GP(s,i),l=r.targetId;n=new J0(l,o)}}return n}function iR(t,e){let n;if(e instanceof Sa)n={update:Vy(t,e.key,e.value)};else if(e instanceof op)n={delete:jh(t,e.key)};else if(e instanceof Cs)n={update:Vy(t,e.key,e.data),updateMask:pR(e.fieldMask)};else{if(!(e instanceof HP))return te();n={verify:jh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof aa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof la)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ua)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof wu)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw te()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:nR(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:te()}(t,e.precondition)),n}function oR(t,e){return t&&t.length>0?(we(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Vn(s.updateTime):Vn(i);return o.isEqual(se.min())&&(o=Vn(i)),new zP(o,s.transformResults||[])}(n,e))):[]}function aR(t,e){return{documents:[nw(t,e.path)]}}function lR(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=nw(t,s);const i=function(d){if(d.length!==0)return iw(In.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(y){return{field:zs(y.field),direction:dR(y.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=kh(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function uR(t){let e=rR(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){we(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(g){const y=sw(g);return y instanceof In&&j0(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(y=>function(k){return new oa(Bs(k.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(g){let y;return y=typeof g=="object"?g.value:g,Qu(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,C=g.values||[];return new xu(C,y)}(n.startAt));let d=null;return n.endAt&&(d=function(g){const y=!g.before,C=g.values||[];return new xu(C,y)}(n.endAt)),CP(e,s,o,i,l,"F",u,d)}function cR(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return te()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function sw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Bs(n.unaryFilter.field);return Ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Bs(n.unaryFilter.field);return Ge.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Bs(n.unaryFilter.field);return Ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bs(n.unaryFilter.field);return Ge.create(o,"!=",{nullValue:"NULL_VALUE"});default:return te()}}(t):t.fieldFilter!==void 0?function(n){return Ge.create(Bs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return te()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return In.create(n.compositeFilter.filters.map(r=>sw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return te()}}(n.compositeFilter.op))}(t):te()}function dR(t){return JP[t]}function hR(t){return ZP[t]}function fR(t){return eR[t]}function zs(t){return{fieldPath:t.canonicalString()}}function Bs(t){return dt.fromServerFormat(t.fieldPath)}function iw(t){return t instanceof Ge?function(n){if(n.op==="=="){if(Ey(n.value))return{unaryFilter:{field:zs(n.field),op:"IS_NAN"}};if(wy(n.value))return{unaryFilter:{field:zs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ey(n.value))return{unaryFilter:{field:zs(n.field),op:"IS_NOT_NAN"}};if(wy(n.value))return{unaryFilter:{field:zs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zs(n.field),op:hR(n.op),value:n.value}}}(t):t instanceof In?function(n){const r=n.getFilters().map(s=>iw(s));return r.length===1?r[0]:{compositeFilter:{op:fR(n.op),filters:r}}}(t):te()}function pR(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ow(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,n,r,s,i=se.min(),o=se.min(),l=mt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Ar(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e){this.ct=e}}function gR(t){const e=uR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Nh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(){this.un=new vR}addToCollectionParentIndex(e,n){return this.un.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve($r.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve($r.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class vR{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ft(Ce.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ft(Ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ii(0)}static kn(){return new Ii(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(){this.changes=new Mi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,St.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Vo(r.mutation,s,xn.empty(),Ze.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ce()){const s=us();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=xo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=us();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ce()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=lr();const o=Oo(),l=function(){return Oo()}();return n.forEach((u,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Cs)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Vo(h.mutation,d,h.mutation.getFieldMask(),Ze.now())):o.set(d.key,xn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var g;return l.set(d,new xR(h,(g=o.get(d))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Oo();let s=new Ve((o,l)=>o-l),i=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||xn.empty();h=l.applyToLocalView(d,h),r.set(u,h);const g=(s.get(l.batchId)||ce()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,h=u.value,g=$0();h.forEach(y=>{if(!i.has(y)){const C=Q0(n.get(y),r.get(y));C!==null&&g.set(y,C),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return J.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):L0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):F.resolve(us());let l=-1,u=i;return o.next(d=>F.forEach(d,(h,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(h)?F.resolve():this.remoteDocumentCache.getEntry(e,h).next(y=>{u=u.insert(h,y)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,ce())).next(h=>({batchId:l,changes:B0(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new J(n)).next(r=>{let s=xo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=xo();return this.indexManager.getCollectionParents(e,i).next(l=>F.forEach(l,u=>{const d=function(g,y){return new Vi(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((g,y)=>{o=o.insert(g,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,St.newInvalidDocument(h)))});let l=xo();return o.forEach((u,d)=>{const h=i.get(u);h!==void 0&&Vo(h.mutation,d,xn.empty(),Ze.now()),Ju(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return F.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Vn(s.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:gR(s.bundledQuery),readTime:Vn(s.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(){this.overlays=new Ve(J.comparator),this.Ir=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=us();return F.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const s=us(),i=n.length+1,o=new J(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return F.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ve((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=us(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=us(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=s)););return F.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new qP(n,r));let i=this.Ir.get(n);i===void 0&&(i=ce(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(){this.sessionToken=mt.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(){this.Tr=new ft(st.Er),this.dr=new ft(st.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new st(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new st(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new J(new Ce([])),r=new st(n,e),s=new st(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new J(new Ce([])),r=new st(n,e),s=new st(n,e+1);let i=ce();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new st(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class st{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return J.comparator(e.key,n.key)||ge(e.wr,n.wr)}static Ar(e,n){return ge(e.wr,n.wr)||J.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ft(st.Er)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new WP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new st(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new st(n,0),s=new st(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ft(ge);return n.forEach(s=>{const i=new st(s,0),o=new st(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),F.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;J.isDocumentKey(i)||(i=i.child(""));const o=new st(new J(i),0);let l=new ft(ge);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.wr)),!0)},o),F.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){we(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return F.forEach(n.mutations,s=>{const i=new st(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new st(n,0),s=this.br.firstAfterOrEqual(r);return F.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e){this.Mr=e,this.docs=function(){return new Ve(J.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():St.newInvalidDocument(n))}getEntries(e,n){let r=lr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():St.newInvalidDocument(s))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=lr();const o=n.path,l=new J(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||lP(aP(h),r)<=0||(s.has(h.key)||Ju(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,r,s){te()}Or(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new CR(this)}getSize(e){return F.resolve(this.size)}}class CR extends _R{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.persistence=e,this.Nr=new Mi(n=>rp(n),sp),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Lr=0,this.Br=new cp,this.targetCount=0,this.kr=Ii.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),F.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Ii(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.Kn(n),F.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),F.waitFor(i).next(()=>s)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Zf(0),this.Kr=!1,this.Kr=!0,this.$r=new SR,this.referenceDelegate=e(this),this.Ur=new AR(this),this.indexManager=new yR,this.remoteDocumentCache=function(s){return new IR(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new mR(n),this.Gr=new ER(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new bR,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new TR(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){G("MemoryPersistence","Starting transaction:",e);const s=new RR(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return F.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class RR extends cP{constructor(e){super(),this.currentSequenceNumber=e}}class dp{constructor(e){this.persistence=e,this.Jr=new cp,this.Yr=null}static Zr(e){return new dp(e)}get Xr(){if(this.Yr)return this.Yr;throw te()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),F.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.Xr,r=>{const s=J.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,se.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return F.or([()=>F.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ce(),s=ce();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new hp(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return kT()?8:dP(It())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new NR;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(lo()<=de.DEBUG&&G("QueryEngine","SDK will not create cache indexes for query:",Us(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),F.resolve()):(lo()<=de.DEBUG&&G("QueryEngine","Query:",Us(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(lo()<=de.DEBUG&&G("QueryEngine","The SDK decides to create cache indexes for query:",Us(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,On(n))):F.resolve())}Yi(e,n){if(Iy(n))return F.resolve(null);let r=On(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Nh(n,null,"F"),r=On(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ce(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,l);return this.ns(n,d,o,u.readTime)?this.Yi(e,Nh(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return Iy(n)||s.isEqual(se.min())?F.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?F.resolve(null):(lo()<=de.DEBUG&&G("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Us(n)),this.rs(e,o,n,oP(s,-1)).next(l=>l))})}ts(e,n){let r=new ft(U0(e));return n.forEach((s,i)=>{Ju(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return lo()<=de.DEBUG&&G("QueryEngine","Using full collection scan to execute query:",Us(n)),this.Ji.getDocumentsMatchingQuery(e,n,$r.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Ve(ge),this._s=new Mi(i=>rp(i),sp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wR(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function jR(t,e,n,r){return new DR(t,e,n,r)}async function aw(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=ce();for(const d of s){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function OR(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,h){const g=d.batch,y=g.keys();let C=F.resolve();return y.forEach(k=>{C=C.next(()=>h.getEntry(u,k)).next(w=>{const N=d.docVersions.get(k);we(N!==null),w.version.compareTo(N)<0&&(g.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))})}),C.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ce();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function lw(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function VR(t,e){const n=ie(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((h,g)=>{const y=s.get(g);if(!y)return;l.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,g)));let C=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?C=C.withResumeToken(mt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):h.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(h.resumeToken,r)),s=s.insert(g,C),function(w,N,b){return w.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(y,C,h)&&l.push(n.Ur.updateTargetData(i,C))});let u=lr(),d=ce();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(MR(i,o,e.documentUpdates).next(h=>{u=h.Ps,d=h.Is})),!r.isEqual(se.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return F.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=s,i))}function MR(t,e,n){let r=ce(),s=ce();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=lr();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(se.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):G("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function LR(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function FR(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,F.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Ar(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Vh(t,e,n){const r=ie(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ba(o))throw o;G("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function My(t,e,n){const r=ie(t);let s=se.min(),i=ce();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,h){const g=ie(u),y=g._s.get(h);return y!==void 0?F.resolve(g.os.get(y)):g.Ur.getTargetData(d,h)}(r,o,On(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:se.min(),n?i:ce())).next(l=>(UR(r,PP(e),l),{documents:l,Ts:i})))}function UR(t,e,n){let r=t.us.get(e)||se.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Ly{constructor(){this.activeTargetIds=OP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zR{constructor(){this.so=new Ly,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ly,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){G("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){G("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fl=null;function hd(){return fl===null?fl=function(){return 268435456+Math.round(2147483648*Math.random())}():fl++,"0x"+fl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xt="WebChannelConnection";class WR extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=hd(),u=this.xo(n,r.toUriEncodedString());G("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(n,u,d,s).then(h=>(G("RestConnection",`Received RPC '${n}' ${l}: `,h),h),h=>{throw Ei("RestConnection",`RPC '${n}' ${l} failed with error: `,h,"url: ",u,"request:",s),h})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ji}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=$R[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=hd();return new Promise((o,l)=>{const u=new E0;u.setWithCredentials(!0),u.listenOnce(b0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ol.NO_ERROR:const h=u.getResponseJson();G(xt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Ol.TIMEOUT:G(xt,`RPC '${e}' ${i} timed out`),l(new $(L.DEADLINE_EXCEEDED,"Request time out"));break;case Ol.HTTP_ERROR:const g=u.getStatus();if(G(xt,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const C=y==null?void 0:y.error;if(C&&C.status&&C.message){const k=function(N){const b=N.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(b)>=0?b:L.UNKNOWN}(C.status);l(new $(k,C.message))}else l(new $(L.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new $(L.UNAVAILABLE,"Connection failed."));break;default:te()}}finally{G(xt,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);G(xt,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=hd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=I0(),l=T0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=i.join("");G(xt,`Creating RPC '${e}' stream ${s}: ${h}`,u);const g=o.createWebChannel(h,u);let y=!1,C=!1;const k=new HR({Io:N=>{C?G(xt,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(y||(G(xt,`Opening RPC '${e}' stream ${s} transport.`),g.open(),y=!0),G(xt,`RPC '${e}' stream ${s} sending:`,N),g.send(N))},To:()=>g.close()}),w=(N,b,E)=>{N.listen(b,v=>{try{E(v)}catch(S){setTimeout(()=>{throw S},0)}})};return w(g,_o.EventType.OPEN,()=>{C||(G(xt,`RPC '${e}' stream ${s} transport opened.`),k.yo())}),w(g,_o.EventType.CLOSE,()=>{C||(C=!0,G(xt,`RPC '${e}' stream ${s} transport closed`),k.So())}),w(g,_o.EventType.ERROR,N=>{C||(C=!0,Ei(xt,`RPC '${e}' stream ${s} transport errored:`,N),k.So(new $(L.UNAVAILABLE,"The operation could not be completed")))}),w(g,_o.EventType.MESSAGE,N=>{var b;if(!C){const E=N.data[0];we(!!E);const v=E,S=v.error||((b=v[0])===null||b===void 0?void 0:b.error);if(S){G(xt,`RPC '${e}' stream ${s} received error:`,S);const P=S.status;let I=function(x){const A=He[x];if(A!==void 0)return X0(A)}(P),_=S.message;I===void 0&&(I=L.INTERNAL,_="Unknown error status: "+P+" with message "+S.message),C=!0,k.So(new $(I,_)),g.close()}else G(xt,`RPC '${e}' stream ${s} received:`,E),k.bo(E)}}),w(l,S0.STAT_EVENT,N=>{N.stat===Th.PROXY?G(xt,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===Th.NOPROXY&&G(xt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.wo()},0),k}}function fd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(t){return new tR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&G("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,n,r,s,i,o,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new uw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===L.RESOURCE_EXHAUSTED?(ar(n.toString()),ar("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===L.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new $(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return G("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(G("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class qR extends cw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=sR(this.serializer,e),r=function(i){if(!("targetChange"in i))return se.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?se.min():o.readTime?Vn(o.readTime):se.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Oh(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=Ph(u)?{documents:aR(i,u)}:{query:lR(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=ew(i,o.resumeToken);const d=kh(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(se.min())>0){l.readTime=Eu(i,o.snapshotVersion.toTimestamp());const d=kh(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=cR(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Oh(this.serializer),n.removeTarget=e,this.a_(n)}}class GR extends cw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return we(!!e.streamToken),this.lastStreamToken=e.streamToken,we(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){we(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=oR(e.writeResults,e.commitTime),r=Vn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Oh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>iR(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new $(L.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Dh(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $(L.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Dh(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $(L.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class QR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ar(n),this.D_=!1):G("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{As(this)&&(G("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=ie(u);d.L_.add(4),await Ia(d),d.q_.set("Unknown"),d.L_.delete(4),await rc(d)}(this))})}),this.q_=new QR(r,s)}}async function rc(t){if(As(t))for(const e of t.B_)await e(!0)}async function Ia(t){for(const e of t.B_)await e(!1)}function dw(t,e){const n=ie(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),gp(n)?mp(n):Li(n).r_()&&pp(n,e))}function fp(t,e){const n=ie(t),r=Li(n);n.N_.delete(e),r.r_()&&hw(n,e),n.N_.size===0&&(r.r_()?r.o_():As(n)&&n.q_.set("Unknown"))}function pp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(se.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Li(t).A_(e)}function hw(t,e){t.Q_.xe(e),Li(t).R_(e)}function mp(t){t.Q_=new XP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Li(t).start(),t.q_.v_()}function gp(t){return As(t)&&!Li(t).n_()&&t.N_.size>0}function As(t){return ie(t).L_.size===0}function fw(t){t.Q_=void 0}async function XR(t){t.q_.set("Online")}async function JR(t){t.N_.forEach((e,n)=>{pp(t,e)})}async function ZR(t,e){fw(t),gp(t)?(t.q_.M_(e),mp(t)):t.q_.set("Unknown")}async function eN(t,e,n){if(t.q_.set("Online"),e instanceof Z0&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){G("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await bu(t,r)}else if(e instanceof Ll?t.Q_.Ke(e):e instanceof J0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(se.min()))try{const r=await lw(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=i.N_.get(d);h&&i.N_.set(d,h.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const h=i.N_.get(u);if(!h)return;i.N_.set(u,h.withResumeToken(mt.EMPTY_BYTE_STRING,h.snapshotVersion)),hw(i,u);const g=new Ar(h.target,u,d,h.sequenceNumber);pp(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){G("RemoteStore","Failed to raise snapshot:",r),await bu(t,r)}}async function bu(t,e,n){if(!ba(e))throw e;t.L_.add(1),await Ia(t),t.q_.set("Offline"),n||(n=()=>lw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{G("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await rc(t)})}function pw(t,e){return e().catch(n=>bu(t,n,e))}async function sc(t){const e=ie(t),n=Wr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;tN(e);)try{const s=await LR(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,nN(e,s)}catch(s){await bu(e,s)}mw(e)&&gw(e)}function tN(t){return As(t)&&t.O_.length<10}function nN(t,e){t.O_.push(e);const n=Wr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function mw(t){return As(t)&&!Wr(t).n_()&&t.O_.length>0}function gw(t){Wr(t).start()}async function rN(t){Wr(t).p_()}async function sN(t){const e=Wr(t);for(const n of t.O_)e.m_(n.mutations)}async function iN(t,e,n){const r=t.O_.shift(),s=ap.from(r,e,n);await pw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await sc(t)}async function oN(t,e){e&&Wr(t).V_&&await async function(r,s){if(function(o){return KP(o)&&o!==L.ABORTED}(s.code)){const i=r.O_.shift();Wr(r).s_(),await pw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await sc(r)}}(t,e),mw(t)&&gw(t)}async function Uy(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),G("RemoteStore","RemoteStore received new credentials");const r=As(n);n.L_.add(3),await Ia(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await rc(n)}async function aN(t,e){const n=ie(t);e?(n.L_.delete(2),await rc(n)):e||(n.L_.add(2),await Ia(n),n.q_.set("Unknown"))}function Li(t){return t.K_||(t.K_=function(n,r,s){const i=ie(n);return i.w_(),new qR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:XR.bind(null,t),Ro:JR.bind(null,t),mo:ZR.bind(null,t),d_:eN.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),gp(t)?mp(t):t.q_.set("Unknown")):(await t.K_.stop(),fw(t))})),t.K_}function Wr(t){return t.U_||(t.U_=function(n,r,s){const i=ie(n);return i.w_(),new GR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:rN.bind(null,t),mo:oN.bind(null,t),f_:sN.bind(null,t),g_:iN.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await sc(t)):(await t.U_.stop(),t.O_.length>0&&(G("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new yp(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vp(t,e){if(ar("AsyncQueue",`${e}: ${t}`),ba(t))return new $(L.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||J.comparator(n.key,r.key):(n,r)=>J.comparator(n.key,r.key),this.keyedMap=xo(),this.sortedSet=new Ve(this.comparator)}static emptySet(e){return new hi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof hi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new hi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(){this.W_=new Ve(J.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):te():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ci{constructor(e,n,r,s,i,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Ci(e,n,hi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class uN{constructor(){this.queries=By(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ie(n),i=s.queries;s.queries=By(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new $(L.ABORTED,"Firestore shutting down"))}}function By(){return new Mi(t=>F0(t),Xu)}async function _p(t,e){const n=ie(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new lN,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=vp(o,`Initialization of query '${Us(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&wp(n)}async function xp(t,e){const n=ie(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function cN(t,e){const n=ie(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&wp(n)}function dN(t,e,n){const r=ie(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function wp(t){t.Y_.forEach(e=>{e.next()})}var Mh,$y;($y=Mh||(Mh={})).ea="default",$y.Cache="cache";class Ep{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ci(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ci.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Mh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e){this.key=e}}class vw{constructor(e){this.key=e}}class hN{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ce(),this.mutatedKeys=ce(),this.Aa=U0(e),this.Ra=new hi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new zy,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,g)=>{const y=s.get(h),C=Ju(this.query,g)?g:null,k=!!y&&this.mutatedKeys.has(y.key),w=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let N=!1;y&&C?y.data.isEqual(C.data)?k!==w&&(r.track({type:3,doc:C}),N=!0):this.ga(y,C)||(r.track({type:2,doc:C}),N=!0,(u&&this.Aa(C,u)>0||d&&this.Aa(C,d)<0)&&(l=!0)):!y&&C?(r.track({type:0,doc:C}),N=!0):y&&!C&&(r.track({type:1,doc:y}),N=!0,(u||d)&&(l=!0)),N&&(C?(o=o.add(C),i=w?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,g)=>function(C,k){const w=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return te()}};return w(C)-w(k)}(h.type,g.type)||this.Aa(h.doc,g.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new Ci(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new zy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ce(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new vw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new yw(r))}),n}ba(e){this.Ta=e.Ts,this.da=ce();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ci.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class fN{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class pN{constructor(e){this.key=e,this.va=!1}}class mN{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Mi(l=>F0(l),Xu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ve(J.comparator),this.Na=new Map,this.La=new cp,this.Ba={},this.ka=new Map,this.qa=Ii.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function gN(t,e,n=!0){const r=Sw(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await _w(r,e,n,!0),s}async function yN(t,e){const n=Sw(t);await _w(n,e,!0,!1)}async function _w(t,e,n,r){const s=await FR(t.localStore,On(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await vN(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&dw(t.remoteStore,s),l}async function vN(t,e,n,r,s){t.Ka=(g,y,C)=>async function(w,N,b,E){let v=N.view.ma(b);v.ns&&(v=await My(w.localStore,N.query,!1).then(({documents:_})=>N.view.ma(_,v)));const S=E&&E.targetChanges.get(N.targetId),P=E&&E.targetMismatches.get(N.targetId)!=null,I=N.view.applyChanges(v,w.isPrimaryClient,S,P);return Wy(w,N.targetId,I.wa),I.snapshot}(t,g,y,C);const i=await My(t.localStore,e,!0),o=new hN(e,i.Ts),l=o.ma(i.documents),u=Ta.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,u);Wy(t,n,d.wa);const h=new fN(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function _N(t,e,n){const r=ie(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Xu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Vh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&fp(r.remoteStore,s.targetId),Lh(r,s.targetId)}).catch(Ea)):(Lh(r,s.targetId),await Vh(r.localStore,s.targetId,!0))}async function xN(t,e){const n=ie(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),fp(n.remoteStore,r.targetId))}async function wN(t,e,n){const r=AN(t);try{const s=await function(o,l){const u=ie(o),d=Ze.now(),h=l.reduce((C,k)=>C.add(k.key),ce());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let k=lr(),w=ce();return u.cs.getEntries(C,h).next(N=>{k=N,k.forEach((b,E)=>{E.isValidDocument()||(w=w.add(b))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,k)).next(N=>{g=N;const b=[];for(const E of l){const v=$P(E,g.get(E.key).overlayedDocument);v!=null&&b.push(new Cs(E.key,v,N0(v.value.mapValue),Sn.exists(!0)))}return u.mutationQueue.addMutationBatch(C,d,b,l)}).next(N=>{y=N;const b=N.applyToLocalDocumentSet(g,w);return u.documentOverlayCache.saveOverlays(C,N.batchId,b)})}).then(()=>({batchId:y.batchId,changes:B0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new Ve(ge)),d=d.insert(l,u),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,n),await Ca(r,s.changes),await sc(r.remoteStore)}catch(s){const i=vp(s,"Failed to persist write");n.reject(i)}}async function xw(t,e){const n=ie(t);try{const r=await VR(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(we(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?we(o.va):s.removedDocuments.size>0&&(we(o.va),o.va=!1))}),await Ca(n,r,e)}catch(r){await Ea(r)}}function Hy(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=ie(o);u.onlineState=l;let d=!1;u.queries.forEach((h,g)=>{for(const y of g.j_)y.Z_(l)&&(d=!0)}),d&&wp(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function EN(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new Ve(J.comparator);o=o.insert(i,St.newNoDocument(i,se.min()));const l=ce().add(i),u=new tc(se.min(),new Map,new Ve(ge),o,l);await xw(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),bp(r)}else await Vh(r.localStore,e,!1).then(()=>Lh(r,e,n)).catch(Ea)}async function bN(t,e){const n=ie(t),r=e.batch.batchId;try{const s=await OR(n.localStore,e);Ew(n,r,null),ww(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ca(n,s)}catch(s){await Ea(s)}}async function SN(t,e,n){const r=ie(t);try{const s=await function(o,l){const u=ie(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,l).next(g=>(we(g!==null),h=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(r.localStore,e);Ew(r,e,n),ww(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ca(r,s)}catch(s){await Ea(s)}}function ww(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Ew(t,e,n){const r=ie(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Lh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||bw(t,r)})}function bw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(fp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),bp(t))}function Wy(t,e,n){for(const r of n)r instanceof yw?(t.La.addReference(r.key,e),TN(t,r)):r instanceof vw?(G("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||bw(t,r.key)):te()}function TN(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(G("SyncEngine","New document in limbo: "+n),t.xa.add(r),bp(t))}function bp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new J(Ce.fromString(e)),r=t.qa.next();t.Na.set(r,new pN(n)),t.Oa=t.Oa.insert(n,r),dw(t.remoteStore,new Ar(On(Yu(n.path)),r,"TargetPurposeLimboResolution",Zf.oe))}}async function Ca(t,e,n){const r=ie(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const g=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(d){s.push(d);const g=hp.Wi(u.targetId,d);i.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,d){const h=ie(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>F.forEach(d,y=>F.forEach(y.$i,C=>h.persistence.referenceDelegate.addReference(g,y.targetId,C)).next(()=>F.forEach(y.Ui,C=>h.persistence.referenceDelegate.removeReference(g,y.targetId,C)))))}catch(g){if(!ba(g))throw g;G("LocalStore","Failed to update sequence numbers: "+g)}for(const g of d){const y=g.targetId;if(!g.fromCache){const C=h.os.get(y),k=C.snapshotVersion,w=C.withLastLimboFreeSnapshotVersion(k);h.os=h.os.insert(y,w)}}}(r.localStore,i))}async function IN(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){G("SyncEngine","User change. New user:",e.toKey());const r=await aw(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new $(L.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ca(n,r.hs)}}function CN(t,e){const n=ie(t),r=n.Na.get(e);if(r&&r.va)return ce().add(r.key);{let s=ce();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function Sw(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=xw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EN.bind(null,e),e.Ca.d_=cN.bind(null,e.eventManager),e.Ca.$a=dN.bind(null,e.eventManager),e}function AN(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SN.bind(null,e),e}class Su{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return jR(this.persistence,new kR,e.initialUser,this.serializer)}Ga(e){return new PR(dp.Zr,this.serializer)}Wa(e){return new zR}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Su.provider={build:()=>new Su};class Fh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Hy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=IN.bind(null,this.syncEngine),await aN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new uN}()}createDatastore(e){const n=nc(e.databaseInfo.databaseId),r=function(i){return new WR(i)}(e.databaseInfo);return function(i,o,l,u){return new KR(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new YR(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Hy(this.syncEngine,n,0),function(){return Fy.D()?new Fy:new BR}())}createSyncEngine(e,n){return function(s,i,o,l,u,d,h){const g=new mN(s,i,o,l,u,d);return h&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ie(s);G("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Ia(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Fh.provider={build:()=>new Fh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ar("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Et.UNAUTHENTICATED,this.clientId=A0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{G("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(G("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=vp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function pd(t,e){t.asyncQueue.verifyOperationInProgress(),G("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await aw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function qy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await RN(t);G("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Uy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Uy(e.remoteStore,s)),t._onlineComponents=e}async function RN(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){G("FirestoreClient","Using user provided OfflineComponentProvider");try{await pd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===L.FAILED_PRECONDITION||s.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ei("Error using user provided cache. Falling back to memory cache: "+n),await pd(t,new Su)}}else G("FirestoreClient","Using default OfflineComponentProvider"),await pd(t,new Su);return t._offlineComponents}async function Tw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(G("FirestoreClient","Using user provided OnlineComponentProvider"),await qy(t,t._uninitializedComponentsProvider._online)):(G("FirestoreClient","Using default OnlineComponentProvider"),await qy(t,new Fh))),t._onlineComponents}function NN(t){return Tw(t).then(e=>e.syncEngine)}async function Tu(t){const e=await Tw(t),n=e.eventManager;return n.onListen=gN.bind(null,e.syncEngine),n.onUnlisten=_N.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=yN.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=xN.bind(null,e.syncEngine),n}function kN(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new Sp({next:y=>{h.Za(),o.enqueueAndForget(()=>xp(i,g));const C=y.docs.has(l);!C&&y.fromCache?d.reject(new $(L.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&y.fromCache&&u&&u.source==="server"?d.reject(new $(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new Ep(Yu(l.path),h,{includeMetadataChanges:!0,_a:!0});return _p(i,g)}(await Tu(t),t.asyncQueue,e,n,r)),r.promise}function DN(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new Sp({next:y=>{h.Za(),o.enqueueAndForget(()=>xp(i,g)),y.fromCache&&u.source==="server"?d.reject(new $(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new Ep(l,h,{includeMetadataChanges:!0,_a:!0});return _p(i,g)}(await Tu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(t,e,n){if(!n)throw new $(L.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function jN(t,e,n,r){if(e===!0&&r===!0)throw new $(L.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ky(t){if(!J.isDocumentKey(t))throw new $(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qy(t){if(J.isDocumentKey(t))throw new $(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ic(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":te()}function un(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ic(t);throw new $(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new $(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Iw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new $(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new $(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new $(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class oc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yy(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new XA;switch(r.type){case"firstParty":return new tP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new $(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Gy.get(n);r&&(G("ComponentProvider","Removing Datastore"),Gy.delete(n),r.terminate())}(this),Promise.resolve()}}function ON(t,e,n,r={}){var s;const i=(t=un(t,oc))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Ei("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=Et.MOCK_USER;else{l=TT(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new $(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Et(d)}t._authCredentials=new JA(new C0(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Yr(this.firestore,e,this._query)}}class Dt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ur(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dt(this.firestore,e,this._key)}}class Ur extends Yr{constructor(e,n,r){super(e,n,Yu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dt(this.firestore,null,new J(e))}withConverter(e){return new Ur(this.firestore,e,this._path)}}function Jt(t,e,...n){if(t=jt(t),Cw("collection","path",e),t instanceof oc){const r=Ce.fromString(e,...n);return Qy(r),new Ur(t,null,r)}{if(!(t instanceof Dt||t instanceof Ur))throw new $(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return Qy(r),new Ur(t.firestore,null,r)}}function $t(t,e,...n){if(t=jt(t),arguments.length===1&&(e=A0.newId()),Cw("doc","path",e),t instanceof oc){const r=Ce.fromString(e,...n);return Ky(r),new Dt(t,null,new J(r))}{if(!(t instanceof Dt||t instanceof Ur))throw new $(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return Ky(r),new Dt(t.firestore,t instanceof Ur?t.converter:null,new J(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new uw(this,"async_queue_retry"),this.Vu=()=>{const r=fd();r&&G("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=fd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=fd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new er;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ba(e))throw e;G("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw ar("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=yp.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&te()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Jy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class qr extends oc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Xy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xy(e),this._firestoreClient=void 0,await e}}}function VN(t,e){const n=typeof t=="object"?t:zx(),r=typeof t=="string"?t:"(default)",s=Uf(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=bT("firestore");i&&ON(s,...i)}return s}function ac(t){if(t._terminated)throw new $(L.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||MN(t),t._firestoreClient}function MN(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,d,h){return new pP(l,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Iw(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new PN(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ai(mt.fromBase64String(e))}catch(n){throw new $(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ai(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new $(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new $(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new $(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ge(this._lat,e._lat)||ge(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=/^__.*__$/;class FN{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Cs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Sa(e,this.data,n,this.fieldTransforms)}}function Aw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw te()}}class Pp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Pp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Iu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Aw(this.Cu)&&LN.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class UN{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||nc(e)}Qu(e,n,r,s=!1){return new Pp({Cu:e,methodName:n,qu:r,path:dt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rp(t){const e=t._freezeSettings(),n=nc(t._databaseId);return new UN(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Pw(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);kw("Data must be an object, but it was:",o,r);const l=Rw(r,o);let u,d;if(i.merge)u=new xn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const g of i.mergeFields){const y=BN(e,g,n);if(!o.contains(y))throw new $(L.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);HN(h,y)||h.push(y)}u=new xn(h),d=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=o.fieldTransforms;return new FN(new on(l),u,d)}class Np extends Ip{_toFieldTransform(e){return new FP(e.path,new aa)}isEqual(e){return e instanceof Np}}function zN(t,e,n,r=!1){return kp(n,t.Qu(r?4:3,e))}function kp(t,e){if(Nw(t=jt(t)))return kw("Unsupported field value:",e,t),Rw(t,e);if(t instanceof Ip)return function(r,s){if(!Aw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=kp(l,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=jt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ze.fromDate(r);return{timestampValue:Eu(s.serializer,i)}}if(r instanceof Ze){const i=new Ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Eu(s.serializer,i)}}if(r instanceof Cp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ai)return{bytesValue:ew(s.serializer,r._byteString)};if(r instanceof Dt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:up(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Ap)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return ip(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${ic(r)}`)}(t,e)}function Rw(t,e){const n={};return P0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Oi(t,(r,s)=>{const i=kp(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Nw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ze||t instanceof Cp||t instanceof Ai||t instanceof Dt||t instanceof Ip||t instanceof Ap)}function kw(t,e,n){if(!Nw(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=ic(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function BN(t,e,n){if((e=jt(e))instanceof Tp)return e._internalPath;if(typeof e=="string")return Dw(t,e);throw Iu("Field path arguments must be of type string or ",t,!1,void 0,n)}const $N=new RegExp("[~\\*/\\[\\]]");function Dw(t,e,n){if(e.search($N)>=0)throw Iu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Tp(...e.split("."))._internalPath}catch{throw Iu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Iu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new $(L.INVALID_ARGUMENT,l+t+u)}function HN(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new WN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(lc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class WN extends jw{data(){return super.data()}}function lc(t,e){return typeof e=="string"?Dw(t,e):e instanceof Tp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Dp{}class Vw extends Dp{}function Cu(t,e,...n){let r=[];e instanceof Dp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof jp).length,l=i.filter(u=>u instanceof uc).length;if(o>1||o>0&&l>0)throw new $(L.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class uc extends Vw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new uc(e,n,r)}_apply(e){const n=this._parse(e);return Mw(e._query,n),new Yr(e.firestore,e.converter,Rh(e._query,n))}_parse(e){const n=Rp(e.firestore);return function(i,o,l,u,d,h,g){let y;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new $(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ev(g,h);const C=[];for(const k of g)C.push(Zy(u,i,k));y={arrayValue:{values:C}}}else y=Zy(u,i,g)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ev(g,h),y=zN(l,o,g,h==="in"||h==="not-in");return Ge.create(d,h,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function qN(t,e,n){const r=e,s=lc("where",t);return uc._create(s,r,n)}class jp extends Dp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new jp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:In.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)Mw(o,u),o=Rh(o,u)}(e._query,n),new Yr(e.firestore,e.converter,Rh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Op extends Vw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Op(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new $(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new $(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new oa(i,o)}(e._query,this._field,this._direction);return new Yr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Vi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function GN(t,e="asc"){const n=e,r=lc("orderBy",t);return Op._create(r,n)}function Zy(t,e,n){if(typeof(n=jt(n))=="string"){if(n==="")throw new $(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!L0(e)&&n.indexOf("/")!==-1)throw new $(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ce.fromString(n));if(!J.isDocumentKey(r))throw new $(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xy(t,new J(r))}if(n instanceof Dt)return xy(t,n._key);throw new $(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ic(n)}.`)}function ev(t,e){if(!Array.isArray(t)||t.length===0)throw new $(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Mw(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new $(L.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $(L.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class KN{convertValue(e,n="none"){switch(Ss(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(bs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw te()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Oi(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Be(o.doubleValue));return new Ap(i)}convertGeoPoint(e){return new Cp(Be(e.latitude),Be(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=tp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ra(e));default:return null}}convertTimestamp(e){const n=Hr(e);return new Ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ce.fromString(e);we(ow(r));const s=new sa(r.get(1),r.get(3)),i=new J(r.popFirst(5));return s.isEqual(n)||ar(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fw extends jw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Fl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(lc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Fl extends Fw{data(e={}){return super.data(e)}}class Uw{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Eo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Fl(this._firestore,this._userDataWriter,r.key,r,new Eo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Fl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Eo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Fl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Eo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:QN(l.type),doc:u,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function QN(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return te()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(t){t=un(t,Dt);const e=un(t.firestore,qr);return kN(ac(e),t._key).then(n=>$w(e,t,n))}class Vp extends KN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ai(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Dt(this.firestore,null,n)}}function Ul(t){t=un(t,Yr);const e=un(t.firestore,qr),n=ac(e),r=new Vp(e);return Ow(t._query),DN(n,t._query).then(s=>new Uw(e,r,t,s))}function Ps(t,e,n){t=un(t,Dt);const r=un(t.firestore,qr),s=Lw(t.converter,e,n);return Lp(r,[Pw(Rp(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Sn.none())])}function Bw(t){return Lp(un(t.firestore,qr),[new op(t._key,Sn.none())])}function Mp(t,e){const n=un(t.firestore,qr),r=$t(t),s=Lw(t.converter,e);return Lp(n,[Pw(Rp(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Sn.exists(!1))]).then(()=>r)}function ps(t,...e){var n,r,s;t=jt(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Jy(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Jy(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(s=g.complete)===null||s===void 0?void 0:s.bind(g)}let u,d,h;if(t instanceof Dt)d=un(t.firestore,qr),h=Yu(t._key.path),u={next:g=>{e[o]&&e[o]($w(d,t,g))},error:e[o+1],complete:e[o+2]};else{const g=un(t,Yr);d=un(g.firestore,qr),h=g._query;const y=new Vp(d);u={next:C=>{e[o]&&e[o](new Uw(d,y,g,C))},error:e[o+1],complete:e[o+2]},Ow(t._query)}return function(y,C,k,w){const N=new Sp(w),b=new Ep(C,N,k);return y.asyncQueue.enqueueAndForget(async()=>_p(await Tu(y),b)),()=>{N.Za(),y.asyncQueue.enqueueAndForget(async()=>xp(await Tu(y),b))}}(ac(d),h,l,u)}function Lp(t,e){return function(r,s){const i=new er;return r.asyncQueue.enqueueAndForget(async()=>wN(await NN(r),s,i)),i.promise}(ac(t),e)}function $w(t,e,n){const r=n.docs.get(e._key),s=new Vp(t);return new Fw(t,s,e._key,r,new Eo(n.hasPendingWrites,n.fromCache),e.converter)}function Hw(){return new Np("serverTimestamp")}(function(e,n=!0){(function(s){ji=s})(ki),xi(new xs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new qr(new ZA(r.getProvider("auth-internal")),new rP(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new $(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sa(d.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Fr(my,"4.7.3",e),Fr(my,"4.7.3","esm2017")})();const YN={apiKey:"AIzaSyDfsK4K4vhOmSSGeVHOlLnJuNlHGNha4LU",authDomain:"storycraft-a5f7e.firebaseapp.com",projectId:"storycraft-a5f7e",storageBucket:"storycraft-a5f7e.firebasestorage.app",messagingSenderId:"727724875985",appId:"1:727724875985:web:97411448885c68c289e5f0",measurementId:"G-JH03Y2NZDK"},Ww=Ux(YN),md=GA(Ww),Pe=VN(Ww),qw=V.createContext(),XN=({children:t})=>{const[e,n]=V.useState(null),[r,s]=V.useState(!1),[i,o]=V.useState(!0),{GLOBAL_APP_IDENTIFIER:l}=Rs();V.useEffect(()=>{const g=OC(md,y=>{n(y),y||(o(!1),s(!1))});return()=>g()},[]),V.useEffect(()=>{if(e&&l){const g=$t(Pe,`artifacts2/${l}/users/${e.uid}`),y=ps(g,async C=>{if(C.exists()){const k=C.data().isMaster===!0;s(k),console.log("%c[DIAGNSTICO AUTH]","color: #00A8E8; font-weight: bold;",{isMaster:k,userData:C.data()})}else try{await Ps(g,{displayName:e.displayName,email:e.email,isMaster:!1}),s(!1)}catch(k){console.error("Erro ao criar o documento do utilizador:",k)}o(!1)},C=>{console.error("Erro ao escutar documento do utilizador:",C),o(!1)});return()=>y()}s(!1)},[e,l]);const h={user:e,loading:i,isMaster:r,googleSignIn:()=>{const g=new qn;return nA(md,g)},googleSignOut:()=>VC(md)};return c.jsx(qw.Provider,{value:h,children:!i&&t})},Fe=()=>{const t=V.useContext(qw);if(!t)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return t},tv="1:727724875985:web:97411448885c68c289e5f0",Gw=(t,e)=>{const[n,r]=V.useState(null),[s,i]=V.useState(!0);V.useEffect(()=>{if(!t||!e){i(!1);return}const u=$t(Pe,`artifacts2/${tv}/users/${e}/characterSheets/${t}`),d=ps(u,h=>{if(h.exists()){const y={...h.data()};Object.keys(y).forEach(C=>{if(typeof y[C]=="string")try{y[C]=JSON.parse(y[C])}catch{}}),r({id:h.id,...y})}else console.error("Personagem no encontrado!"),r(null);i(!1)},h=>{console.error("Erro ao carregar o personagem:",h),i(!1)});return()=>d()},[t,e]);const o=V.useCallback(async(u,d)=>{if(!t||!e)return;const h=$t(Pe,`artifacts2/${tv}/users/${e}/characterSheets/${t}`),g=typeof d=="object"&&d!==null?JSON.stringify(d):d;try{await Ps(h,{[u]:g},{merge:!0})}catch(y){console.error(`Erro ao atualizar o campo ${u}:`,y)}},[t,e]),l=V.useCallback(u=>{var d;if(n){const h=((d=n.collapsedStates)==null?void 0:d[u])??!1,g={...n.collapsedStates,[u]:!h};o("collapsedStates",g)}},[n,o]);return{character:n,loading:s,updateCharacterField:o,toggleSection:l}},Kw=V.createContext(),Rs=()=>V.useContext(Kw),gd="1:727724875985:web:97411448885c68c289e5f0",nv="storycraft-v2/default-session",JN=({children:t})=>{const[e,n]=V.useState(null),r=V.useMemo(()=>{switch(e){case"v1":return`artifacts2/${gd}`;case"v2":return`artifacts2/${gd}`;default:return null}},[e]),i={currentSystem:e,setCurrentSystem:n,characterDataCollectionRoot:r,sessionDataCollectionRoot:nv,GLOBAL_APP_IDENTIFIER:gd,GLOBAL_SESSION_PATH:nv};return c.jsx(Kw.Provider,{value:i,children:t})},Ht=({title:t,isCollapsed:e,toggleSection:n,actions:r,children:s,isComplexTitle:i})=>c.jsxs("section",{className:"mb-8 p-6 bg-bgSurface backdrop-blur-sm rounded-xl shadow-inner border border-bgElement",children:[c.jsxs("div",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2 cursor-pointer flex justify-between items-center",onClick:n,children:[c.jsx("h2",{className:`flex-grow ${i?"":"truncate"}`.trim(),children:t}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{onClick:o=>o.stopPropagation(),children:r}),c.jsx("span",{children:e?"":""})]})]}),!e&&c.jsx("div",{className:"mt-4",children:s})]}),ti=[{name:"Acrobacia",attr:"DES"},{name:"Adestramento*",attr:"CAR"},{name:"Armadilhas*",attr:"INT"},{name:"Atletismo",attr:"FOR"},{name:"Atuao*",attr:"CAR"},{name:"Cavalgar",attr:"DES"},{name:"Cirurgia*",attr:"INT"},{name:"Conhecimento*",attr:"INT"},{name:"Cura",attr:"SAB"},{name:"Diplomacia",attr:"CAR"},{name:"Disfarce*",attr:"CAR"},{name:"Enganao",attr:"CAR"},{name:"Furtividade",attr:"DES"},{name:"Guerra*",attr:"INT"},{name:"Intimidao",attr:"CAR"},{name:"Intuio",attr:"SAB"},{name:"Investigao",attr:"INT"},{name:"Jogatina*",attr:"CAR"},{name:"Ladinagem*",attr:"DES"},{name:"Luta",attr:"FOR"},{name:"Misticismo*",attr:"INT"},{name:"Nobreza*",attr:"INT"},{name:"Ofcio",attr:"INT"},{name:"Percepo",attr:"SAB"},{name:"Pilotagem*",attr:"DES"},{name:"Pontaria",attr:"DES"},{name:"Prestidigitao",attr:"DES"},{name:"Religio*",attr:"SAB"},{name:"Seduo",attr:"CAR"},{name:"Sobrevivncia",attr:"SAB"}],Uh={FOR:"forca",DES:"destreza",CON:"constituicao",INT:"inteligencia",SAB:"sabedoria",CAR:"carisma"},ZN=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,onUpdate:s,onExecuteFormula:i,isEditMode:o})=>{const{user:l}=Fe(),u=l.uid===t.ownerUid||e,[d,h]=V.useState(t.skillSystem||{});V.useEffect(()=>{if((!t.skillSystem||ti.some(S=>!t.skillSystem[S.name]||!t.skillSystem[S.name].hasOwnProperty("selectedAttr")))&&u){console.log("Inicializando ou atualizando sistema de percias...");const S={...t.skillSystem};ti.forEach(P=>{const I=S[P.name]||{};I.hasOwnProperty("selectedAttr")||(S[P.name]={trained:I.trained||!1,otherBonus:I.otherBonus||0,selectedAttr:P.attr})}),s("skillSystem",S)}h(t.skillSystem||{})},[t.skillSystem,s,u]);const g=V.useMemo(()=>t.mainAttributes||{},[t.mainAttributes]),y=V.useMemo(()=>t.level||0,[t.level]),C=V.useCallback((v,S)=>{if(!S)return 0;const P=S.selectedAttr||v.attr,I=Uh[P],_=g[I]||0;let p=0;S.trained&&(p=2+Math.floor(y/10));const x=parseInt(S.otherBonus,10)||0;return _+p+x},[g,y]),k=v=>{if(!u||!o)return;const S=t.skillSystem||{},P=S[v]||{trained:!1,otherBonus:0},I={...S,[v]:{...P,trained:!P.trained}};s("skillSystem",I)},w=(v,S)=>{if(!u||!o)return;const P=t.skillSystem||{},I=P[v]||{trained:!1,otherBonus:0,selectedAttr:""},_={...P,[v]:{...I,selectedAttr:S}};s("skillSystem",_)},N=(v,S)=>{h(P=>{const I=P[v]||{trained:!1,otherBonus:0};return{...P,[v]:{...I,otherBonus:S}}})},b=v=>{var p,x,A;if(!u||!o)return;const S=(p=d[v])==null?void 0:p.otherBonus,P=(A=(x=t.skillSystem)==null?void 0:x[v])==null?void 0:A.otherBonus,I=parseInt(S,10)||0,_=parseInt(P,10)||0;if(I!==_){const D={...t.skillSystem,...d};D[v].otherBonus=I,s("skillSystem",D)}String(S)!==String(I)&&h(t.skillSystem||{})},E=(v,S)=>{const P=`${S>0?"+":""}${S}`,I={name:`Percia: ${v.name}`,components:[{type:"dice",value:"1d20"},{type:"number",value:S,label:"Bnus Total"}],discordText:`Rolagem de ${v.name} (1d20${P})`};i(I)};return!d||Object.keys(d).length<ti.length?c.jsx(Ht,{title:"Percias",isCollapsed:n,toggleSection:r,children:c.jsx("p",{className:"text-textSecondary text-center",children:"Carregando percias..."})}):c.jsx(Ht,{title:"Percias",isCollapsed:n,toggleSection:r,children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:ti.map(v=>{const S=d[v.name];if(!S)return null;const P=C(v,S),I=`${P>=0?"+":""}${P}`,_=S.selectedAttr||v.attr;return c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex flex-col gap-2",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center gap-2 flex-grow overflow-hidden",children:[c.jsx("input",{type:"checkbox",id:`trained-${v.name}`,checked:S.trained,onChange:()=>k(v.name),className:"form-checkbox text-btnHighlightBg rounded-sm focus:ring-btnHighlightBg disabled:opacity-50",disabled:!u||!o}),c.jsx("label",{className:"font-semibold text-lg text-textPrimary truncate",title:`${v.name}`,children:v.name})]}),o?c.jsx("select",{value:_,onChange:p=>w(v.name,p.target.value),className:"bg-bgInput text-textPrimary text-sm font-bold rounded-md p-1 border-none focus:ring-2 focus:ring-btnHighlightBg",disabled:!u,children:Object.keys(Uh).map(p=>c.jsx("option",{value:p,children:p},p))}):c.jsxs("span",{className:"font-semibold text-textSecondary text-sm ml-1",children:["(",_,")"]}),c.jsx("span",{className:"font-bold text-lg text-btnHighlightBg whitespace-nowrap ml-2",children:I})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{htmlFor:`other-${v.name}`,className:"text-sm text-textSecondary whitespace-nowrap",children:"Outros:"}),c.jsx("input",{type:"number",id:`other-${v.name}`,value:S.otherBonus===0?"":S.otherBonus,onChange:p=>N(v.name,p.target.value),onBlur:()=>b(v.name),className:"w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center disabled:bg-bgPage",placeholder:"0",disabled:!u||!o}),c.jsx("button",{onClick:()=>E(v,P),className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg text-lg",title:`Rolar ${v.name} (1d20${I})`,children:""})]})]},v.name)})})})},e1=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i})=>{const o=V.useRef(null);return Pv.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),c.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i})},t1=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,onOpenActionModal:s,allAttributes:i,onUpdate:o,onExecuteFormula:l,isEditMode:u})=>{const{user:d}=Fe();if(!t||!d)return null;const h=d.uid===t.ownerUid||e,[g,y]=V.useState(t.formulaActions||[]);V.useEffect(()=>{y(t.formulaActions||[])},[t.formulaActions]);const C=()=>{const I={id:crypto.randomUUID(),name:"Nova Ao",components:[{id:crypto.randomUUID(),type:"dice",value:"1d6"}],multiplier:1,discordText:"",isCollapsed:!1,costValue:0,costType:"",recoverHP:!1,recoverMP:!1};o("formulaActions",[...t.formulaActions||[],I])},k=I=>{o("formulaActions",(t.formulaActions||[]).filter(_=>_.id!==I))},w=(I,_,p)=>{y(x=>x.map(A=>A.id===I?{...A,[_]:p}:A))},N=V.useCallback((I,_,p)=>{const x=g.find(D=>D.id===I),A=(t.formulaActions||[]).find(D=>D.id===I);if(x&&A){const D=p!==void 0?p:x[_];D!==A[_]&&o("formulaActions",(t.formulaActions||[]).map(j=>j.id===I?{...j,[_]:D}:j))}},[g,t.formulaActions,o]),b=(I,_)=>{let p;_==="dice"?p={id:crypto.randomUUID(),type:_,value:"1d6"}:_==="attribute"?p={id:crypto.randomUUID(),type:_,value:""}:_==="critDice"?p={id:crypto.randomUUID(),type:_,value:"1d6",critValue:6,critBonusAttribute:"",critBonusMultiplier:1}:_==="skillRoll"&&(p={id:crypto.randomUUID(),type:_,skill:"",critMin:19,critFormula:""}),o("formulaActions",(t.formulaActions||[]).map(x=>x.id===I?{...x,components:[...x.components||[],p]}:x))},E=(I,_)=>{o("formulaActions",(t.formulaActions||[]).map(p=>p.id===I?{...p,components:(p.components||[]).filter(x=>x&&x.id!==_)}:p))},v=(I,_,p,x)=>{y(A=>A.map(D=>D.id===I?{...D,components:D.components.map(j=>j.id===_?{...j,[p]:x}:j)}:D))},S=V.useCallback((I,_,p,x)=>{const A=g.find(q=>q.id===I),D=A==null?void 0:A.components.find(q=>q.id===_),j=(t.formulaActions||[]).find(q=>q.id===I),R=j==null?void 0:j.components.find(q=>q.id===_);if(D&&R){const q=x!==void 0?x:D[p];q!==R[p]&&o("formulaActions",(t.formulaActions||[]).map(ne=>ne.id===I?{...ne,components:ne.components.map(ae=>ae.id===_?{...ae,[p]:q}:ae)}:ne))}},[g,t.formulaActions,o]),P=I=>{o("formulaActions",(t.formulaActions||[]).map(_=>_.id===I?{..._,isCollapsed:!_.isCollapsed}:_))};return c.jsx(Ht,{title:"Aes",isCollapsed:n,toggleSection:r,children:c.jsx(c.Fragment,{children:c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3",children:"Construtor de Aes Rpidas"}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(g||[]).map(I=>I.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>P(I.id),children:I.name||"Ao Sem Nome"}),c.jsx("button",{onClick:()=>l(I),className:"px-4 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-2 text-sm",children:"Usar"})]},I.id):c.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center gap-2 mb-3",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>P(I.id),children:I.name||"Ao Sem Nome"}),c.jsx("button",{onClick:()=>l(I),className:"px-5 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap",children:"Usar"}),h&&u&&c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>P(I.id),children:"Recolher "})]}),h&&u&&c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 border-t border-bgInput pt-3 mt-3 flex-grow",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome da Ao:"}),c.jsx("input",{type:"text",placeholder:"Nome da Ao",value:I.name,onChange:p=>w(I.id,"name",p.target.value),onBlur:()=>N(I.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-3",disabled:!h||!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Componentes da Frmula:"}),c.jsx("div",{className:"space-y-2 mb-3",children:(I.components||[]).filter(Boolean).map(p=>c.jsx("div",{className:"flex flex-col gap-2 p-2 rounded-md border border-dashed border-textSecondary/30",children:p.type==="dice"?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",placeholder:"1d6 ou 10",value:p.value,onChange:x=>v(I.id,p.id,"value",x.target.value),onBlur:()=>S(I.id,p.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Dado/N"}),h&&u&&c.jsx("button",{onClick:()=>E(I.id,p.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}):p.type==="attribute"?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:p.value,onChange:x=>v(I.id,p.id,"value",x.target.value),onBlur:()=>S(I.id,p.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u,children:[c.jsx("option",{value:"",children:"Selecione Atributo"}),i.map(x=>c.jsx("option",{value:x,children:x},x))]}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Atributo"}),h&&u&&c.jsx("button",{onClick:()=>E(I.id,p.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}):p.type==="critDice"?c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",placeholder:"1d6",value:p.value,onChange:x=>v(I.id,p.id,"value",x.target.value),onBlur:()=>S(I.id,p.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Dado Crtico"}),h&&u&&c.jsx("button",{onClick:()=>E(I.id,p.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-textSecondary",children:[c.jsx("span",{className:"flex-shrink-0",children:"Crit. "}),c.jsx("input",{type:"number",placeholder:"6",value:p.critValue||"",onChange:x=>v(I.id,p.id,"critValue",x.target.value),onBlur:()=>S(I.id,p.id,"critValue"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsx("span",{className:"flex-shrink-0",children:"Bnus:"}),c.jsxs("select",{value:p.critBonusAttribute||"",onChange:x=>v(I.id,p.id,"critBonusAttribute",x.target.value),onBlur:()=>S(I.id,p.id,"critBonusAttribute"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u,children:[c.jsx("option",{value:"",children:"Nenhum"}),i.map(x=>c.jsx("option",{value:x,children:x},x))]}),c.jsx("span",{className:"flex-shrink-0",children:"x"}),c.jsx("input",{type:"number",placeholder:"1",value:p.critBonusMultiplier||"",onChange:x=>v(I.id,p.id,"critBonusMultiplier",x.target.value),onBlur:()=>S(I.id,p.id,"critBonusMultiplier"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u})]})]}):p.type==="skillRoll"?c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:p.skill,onChange:x=>v(I.id,p.id,"skill",x.target.value),onBlur:()=>S(I.id,p.id,"skill"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u,children:[c.jsx("option",{value:"",children:"Selecione Percia"}),ti.map(x=>c.jsx("option",{value:x.name,children:x.name},x.name))]}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Percia"}),h&&u&&c.jsx("button",{onClick:()=>E(I.id,p.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-textSecondary",children:[c.jsx("span",{className:"flex-shrink-0",children:"Crit. "}),c.jsx("input",{type:"number",placeholder:"19",value:p.critMin||"",onChange:x=>v(I.id,p.id,"critMin",x.target.value),onBlur:()=>S(I.id,p.id,"critMin"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsx("span",{className:"flex-shrink-0",children:"Frmula Crtico:"}),c.jsx("input",{type:"text",placeholder:"Ex: 1d6",value:p.critFormula||"",onChange:x=>v(I.id,p.id,"critFormula",x.target.value),onBlur:()=>S(I.id,p.id,"critFormula"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u})]})]}):null},p.id))}),h&&u&&c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsx("button",{onClick:()=>b(I.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Dado/N"}),c.jsx("button",{onClick:()=>b(I.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Atributo"}),c.jsx("button",{onClick:()=>b(I.id,"critDice"),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md",children:"+ Dado Crtico"}),c.jsx("button",{onClick:()=>b(I.id,"skillRoll"),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md",children:"+ Rolagem de Percia"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Multiplicador:"}),c.jsx("input",{type:"number",value:I.multiplier||"",onChange:p=>w(I.id,"multiplier",p.target.value),onBlur:()=>N(I.id,"multiplier"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-3",placeholder:"1",disabled:!h||!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Descrio da Ao:"}),c.jsx(e1,{placeholder:"Descrio...",value:I.discordText,onChange:p=>w(I.id,"discordText",p.target.value),onBlur:()=>N(I.id,"discordText"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-sm",disabled:!h||!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2 mt-3",children:"Custo da Ao:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",placeholder:"Custo",value:I.costValue||"",onChange:p=>w(I.id,"costValue",p.target.value),onBlur:()=>N(I.id,"costValue"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsxs("select",{value:I.costType,onChange:p=>w(I.id,"costType",p.target.value),onBlur:()=>N(I.id,"costType"),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u,children:[c.jsx("option",{value:"",children:"N/A"}),c.jsx("option",{value:"HP",children:"HP"}),c.jsx("option",{value:"MP",children:"MP"})]})]}),h&&c.jsxs("div",{className:"flex gap-4 mt-4",style:{display:u?"flex":"none"},children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`recover-hp-${I.id}`,checked:I.recoverHP||!1,onChange:p=>N(I.id,"recoverHP",p.target.checked),className:"form-checkbox text-green-500 rounded-sm",disabled:!h}),c.jsx("label",{htmlFor:`recover-hp-${I.id}`,className:"ml-2 text-sm text-textSecondary",children:"Recuperar HP"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`recover-mp-${I.id}`,checked:I.recoverMP||!1,onChange:p=>N(I.id,"recoverMP",p.target.checked),className:"form-checkbox text-blue-500 rounded-sm",disabled:!h}),c.jsx("label",{htmlFor:`recover-mp-${I.id}`,className:"ml-2 text-sm text-textSecondary",children:"Recuperar MP"})]})]})]})]}),h&&u&&c.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>k(I.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Ao",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},I.id))}),h&&u&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:C,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"+ Adicionar Ao Rpida"})})]})})})},n1=({character:t,isMaster:e,onUpdate:n,allAttributes:r,isCollapsed:s,toggleSection:i,isEditMode:o})=>{const{user:l}=Fe();if(!t||!l)return c.jsx("div",{className:"p-6 text-center text-textSecondary",children:"A carregar buffs..."});const u=l.uid===t.ownerUid||e,[d,h]=V.useState(t.buffs||[]);V.useEffect(()=>{h(t.buffs||[])},[t.buffs]);const g=()=>{const P={id:crypto.randomUUID(),name:"Novo Buff",effects:[],isActive:!1,isCollapsed:!1,costValue:0,costType:""};n("buffs",[...d,P])},y=P=>n("buffs",(t.buffs||[]).filter(I=>I.id!==P)),C=P=>n("buffs",(t.buffs||[]).map(I=>I.id===P?{...I,isActive:!I.isActive}:I)),k=P=>n("buffs",(t.buffs||[]).map(I=>I.id===P?{...I,isCollapsed:!I.isCollapsed}:I)),w=(P,I,_)=>{h(p=>p.map(x=>x.id===P?{...x,[I]:_}:x))},N=V.useCallback((P,I)=>{const _=d.find(x=>x.id===P),p=(t.buffs||[]).find(x=>x.id===P);if(_&&p&&_[I]!==p[I]){const x=I==="costValue"?parseInt(_[I],10)||0:_[I];n("buffs",(t.buffs||[]).map(A=>A.id===P?{...A,[I]:x}:A))}},[d,t.buffs,n]),b=(P,I)=>{const _={id:crypto.randomUUID(),type:I,target:"",value:I==="attribute"?0:"1d6"};n("buffs",(t.buffs||[]).map(p=>p.id===P?{...p,effects:[...p.effects||[],_]}:p))},E=(P,I)=>{n("buffs",(t.buffs||[]).map(_=>_.id===P?{..._,effects:(_.effects||[]).filter(p=>p.id!==I)}:_))},v=(P,I,_,p)=>{h(x=>x.map(A=>A.id===P?{...A,effects:A.effects.map(D=>{if(D.id===I){const j={...D,[_]:p};return _==="type"&&(j.target="",j.value=p==="attribute"?0:"1d6"),j}return D})}:A))},S=V.useCallback((P,I,_)=>{const p=d.find(j=>j.id===P),x=p==null?void 0:p.effects.find(j=>j.id===I),A=(t.buffs||[]).find(j=>j.id===P),D=A==null?void 0:A.effects.find(j=>j.id===I);x&&D&&x[_]!==D[_]&&n("buffs",(t.buffs||[]).map(j=>j.id===P?{...j,effects:j.effects.map(R=>R.id===I?{...R,[_]:x[_]}:R)}:j))},[d,t.buffs,n]);return c.jsx(Ht,{title:"Buffs",isCollapsed:s,toggleSection:i,children:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(d||[]).map(P=>P.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>k(P.id),children:P.name||"Buff Sem Nome"}),c.jsx("label",{className:"flex items-center cursor-pointer ml-2",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"checkbox",checked:P.isActive,onChange:()=>C(P.id),className:"sr-only",disabled:!u}),c.jsx("div",{className:`block w-12 h-6 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),c.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})]})})]},P.id):c.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>k(P.id),children:P.name||"Buff Sem Nome"}),c.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[c.jsx("label",{className:"flex items-center cursor-pointer",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"checkbox",checked:P.isActive,onChange:()=>C(P.id),className:"sr-only",disabled:!u}),c.jsx("div",{className:`block w-14 h-8 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),c.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})]})}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>k(P.id),children:"Recolher "})]})]}),c.jsxs("div",{className:"mt-3 pt-3 border-t border-bgInput/50 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome do Buff:"}),c.jsx("input",{type:"text",placeholder:"Nome do Buff",value:P.name,onChange:_=>w(P.id,"name",_.target.value),onBlur:()=>N(P.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-4",disabled:!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Custo de Manuteno:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",placeholder:"0",value:P.costValue||"",onChange:_=>w(P.id,"costValue",_.target.value),onBlur:()=>N(P.id,"costValue"),className:"w-20 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),c.jsxs("select",{value:P.costType,onChange:_=>w(P.id,"costType",_.target.value),onBlur:()=>N(P.id,"costType"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u,children:[c.jsx("option",{value:"",children:"N/A"}),c.jsx("option",{value:"HP",children:"HP"}),c.jsx("option",{value:"MP",children:"MP"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Efeitos do Buff:"}),c.jsx("div",{className:"space-y-2",children:(P.effects||[]).map(_=>c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("select",{value:_.type,onChange:p=>v(P.id,_.id,"type",p.target.value),onBlur:()=>S(P.id,_.id,"type"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!u,children:[c.jsx("option",{value:"attribute",children:"Modificar Atributo"}),c.jsx("option",{value:"dice",children:"Adicionar Dado/N"})]}),_.type==="attribute"?c.jsxs("select",{value:_.target,onChange:p=>v(P.id,_.id,"target",p.target.value),onBlur:()=>S(P.id,_.id,"target"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!u,children:[c.jsx("option",{value:"",children:"Selecione Atributo"}),r.map(p=>c.jsx("option",{value:p,children:p},p))]}):c.jsx("div",{className:"p-2 bg-bgPage border-bgElement rounded-md text-textSecondary text-center italic col-span-3 sm:col-span-1",children:"No aplicvel"}),c.jsxs("div",{className:"flex items-center gap-2 col-span-3 sm:col-span-1",children:[c.jsx("input",{type:"text",placeholder:_.type==="attribute"?"Valor (+/-)":"1d6 ou 6",value:_.value||"",onChange:p=>v(P.id,_.id,"value",p.target.value),onBlur:()=>S(P.id,_.id,"value"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center",disabled:!u}),u&&c.jsx("button",{onClick:()=>E(P.id,_.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Efeito",children:c.jsx("span",{role:"img","aria-label":"Remover",children:""})})]})]},_.id))}),u&&o&&c.jsxs("div",{className:"flex gap-2 mt-2",children:[c.jsx("button",{onClick:()=>b(P.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Atributo"}),c.jsx("button",{onClick:()=>b(P.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Dado/N"})]})]})]}),u&&o&&c.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>y(P.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Buff",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]})]},P.id))}),(d||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum buff criado."}),u&&o&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:g,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})})},Qw=({user:t,onSelectCharacter:e,handleCreateClick:n,handleImportClick:r,handleDeleteClick:s,characters:i,isMaster:o,viewingAll:l,onToggleView:u})=>c.jsxs("div",{className:"bg-bgSurface/80 backdrop-blur-sm p-6 rounded-lg shadow-lg border border-bgElement w-full",children:[c.jsx("h2",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2",children:l?"Todas as Fichas":"Meus Personagens"}),c.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[c.jsx("button",{onClick:n,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Criar Novo Personagem"}),c.jsx("button",{onClick:r,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md",children:"Importar Ficha (JSON)"}),o&&c.jsx("button",{onClick:()=>u(!l),className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md",children:l?"Ver Apenas Minhas Fichas":"Ver Todas as Fichas"})]}),i.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(d=>c.jsxs("div",{className:"bg-bgElement p-4 rounded-lg shadow-md flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-1",children:d.name}),c.jsxs("p",{className:"text-sm text-textSecondary",children:["Nvel: ",d.level||"1"]}),o&&l&&c.jsxs("p",{className:"text-xs text-textSecondary mt-2 break-all",children:["Dono: ",d.ownerUid]})]}),c.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[c.jsx("button",{onClick:()=>e(d),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-lg",children:"Ver/Editar"}),t&&(t.uid===d.ownerUid||o)&&c.jsx("button",{onClick:()=>s(d),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-lg",children:"Excluir"})]})]},d.id))}):c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum personagem encontrado."})]}),rv=async(t,e)=>{try{console.log("[DIAGNSTICO FIRESTORE] Adicionando item  coleo:",t,e);const n=Jt(Pe,t,"feed");await Mp(n,{...e,timestamp:Hw()})}catch(n){console.error("Error adding document to feed: ",n)}},r1=(t,e)=>{console.log("[DIAGNSTICO FIRESTORE] Assinando coleo:",t);const n=Jt(Pe,t,"feed"),r=Cu(n,GN("timestamp","desc"));return ps(r,s=>{const i=[];s.forEach(o=>{i.push({id:o.id,...o.data()})}),e(i)},s=>{console.error("Error subscribing to feed:",s)})},Yw=V.createContext(),cc=()=>V.useContext(Yw),s1=({children:t})=>{const{user:e}=Fe(),{GLOBAL_SESSION_PATH:n}=Rs(),[r,s]=V.useState([]),[i,o]=V.useState(!0);V.useEffect(()=>{if(!e){s([]),o(!1);return}o(!0),console.log("[DIAGNSTICO ROLLFEED] Assinando feed global:",n);const h=r1(n,g=>{s(g),o(!1),console.log("[DIAGNSTICO ROLLFEED] Feed atualizado. Total de itens:",g.length)});return()=>h()},[e,n]);const l=V.useCallback(h=>{if(!e){console.warn("[DIAGNSTICO ROLLFEED] Tentativa de adicionar rolagem sem usurio logado.");return}console.log("[DIAGNSTICO ROLLFEED] Adicionando rolagem ao feed global:",n,h),rv(n,{...h,type:"roll"})},[e,n]),u=V.useCallback(h=>{if(!e){console.warn("[DIAGNSTICO ROLLFEED] Tentativa de adicionar mensagem sem usurio logado.");return}console.log("[DIAGNSTICO ROLLFEED] Adicionando mensagem ao feed global:",n,h),rv(n,{...h,type:"message"})},[e,n]),d={feedItems:r,isLoading:i,addRollToFeed:l,addMessageToFeed:u};return c.jsx(Yw.Provider,{value:d,children:t})},Xw=async(t,e,n=!1)=>{if(!e||!t)return[];try{let r=[];if(n){const s=Jt(Pe,`${t}/users`),i=await Ul(s);for(const o of i.docs){const l=Jt(Pe,`${t}/users/${o.id}/characterSheets`),u=Cu(l);(await Ul(u)).forEach(h=>{r.push({id:h.id,ownerUid:o.id,...h.data()})})}}else{const s=Jt(Pe,`${t}/users/${e}/characterSheets`),i=Cu(s);(await Ul(i)).forEach(l=>{r.push({id:l.id,ownerUid:e,...l.data()})})}return r}catch(r){return console.error("Erro ao buscar personagens:",r),[]}},Jw=async(t,e)=>{if(!e||!t)return null;const n=prompt("Qual o nome do novo personagem?");if(!n)return null;try{const r=Jt(Pe,`${t}/users/${e}/characterSheets`),s={name:n,ownerUid:e,createdAt:Hw(),level:1,mainAttributes:{hp:{current:100,max:100,temp:0},mp:{current:50,max:50}}};return{id:(await Mp(r,s)).id,...s}}catch(r){return console.error("Erro ao criar novo personagem:",r),null}},Zw=async(t,e,n)=>{if(!e||!n||!t)return!1;try{const r=$t(Pe,`${t}/users/${e}/characterSheets/${n}`);return await Bw(r),console.log("Ficha deletada com sucesso!"),!0}catch(r){return console.error("Erro ao deletar personagem:",r),!1}},Fp="1:727724875985:web:97411448885c68c289e5f0",yd=async t=>{if(!t)return[];try{const e=Jt(Pe,"themes"),n=Cu(e,qN("ownerUid","==",t)),r=await Ul(n),s=[];return r.forEach(i=>{s.push({id:i.id,...i.data()})}),s}catch(e){return console.error("Erro ao buscar temas:",e),[]}},i1=async t=>{if(!t)return null;try{const e=$t(Pe,"themes",t),n=await zw(e);return n.exists()?{id:n.id,...n.data()}:null}catch(e){return console.error("Erro ao buscar tema por ID:",e),null}},sv=async t=>{try{if(t.id){const e=$t(Pe,"themes",t.id);return await Ps(e,t,{merge:!0}),t.id}else{const e=Jt(Pe,"themes");return(await Mp(e,t)).id}}catch(e){return console.error("Erro ao salvar tema:",e),null}},o1=async t=>{if(!t)return!1;try{const e=$t(Pe,"themes",t);return await Bw(e),!0}catch(e){return console.error("Erro ao deletar tema:",e),!1}},a1=async t=>{if(!t)return null;try{const e=$t(Pe,"storycraft-v2",Fp,"userSettings",t),n=await zw(e);return n.exists()?{id:n.id,...n.data()}:null}catch(e){return console.error("Erro ao buscar configuraes de usurio:",e),null}},l1=async(t,e)=>{if(!t||!e)return!1;try{const n=$t(Pe,"storycraft-v2",Fp,"userSettings",t);return await Ps(n,e,{merge:!0}),!0}catch(n){return console.error("Erro ao salvar configuraes de usurio:",n),!1}},u1=async(t,e,n,r)=>{if(!(!t||!e))try{const s=$t(Pe,`${r}/${Fp}/users/${t}/characterSheets/${e}`);await Ps(s,{activeThemeId:n},{merge:!0})}catch(s){console.error("Erro ao aplicar tema ao personagem:",s)}};function c1(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var eE=c1,d1=typeof Wa=="object"&&Wa&&Wa.Object===Object&&Wa,h1=d1,f1=h1,p1=typeof self=="object"&&self&&self.Object===Object&&self,m1=f1||p1||Function("return this")(),tE=m1,g1=tE,y1=function(){return g1.Date.now()},v1=y1,_1=/\s/;function x1(t){for(var e=t.length;e--&&_1.test(t.charAt(e)););return e}var w1=x1,E1=w1,b1=/^\s+/;function S1(t){return t&&t.slice(0,E1(t)+1).replace(b1,"")}var T1=S1,I1=tE,C1=I1.Symbol,nE=C1,iv=nE,rE=Object.prototype,A1=rE.hasOwnProperty,P1=rE.toString,uo=iv?iv.toStringTag:void 0;function R1(t){var e=A1.call(t,uo),n=t[uo];try{t[uo]=void 0;var r=!0}catch{}var s=P1.call(t);return r&&(e?t[uo]=n:delete t[uo]),s}var N1=R1,k1=Object.prototype,D1=k1.toString;function j1(t){return D1.call(t)}var O1=j1,ov=nE,V1=N1,M1=O1,L1="[object Null]",F1="[object Undefined]",av=ov?ov.toStringTag:void 0;function U1(t){return t==null?t===void 0?F1:L1:av&&av in Object(t)?V1(t):M1(t)}var z1=U1;function B1(t){return t!=null&&typeof t=="object"}var $1=B1,H1=z1,W1=$1,q1="[object Symbol]";function G1(t){return typeof t=="symbol"||W1(t)&&H1(t)==q1}var K1=G1,Q1=T1,lv=eE,Y1=K1,uv=NaN,X1=/^[-+]0x[0-9a-f]+$/i,J1=/^0b[01]+$/i,Z1=/^0o[0-7]+$/i,ek=parseInt;function tk(t){if(typeof t=="number")return t;if(Y1(t))return uv;if(lv(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=lv(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Q1(t);var n=J1.test(t);return n||Z1.test(t)?ek(t.slice(2),n?2:8):X1.test(t)?uv:+t}var nk=tk,rk=eE,vd=v1,cv=nk,sk="Expected a function",ik=Math.max,ok=Math.min;function ak(t,e,n){var r,s,i,o,l,u,d=0,h=!1,g=!1,y=!0;if(typeof t!="function")throw new TypeError(sk);e=cv(e)||0,rk(n)&&(h=!!n.leading,g="maxWait"in n,i=g?ik(cv(n.maxWait)||0,e):i,y="trailing"in n?!!n.trailing:y);function C(I){var _=r,p=s;return r=s=void 0,d=I,o=t.apply(p,_),o}function k(I){return d=I,l=setTimeout(b,e),h?C(I):o}function w(I){var _=I-u,p=I-d,x=e-_;return g?ok(x,i-p):x}function N(I){var _=I-u,p=I-d;return u===void 0||_>=e||_<0||g&&p>=i}function b(){var I=vd();if(N(I))return E(I);l=setTimeout(b,w(I))}function E(I){return l=void 0,y&&r?C(I):(r=s=void 0,o)}function v(){l!==void 0&&clearTimeout(l),d=0,r=u=s=l=void 0}function S(){return l===void 0?o:E(vd())}function P(){var I=vd(),_=N(I);if(r=arguments,s=this,u=I,_){if(l===void 0)return k(u);if(g)return clearTimeout(l),l=setTimeout(b,e),C(u)}return l===void 0&&(l=setTimeout(b,e)),o}return P.cancel=v,P.flush=S,P}var lk=ak;const uk=Bh(lk),sE=V.createContext(),ck=()=>V.useContext(sE),dk=({children:t})=>{const{user:e,isMaster:n}=Fe(),{characterDataCollectionRoot:r,GLOBAL_SESSION_PATH:s}=Rs(),[i,o]=V.useState([]),[l,u]=V.useState(()=>{try{const w=localStorage.getItem("selectedCharIds");return w?JSON.parse(w):[]}catch{return[]}}),[d,h]=V.useState(!0);V.useEffect(()=>{if(!e)return;(async()=>{const N=await a1(e.uid);N&&N.selectedCharIds&&u(N.selectedCharIds)})()},[e]),V.useEffect(()=>{if(!e||!r){o([]),h(!1);return}o([]),h(!0);const w=new Map,N=(b,E)=>{let v=!1;if(b.docChanges().forEach(S=>{const P=S.doc.data();let I=P.mainAttributes;if(typeof I=="string")try{I=JSON.parse(I)}catch(p){console.error(`Erro ao parsear mainAttributes para o personagem ${S.doc.id}:`,p)}const _={id:S.doc.id,ownerUid:E,...P,mainAttributes:I};S.type==="added"||S.type==="modified"?(w.set(_.id,_),v=!0):S.type==="removed"&&(w.delete(_.id),v=!0)}),v){const S=Array.from(w.values());o(S)}h(!1)};if(n){let b=[];const E=Jt(Pe,`${r}/users`),v=ps(E,S=>{if(b.forEach(P=>P()),b=[],S.empty){w.clear(),o([]),h(!1);return}S.docs.forEach(P=>{const I=P.id,_=Jt(Pe,`${r}/users/${I}/characterSheets`),p=ps(_,x=>N(x,I),x=>{console.error(`Erro ao ouvir fichas do usurio ${I}:`,x),h(!1)});b.push(p)})},S=>{console.error("Erro ao ouvir coleo de usurios:",S),h(!1)});return()=>{v(),b.forEach(S=>S())}}else{const b=Jt(Pe,`${r}/users/${e.uid}/characterSheets`),E=ps(b,v=>N(v,e.uid),v=>{console.error("Erro ao ouvir as prprias fichas:",v),h(!1)});return()=>E()}},[e,n,r]);const g=V.useRef(uk((w,N,b)=>{localStorage.setItem("selectedCharIds",JSON.stringify(b)),N&&l1(N,{selectedCharIds:b})},1e3)).current;V.useEffect(()=>{e&&g(s,e.uid,l)},[l,e,g]);const y=V.useMemo(()=>i.filter(w=>l.includes(w.id)),[i,l]),C=V.useCallback(w=>{u(N=>N.includes(w)?N.filter(b=>b!==w):[...N,w])},[]),k={allCharacters:i,selectedCharIds:l,partyHealthData:y,isLoading:d,toggleCharacterSelection:C};return c.jsx(sE.Provider,{value:k,children:t})},hk=()=>{const{feedItems:t,isLoading:e}=cc(),[n,r]=V.useState(!0),s=u=>!u||typeof u.toDate!="function"?"":u.toDate().toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),i=u=>c.jsxs("div",{className:"p-3 bg-bgElement rounded-md border border-bgInput mb-2",children:[c.jsxs("div",{className:"flex justify-between items-center text-xs text-textSecondary mb-1",children:[c.jsx("span",{className:"font-bold",children:u.characterName}),c.jsx("span",{children:s(u.timestamp)})]}),u.title&&c.jsx("h4",{className:"font-semibold text-textAccent text-lg mb-1",children:u.title}),c.jsx("p",{className:"text-sm text-textPrimary break-words whitespace-pre-wrap",children:u.description||u.text})]},u.id),o=u=>{const d=u.totalResult,h=u.results.map(g=>g.displayValue).join(" + ");return c.jsxs("div",{className:"p-3 bg-bgElement rounded-md border border-bgInput mb-2",children:[c.jsxs("div",{className:"flex justify-between items-center text-xs text-textSecondary mb-1",children:[c.jsx("span",{children:u.characterName}),c.jsx("span",{children:s(u.timestamp)})]}),c.jsx("p",{className:"font-semibold text-lg text-textPrimary",children:u.rollName}),u.acertoResult&&c.jsxs("div",{className:"mt-2 pt-2 border-t border-bgInput/50",children:[c.jsxs("p",{className:"font-semibold text-textPrimary/90",children:["Acerto:",c.jsx("span",{className:"font-bold text-lg text-textAccent ml-2",children:u.acertoResult.total}),c.jsxs("span",{className:"text-sm text-textSecondary ml-2",children:["(",u.acertoResult.skillName,")"]})]}),c.jsxs("p",{className:"text-sm text-textSecondary mt-1",children:["1d20(",c.jsx("span",{className:u.acertoResult.isCrit?"text-red-400 font-bold":"",children:u.acertoResult.roll}),") + ",u.acertoResult.bonus,u.acertoResult.isCrit&&c.jsx("span",{className:"text-red-400 font-bold ml-2",children:" CRTICO!"})]})]}),(h||!u.acertoResult||u.criticals&&u.criticals.length>0)&&c.jsxs("div",{className:"mt-2 pt-2 border-t border-bgInput/50",children:[c.jsxs("p",{className:"font-semibold text-textPrimary/90",children:[u.acertoResult?"Dano/Resultado:":"Resultado:",c.jsx("span",{className:"font-bold text-3xl text-textAccent ml-2",children:d})]}),h&&c.jsx("p",{className:"text-sm text-textSecondary break-words mt-2",children:h}),u.criticals&&u.criticals.length>0&&c.jsx("p",{className:"text-sm text-red-400 font-semibold whitespace-pre-wrap mt-1",children:u.criticals.filter(g=>!g.startsWith("Acerto Crtico")).join(`
`)})]}),u.discordText&&c.jsxs("p",{className:"text-xs italic text-textSecondary mt-2",children:['"',u.discordText,'"']})]},u.id)},l=u=>{switch(u.type){case"roll":return o(u);case"message":return i(u);default:return null}};return n?c.jsx("div",{className:"fixed bottom-4 left-4 bg-btnHighlightBg text-btnHighlightText p-3 rounded-full shadow-lg cursor-pointer hover:opacity-90 z-50",onClick:()=>r(!1),children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}):c.jsxs("div",{className:"fixed bottom-4 left-4 w-full max-w-sm h-[60vh] bg-bgSurface/90 backdrop-blur-md rounded-lg shadow-2xl border border-bgElement flex flex-col z-50",children:[c.jsxs("div",{className:"flex justify-between items-center p-3 bg-bgElement cursor-pointer",onClick:()=>r(!0),children:[c.jsx("h3",{className:"font-bold text-textAccent",children:"Feed de Rolagens"}),c.jsx("button",{className:"text-textSecondary hover:text-textPrimary",children:""})]}),c.jsxs("div",{className:"flex-grow p-3 overflow-y-auto",children:[e&&c.jsx("p",{className:"text-textSecondary italic",children:"Carregando feed..."}),!e&&t.length===0&&c.jsx("p",{className:"text-textSecondary italic",children:"Nenhuma rolagem ou mensagem ainda..."}),t.map(l)]}),c.jsx(_k,{})]})},fk=({message:t,onConfirm:e,onCancel:n,type:r,showCopyButton:s,copyText:i})=>{const[o,l]=V.useState(""),u=()=>{navigator.clipboard.writeText(i).then(()=>{l("Copiado!"),setTimeout(()=>l(""),2e3)},()=>{l("Falhou em copiar.")})},d=r==="confirm"?"Confirmar":"OK",h=r==="confirm"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700";return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-lg text-textPrimary mb-4 text-center whitespace-pre-wrap",children:t}),s&&c.jsxs("div",{className:"my-4 p-2 bg-bgElement rounded-md text-center",children:[c.jsx("p",{className:"text-textSecondary text-sm mb-1",children:"Comando para Discord/Roll20:"}),c.jsx("code",{className:"text-textAccent break-words",children:i}),c.jsx("button",{onClick:u,className:"ml-4 px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-xs font-bold rounded-md",children:o||"Copiar"})]}),c.jsxs("div",{className:"flex justify-around gap-4 mt-4",children:[c.jsx("button",{onClick:e,className:`px-5 py-2 rounded-lg font-bold shadow-md text-white ${h}`,children:d}),r!=="info"&&c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},pk=({title:t,onConfirm:e,onClose:n,type:r})=>{const[s,i]=V.useState(""),[o,l]=V.useState("HP"),u=()=>{const h=parseInt(s,10);!isNaN(h)&&h>0?e(h,o):console.error("Valor invlido.")},d=h=>{h.key==="Enter"&&u()};return c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center",children:t}),c.jsx("input",{type:"number",value:s,onChange:h=>i(h.target.value),onKeyDown:d,className:"w-full p-2 mb-4 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg focus:ring-btnHighlightBg focus:border-btnHighlightBg",placeholder:"Valor",autoFocus:!0}),c.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"HP",checked:o==="HP",onChange:()=>l("HP"),className:"form-radio text-btnHighlightBg"})," HP"]}),r==="heal"&&c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"HP Bonus",checked:o==="HP Bonus",onChange:()=>l("HP Bonus"),className:"form-radio text-btnHighlightBg"})," HP Bonus"]}),c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"MP",checked:o==="MP",onChange:()=>l("MP"),className:"form-radio text-btnHighlightBg"})," MP"]})]}),c.jsxs("div",{className:"flex justify-around gap-4",children:[c.jsx("button",{onClick:u,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Confirmar"}),c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},mk=({attributeName:t,onConfirm:e,onClose:n})=>{const[r,s]=V.useState("1d20"),[i,o]=V.useState(""),l=()=>e(r,parseInt(i,10)||0),u=d=>{d.key==="Enter"&&l()};return c.jsxs(c.Fragment,{children:[c.jsxs("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center",children:["Rolar ",t]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{htmlFor:"dice-input",className:"block text-sm font-medium text-textSecondary mb-1",children:"Dado:"}),c.jsx("input",{id:"dice-input",type:"text",value:r,onChange:d=>s(d.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"Ex: 1d20, 2d6",autoFocus:!0})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{htmlFor:"bonus-input",className:"block text-sm font-medium text-textSecondary mb-1",children:"Bnus Adicional:"}),c.jsx("input",{id:"bonus-input",type:"number",value:i,onChange:d=>o(d.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"0"})]}),c.jsxs("div",{className:"flex justify-around gap-4",children:[c.jsx("button",{onClick:l,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Confirmar"}),c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},gk=({attributeName:t,onConfirm:e,onClose:n})=>{const[r,s]=V.useState(""),[i,o]=V.useState("damage"),[l,u]=V.useState(!1),d=()=>{const y=parseInt(r,10);!isNaN(y)&&y>0&&(e(y,t,i,l),n())},h=y=>{y.key==="Enter"&&d()},g=i==="heal"?`Curar ${t}`:`Causar Dano em ${t}`;return c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-4 text-center",children:g}),c.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[c.jsx("button",{onClick:()=>o("damage"),className:`px-4 py-2 rounded-lg font-semibold ${i==="damage"?"bg-red-600 text-white":"bg-bgElement text-textSecondary"}`,children:" Dano"}),c.jsx("button",{onClick:()=>o("heal"),className:`px-4 py-2 rounded-lg font-semibold ${i==="heal"?"bg-green-600 text-white":"bg-bgElement text-textSecondary"}`,children:" Cura"})]}),c.jsx("input",{type:"number",value:r,onChange:y=>s(y.target.value),onKeyDown:h,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-2xl mb-4",placeholder:"Valor",autoFocus:!0}),i==="damage"&&t==="HP"&&c.jsxs("div",{className:"flex items-center justify-center mb-4",children:[c.jsx("input",{type:"checkbox",id:"directDamage",checked:l,onChange:y=>u(y.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),c.jsx("label",{htmlFor:"directDamage",className:"ml-2 block text-sm text-textSecondary",children:"Dano Direto (ignora HP Bnus)"})]}),c.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[c.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg",children:"Cancelar"}),c.jsx("button",{onClick:d,className:"px-4 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",disabled:!r,children:"Confirmar"})]})]})},dc=({modalState:t,closeModal:e})=>{if(!t.type)return null;const n=()=>{const{type:r,props:s}=t;switch(r){case"info":case"confirm":return c.jsx(fk,{...s});case"action":return c.jsx(pk,{...s});case"rollAttribute":return c.jsx(mk,{...s});case"damageHeal":return c.jsx(gk,{...s});default:return null}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",onClick:e,children:c.jsx("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-sm border border-bgElement",onClick:r=>r.stopPropagation(),children:n()})})},_d={name:"Novo Tema",ownerUid:"",isPublic:!1,styles:{backgroundImage:"url('')",fontFamily:"'Roboto', sans-serif",surfaceOpacity:80,colors:{bgPage:"#111827",bgSurface:"#1f2937",bgElement:"#374151",bgInput:"#4b5563",textPrimary:"#f9fafb",textSecondary:"#9ca3af",borderAccent:"#f59e0b",textAccent:"#fcd34d",btnHighlightBg:"#8b5cf6",btnHighlightText:"#ffffff"}}},yk=["'Roboto', sans-serif","'Merriweather', serif","'Lato', sans-serif","'Noto Sans', sans-serif","'Slabo 27px', serif"],vk=({character:t,setPreviewTheme:e,onClose:n})=>{const{user:r}=Fe(),{characterDataCollectionRoot:s}=Rs(),[i,o]=V.useState([]),[l,u]=V.useState(_d),[d,h]=V.useState({type:null,props:{}}),g=()=>h({type:null,props:{}});V.useEffect(()=>{r&&(yd(r.uid).then(o),u(v=>({..._d,ownerUid:r.uid})))},[r]),V.useEffect(()=>{e(l)},[l,e]);const y=v=>{if(v==="new")u({..._d,ownerUid:r.uid});else{const S=i.find(P=>P.id===v);S&&u(S)}},C=(v,S)=>u(P=>({...P,styles:{...P.styles,[v]:S}})),k=(v,S)=>u(P=>({...P,styles:{...P.styles,colors:{...P.styles.colors,[v]:S}}})),w=v=>u(S=>({...S,name:v.target.value})),N=async()=>{const v={...l,ownerUid:r.uid};try{const S=await sv(v);if(S){h({type:"info",props:{message:"Tema salvo com sucesso!",onConfirm:g}});const P=await yd(r.uid);o(P);const I=P.find(_=>_.id===(v.id||S));I&&u(I)}else throw new Error("Ocorreu um erro desconhecido ao salvar.")}catch(S){console.error("Falha ao salvar o tema:",S),h({type:"info",props:{message:"Falha ao salvar o tema.",onConfirm:g}})}},b=()=>{if(!l.id){h({type:"info",props:{message:"No pode apagar um tema que ainda no foi salvo.",onConfirm:g}});return}h({type:"confirm",props:{message:`Tem a certeza que quer apagar o tema "${l.name}"?`,onConfirm:async()=>{await o1(l.id),g(),yd(r.uid).then(o),y("new")},onCancel:g}})},E=async()=>{if(!t||!l.id){h({type:"info",props:{message:"Precisa ter uma ficha selecionada e um tema salvo para aplicar.",onConfirm:g}});return}await sv(l),await u1(t.ownerUid,t.id,l.id,s),h({type:"info",props:{message:`Tema "${l.name}" aplicado!`,onConfirm:()=>{g(),n()}}})};return c.jsxs(c.Fragment,{children:[c.jsx(dc,{modalState:d,closeModal:g}),c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-3xl border border-bgElement max-h-[90vh] flex flex-col",children:[c.jsx("h2",{className:"text-2xl font-bold text-textAccent mb-4",children:"Editor de Temas"}),c.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Tema a Editar"}),c.jsxs("select",{onChange:v=>y(v.target.value),value:l.id||"new",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",children:[c.jsx("option",{value:"new",children:"-- Criar Novo Tema --"}),i.map(v=>c.jsx("option",{value:v.id,children:v.name},v.id))]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Nome do Tema"}),c.jsx("input",{type:"text",value:l.name,onChange:w,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"URL da Imagem de Fundo"}),c.jsx("input",{type:"text",value:l.styles.backgroundImage.replace(/url\(['"]?(.*?)['"]?\)/,"$1"),onChange:v=>C("backgroundImage",`url('${v.target.value}')`),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Fonte Principal"}),c.jsx("select",{value:l.styles.fontFamily,onChange:v=>C("fontFamily",v.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",children:yk.map(v=>c.jsx("option",{value:v,children:v.split(",")[0].replace(/'/g,"")},v))})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:["Transparncia dos Mdulos (",l.styles.surfaceOpacity||80,"%)"]}),c.jsx("input",{type:"range",min:"10",max:"100",step:"5",value:l.styles.surfaceOpacity||80,onChange:v=>C("surfaceOpacity",parseInt(v.target.value)),className:"w-full h-2 bg-bgElement rounded-lg appearance-none cursor-pointer mt-2"})]})]}),c.jsx("h3",{className:"text-lg font-semibold text-textAccent mt-6 mb-2",children:"Cores"}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Object.entries(l.styles.colors).map(([v,S])=>c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary capitalize",children:v.replace(/([A-Z])/g," $1")}),c.jsxs("div",{className:"flex items-center gap-2 p-1 bg-bgInput border border-bgElement rounded-md",children:[c.jsx("input",{type:"color",value:S,onChange:P=>k(v,P.target.value),className:"w-8 h-8 rounded border-none bg-transparent cursor-pointer"}),c.jsx("input",{type:"text",value:S,onChange:P=>k(v,P.target.value),className:"w-full bg-transparent text-textPrimary text-sm"})]})]},v))})]}),c.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-6 pt-4 border-t border-bgElement",children:[c.jsxs("div",{children:[c.jsx("button",{onClick:N,className:"px-4 py-2 bg-green-600 text-white font-bold rounded-lg mr-2",children:"Salvar"}),c.jsx("button",{onClick:b,className:"px-4 py-2 bg-red-600 text-white font-bold rounded-lg",children:"Apagar"})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:E,disabled:!t||!l.id,className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg disabled:opacity-50",children:"Aplicar"}),c.jsx("button",{onClick:n,className:"px-4 py-2 bg-textSecondary/50 text-textPrimary font-bold rounded-lg",children:"Fechar"})]})]})]})})]})},_k=()=>{const[t,e]=V.useState(""),{addMessageToFeed:n}=cc(),{user:r}=Fe(),{character:s}=Gw(),i=o=>{o.preventDefault(),t.trim()!==""&&(n({characterName:(s==null?void 0:s.name)||r.displayName||"Usurio",text:t,ownerUid:r.uid}),e(""))};return c.jsx("form",{onSubmit:i,className:"p-3 border-t border-bgElement",children:c.jsxs("div",{className:"flex items-center bg-bgInput rounded-md",children:[c.jsx("input",{type:"text",value:t,onChange:o=>e(o.target.value),placeholder:"Digite uma mensagem...",className:"w-full bg-transparent p-2 text-textPrimary placeholder-textSecondary focus:outline-none"}),c.jsx("button",{type:"submit",className:"p-2 text-textAccent hover:opacity-80 disabled:opacity-50",disabled:!t.trim(),children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",clipRule:"evenodd"})})})]})})},iE=({onCharacterClick:t})=>{const{isMaster:e}=Fe(),{allCharacters:n,selectedCharIds:r,partyHealthData:s,toggleCharacterSelection:i}=ck(),[o,l]=V.useState(!1),[u,d]=V.useState(!1),h=y=>{t&&t(y)},g=y=>{var w,N;const C=((w=y.mainAttributes)==null?void 0:w.hp)||{current:"?",max:"?",temp:0},k=((N=y.mainAttributes)==null?void 0:N.mp)||{current:"?",max:"?"};return c.jsxs("div",{className:"p-2 bg-bgElement rounded-md border border-bgInput cursor-pointer hover:border-btnHighlightBg",onClick:()=>h(y),title:`Clique para ir para a ficha de ${y.name}`,children:[c.jsx("p",{className:"font-bold text-textPrimary truncate",children:y.name}),c.jsxs("div",{className:"text-sm flex justify-between",children:[c.jsxs("span",{className:"text-red-400",children:["HP: ",C.current,"/",C.max," ",C.temp>0?`(+${C.temp})`:""]}),c.jsxs("span",{className:"text-blue-400",children:["MP: ",k.current,"/",k.max]})]})]},y.id)};return o?c.jsx("div",{className:"fixed top-4 left-4 bg-btnHighlightBg text-btnHighlightText p-3 rounded-full shadow-lg cursor-pointer hover:opacity-90 z-50",onClick:()=>l(!1),title:"Expandir Monitor de Grupo",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-5M3 4h5V9"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 16l-4-4M3 8l4 4"})]})}):c.jsxs("div",{className:"fixed top-4 left-4 w-full max-w-xs bg-bgSurface/90 backdrop-blur-md rounded-lg shadow-2xl border border-bgElement flex flex-col z-50",children:[c.jsxs("div",{className:"flex justify-between items-center p-3 bg-bgElement cursor-pointer",onClick:()=>l(!0),children:[c.jsx("h3",{className:"font-bold text-textAccent",children:"Monitor de Grupo"}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{className:"text-textSecondary hover:text-textPrimary mr-2",onClick:y=>{y.stopPropagation(),d(!u)},title:"Selecionar Personagens",children:""}),c.jsx("button",{className:"text-textSecondary hover:text-textPrimary",title:"Recolher",children:""})]})]}),u&&c.jsxs("div",{className:"p-3 border-b border-bgElement max-h-48 overflow-y-auto",children:[c.jsx("h4",{className:"text-sm font-semibold text-textSecondary mb-2",children:"Selecionar Personagens"}),n.length>0?n.map(y=>c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`char-select-${y.id}`,checked:r.includes(y.id),onChange:()=>i(y.id),className:"form-checkbox h-4 w-4 text-btnHighlightBg bg-bgInput border-bgElement rounded"}),c.jsx("label",{htmlFor:`char-select-${y.id}`,className:"ml-2 text-textPrimary text-sm truncate",children:y.name})]},y.id)):c.jsx("p",{className:"text-xs text-textSecondary italic",children:"Nenhuma ficha encontrada."})]}),c.jsx("div",{className:"flex-grow p-3 overflow-y-auto space-y-2 max-h-[60vh]",children:s.length>0?s.map(g):c.jsx("p",{className:"text-textSecondary italic text-sm text-center py-4",children:"Nenhum personagem selecionado. Clique na engrenagem  para selecionar."})})]})},xk=[2,3,4,6,8,10,12,20,50,100],wk=({character:t})=>{const[e,n]=V.useState(!1),{addRollToFeed:r}=cc(),s=V.useCallback(async(o,l)=>{const u=`${o}
${l}`;if(t&&t.discordWebhookUrl){try{await fetch(t.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[{title:o,description:l.replace(/\*/g,""),color:7506394}]})})}catch(d){return console.error("Failed to send to Discord:",d),null}return u}else return alert(`Webhook do Discord no configurado. Copie o comando:

${u}`),null},[t,r]),i=async o=>{const l=Math.floor(Math.random()*o)+1;n(!1);const u=await s(`Rolagem de d${o}`,`**Resultado: ${l}**`);r({characterName:(t==null?void 0:t.name)||"Narrador",rollName:`Rolagem Rpida de d${o}`,results:[{value:l,displayValue:`d${o} (${l})`}],discordText:u})};return c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>n(!e),title:"Rolagem Rpida",className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600",children:""}),e&&c.jsx("div",{className:"absolute bottom-12 right-0 bg-gray-900 bg-opacity-90 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700 w-40",children:c.jsx("div",{className:"grid grid-cols-2 gap-2",children:xk.map(o=>c.jsxs("button",{onClick:()=>i(o),className:"bg-gray-700 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:["d",o]},o))})})]})},Ek=({href:t,title:e,children:n})=>c.jsx("a",{href:t,title:e,className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600",children:n}),bk=({character:t})=>{const e=[{href:"#info",title:"Informaes",icon:""},{href:"#main-attributes",title:"Atributos Principais",icon:""},{href:"#actions",title:"Aes",icon:""},{href:"#buffs",title:"Buffs",icon:""},{href:"#wallet",title:"Carteira",icon:""},{href:"#inventory",title:"Inventrio",icon:""},{href:"#equipped",title:"Equipados",icon:""},{href:"#perks",title:"Vantagens",icon:""},{href:"#skills",title:"Habilidades",icon:""},{href:"#specializations",title:"Especializaes",icon:""},{href:"#story",title:"Histria",icon:""},{href:"#notes",title:"Anotaes",icon:""},{href:"#discord",title:"Discord",icon:""}];return c.jsx("div",{className:"fixed bottom-4 right-4 z-40 bg-gray-900 bg-opacity-80 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700",children:c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.map(n=>c.jsx(Ek,{href:n.href,title:n.title,children:n.icon},n.href)),c.jsx(wk,{character:t})]})})},Sk=({initialValue:t,onConfirm:e,onCancel:n})=>{const[r,s]=V.useState(t),i=()=>{e(r)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50",children:c.jsxs("div",{className:"bg-bgSurface p-6 rounded-lg shadow-xl w-full max-w-md",children:[c.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-4",children:"URL da Imagem do Personagem"}),c.jsx("p",{className:"text-textSecondary mb-4",children:"Cole a nova URL da imagem abaixo:"}),c.jsx("input",{type:"text",value:r,onChange:o=>s(o.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary focus:ring-btnHighlightBg focus:border-btnHighlightBg",placeholder:"https://exemplo.com/imagem.png",autoFocus:!0}),c.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[c.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg",children:"Cancelar"}),c.jsx("button",{onClick:i,className:"px-4 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Confirmar"})]})]})})},Tk=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=Fe(),l=o&&(o.uid===t.ownerUid||n),[u,d]=V.useState(!1),[h,g]=V.useState({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""});V.useEffect(()=>{g({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""})},[t]);const y=S=>(S=parseInt(S,10),isNaN(S)||S<1?{scale:"N/A",category:"Desconhecida"}:S>=1&&S<=10?{scale:0,category:"Comum"}:S>=11&&S<=20?{scale:1,category:"Lendrio I"}:S>=21&&S<=30?{scale:2,category:"Lendrio II"}:S>=31&&S<=40?{scale:3,category:"Lendrio III"}:S>=41&&S<=45?{scale:4,category:"Colossal I"}:S>=46&&S<=50?{scale:5,category:"Colossal II"}:S>=51&&S<=55?{scale:6,category:"Colossal III"}:S>=56&&S<=59?{scale:7,category:"Titnico"}:S===60?{scale:8,category:"Divino"}:{scale:"N/A",category:"Alm do Divino"}),{scale:C,category:k}=V.useMemo(()=>y(t.level),[t.level]),w=S=>{const{name:P,value:I}=S.target;g(_=>({..._,[P]:I}))},N=V.useCallback(S=>{const P=h[S],I=t[S],p=["age","level","xp"].includes(S)?parseInt(P,10)||0:P;p!==I&&e(S,p)},[h,t,e]),b=()=>{l&&i&&d(!0)},E=S=>{S!==null&&S!==t.photoUrl&&e("photoUrl",S),d(!1)},v=["name","age","height","gender","race","class","alignment","level","xp"];return c.jsxs(Ht,{title:"Informaes do Personagem",isCollapsed:r,toggleSection:s,children:[u&&c.jsx(Sk,{initialValue:t.photoUrl||"",onConfirm:E,onCancel:()=>d(!1)}),c.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[c.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center",children:[c.jsx("div",{className:`rounded-full border-2 border-btnHighlightBg ${l&&i?"cursor-pointer":""}`,onClick:b,children:t.photoUrl?c.jsx("img",{src:t.photoUrl,alt:"Foto",className:"w-48 h-48 object-cover rounded-full",onError:S=>{S.target.onerror=null,S.target.src="https://placehold.co/192x192/1f2937/FFFFFF?text=Erro"}}):c.jsx("div",{className:"w-48 h-48 bg-bgElement rounded-full flex items-center justify-center text-6xl text-textSecondary",children:"+"})}),c.jsxs("div",{className:"text-center mt-2",children:[c.jsx("p",{className:"text-sm font-medium text-textSecondary",children:"Escala de Poder:"}),c.jsx("p",{className:"text-lg font-bold text-textPrimary",children:k})]})]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 flex-grow w-full",children:v.map(S=>c.jsxs("div",{children:[c.jsxs("label",{htmlFor:S,className:"block text-sm font-medium text-textSecondary mb-1 capitalize",children:[S,":"]}),c.jsx("input",{type:["age","level","xp"].includes(S)?"number":"text",id:S,name:S,value:h[S],onChange:w,onBlur:()=>N(S),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary focus:ring-btnHighlightBg focus:border-btnHighlightBg",disabled:!l||!i&&["race","class","alignment"].includes(S)})]},S))})]})]})},Ik=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,buffModifiers:i,isEditMode:o,onAttributeRoll:l})=>{var v,S,P,I,_;const{user:u}=Fe();u&&(u.uid,t.ownerUid);const d=u&&(u.uid===t.ownerUid||n),[h,g]=V.useState(t.mainAttributes||{hp:{},mp:{}});V.useEffect(()=>{g(t.mainAttributes||{hp:{},mp:{}})},[t.mainAttributes]);const y=(p,x)=>(parseInt(p,10)||0)+(i&&i[x]||0),C=V.useMemo(()=>y(h==null?void 0:h.destreza,"Destreza"),[h==null?void 0:h.destreza,i]),k=V.useMemo(()=>y(h==null?void 0:h.constituicao,"Constituio"),[h==null?void 0:h.constituicao,i]),w=V.useMemo(()=>y(h==null?void 0:h.sabedoria,"Sabedoria"),[h==null?void 0:h.sabedoria,i]),N=V.useMemo(()=>({FOR:y(h==null?void 0:h.forca,"Fora"),DES:C,CON:k,INT:y(h==null?void 0:h.inteligencia,"Inteligencia"),SAB:w,CAR:y(h==null?void 0:h.carisma,"Carisma")}),[h,C,k,w,i]);parseInt(h==null?void 0:h.fd,10);const b=(p,x)=>{const{name:A,value:D}=p.target,j=D===""?"":parseInt(D,10);g(R=>x==="fd"?{...R,fd:j}:x?{...R,[x]:{...R[x]||{},[A]:j}}:{...R,[A]:j})},E=V.useCallback((p,x)=>{var D;if(!t)return;const A=t.mainAttributes||{};if(x){const j=(D=h==null?void 0:h[x])==null?void 0:D[p],R=A[x]||{},q=R[p],ne=parseInt(j,10)||0;if(ne!==(q||0)){const ae={...R,[p]:ne},re={...A,[x]:ae};e("mainAttributes",re)}}else{const j=h==null?void 0:h[p],R=A[p],q=parseInt(j,10)||0;if(q!==(R||0)){const ne={...A,[p]:q};e("mainAttributes",ne)}}},[h,t,e]);return c.jsx(Ht,{title:"Atributos",isCollapsed:r,toggleSection:s,children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase",children:"HP"}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",readOnly:!0,name:"current",value:((v=h.hp)==null?void 0:v.current)??"",className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var p;return l("HP",(p=h.hp)==null?void 0:p.current)},title:"Aplicar Dano/Cura no HP"}),c.jsx("span",{className:"text-textSecondary",children:"/"}),c.jsx("input",{type:"number",name:"max",value:((S=h.hp)==null?void 0:S.max)??"",onChange:p=>b(p,"hp"),onBlur:()=>E("max","hp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),c.jsx("span",{className:"text-blue-400 font-bold text-xl ml-1",children:"+"}),c.jsx("input",{type:"number",readOnly:!0,title:"HP Temporrio",name:"temp",value:((P=h.hp)==null?void 0:P.temp)??"",className:"w-16 p-2 text-center bg-bgInput border border-blue-400 rounded-md text-blue-300 text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var p;return l("HP Bonus",(p=h.hp)==null?void 0:p.temp)}})]})]}),c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase",children:"MP"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",readOnly:!0,name:"current",value:((I=h.mp)==null?void 0:I.current)??"",className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var p;return l("MP",(p=h.mp)==null?void 0:p.current)},title:"Aplicar Dano/Cura no MP"}),c.jsx("span",{className:"text-textSecondary",children:"/"}),c.jsx("input",{type:"number",name:"max",value:((_=h.mp)==null?void 0:_.max)??"",onChange:p=>b(p,"mp"),onBlur:()=>E("max","mp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n})]})]})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:["Fora","Destreza","Constituio","Inteligencia","Sabedoria","Carisma"].map(p=>{const x=p.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),A=(h==null?void 0:h[x])??"",D=y(A,p);return c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(p,D),title:`Clique para rolar ${p} (Valor: ${D})`,children:D}),c.jsx("input",{type:"number",id:p,name:x,value:A,onChange:b,onBlur:()=>E(x),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!d,"aria-label":`${p} Base`}),c.jsx("label",{htmlFor:p,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:p})]},p)})}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 auto-rows-fr",children:[["Iniciativa","FA","FM","MD","Acerto","ME"].map(p=>{const x=p.toLowerCase();let A,D;return p==="Iniciativa"?(A=(h==null?void 0:h[x])??"",D=(parseInt(A,10)||0)+C+(i.Iniciativa||0)):p==="MD"?(A=(h==null?void 0:h.fd)??"",D=(parseInt(A,10)||0)+k+(i.MD||0)):(A=(h==null?void 0:h[x])??"",D=y((h==null?void 0:h[x])||0,p.toUpperCase())),c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(p,D),title:`Clique para rolar ${p} (Valor: ${D})`,children:D}),c.jsx("input",{type:"number",id:p,name:x,value:A,onChange:j=>b(j,p==="MD"?"fd":void 0),onBlur:()=>E(p==="MD"?"fd":x),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!d,"aria-label":`${p} Base`}),c.jsx("label",{htmlFor:p,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:p})]},p)}),[{key:"Fortitude",defaultAttr:"CON"},{key:"Reflexo",defaultAttr:"DES"},{key:"Vontade",defaultAttr:"SAB"}].map(({key:p,defaultAttr:x})=>{const A=p.toLowerCase(),D=`${A}Attr`,j=t[D]||x,R=N[j]||0,q=(h==null?void 0:h[A])??"",ne=(parseInt(q,10)||0)+R+(i[p]||0),ae=re=>{e(D,re)};return c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md col-span-2 justify-between",children:[c.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(p,ne),title:`Clique para rolar ${p} (Valor: ${ne})`,children:ne}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",id:p,name:A,value:q,onChange:b,onBlur:()=>E(A),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!d||!o,"aria-label":`${p} Base`}),o?c.jsx("select",{value:j,onChange:re=>ae(re.target.value),className:"bg-bgInput text-textPrimary text-sm font-bold rounded-md p-1 border-none focus:ring-2 focus:ring-btnHighlightBg",disabled:!d,children:Object.keys(N).map(re=>c.jsx("option",{value:re,children:re},re))}):c.jsxs("span",{className:"font-semibold text-textSecondary text-sm ml-1",children:["(",j,")"]})]}),c.jsx("label",{htmlFor:p,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:p})]},p)})]})]})})},Ck=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{var E,v;const{user:o}=Fe(),[l,u]=V.useState(0),d=((E=t.wallet)==null?void 0:E.zeni)||0,h=((v=t.wallet)==null?void 0:v.inspiration)||0,g=o&&(o.uid===t.ownerUid||e),y=(S,P)=>{const I={...t.wallet,[S]:Math.max(0,P)};n("wallet",I)},C=()=>{y("zeni",d+l),u(0)},k=()=>{y("zeni",d-l),u(0)},w=()=>y("inspiration",h+1),N=()=>y("inspiration",h-1),b=c.jsxs("div",{className:"flex justify-between items-center w-full",children:[c.jsxs("span",{children:["Zeni: ",d]}),c.jsxs("span",{className:"text-textPrimary text-base",children:["Inspirao: ",h]})]});return c.jsx(Ht,{title:b,isCollapsed:r,toggleSection:s,isComplexTitle:!0,children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"hidden sm:inline font-semibold text-textSecondary",children:"Zeni:"}),c.jsx("input",{type:"number",value:l===0?"":l,onChange:S=>u(parseInt(S.target.value,10)||0),className:"w-24 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-lg",placeholder:"Valor",disabled:!g}),c.jsx("button",{onClick:C,className:"px-3 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg text-sm",disabled:!g,children:"+"}),c.jsx("button",{onClick:k,className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm",disabled:!g,children:"-"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"hidden sm:inline font-semibold text-textSecondary",children:"Inspirao:"}),c.jsx("button",{onClick:w,className:"px-3 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg text-sm",disabled:!g,children:"+1"}),c.jsx("button",{onClick:N,className:"px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-lg text-sm",disabled:!g,children:"-1"})]})]})})},Ak=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=Fe(),l=o&&(o.uid===t.ownerUid||n),[u,d]=V.useState(t.discordWebhookUrl||"");V.useEffect(()=>{d(t.discordWebhookUrl||"")},[t.discordWebhookUrl]);const h=y=>{d(y.target.value)},g=V.useCallback(()=>{u!==t.discordWebhookUrl&&e("discordWebhookUrl",u)},[u,t.discordWebhookUrl,e]);return c.jsx(Ht,{title:"Integrao com Discord",isCollapsed:r,toggleSection:s,children:c.jsxs("div",{children:[c.jsx("label",{htmlFor:"discordWebhookUrl",className:"block text-sm font-medium text-textSecondary mb-1",children:"URL do Webhook do Canal:"}),c.jsx("input",{type:"text",id:"discordWebhookUrl",name:"discordWebhookUrl",value:u,onChange:h,onBlur:g,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md focus:ring-btnHighlightBg focus:border-btnHighlightBg text-textPrimary",placeholder:"Cole a URL do Webhook do seu canal do Discord aqui",disabled:!l||!i}),c.jsx("p",{className:"text-xs text-textSecondary mt-2",children:"Com a URL do Webhook configurada, os comandos de rolagem sero enviados diretamente para o seu canal do Discord."})]})})},ca=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i,name:o})=>{const l=V.useRef(null);return V.useEffect(()=>{l.current&&(l.current.style.height="auto",l.current.style.height=`${l.current.scrollHeight}px`)},[t]),c.jsx("textarea",{ref:l,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i,name:o})},Pk=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,onShowDiscord:i})=>{const{user:o}=Fe(),l=o.uid===t.ownerUid||n,[u,d]=V.useState(t.inventory||[]);V.useEffect(()=>{d(t.inventory||[])},[t.inventory]);const h=()=>e("inventory",[...t.inventory||[],{id:crypto.randomUUID(),name:"",description:"",isCollapsed:!1}]),g=w=>e("inventory",(t.inventory||[]).filter(N=>N.id!==w)),y=(w,N,b)=>{d(E=>E.map(v=>v.id===w?{...v,[N]:b}:v))},C=V.useCallback((w,N)=>{const b=u.find(v=>v.id===w),E=(t.inventory||[]).find(v=>v.id===w);b&&E&&b[N]!==E[N]&&e("inventory",(t.inventory||[]).map(v=>v.id===w?{...v,[N]:b[N]}:v))},[u,t.inventory,e]),k=w=>{u.find(b=>b.id===w)&&e("inventory",(t.inventory||[]).map(b=>b.id===w?{...b,isCollapsed:!b.isCollapsed}:b))};return c.jsxs(Ht,{title:"Inventrio",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(w=>w.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>k(w.id),children:w.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>i(w.name,w.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},w.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>k(w.id),children:w.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>i(w.name,w.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-4",children:"Mostrar no Feed"})]}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer self-end",onClick:()=>k(w.id),children:"Recolher "}),c.jsx("input",{type:"text",value:w.name,onChange:b=>y(w.id,"name",b.target.value),onBlur:()=>C(w.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome do Item",disabled:!l}),c.jsx(ca,{name:"description",value:w.description,onChange:b=>y(w.id,"description",b.target.value),onBlur:()=>C(w.id,"description"),placeholder:"Descrio do item",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(w.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Item",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},w.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhum item no inventrio."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:h,className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})},Rk=({character:t,isMaster:e,onUpdate:n,onShowDiscord:r,isCollapsed:s,toggleSection:i})=>{const{user:o}=Fe(),l=o.uid===t.ownerUid||e,[u,d]=V.useState(t.equippedItems||[]);V.useEffect(()=>{d(t.equippedItems||[])},[t.equippedItems]);const h=()=>n("equippedItems",[...t.equippedItems||[],{id:crypto.randomUUID(),name:"",description:"",attributes:"",isCollapsed:!1}]),g=w=>n("equippedItems",(t.equippedItems||[]).filter(N=>N.id!==w)),y=(w,N,b)=>{d(E=>E.map(v=>v.id===w?{...v,[N]:b}:v))},C=V.useCallback((w,N)=>{const b=u.find(v=>v.id===w),E=(t.equippedItems||[]).find(v=>v.id===w);b&&E&&b[N]!==E[N]&&n("equippedItems",(t.equippedItems||[]).map(v=>v.id===w?{...v,[N]:b[N]}:v))},[u,t.equippedItems,n]),k=w=>n("equippedItems",(t.equippedItems||[]).map(N=>N.id===w?{...N,isCollapsed:!N.isCollapsed}:N));return c.jsxs(Ht,{title:"Itens Equipados",isCollapsed:s,toggleSection:i,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(w=>w.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>k(w.id),children:w.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>r(w.name,w.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},w.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>k(w.id),children:w.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>r(w.name,w.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-4",children:"Mostrar no Feed"})]}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer self-end",onClick:()=>k(w.id),children:"Recolher "}),c.jsx("input",{type:"text",value:w.name,onChange:b=>y(w.id,"name",b.target.value),onBlur:()=>C(w.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome",disabled:!l}),c.jsx(ca,{value:w.description,onChange:b=>y(w.id,"description",b.target.value),onBlur:()=>C(w.id,"description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md mb-2",disabled:!l}),c.jsx(ca,{value:w.attributes,onChange:b=>y(w.id,"attributes",b.target.value),onBlur:()=>C(w.id,"attributes"),placeholder:"Atributos/Efeitos",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-sm text-textPrimary",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(w.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Item",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},w.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhum item equipado."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:h,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})},Nk=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,onShowDiscord:i})=>{const{user:o}=Fe(),l=o.uid===t.ownerUid||e,[u,d]=V.useState(t.abilities||[]);V.useEffect(()=>{d(t.abilities||[])},[t.abilities]);const h=()=>n("abilities",[...t.abilities||[],{id:crypto.randomUUID(),title:"",description:"",isCollapsed:!1}]),g=w=>n("abilities",(t.abilities||[]).filter(N=>N.id!==w)),y=(w,N,b)=>{d(E=>E.map(v=>v.id===w?{...v,[N]:b}:v))},C=V.useCallback((w,N)=>{const b=u.find(v=>v.id===w),E=(t.abilities||[]).find(v=>v.id===w);b&&E&&b[N]!==E[N]&&n("abilities",(t.abilities||[]).map(v=>v.id===w?{...v,[N]:b[N]}:v))},[u,t.abilities,n]),k=w=>n("abilities",(t.abilities||[]).map(N=>N.id===w?{...N,isCollapsed:!N.isCollapsed}:N));return c.jsxs(Ht,{title:"Habilidades",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(w=>w.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>k(w.id),children:w.title||"Habilidade Sem Ttulo"}),c.jsx("button",{onClick:()=>i(w.title,w.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},w.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>k(w.id),children:w.title||"Habilidade Sem Ttulo"}),c.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[c.jsx("button",{onClick:()=>i(w.title,w.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap",children:"Mostrar no Feed"}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>k(w.id),children:"Recolher "})]})]}),c.jsx("input",{type:"text",value:w.title,onChange:b=>y(w.id,"title",b.target.value),onBlur:()=>C(w.id,"title"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Ttulo",disabled:!l}),c.jsx(ca,{value:w.description,onChange:b=>y(w.id,"description",b.target.value),onBlur:()=>C(w.id,"description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(w.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Habilidade",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},w.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhuma habilidade adicionada."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:h,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})},kk=({character:t,onUpdate:e,isCollapsed:n,toggleSection:r,onShowDiscord:s})=>{const o=g=>e(g,[...t[g]||[],{id:crypto.randomUUID(),name:"",description:"",origin:{class:!1,race:!1,manual:!0},value:0,isCollapsed:!1}]),l=(g,y)=>e(g,(t[g]||[]).filter(C=>C.id!==y)),u=(g,y,C)=>e(g,(t[g]||[]).map(k=>k.id===y?{...k,origin:{...k.origin,[C]:!k.origin[C]}}:k)),d=(g,y,C,k)=>e(g,(t[g]||[]).map(w=>w.id===y?{...w,[C]:k}:w)),h=(g,y)=>e(g,(t[g]||[]).map(C=>C.id===y?{...C,isCollapsed:!C.isCollapsed}:C));return c.jsx(Ht,{title:"Vantagens e Desvantagens",isCollapsed:n,toggleSection:r,children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1",children:"Vantagens"}),c.jsxs("div",{className:"space-y-2",children:[(t.advantages||[]).map(g=>c.jsx(dv,{perk:g,type:"advantages",canEdit:!0,onRemove:l,onChange:d,onOriginChange:u,onToggleCollapse:h,onShowDiscord:s},g.id)),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("button",{onClick:()=>o("advantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1",children:"Desvantagens"}),c.jsxs("div",{className:"space-y-2",children:[(t.disadvantages||[]).map(g=>c.jsx(dv,{perk:g,type:"disadvantages",canEdit:!0,onRemove:l,onChange:d,onOriginChange:u,onToggleCollapse:h,onShowDiscord:s},g.id)),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("button",{onClick:()=>o("disadvantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})]})]})})},dv=({perk:t,type:e,canEdit:n,onRemove:r,onChange:s,onOriginChange:i,onToggleCollapse:o,onShowDiscord:l})=>{const[u,d]=V.useState(t);V.useEffect(()=>{d(t)},[t.id]);const h=y=>{const{name:C,value:k,type:w}=y.target,N=w==="number"?parseInt(k,10)||0:k;d(b=>({...b,[C]:N}))},g=V.useCallback(y=>{u[y]!==t[y]&&s(e,u.id,y,u[y])},[u,t,e,s]);return c.jsxs("div",{className:"flex flex-col p-3 bg-bgElement rounded-md shadow-sm",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsxs("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>o(e,t.id),children:[u.name||"Sem Nome"," ",t.isCollapsed?"...":""]}),c.jsx("button",{onClick:()=>l(u.name,u.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]}),!t.isCollapsed&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("input",{type:"text",name:"name",value:u.name,onChange:h,onBlur:()=>g("name"),className:"font-semibold text-lg flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",placeholder:"Nome",disabled:!n}),c.jsx("input",{type:"number",name:"value",value:u.value===0?"":u.value,onChange:h,onBlur:()=>g("value"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary",placeholder:"Valor",disabled:!n})]}),c.jsx(ca,{name:"description",value:u.description,onChange:h,onBlur:()=>g("description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!n}),c.jsx("div",{className:"flex gap-3 text-sm text-textSecondary mt-2",children:["class","race","manual"].map(y=>{var C;return c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"checkbox",checked:((C=t.origin)==null?void 0:C[y])||!1,onChange:()=>i(e,t.id,y),className:"form-checkbox text-btnHighlightBg rounded",disabled:!n}),y.charAt(0).toUpperCase()+y.slice(1)]},y)})}),n&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>r(e,t.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:`Remover ${e==="advantages"?"Vantagem":"Desvantagem"}`,children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]})]})},Dk=({value:t,onChange:e,placeholder:n,className:r,disabled:s,onBlur:i})=>{const o=V.useRef(null);return V.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),c.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:i,placeholder:n,className:`${r} resize-none overflow-hidden`,rows:"1",disabled:s})},jk=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=Fe(),l=o.uid===t.ownerUid||e,u=g=>{const y=g==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(g==="image"){const C=prompt("Cole a URL da imagem:");C&&n("history",[...t.history||[],{...y,value:C}])}else n("history",[...t.history||[],y])},d=(g,y,C)=>n("history",(t.history||[]).map(k=>k.id===g?{...k,[y]:C}:k)),h=g=>n("history",(t.history||[]).filter(y=>y.id!==g));return c.jsxs(Ht,{title:"Histria do Personagem",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"space-y-4 mb-4",children:(t.history||[]).length===0?c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum bloco de histria adicionado."}):t.history.map(g=>oE(g,l,d,h))}),l&&i&&c.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 justify-center",children:[c.jsx("button",{onClick:()=>u("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Texto"}),c.jsx("button",{onClick:()=>u("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Imagem"})]})]})},Ok=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=Fe(),l=o.uid===t.ownerUid||e,u=g=>{const y=g==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(g==="image"){const C=prompt("Cole a URL da imagem para a anotao:");C&&n("notes",[...t.notes||[],{...y,value:C}])}else n("notes",[...t.notes||[],y])},d=(g,y,C)=>n("notes",(t.notes||[]).map(k=>k.id===g?{...k,[y]:C}:k)),h=g=>n("notes",(t.notes||[]).filter(y=>y.id!==g));return c.jsxs(Ht,{title:"Anotaes",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"space-y-4 mb-4",children:(t.notes||[]).length===0?c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum bloco de anotao adicionado."}):t.notes.map(g=>oE(g,l,d,h))}),l&&i&&c.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 justify-center",children:[c.jsx("button",{onClick:()=>u("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Texto"}),c.jsx("button",{onClick:()=>u("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Imagem"})]})]})},oE=(t,e,n,r)=>c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput relative",children:[e&&c.jsx("button",{onClick:()=>r(t.id),className:"absolute top-2 right-2 p-1 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white z-10",title:"Remover Bloco",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-lg",children:""})}),t.type==="text"?c.jsx(Vk,{block:t,canEdit:e,updateBlock:n}):c.jsx(Mk,{block:t,canEdit:e,updateBlock:n})]},t.id),Vk=({block:t,canEdit:e,updateBlock:n})=>{const[r,s]=V.useState(t.value||"");V.useEffect(()=>{s(t.value||"")},[t.value]);const i=V.useCallback(()=>{r!==t.value&&n(t.id,"value",r)},[r,t.value,t.id,n]);return t.isCollapsed?c.jsxs("div",{className:"cursor-pointer",onClick:()=>n(t.id,"isCollapsed",!1),children:[c.jsx("p",{className:"text-lg font-semibold mb-1 text-textPrimary",children:"Bloco de Texto"}),c.jsx("p",{className:"text-sm italic text-textSecondary truncate",children:t.value||"Vazio..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Dk,{value:r,onChange:o=>s(o.target.value),onBlur:i,placeholder:"Digite aqui...",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!e}),c.jsx("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary",children:"Ocultar "})]})},Mk=({block:t,canEdit:e,updateBlock:n})=>{const[r,s]=V.useState(t.width===0?"":t.width),[i,o]=V.useState(t.height===0?"":t.height),[l,u]=V.useState(t.fitWidth);V.useEffect(()=>{s(t.width===0?"":t.width),o(t.height===0?"":t.height),u(t.fitWidth)},[t.width,t.height,t.fitWidth]);const d=V.useCallback(()=>n(t.id,"width",parseInt(r)||0),[t.id,n,r]),h=V.useCallback(()=>n(t.id,"height",parseInt(i)||0),[t.id,n,i]),g=V.useCallback(y=>n(t.id,"fitWidth",y.target.checked),[t.id,n]);return t.isCollapsed?c.jsx("div",{className:"cursor-pointer text-center py-2",onClick:()=>n(t.id,"isCollapsed",!1),children:c.jsx("p",{className:"text-lg font-semibold text-textPrimary",children:"Mostrar Imagem"})}):c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("img",{src:t.value,alt:"Imagem",className:"max-w-full h-auto rounded-md shadow-md",style:{width:l?"100%":r?`${r}px`:"auto",height:l?"auto":i?`${i}px`:"auto",objectFit:"contain"},onError:y=>{y.target.onerror=null,y.target.src="https://placehold.co/300x200/1f2937/FFFFFF?text=Erro"}}),e&&c.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 mt-2 text-sm text-textSecondary",children:[c.jsxs("label",{children:["Ajustar  Largura: ",c.jsx("input",{type:"checkbox",checked:l,onChange:y=>{u(y.target.checked),g(y)},className:"form-checkbox text-btnHighlightBg rounded"})]}),!l&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Largura (px): ",c.jsx("input",{type:"number",value:r,onChange:y=>s(y.target.value),onBlur:d,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})]}),c.jsxs("label",{children:["Altura (px): ",c.jsx("input",{type:"number",value:i,onChange:y=>o(y.target.value),onBlur:h,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})]})]})]}),c.jsx("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 w-full text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary",children:"Ocultar "})]})},Lk=({character:t,onBack:e,isMaster:n})=>{var D,j,R,q,ne,ae,re,z,K,Q,Ee,ve,Re;const{character:r,loading:s,updateCharacterField:i,toggleSection:o}=Gw(t.id,t.ownerUid),{addRollToFeed:l,addMessageToFeed:u}=cc(),{user:d}=Fe(),[h,g]=V.useState(!1),y=n||d&&d.uid===(r==null?void 0:r.ownerUid),[C,k]=V.useState({type:null,props:{}}),w=()=>k({type:null,props:{}}),N=V.useMemo(()=>r?["Iniciativa","FA","FM","FD","Acerto","MD","ME","Fora","Destreza","Constituio","Inteligencia","Sabedoria","Carisma","Fortitude","Reflexo","Vontade"]:[],[r]),b=V.useMemo(()=>{const H={attributes:{},dice:[]};return r!=null&&r.buffs&&r.buffs.forEach(Y=>{Y.isActive&&Y.effects&&Y.effects.forEach(oe=>{if(oe.type==="attribute"&&oe.target){const ue=parseInt(oe.value,10)||0;H.attributes[oe.target]=(H.attributes[oe.target]||0)+ue}else oe.type==="dice"&&oe.value&&H.dice.push({name:Y.name,value:oe.value})})}),H},[r==null?void 0:r.buffs]),E=async(H,Y,oe=[],ue="",_e="",Ct=!1)=>{if(!r)return;Ct||u({characterName:r.name||"Narrador",title:H,description:Y||"Nenhuma descrio."});const At={author:{name:r.name||"Personagem",icon_url:r.photoUrl||""},title:H||"Sem Ttulo",description:Y||"Sem Descrio.",fields:oe,color:8141549,footer:ue?{text:ue}:void 0};if(r.discordWebhookUrl)try{await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[At]})}),_e&&await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:_e})})}catch(ye){k({type:"info",props:{message:`Falha ao enviar para o Discord: ${ye.message}`,onConfirm:w}})}else{const ye=`**${H||"Sem Ttulo"}**
${Y||"Sem Descrio."}`;k({type:"info",props:{message:"Webhook do Discord no configurado. Copie e cole no Discord:",copyText:ye,showCopyButton:!0,onConfirm:w}})}},v=(H,Y,oe,ue=!1)=>{if(!(r!=null&&r.mainAttributes))return;let _e="";const Ct=r.name||"Personagem",At=JSON.parse(JSON.stringify(r.mainAttributes)),ye=At.hp,ze=At.mp;if(oe==="heal")switch(Y){case"HP":ye.current=Math.min(ye.max,ye.current+H),_e=`${Ct} recuperou ${H} de HP.`;break;case"HP Bonus":ye.temp=(ye.temp||0)+H,_e=`${Ct} recebeu ${H} de HP Bnus.`;break;case"MP":ze.current=Math.min(ze.max,ze.current+H),_e=`${Ct} recuperou ${H} de MP.`;break}else switch(Y){case"HP":let et=H;if(ue)ye.current-=et,_e=`${Ct} sofreu ${H} de dano direto no HP.`;else{const Wt=Math.min(et,ye.temp||0);ye.temp-=Wt,et-=Wt,et>0&&(ye.current-=et),_e=`${Ct} sofreu ${H} de dano.`}break;case"HP Bonus":ye.temp=Math.max(0,(ye.temp||0)-H),_e=`${Ct} perdeu ${H} de HP Bnus.`;break;case"MP":ze.current=Math.max(0,ze.current-H),_e=`${Ct} perdeu ${H} de MP.`;break}ye.current=Math.max(0,ye.current),i("mainAttributes",At),E(oe==="heal"?" Cura / Restaurao":" Dano Sofrido",_e),w()},S=H=>{k({type:"damageHeal",props:{attributeName:H,onConfirm:v,onClose:w}})},P=(H,Y)=>{if(!r)return;const oe={name:`Rolagem de ${H}`,components:[{type:"dice",value:"1d20"},{type:"number",value:Y,label:"Bnus"}],discordText:`Rolagem de ${H} (1d20${Y>=0?"+":""}${Y})`};p(oe)},I=(H,Y)=>{["HP","HP Bonus","MP"].includes(H)?S(H):P(H,Y)},_=V.useCallback((H,Y)=>{var Wt,hn;const oe=ti.find(fn=>fn.name===H),ue=(Wt=Y.skillSystem)==null?void 0:Wt[H];if(!oe||!ue)return 0;const _e=ue.selectedAttr||oe.attr,Ct=Uh[_e],At=((hn=Y.mainAttributes)==null?void 0:hn[Ct])||0,ye=Y.level||0;let ze=0;ue.trained&&(ze=2+Math.floor(ye/10));const et=parseInt(ue.otherBonus,10)||0;return At+ze+et},[]),p=async H=>{var nt;if(!H)return;let Y=0,oe=null,ue=[],_e=[];const Ct=H.multiplier||1,At=X=>{let Z=0;if(!X)return 0;const pe=(X||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.mainAttributes&&r.mainAttributes.hasOwnProperty(pe)?Z=r.mainAttributes[pe]||0:r.mainAttributes&&r.mainAttributes.hasOwnProperty(pe.toLowerCase())&&(Z=r.mainAttributes[pe.toLowerCase()]||0),Z+=b.attributes[X]||0,Z},ye=(nt=H.components)==null?void 0:nt.find(X=>X.type==="skillRoll");if(ye&&ye.skill){const X=Math.floor(Math.random()*20)+1,Z=_(ye.skill,r),pe=X+Z,ke=parseInt(ye.critMin,10)||19,at=X>=ke;if(oe={roll:X,bonus:Z,total:pe,isCrit:at,skillName:ye.skill},at){_e.push(`Acerto Crtico no d20 (${X})!`);const rt=ye.critFormula||"",Ke=rt.match(/(\d+)d(\d+)/i);if(Ke){const Qe=parseInt(Ke[1],10),qt=parseInt(Ke[2],10);let zi=[],Cn=0;for(let Bi=0;Bi<Qe;Bi++){const dr=Math.floor(Math.random()*qt)+1;zi.push(dr),Cn+=dr}Y+=Cn;const Pa=`Crtico(${rt}: ${zi.join("+")}) = ${Cn}`;_e.push(Pa)}else if(!isNaN(parseInt(rt,10))&&rt.trim()!==""){const Qe=parseInt(rt,10);Y+=Qe;const qt=`Crtico(Bnus: ${Qe})`;ue.push({type:"number",value:Qe,displayValue:qt}),_e.push(qt)}}}else if(!(H.components||[]).some(Z=>Z.type==="dice"||Z.type==="critDice")){const Z=Math.floor(Math.random()*20)+1;Y+=Z,ue.push({type:"dice",value:Z,displayValue:`1d20(${Z})`})}for(let X=0;X<Ct;X++)for(const Z of H.components||[])if(Z.type==="attribute"){const pe=Z.value,ke=At(pe);Y+=ke,ue.push({type:"attribute",value:ke,displayValue:`${pe}(${ke})`})}else if(Z.type==="critDice"){const pe=String(Z.value||"").match(/(\d+)d(\d+)/i);if(pe){const ke=parseInt(pe[1],10),at=parseInt(pe[2],10);let rt=[],Ke=0;for(let Qe=0;Qe<ke;Qe++){const qt=Math.floor(Math.random()*at)+1;if(rt.push(qt),Ke+=qt,qt>=(Z.critValue||at)){const Cn=At(Z.critBonusAttribute)*(Z.critBonusMultiplier||1);Ke+=Cn,_e.push(`Crtico no ${qt}! Adiciona ${Z.critBonusAttribute} (${Cn})`)}}Y+=Ke,ue.push({type:"dice",value:Ke,displayValue:`${Z.value}(${rt.join("+")})`})}else{const ke=parseInt(Z.value,10)||0;Y+=ke,ue.push({type:"number",value:ke,displayValue:`${ke}`})}}else if(Z.type==="dice"){const pe=String(Z.value||"").match(/(\d+)d(\d+)/i);if(pe){const ke=parseInt(pe[1],10),at=parseInt(pe[2],10);let rt=[];for(let Qe=0;Qe<ke;Qe++)rt.push(Math.floor(Math.random()*at)+1);const Ke=rt.reduce((Qe,qt)=>Qe+qt,0);Y+=Ke,ue.push({type:"dice",value:Ke,displayValue:`${Z.value}(${rt.join("+")})`})}else if(!isNaN(parseInt(Z.value,10))){const ke=parseInt(Z.value,10)||0;Y+=ke,ue.push({type:"number",value:ke,displayValue:`${ke}`})}}else if(Z.type==="number"){const pe=parseInt(Z.value,10)||0;Y+=pe;const ke=Z.label?`${Z.label}(${pe>=0?"+":""}${pe})`:`${pe}`;ue.push({type:"number",value:pe,displayValue:ke})}else Z.type;b.dice.forEach(X=>{const Z=(X.value||"").match(/(\d+)d(\d+)/i);if(Z){const pe=parseInt(Z[1],10),ke=parseInt(Z[2],10);let at=[];for(let Ke=0;Ke<pe;Ke++)at.push(Math.floor(Math.random()*ke)+1);const rt=at.reduce((Ke,Qe)=>Ke+Qe,0);Y+=rt,ue.push({type:"dice",value:rt,displayValue:`${X.name}(${at.join("+")})`})}else{const pe=parseInt(X.value,10)||0;Y+=pe,ue.push({type:"number",value:pe,displayValue:`${X.name}(${pe})`})}});const ze={HP:0,MP:0};let et=[];const Wt=(r.buffs||[]).filter(X=>X.isActive),hn=H.costType&&H.costIsRollResult?-Y:parseInt(H.costValue,10)||0;H.costType&&hn!==0&&(ze[H.costType]+=hn,et.push(`Ao: ${hn>=0?"+":""}${hn} ${H.costType}`));const fn={HP:0,MP:0};H.recoverHP&&(fn.HP=Y,et.push(`Recupera: ${Y} HP`)),H.recoverMP&&(fn.MP=Y,et.push(`Recupera: ${Y} MP`)),Wt.forEach(X=>{if(X.costType&&X.costValue!==void 0){const Z=parseInt(X.costValue,10)||0;Z!==0&&(ze[X.costType]+=Z,et.push(`${X.name}: ${Z>=0?"+":""}${Z} ${X.costType}`))}});const gc=Math.abs(Math.min(0,ze.HP)),yc=Math.abs(Math.min(0,ze.MP));if(r.mainAttributes.hp.current<gc||r.mainAttributes.mp.current<yc){k({type:"info",props:{message:"Custo de HP/MP insuficiente!",onConfirm:w}});return}const Fi=/(https?:\/\/[^\s]+)/i;let ks="",zn=H.discordText||"";const Aa=zn.match(Fi);if(Aa&&(ks=Aa[0],zn=zn.replace(Fi,"").trim()),ze.HP!==0||ze.MP!==0||fn.HP>0||fn.MP>0){const X={...r.mainAttributes};X.hp.current=X.hp.current-ze.HP+fn.HP,X.mp.current=X.mp.current-ze.MP+fn.MP,X.hp.current=Math.min(X.hp.current,X.hp.max),X.hp.current=Math.max(X.hp.current,0),X.mp.current=Math.min(X.mp.current,X.mp.max),X.mp.current=Math.max(X.mp.current,0),await i("mainAttributes",X)}let Ui=ue.map(X=>X.displayValue).join(" + "),Xr;if(oe){const X=`**Acerto (${oe.skillName}):** ${oe.total} (d20:${oe.roll} + Bnus:${oe.bonus})`;Xr=`${zn}
${X}

**Dano/Resultado: ${Y}**`}else Xr=`${zn}

**Resultado Final: ${Y}**`;const Ds=[{name:"Detalhes da Rolagem",value:Ui||"N/A",inline:!1}];_e.length>0&&Ds.push({name:"Crticos",value:_e.join(`
`),inline:!1}),Wt.length>0&&Ds.push({name:"Buffs Ativos",value:Wt.map(X=>X.name).join(", "),inline:!1});const tt=et.length>0?`Custo Total: ${et.join(" | ")}`:"";E(H.name,Xr,Ds,tt,ks,!0),l({characterId:r.id,characterName:r.name,ownerUid:d.uid,rollName:H.name,results:ue,totalResult:Y,acertoResult:oe,criticals:_e,discordText:zn})},x=()=>{k({type:"confirm",props:{message:`Tem a certeza que deseja resetar PERMANENTEMENTE a ficha de "${r.name}"?`,onConfirm:async()=>{const H={photoUrl:"",age:"",height:"",gender:"",race:"",class:"",alignment:"",level:1,xp:0,mainAttributes:{hp:{current:10,max:10,temp:0},mp:{current:10,max:10},fa:0,fm:0,fd:0,acerto:0,me:0,forca:0,destreza:0,constituicao:0,inteligencia:0,sabedoria:0,carisma:0,fortitude:0,reflexo:0,vontade:0},attributes:[],inventory:[],wallet:{zeni:0,inspiration:0},fortitude:0,reflexo:0,vontade:0,advantages:[],disadvantages:[],abilities:[],equippedItems:[],history:[],notes:[],buffs:[],formulaActions:[],discordWebhookUrl:"",fortitudeAttr:"CON",reflexoAttr:"DES",vontadeAttr:"SAB",skillSystem:{}};for(const[Y,oe]of Object.entries(H))await i(Y,oe);w()},onCancel:w}})},A=()=>{const{collapsedStates:H,...Y}=r,oe=JSON.stringify(Y,null,2),ue=new Blob([oe],{type:"application/json"}),_e=document.createElement("a");_e.href=URL.createObjectURL(ue),_e.download=`${r.name||"ficha"}.json`,document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),URL.revokeObjectURL(_e.href)};return s?c.jsx("div",{className:"text-center p-8",children:c.jsx("p",{className:"text-xl text-textSecondary",children:"A carregar ficha..."})}):r?c.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4",children:[c.jsx(dc,{modalState:C,closeModal:w}),c.jsx(bk,{character:r}),c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("button",{onClick:e,className:"px-4 py-2 bg-bgSurface hover:opacity-80 text-textPrimary font-bold rounded-lg",children:" Voltar para a Lista"}),y&&c.jsx("button",{onClick:()=>g(!h),className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg shadow-lg",children:h?" Sair do Modo Edio":" Entrar no Modo Edio"})]}),c.jsx("div",{id:"info",children:c.jsx(Tk,{character:r,onUpdate:i,isMaster:n,isEditMode:h,isCollapsed:(D=r.collapsedStates)==null?void 0:D.info,toggleSection:()=>o("info")})}),c.jsx("div",{id:"main-attributes",children:c.jsx(Ik,{character:r,onUpdate:i,isMaster:n,isEditMode:h,buffModifiers:b.attributes,isCollapsed:(j=r.collapsedStates)==null?void 0:j.main,toggleSection:()=>o("main"),onAttributeRoll:I})}),c.jsx("div",{id:"actions",children:c.jsx(t1,{character:r,isMaster:n,isCollapsed:(R=r.collapsedStates)==null?void 0:R.actions,toggleSection:()=>o("actions"),allAttributes:N,onUpdate:i,onExecuteFormula:p,isEditMode:h})}),c.jsx("div",{id:"buffs",children:c.jsx(n1,{character:r,isMaster:n,onUpdate:i,allAttributes:N,isCollapsed:(q=r.collapsedStates)==null?void 0:q.buffs,toggleSection:()=>o("buffs"),isEditMode:h})}),c.jsx("div",{id:"wallet",children:c.jsx(Ck,{character:r,isMaster:n,onUpdate:i,isCollapsed:(ne=r.collapsedStates)==null?void 0:ne.wallet,toggleSection:()=>o("wallet"),isEditMode:h})}),c.jsx("div",{id:"inventory",children:c.jsx(Pk,{character:r,onUpdate:i,isMaster:n,onShowDiscord:E,isCollapsed:(ae=r.collapsedStates)==null?void 0:ae.inventory,toggleSection:()=>o("inventory"),isEditMode:h})}),c.jsx("div",{id:"equipped",children:c.jsx(Rk,{character:r,onUpdate:i,isMaster:n,onShowDiscord:E,isCollapsed:(re=r.collapsedStates)==null?void 0:re.equipped,toggleSection:()=>o("equipped"),isEditMode:h})}),c.jsx("div",{id:"perks",children:c.jsx(kk,{character:r,onUpdate:i,onShowDiscord:E,isCollapsed:(z=r.collapsedStates)==null?void 0:z.perks,toggleSection:()=>o("perks"),isEditMode:h})}),c.jsx("div",{id:"skills",children:c.jsx(Nk,{character:r,onUpdate:i,isMaster:n,onShowDiscord:E,isCollapsed:(K=r.collapsedStates)==null?void 0:K.skills,toggleSection:()=>o("skills"),isEditMode:h})}),c.jsx("div",{id:"specializations",children:c.jsx(ZN,{character:r,onUpdate:i,isMaster:n,isCollapsed:(Q=r.collapsedStates)==null?void 0:Q.specializations,toggleSection:()=>o("specializations"),onExecuteFormula:p,isEditMode:h})}),c.jsx("div",{id:"story",children:c.jsx(jk,{character:r,onUpdate:i,isMaster:n,isCollapsed:(Ee=r.collapsedStates)==null?void 0:Ee.story,toggleSection:()=>o("story"),isEditMode:h})}),c.jsx("div",{id:"notes",children:c.jsx(Ok,{character:r,onUpdate:i,isMaster:n,isCollapsed:(ve=r.collapsedStates)==null?void 0:ve.notes,toggleSection:()=>o("notes"),isEditMode:h})}),c.jsx("div",{id:"discord",children:c.jsx(Ak,{character:r,onUpdate:i,isMaster:n,isCollapsed:(Re=r.collapsedStates)==null?void 0:Re.discord,toggleSection:()=>o("discord"),isEditMode:h})}),c.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mt-8 p-4 bg-bgSurface/80 backdrop-blur-sm rounded-xl border border-bgElement",children:[c.jsx("button",{onClick:A,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!r,children:"Exportar Ficha (JSON)"}),c.jsx("button",{onClick:x,className:"px-8 py-3 bg-red-700 hover:bg-red-800 text-white font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!r,children:"Resetar Ficha"})]})]}):c.jsx("div",{className:"text-center p-8",children:c.jsx("p",{className:"text-xl text-red-400",children:"Erro: Personagem no encontrado."})})},Fk=({activeTheme:t,setActiveTheme:e,setPreviewTheme:n})=>{const{user:r,googleSignOut:s,isMaster:i}=Fe(),[o,l]=V.useState(null),[u,d]=V.useState([]),h=V.useRef(null),[g,y]=V.useState(!1),[C,k]=V.useState(!1),{currentSystem:w,setCurrentSystem:N,characterDataCollectionRoot:b,GLOBAL_APP_IDENTIFIER:E}=Rs(),[v,S]=V.useState({type:null,props:{}}),P=()=>S({type:null,props:{}});V.useEffect(()=>{if(o!=null&&o.id&&(o!=null&&o.ownerUid)){const q=ps($t(Pe,`${b}/users/${o.ownerUid}/characterSheets/${o.id}`),async ne=>{if(ne.exists()){const ae=ne.data();if(ae.activeThemeId){const re=await i1(ae.activeThemeId);e(re)}else e(null)}});return()=>q()}else e(null)},[o,e,b,Pe]);const I=()=>{k(!1),n(null)},_=q=>{l(q)},p=async()=>{if(r){console.log("%c[DIAGNSTICO DASHBOARD]","color: #00A8E8; font-weight: bold;",`Buscando fichas. isMaster: ${i}, viewingAll: ${g}`);const q=await Xw(b,r.uid,i&&g);d(q)}};V.useEffect(()=>{p()},[r,g,i,b]);const x=async()=>{await Jw(b,r.uid)&&p()},A=()=>{h.current.click()},D=q=>{const ne=q.target.files[0];if(!ne)return;const ae=new FileReader;ae.onload=re=>{try{const z=JSON.parse(re.target.result);if(!z.name)throw new Error("Ficheiro JSON invlido ou incompatvel.");S({type:"confirm",props:{message:`Deseja criar um novo personagem para o sistema ${w.toUpperCase()} com os dados de "${z.name}"?`,onConfirm:async()=>{const K=$t(Jt(Pe,`${b}/users/${r.uid}/characterSheets`)),Q={...z,ownerUid:r.uid,system:w};delete Q.id,await Ps(K,Q),p(),P()},onCancel:P}})}catch(z){S({type:"info",props:{message:`Erro ao ler arquivo: ${z.message}`,onConfirm:P}})}},ae.readAsText(ne),q.target.value=null},j=q=>{const ne=q.ownerUid||r.uid;S({type:"confirm",props:{message:`Tem a certeza que deseja excluir permanentemente a ficha de "${q.name}" do sistema ${w.toUpperCase()}?`,onConfirm:async()=>{await Zw(b,ne,q.id)?d(re=>re.filter(z=>z.id!==q.id)):alert("No foi possvel excluir a ficha."),P()},onCancel:P}})},R=c.jsx(iE,{onCharacterClick:_});return c.jsxs(c.Fragment,{children:[R,c.jsx("button",{onClick:()=>k(!0),className:"fixed top-4 right-4 z-[60] px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg shadow-lg",children:"Editor de Temas"}),C&&c.jsx(vk,{character:o,originalTheme:t,setPreviewTheme:n,onClose:I}),o?c.jsx(Lk,{character:o,onBack:()=>l(null),isMaster:i}):c.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 md:p-8",children:[c.jsx(dc,{modalState:v,closeModal:P}),c.jsx("input",{type:"file",ref:h,onChange:D,accept:".json",className:"hidden"}),c.jsxs("header",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-textPrimary",children:"Painel StoryCraft V1"}),c.jsxs("p",{className:"text-textSecondary",children:["Bem-vindo, ",r.displayName,"!"]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>N(null),className:"px-4 py-2 bg-bgElement hover:bg-opacity-80 text-textPrimary font-semibold rounded-lg shadow-lg",children:"Trocar Sistema"}),c.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg",children:"Sair"})]})]}),c.jsx("main",{children:c.jsx(Qw,{user:r,onSelectCharacter:l,handleImportClick:A,handleDeleteClick:j,handleCreateClick:x,characters:u,isMaster:i,viewingAll:g,onToggleView:y})})]})]})};var hc={exports:{}},aE={},lE={exports:{}},Uk="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",zk=Uk,Bk=zk;function uE(){}function cE(){}cE.resetWarningCache=uE;var $k=function(){function t(r,s,i,o,l,u){if(u!==Bk){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:cE,resetWarningCache:uE};return n.PropTypes=n,n};lE.exports=$k();var dE=lE.exports;function hE(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=hE(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function hv(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=hE(t))&&(r&&(r+=" "),r+=e);return r}const Hk=Object.freeze(Object.defineProperty({__proto__:null,clsx:hv,default:hv},Symbol.toStringTag,{value:"Module"})),Wk=HE(Hk);var Ue={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});Fn.dontSetMe=Yk;Fn.findInArray=qk;Fn.int=Qk;Fn.isFunction=Gk;Fn.isNum=Kk;function qk(t,e){for(let n=0,r=t.length;n<r;n++)if(e.apply(e,[t[n],n,t]))return t[n]}function Gk(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Kk(t){return typeof t=="number"&&!isNaN(t)}function Qk(t){return parseInt(t,10)}function Yk(t,e,n){if(t[e])return new Error("Invalid prop ".concat(e," passed to ").concat(n," - do not set this, set it on the child."))}var Ns={};Object.defineProperty(Ns,"__esModule",{value:!0});Ns.browserPrefixToKey=pE;Ns.browserPrefixToStyle=Xk;Ns.default=void 0;Ns.getPrefix=fE;const xd=["Moz","Webkit","O","ms"];function fE(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const n=(t=window.document)===null||t===void 0||(t=t.documentElement)===null||t===void 0?void 0:t.style;if(!n||e in n)return"";for(let r=0;r<xd.length;r++)if(pE(e,xd[r])in n)return xd[r];return""}function pE(t,e){return e?"".concat(e).concat(Jk(t)):t}function Xk(t,e){return e?"-".concat(e.toLowerCase(),"-").concat(t):t}function Jk(t){let e="",n=!0;for(let r=0;r<t.length;r++)n?(e+=t[r].toUpperCase(),n=!1):t[r]==="-"?n=!0:e+=t[r];return e}Ns.default=fE();Object.defineProperty(Ue,"__esModule",{value:!0});Ue.addClassName=yE;Ue.addEvent=tD;Ue.addUserSelectStyles=hD;Ue.createCSSTransform=lD;Ue.createSVGTransform=uD;Ue.getTouch=cD;Ue.getTouchIdentifier=dD;Ue.getTranslation=Up;Ue.innerHeight=iD;Ue.innerWidth=oD;Ue.matchesSelector=gE;Ue.matchesSelectorAndParentsTo=eD;Ue.offsetXYFromParent=aD;Ue.outerHeight=rD;Ue.outerWidth=sD;Ue.removeClassName=vE;Ue.removeEvent=nD;Ue.removeUserSelectStyles=fD;var Zt=Fn,fv=Zk(Ns);function mE(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(mE=function(r){return r?n:e})(t)}function Zk(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=mE(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}let pl="";function gE(t,e){return pl||(pl=(0,Zt.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,Zt.isFunction)(t[n])})),(0,Zt.isFunction)(t[pl])?t[pl](e):!1}function eD(t,e,n){let r=t;do{if(gE(r,e))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function tD(t,e,n,r){if(!t)return;const s={capture:!0,...r};t.addEventListener?t.addEventListener(e,n,s):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}function nD(t,e,n,r){if(!t)return;const s={capture:!0,...r};t.removeEventListener?t.removeEventListener(e,n,s):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}function rD(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,Zt.int)(n.borderTopWidth),e+=(0,Zt.int)(n.borderBottomWidth),e}function sD(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,Zt.int)(n.borderLeftWidth),e+=(0,Zt.int)(n.borderRightWidth),e}function iD(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,Zt.int)(n.paddingTop),e-=(0,Zt.int)(n.paddingBottom),e}function oD(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,Zt.int)(n.paddingLeft),e-=(0,Zt.int)(n.paddingRight),e}function aD(t,e,n){const s=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),i=(t.clientX+e.scrollLeft-s.left)/n,o=(t.clientY+e.scrollTop-s.top)/n;return{x:i,y:o}}function lD(t,e){const n=Up(t,e,"px");return{[(0,fv.browserPrefixToKey)("transform",fv.default)]:n}}function uD(t,e){return Up(t,e,"")}function Up(t,e,n){let{x:r,y:s}=t,i="translate(".concat(r).concat(n,",").concat(s).concat(n,")");if(e){const o="".concat(typeof e.x=="string"?e.x:e.x+n),l="".concat(typeof e.y=="string"?e.y:e.y+n);i="translate(".concat(o,", ").concat(l,")")+i}return i}function cD(t,e){return t.targetTouches&&(0,Zt.findInArray)(t.targetTouches,n=>e===n.identifier)||t.changedTouches&&(0,Zt.findInArray)(t.changedTouches,n=>e===n.identifier)}function dD(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function hD(t){if(!t)return;let e=t.getElementById("react-draggable-style-el");e||(e=t.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(e)),t.body&&yE(t.body,"react-draggable-transparent-selection")}function fD(t){if(t)try{if(t.body&&vE(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{const e=(t.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function yE(t,e){t.classList?t.classList.add(e):t.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(t.className+=" ".concat(e))}function vE(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var Un={};Object.defineProperty(Un,"__esModule",{value:!0});Un.canDragX=gD;Un.canDragY=yD;Un.createCoreData=_D;Un.createDraggableData=xD;Un.getBoundPosition=pD;Un.getControlPosition=vD;Un.snapToGrid=mD;var Kt=Fn,ni=Ue;function pD(t,e,n){if(!t.props.bounds)return[e,n];let{bounds:r}=t.props;r=typeof r=="string"?r:wD(r);const s=zp(t);if(typeof r=="string"){const{ownerDocument:i}=s,o=i.defaultView;let l;if(r==="parent"?l=s.parentNode:l=i.querySelector(r),!(l instanceof o.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const u=l,d=o.getComputedStyle(s),h=o.getComputedStyle(u);r={left:-s.offsetLeft+(0,Kt.int)(h.paddingLeft)+(0,Kt.int)(d.marginLeft),top:-s.offsetTop+(0,Kt.int)(h.paddingTop)+(0,Kt.int)(d.marginTop),right:(0,ni.innerWidth)(u)-(0,ni.outerWidth)(s)-s.offsetLeft+(0,Kt.int)(h.paddingRight)-(0,Kt.int)(d.marginRight),bottom:(0,ni.innerHeight)(u)-(0,ni.outerHeight)(s)-s.offsetTop+(0,Kt.int)(h.paddingBottom)-(0,Kt.int)(d.marginBottom)}}return(0,Kt.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,Kt.isNum)(r.bottom)&&(n=Math.min(n,r.bottom)),(0,Kt.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,Kt.isNum)(r.top)&&(n=Math.max(n,r.top)),[e,n]}function mD(t,e,n){const r=Math.round(e/t[0])*t[0],s=Math.round(n/t[1])*t[1];return[r,s]}function gD(t){return t.props.axis==="both"||t.props.axis==="x"}function yD(t){return t.props.axis==="both"||t.props.axis==="y"}function vD(t,e,n){const r=typeof e=="number"?(0,ni.getTouch)(t,e):null;if(typeof e=="number"&&!r)return null;const s=zp(n),i=n.props.offsetParent||s.offsetParent||s.ownerDocument.body;return(0,ni.offsetXYFromParent)(r||t,i,n.props.scale)}function _D(t,e,n){const r=!(0,Kt.isNum)(t.lastX),s=zp(t);return r?{node:s,deltaX:0,deltaY:0,lastX:e,lastY:n,x:e,y:n}:{node:s,deltaX:e-t.lastX,deltaY:n-t.lastY,lastX:t.lastX,lastY:t.lastY,x:e,y:n}}function xD(t,e){const n=t.props.scale;return{node:e.node,x:t.state.x+e.deltaX/n,y:t.state.y+e.deltaY/n,deltaX:e.deltaX/n,deltaY:e.deltaY/n,lastX:t.state.x,lastY:t.state.y}}function wD(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function zp(t){const e=t.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var fc={},pc={};Object.defineProperty(pc,"__esModule",{value:!0});pc.default=ED;function ED(){}Object.defineProperty(fc,"__esModule",{value:!0});fc.default=void 0;var wd=SD(V),Mt=Bp(dE),bD=Bp(ga),wt=Ue,yr=Un,Ed=Fn,co=Bp(pc);function Bp(t){return t&&t.__esModule?t:{default:t}}function _E(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(_E=function(r){return r?n:e})(t)}function SD(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=_E(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}function Rt(t,e,n){return e=TD(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TD(t){var e=ID(t,"string");return typeof e=="symbol"?e:String(e)}function ID(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gn={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let vr=gn.mouse,mc=class extends wd.Component{constructor(){super(...arguments),Rt(this,"dragging",!1),Rt(this,"lastX",NaN),Rt(this,"lastY",NaN),Rt(this,"touchIdentifier",null),Rt(this,"mounted",!1),Rt(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=n;if(this.props.disabled||!(e.target instanceof r.defaultView.Node)||this.props.handle&&!(0,wt.matchesSelectorAndParentsTo)(e.target,this.props.handle,n)||this.props.cancel&&(0,wt.matchesSelectorAndParentsTo)(e.target,this.props.cancel,n))return;e.type==="touchstart"&&e.preventDefault();const s=(0,wt.getTouchIdentifier)(e);this.touchIdentifier=s;const i=(0,yr.getControlPosition)(e,s,this);if(i==null)return;const{x:o,y:l}=i,u=(0,yr.createCoreData)(this,o,l);(0,co.default)("DraggableCore: handleDragStart: %j",u),(0,co.default)("calling",this.props.onStart),!(this.props.onStart(e,u)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,wt.addUserSelectStyles)(r),this.dragging=!0,this.lastX=o,this.lastY=l,(0,wt.addEvent)(r,vr.move,this.handleDrag),(0,wt.addEvent)(r,vr.stop,this.handleDragStop))}),Rt(this,"handleDrag",e=>{const n=(0,yr.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:s}=n;if(Array.isArray(this.props.grid)){let l=r-this.lastX,u=s-this.lastY;if([l,u]=(0,yr.snapToGrid)(this.props.grid,l,u),!l&&!u)return;r=this.lastX+l,s=this.lastY+u}const i=(0,yr.createCoreData)(this,r,s);if((0,co.default)("DraggableCore: handleDrag: %j",i),this.props.onDrag(e,i)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const u=document.createEvent("MouseEvents");u.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(u)}return}this.lastX=r,this.lastY=s}),Rt(this,"handleDragStop",e=>{if(!this.dragging)return;const n=(0,yr.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:s}=n;if(Array.isArray(this.props.grid)){let u=r-this.lastX||0,d=s-this.lastY||0;[u,d]=(0,yr.snapToGrid)(this.props.grid,u,d),r=this.lastX+u,s=this.lastY+d}const i=(0,yr.createCoreData)(this,r,s);if(this.props.onStop(e,i)===!1||this.mounted===!1)return!1;const l=this.findDOMNode();l&&this.props.enableUserSelectHack&&(0,wt.removeUserSelectStyles)(l.ownerDocument),(0,co.default)("DraggableCore: handleDragStop: %j",i),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,l&&((0,co.default)("DraggableCore: Removing handlers"),(0,wt.removeEvent)(l.ownerDocument,vr.move,this.handleDrag),(0,wt.removeEvent)(l.ownerDocument,vr.stop,this.handleDragStop))}),Rt(this,"onMouseDown",e=>(vr=gn.mouse,this.handleDragStart(e))),Rt(this,"onMouseUp",e=>(vr=gn.mouse,this.handleDragStop(e))),Rt(this,"onTouchStart",e=>(vr=gn.touch,this.handleDragStart(e))),Rt(this,"onTouchEnd",e=>(vr=gn.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,wt.addEvent)(e,gn.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:n}=e;(0,wt.removeEvent)(n,gn.mouse.move,this.handleDrag),(0,wt.removeEvent)(n,gn.touch.move,this.handleDrag),(0,wt.removeEvent)(n,gn.mouse.stop,this.handleDragStop),(0,wt.removeEvent)(n,gn.touch.stop,this.handleDragStop),(0,wt.removeEvent)(e,gn.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,wt.removeUserSelectStyles)(n)}}findDOMNode(){var e,n;return(e=this.props)!==null&&e!==void 0&&e.nodeRef?(n=this.props)===null||n===void 0||(n=n.nodeRef)===null||n===void 0?void 0:n.current:bD.default.findDOMNode(this)}render(){return wd.cloneElement(wd.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};fc.default=mc;Rt(mc,"displayName","DraggableCore");Rt(mc,"propTypes",{allowAnyClick:Mt.default.bool,children:Mt.default.node.isRequired,disabled:Mt.default.bool,enableUserSelectHack:Mt.default.bool,offsetParent:function(t,e){if(t[e]&&t[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Mt.default.arrayOf(Mt.default.number),handle:Mt.default.string,cancel:Mt.default.string,nodeRef:Mt.default.object,onStart:Mt.default.func,onDrag:Mt.default.func,onStop:Mt.default.func,onMouseDown:Mt.default.func,scale:Mt.default.number,className:Ed.dontSetMe,style:Ed.dontSetMe,transform:Ed.dontSetMe});Rt(mc,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var e=y(V),n=h(dE),r=h(ga),s=h(Wk),i=Ue,o=Un,l=Fn,u=h(fc),d=h(pc);function h(E){return E&&E.__esModule?E:{default:E}}function g(E){if(typeof WeakMap!="function")return null;var v=new WeakMap,S=new WeakMap;return(g=function(P){return P?S:v})(E)}function y(E,v){if(E&&E.__esModule)return E;if(E===null||typeof E!="object"&&typeof E!="function")return{default:E};var S=g(v);if(S&&S.has(E))return S.get(E);var P={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in E)if(_!=="default"&&Object.prototype.hasOwnProperty.call(E,_)){var p=I?Object.getOwnPropertyDescriptor(E,_):null;p&&(p.get||p.set)?Object.defineProperty(P,_,p):P[_]=E[_]}return P.default=E,S&&S.set(E,P),P}function C(){return C=Object.assign?Object.assign.bind():function(E){for(var v=1;v<arguments.length;v++){var S=arguments[v];for(var P in S)Object.prototype.hasOwnProperty.call(S,P)&&(E[P]=S[P])}return E},C.apply(this,arguments)}function k(E,v,S){return v=w(v),v in E?Object.defineProperty(E,v,{value:S,enumerable:!0,configurable:!0,writable:!0}):E[v]=S,E}function w(E){var v=N(E,"string");return typeof v=="symbol"?v:String(v)}function N(E,v){if(typeof E!="object"||E===null)return E;var S=E[Symbol.toPrimitive];if(S!==void 0){var P=S.call(E,v);if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(v==="string"?String:Number)(E)}class b extends e.Component{static getDerivedStateFromProps(v,S){let{position:P}=v,{prevPropsPosition:I}=S;return P&&(!I||P.x!==I.x||P.y!==I.y)?((0,d.default)("Draggable: getDerivedStateFromProps %j",{position:P,prevPropsPosition:I}),{x:P.x,y:P.y,prevPropsPosition:{...P}}):null}constructor(v){super(v),k(this,"onDragStart",(S,P)=>{if((0,d.default)("Draggable: onDragStart: %j",P),this.props.onStart(S,(0,o.createDraggableData)(this,P))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),k(this,"onDrag",(S,P)=>{if(!this.state.dragging)return!1;(0,d.default)("Draggable: onDrag: %j",P);const I=(0,o.createDraggableData)(this,P),_={x:I.x,y:I.y,slackX:0,slackY:0};if(this.props.bounds){const{x,y:A}=_;_.x+=this.state.slackX,_.y+=this.state.slackY;const[D,j]=(0,o.getBoundPosition)(this,_.x,_.y);_.x=D,_.y=j,_.slackX=this.state.slackX+(x-_.x),_.slackY=this.state.slackY+(A-_.y),I.x=_.x,I.y=_.y,I.deltaX=_.x-this.state.x,I.deltaY=_.y-this.state.y}if(this.props.onDrag(S,I)===!1)return!1;this.setState(_)}),k(this,"onDragStop",(S,P)=>{if(!this.state.dragging||this.props.onStop(S,(0,o.createDraggableData)(this,P))===!1)return!1;(0,d.default)("Draggable: onDragStop: %j",P);const _={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x,y:A}=this.props.position;_.x=x,_.y=A}this.setState(_)}),this.state={dragging:!1,dragged:!1,x:v.position?v.position.x:v.defaultPosition.x,y:v.position?v.position.y:v.defaultPosition.y,prevPropsPosition:{...v.position},slackX:0,slackY:0,isElementSVG:!1},v.position&&!(v.onDrag||v.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var v,S;return(v=(S=this.props)===null||S===void 0||(S=S.nodeRef)===null||S===void 0?void 0:S.current)!==null&&v!==void 0?v:r.default.findDOMNode(this)}render(){const{axis:v,bounds:S,children:P,defaultPosition:I,defaultClassName:_,defaultClassNameDragging:p,defaultClassNameDragged:x,position:A,positionOffset:D,scale:j,...R}=this.props;let q={},ne=null;const re=!!!A||this.state.dragging,z=A||I,K={x:(0,o.canDragX)(this)&&re?this.state.x:z.x,y:(0,o.canDragY)(this)&&re?this.state.y:z.y};this.state.isElementSVG?ne=(0,i.createSVGTransform)(K,D):q=(0,i.createCSSTransform)(K,D);const Q=(0,s.default)(P.props.className||"",_,{[p]:this.state.dragging,[x]:this.state.dragged});return e.createElement(u.default,C({},R,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(P),{className:Q,style:{...P.props.style,...q},transform:ne}))}}t.default=b,k(b,"displayName","Draggable"),k(b,"propTypes",{...u.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),k(b,"defaultProps",{...u.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(aE);const{default:xE,DraggableCore:CD}=aE;hc.exports=xE;hc.exports.default=xE;hc.exports.DraggableCore=CD;var AD=hc.exports;const PD=Bh(AD);var We=function(){return We=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},We.apply(this,arguments)},pv={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},mv={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},ml={width:"20px",height:"20px",position:"absolute",zIndex:1},RD={top:We(We({},pv),{top:"-5px"}),right:We(We({},mv),{left:void 0,right:"-5px"}),bottom:We(We({},pv),{top:void 0,bottom:"-5px"}),left:We(We({},mv),{left:"-5px"}),topRight:We(We({},ml),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:We(We({},ml),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:We(We({},ml),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:We(We({},ml),{left:"-10px",top:"-10px",cursor:"nw-resize"})},ND=V.memo(function(t){var e=t.onResizeStart,n=t.direction,r=t.children,s=t.replaceStyles,i=t.className,o=V.useCallback(function(d){e(d,n)},[e,n]),l=V.useCallback(function(d){e(d,n)},[e,n]),u=V.useMemo(function(){return We(We({position:"absolute",userSelect:"none"},RD[n]),s??{})},[s,n]);return c.jsx("div",{className:i||void 0,style:u,onMouseDown:o,onTouchStart:l,children:r})}),kD=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rn=function(){return Rn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Rn.apply(this,arguments)},DD={width:"auto",height:"auto"},gl=function(t,e,n){return Math.max(Math.min(t,n),e)},gv=function(t,e,n){var r=Math.round(t/e);return r*e+n*(r-1)},Fs=function(t,e){return new RegExp(t,"i").test(e)},yl=function(t){return!!(t.touches&&t.touches.length)},jD=function(t){return!!((t.clientX||t.clientX===0)&&(t.clientY||t.clientY===0))},yv=function(t,e,n){n===void 0&&(n=0);var r=e.reduce(function(i,o,l){return Math.abs(o-t)<Math.abs(e[i]-t)?l:i},0),s=Math.abs(e[r]-t);return n===0||s<n?e[r]:t},bd=function(t){return t=t.toString(),t==="auto"||t.endsWith("px")||t.endsWith("%")||t.endsWith("vh")||t.endsWith("vw")||t.endsWith("vmax")||t.endsWith("vmin")?t:"".concat(t,"px")},vl=function(t,e,n,r){if(t&&typeof t=="string"){if(t.endsWith("px"))return Number(t.replace("px",""));if(t.endsWith("%")){var s=Number(t.replace("%",""))/100;return e*s}if(t.endsWith("vw")){var s=Number(t.replace("vw",""))/100;return n*s}if(t.endsWith("vh")){var s=Number(t.replace("vh",""))/100;return r*s}}return t},OD=function(t,e,n,r,s,i,o){return r=vl(r,t.width,e,n),s=vl(s,t.height,e,n),i=vl(i,t.width,e,n),o=vl(o,t.height,e,n),{maxWidth:typeof r>"u"?void 0:Number(r),maxHeight:typeof s>"u"?void 0:Number(s),minWidth:typeof i>"u"?void 0:Number(i),minHeight:typeof o>"u"?void 0:Number(o)}},VD=function(t){return Array.isArray(t)?t:[t,t]},MD=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],vv="__resizable_base__",LD=function(t){kD(e,t);function e(n){var r,s,i,o,l=t.call(this,n)||this;return l.ratio=1,l.resizable=null,l.parentLeft=0,l.parentTop=0,l.resizableLeft=0,l.resizableRight=0,l.resizableTop=0,l.resizableBottom=0,l.targetLeft=0,l.targetTop=0,l.delta={width:0,height:0},l.appendBase=function(){if(!l.resizable||!l.window)return null;var u=l.parentNode;if(!u)return null;var d=l.window.document.createElement("div");return d.style.width="100%",d.style.height="100%",d.style.position="absolute",d.style.transform="scale(0, 0)",d.style.left="0",d.style.flex="0 0 100%",d.classList?d.classList.add(vv):d.className+=vv,u.appendChild(d),d},l.removeBase=function(u){var d=l.parentNode;d&&d.removeChild(u)},l.state={isResizing:!1,width:(s=(r=l.propsSize)===null||r===void 0?void 0:r.width)!==null&&s!==void 0?s:"auto",height:(o=(i=l.propsSize)===null||i===void 0?void 0:i.height)!==null&&o!==void 0?o:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},l.onResizeStart=l.onResizeStart.bind(l),l.onMouseMove=l.onMouseMove.bind(l),l.onMouseUp=l.onMouseUp.bind(l),l}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||DD},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var n=0,r=0;if(this.resizable&&this.window){var s=this.resizable.offsetWidth,i=this.resizable.offsetHeight,o=this.resizable.style.position;o!=="relative"&&(this.resizable.style.position="relative"),n=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:s,r=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:i,this.resizable.style.position=o}return{width:n,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sizeStyle",{get:function(){var n=this,r=this.props.size,s=function(l){var u;if(typeof n.state[l]>"u"||n.state[l]==="auto")return"auto";if(n.propsSize&&n.propsSize[l]&&(!((u=n.propsSize[l])===null||u===void 0)&&u.toString().endsWith("%"))){if(n.state[l].toString().endsWith("%"))return n.state[l].toString();var d=n.getParentSize(),h=Number(n.state[l].toString().replace("px","")),g=h/d[l]*100;return"".concat(g,"%")}return bd(n.state[l])},i=r&&typeof r.width<"u"&&!this.state.isResizing?bd(r.width):s("width"),o=r&&typeof r.height<"u"&&!this.state.isResizing?bd(r.height):s("height");return{width:i,height:o}},enumerable:!1,configurable:!0}),e.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var n=this.appendBase();if(!n)return{width:0,height:0};var r=!1,s=this.parentNode.style.flexWrap;s!=="wrap"&&(r=!0,this.parentNode.style.flexWrap="wrap"),n.style.position="relative",n.style.minWidth="100%",n.style.minHeight="100%";var i={width:n.offsetWidth,height:n.offsetHeight};return r&&(this.parentNode.style.flexWrap=s),this.removeBase(n),i},e.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},e.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},e.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var n=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:n.flexBasis!=="auto"?n.flexBasis:void 0})}},e.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},e.prototype.createSizeForCssProperty=function(n,r){var s=this.propsSize&&this.propsSize[r];return this.state[r]==="auto"&&this.state.original[r]===n&&(typeof s>"u"||s==="auto")?"auto":n},e.prototype.calculateNewMaxFromBoundary=function(n,r){var s=this.props.boundsByDirection,i=this.state.direction,o=s&&Fs("left",i),l=s&&Fs("top",i),u,d;if(this.props.bounds==="parent"){var h=this.parentNode;h&&(u=o?this.resizableRight-this.parentLeft:h.offsetWidth+(this.parentLeft-this.resizableLeft),d=l?this.resizableBottom-this.parentTop:h.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(u=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,d=l?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(u=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),d=l?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return u&&Number.isFinite(u)&&(n=n&&n<u?n:u),d&&Number.isFinite(d)&&(r=r&&r<d?r:d),{maxWidth:n,maxHeight:r}},e.prototype.calculateNewSizeFromDirection=function(n,r){var s=this.props.scale||1,i=VD(this.props.resizeRatio||1),o=i[0],l=i[1],u=this.state,d=u.direction,h=u.original,g=this.props,y=g.lockAspectRatio,C=g.lockAspectRatioExtraHeight,k=g.lockAspectRatioExtraWidth,w=h.width,N=h.height,b=C||0,E=k||0;return Fs("right",d)&&(w=h.width+(n-h.x)*o/s,y&&(N=(w-E)/this.ratio+b)),Fs("left",d)&&(w=h.width-(n-h.x)*o/s,y&&(N=(w-E)/this.ratio+b)),Fs("bottom",d)&&(N=h.height+(r-h.y)*l/s,y&&(w=(N-b)*this.ratio+E)),Fs("top",d)&&(N=h.height-(r-h.y)*l/s,y&&(w=(N-b)*this.ratio+E)),{newWidth:w,newHeight:N}},e.prototype.calculateNewSizeFromAspectRatio=function(n,r,s,i){var o=this.props,l=o.lockAspectRatio,u=o.lockAspectRatioExtraHeight,d=o.lockAspectRatioExtraWidth,h=typeof i.width>"u"?10:i.width,g=typeof s.width>"u"||s.width<0?n:s.width,y=typeof i.height>"u"?10:i.height,C=typeof s.height>"u"||s.height<0?r:s.height,k=u||0,w=d||0;if(l){var N=(y-k)*this.ratio+w,b=(C-k)*this.ratio+w,E=(h-w)/this.ratio+k,v=(g-w)/this.ratio+k,S=Math.max(h,N),P=Math.min(g,b),I=Math.max(y,E),_=Math.min(C,v);n=gl(n,S,P),r=gl(r,I,_)}else n=gl(n,h,g),r=gl(r,y,C);return{newWidth:n,newHeight:r}},e.prototype.setBoundingClientRect=function(){var n=1/(this.props.scale||1);if(this.props.bounds==="parent"){var r=this.parentNode;if(r){var s=r.getBoundingClientRect();this.parentLeft=s.left*n,this.parentTop=s.top*n}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left*n,this.targetTop=i.top*n}if(this.resizable){var o=this.resizable.getBoundingClientRect(),l=o.left,u=o.top,d=o.right,h=o.bottom;this.resizableLeft=l*n,this.resizableRight=d*n,this.resizableTop=u*n,this.resizableBottom=h*n}},e.prototype.onResizeStart=function(n,r){if(!(!this.resizable||!this.window)){var s=0,i=0;if(n.nativeEvent&&jD(n.nativeEvent)?(s=n.nativeEvent.clientX,i=n.nativeEvent.clientY):n.nativeEvent&&yl(n.nativeEvent)&&(s=n.nativeEvent.touches[0].clientX,i=n.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var o=this.props.onResizeStart(n,r,this.resizable);if(o===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var l,u=this.window.getComputedStyle(this.resizable);if(u.flexBasis!=="auto"){var d=this.parentNode;if(d){var h=this.window.getComputedStyle(d).flexDirection;this.flexDir=h.startsWith("row")?"row":"column",l=u.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var g={original:{x:s,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:Rn(Rn({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(n.target).cursor||"auto"}),direction:r,flexBasis:l};this.setState(g)}},e.prototype.onMouseMove=function(n){var r=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&yl(n))try{n.preventDefault(),n.stopPropagation()}catch{}var s=this.props,i=s.maxWidth,o=s.maxHeight,l=s.minWidth,u=s.minHeight,d=yl(n)?n.touches[0].clientX:n.clientX,h=yl(n)?n.touches[0].clientY:n.clientY,g=this.state,y=g.direction,C=g.original,k=g.width,w=g.height,N=this.getParentSize(),b=OD(N,this.window.innerWidth,this.window.innerHeight,i,o,l,u);i=b.maxWidth,o=b.maxHeight,l=b.minWidth,u=b.minHeight;var E=this.calculateNewSizeFromDirection(d,h),v=E.newHeight,S=E.newWidth,P=this.calculateNewMaxFromBoundary(i,o);this.props.snap&&this.props.snap.x&&(S=yv(S,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(v=yv(v,this.props.snap.y,this.props.snapGap));var I=this.calculateNewSizeFromAspectRatio(S,v,{width:P.maxWidth,height:P.maxHeight},{width:l,height:u});if(S=I.newWidth,v=I.newHeight,this.props.grid){var _=gv(S,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),p=gv(v,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),x=this.props.snapGap||0,A=x===0||Math.abs(_-S)<=x?_:S,D=x===0||Math.abs(p-v)<=x?p:v;S=A,v=D}var j={width:S-C.width,height:v-C.height};if(this.delta=j,k&&typeof k=="string"){if(k.endsWith("%")){var R=S/N.width*100;S="".concat(R,"%")}else if(k.endsWith("vw")){var q=S/this.window.innerWidth*100;S="".concat(q,"vw")}else if(k.endsWith("vh")){var ne=S/this.window.innerHeight*100;S="".concat(ne,"vh")}}if(w&&typeof w=="string"){if(w.endsWith("%")){var R=v/N.height*100;v="".concat(R,"%")}else if(w.endsWith("vw")){var q=v/this.window.innerWidth*100;v="".concat(q,"vw")}else if(w.endsWith("vh")){var ne=v/this.window.innerHeight*100;v="".concat(ne,"vh")}}var ae={width:this.createSizeForCssProperty(S,"width"),height:this.createSizeForCssProperty(v,"height")};this.flexDir==="row"?ae.flexBasis=ae.width:this.flexDir==="column"&&(ae.flexBasis=ae.height);var re=this.state.width!==ae.width,z=this.state.height!==ae.height,K=this.state.flexBasis!==ae.flexBasis,Q=re||z||K;Q&&ga.flushSync(function(){r.setState(ae)}),this.props.onResize&&Q&&this.props.onResize(n,y,this.resizable,j)}},e.prototype.onMouseUp=function(n){var r,s,i=this.state,o=i.isResizing,l=i.direction;i.original,!(!o||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(n,l,this.resizable,this.delta),this.props.size&&this.setState({width:(r=this.props.size.width)!==null&&r!==void 0?r:"auto",height:(s=this.props.size.height)!==null&&s!==void 0?s:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:Rn(Rn({},this.state.backgroundStyle),{cursor:"auto"})}))},e.prototype.updateSize=function(n){var r,s;this.setState({width:(r=n.width)!==null&&r!==void 0?r:"auto",height:(s=n.height)!==null&&s!==void 0?s:"auto"})},e.prototype.renderResizer=function(){var n=this,r=this.props,s=r.enable,i=r.handleStyles,o=r.handleClasses,l=r.handleWrapperStyle,u=r.handleWrapperClass,d=r.handleComponent;if(!s)return null;var h=Object.keys(s).map(function(g){return s[g]!==!1?c.jsx(ND,{direction:g,onResizeStart:n.onResizeStart,replaceStyles:i&&i[g],className:o&&o[g],children:d&&d[g]?d[g]:null},g):null});return c.jsx("div",{className:u,style:l,children:h})},e.prototype.render=function(){var n=this,r=Object.keys(this.props).reduce(function(o,l){return MD.indexOf(l)!==-1||(o[l]=n.props[l]),o},{}),s=Rn(Rn(Rn({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(s.flexBasis=this.state.flexBasis);var i=this.props.as||"div";return c.jsxs(i,Rn({style:s,className:this.props.className},r,{ref:function(o){o&&(n.resizable=o)},children:[this.state.isResizing&&c.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},e.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},e}(V.PureComponent);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var zh=function(t,e){return zh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},zh(t,e)};function FD(t,e){zh(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ye=function(){return Ye=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ye.apply(this,arguments)};function UD(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}var zD={width:"auto",height:"auto",display:"inline-block",position:"absolute",top:0,left:0},BD=function(t){return{bottom:t,bottomLeft:t,bottomRight:t,left:t,right:t,top:t,topLeft:t,topRight:t}},$D=function(t){FD(e,t);function e(n){var r=t.call(this,n)||this;return r.resizingPosition={x:0,y:0},r.offsetFromParent={left:0,top:0},r.resizableElement={current:null},r.originalPosition={x:0,y:0},r.state={resizing:!1,bounds:{top:0,right:0,bottom:0,left:0},maxWidth:n.maxWidth,maxHeight:n.maxHeight},r.onResizeStart=r.onResizeStart.bind(r),r.onResize=r.onResize.bind(r),r.onResizeStop=r.onResizeStop.bind(r),r.onDragStart=r.onDragStart.bind(r),r.onDrag=r.onDrag.bind(r),r.onDragStop=r.onDragStop.bind(r),r.getMaxSizesFromProps=r.getMaxSizesFromProps.bind(r),r}return e.prototype.componentDidMount=function(){this.updateOffsetFromParent();var n=this.offsetFromParent,r=n.left,s=n.top,i=this.getDraggablePosition(),o=i.x,l=i.y;this.draggable.setState({x:o-r,y:l-s}),this.forceUpdate()},e.prototype.getDraggablePosition=function(){var n=this.draggable.state,r=n.x,s=n.y;return{x:r,y:s}},e.prototype.getParent=function(){return this.resizable&&this.resizable.parentNode},e.prototype.getParentSize=function(){return this.resizable.getParentSize()},e.prototype.getMaxSizesFromProps=function(){var n=typeof this.props.maxWidth>"u"?Number.MAX_SAFE_INTEGER:this.props.maxWidth,r=typeof this.props.maxHeight>"u"?Number.MAX_SAFE_INTEGER:this.props.maxHeight;return{maxWidth:n,maxHeight:r}},e.prototype.getSelfElement=function(){return this.resizable&&this.resizable.resizable},e.prototype.getOffsetHeight=function(n){var r=this.props.scale;switch(this.props.bounds){case"window":return window.innerHeight/r;case"body":return document.body.offsetHeight/r;default:return n.offsetHeight}},e.prototype.getOffsetWidth=function(n){var r=this.props.scale;switch(this.props.bounds){case"window":return window.innerWidth/r;case"body":return document.body.offsetWidth/r;default:return n.offsetWidth}},e.prototype.onDragStart=function(n,r){this.props.onDragStart&&this.props.onDragStart(n,r);var s=this.getDraggablePosition();if(this.originalPosition=s,!!this.props.bounds){var i=this.getParent(),o=this.props.scale,l;if(this.props.bounds==="parent")l=i;else if(this.props.bounds==="body"){var u=i.getBoundingClientRect(),d=u.left,h=u.top,g=document.body.getBoundingClientRect(),y=-(d-i.offsetLeft*o-g.left)/o,C=-(h-i.offsetTop*o-g.top)/o,k=(document.body.offsetWidth-this.resizable.size.width*o)/o+y,w=(document.body.offsetHeight-this.resizable.size.height*o)/o+C;return this.setState({bounds:{top:C,right:k,bottom:w,left:y}})}else if(this.props.bounds==="window"){if(!this.resizable)return;var N=i.getBoundingClientRect(),b=N.left,E=N.top,v=-(b-i.offsetLeft*o)/o,S=-(E-i.offsetTop*o)/o,k=(window.innerWidth-this.resizable.size.width*o)/o+v,w=(window.innerHeight-this.resizable.size.height*o)/o+S;return this.setState({bounds:{top:S,right:k,bottom:w,left:v}})}else typeof this.props.bounds=="string"?l=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(l=this.props.bounds);if(!(!(l instanceof HTMLElement)||!(i instanceof HTMLElement))){var P=l.getBoundingClientRect(),I=P.left,_=P.top,p=i.getBoundingClientRect(),x=p.left,A=p.top,D=(I-x)/o,j=_-A;if(this.resizable){this.updateOffsetFromParent();var R=this.offsetFromParent;this.setState({bounds:{top:j-R.top,right:D+(l.offsetWidth-this.resizable.size.width)-R.left/o,bottom:j+(l.offsetHeight-this.resizable.size.height)-R.top,left:D-R.left/o}})}}}},e.prototype.onDrag=function(n,r){if(this.props.onDrag){var s=this.offsetFromParent,i=s.left,o=s.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDrag(n,Ye(Ye({},r),{x:r.x+i,y:r.y+o}));if(this.props.dragAxis==="x")return this.props.onDrag(n,Ye(Ye({},r),{x:r.x+i,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDrag(n,Ye(Ye({},r),{x:this.originalPosition.x+i,y:r.y+o,deltaX:0}))}},e.prototype.onDragStop=function(n,r){if(this.props.onDragStop){var s=this.offsetFromParent,i=s.left,o=s.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDragStop(n,Ye(Ye({},r),{x:r.x+i,y:r.y+o}));if(this.props.dragAxis==="x")return this.props.onDragStop(n,Ye(Ye({},r),{x:r.x+i,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDragStop(n,Ye(Ye({},r),{x:this.originalPosition.x+i,y:r.y+o,deltaX:0}))}},e.prototype.onResizeStart=function(n,r,s){n.stopPropagation(),this.setState({resizing:!0});var i=this.props.scale,o=this.offsetFromParent,l=this.getDraggablePosition();if(this.resizingPosition={x:l.x+o.left,y:l.y+o.top},this.originalPosition=l,this.props.bounds){var u=this.getParent(),d=void 0;this.props.bounds==="parent"?d=u:this.props.bounds==="body"?d=document.body:this.props.bounds==="window"?d=window:typeof this.props.bounds=="string"?d=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(d=this.props.bounds);var h=this.getSelfElement();if(h instanceof Element&&(d instanceof HTMLElement||d===window)&&u instanceof HTMLElement){var g=this.getMaxSizesFromProps(),y=g.maxWidth,C=g.maxHeight,k=this.getParentSize();if(y&&typeof y=="string")if(y.endsWith("%")){var w=Number(y.replace("%",""))/100;y=k.width*w}else y.endsWith("px")&&(y=Number(y.replace("px","")));if(C&&typeof C=="string")if(C.endsWith("%")){var w=Number(C.replace("%",""))/100;C=k.height*w}else C.endsWith("px")&&(C=Number(C.replace("px","")));var N=h.getBoundingClientRect(),b=N.left,E=N.top,v=this.props.bounds==="window"?{left:0,top:0}:d.getBoundingClientRect(),S=v.left,P=v.top,I=this.getOffsetWidth(d),_=this.getOffsetHeight(d),p=r.toLowerCase().endsWith("left"),x=r.toLowerCase().endsWith("right"),A=r.startsWith("top"),D=r.startsWith("bottom");if((p||A)&&this.resizable){var j=(b-S)/i+this.resizable.size.width;this.setState({maxWidth:j>Number(y)?y:j})}if(x||this.props.lockAspectRatio&&!p&&!A){var j=I+(S-b)/i;this.setState({maxWidth:j>Number(y)?y:j})}if((A||p)&&this.resizable){var j=(E-P)/i+this.resizable.size.height;this.setState({maxHeight:j>Number(C)?C:j})}if(D||this.props.lockAspectRatio&&!A&&!p){var j=_+(P-E)/i;this.setState({maxHeight:j>Number(C)?C:j})}}}else this.setState({maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight});this.props.onResizeStart&&this.props.onResizeStart(n,r,s)},e.prototype.onResize=function(n,r,s,i){var o=this,l={x:this.originalPosition.x,y:this.originalPosition.y},u=-i.width,d=-i.height,h=["top","left","topLeft","bottomLeft","topRight"];h.includes(r)&&(r==="bottomLeft"?l.x+=u:(r==="topRight"||(l.x+=u),l.y+=d));var g=this.draggable.state;(l.x!==g.x||l.y!==g.y)&&ga.flushSync(function(){o.draggable.setState(l)}),this.updateOffsetFromParent();var y=this.offsetFromParent,C=this.getDraggablePosition().x+y.left,k=this.getDraggablePosition().y+y.top;this.resizingPosition={x:C,y:k},this.props.onResize&&this.props.onResize(n,r,s,i,{x:C,y:k})},e.prototype.onResizeStop=function(n,r,s,i){this.setState({resizing:!1});var o=this.getMaxSizesFromProps(),l=o.maxWidth,u=o.maxHeight;this.setState({maxWidth:l,maxHeight:u}),this.props.onResizeStop&&this.props.onResizeStop(n,r,s,i,this.resizingPosition)},e.prototype.updateSize=function(n){this.resizable&&this.resizable.updateSize({width:n.width,height:n.height})},e.prototype.updatePosition=function(n){this.draggable.setState(n)},e.prototype.updateOffsetFromParent=function(){var n=this.props.scale,r=this.getParent(),s=this.getSelfElement();if(!r||s===null)return{top:0,left:0};var i=r.getBoundingClientRect(),o=i.left,l=i.top,u=s.getBoundingClientRect(),d=this.getDraggablePosition(),h=r.scrollLeft,g=r.scrollTop;this.offsetFromParent={left:u.left-o+h-d.x*n,top:u.top-l+g-d.y*n}},e.prototype.render=function(){var n=this,r=this.props,s=r.disableDragging,i=r.style,o=r.dragHandleClassName,l=r.position,u=r.onMouseDown,d=r.onMouseUp,h=r.dragAxis,g=r.dragGrid,y=r.bounds,C=r.enableUserSelectHack,k=r.cancel,w=r.children;r.onResizeStart,r.onResize,r.onResizeStop,r.onDragStart,r.onDrag,r.onDragStop;var N=r.resizeHandleStyles,b=r.resizeHandleClasses,E=r.resizeHandleComponent,v=r.enableResizing,S=r.resizeGrid,P=r.resizeHandleWrapperClass,I=r.resizeHandleWrapperStyle,_=r.scale,p=r.allowAnyClick,x=r.dragPositionOffset,A=UD(r,["disableDragging","style","dragHandleClassName","position","onMouseDown","onMouseUp","dragAxis","dragGrid","bounds","enableUserSelectHack","cancel","children","onResizeStart","onResize","onResizeStop","onDragStart","onDrag","onDragStop","resizeHandleStyles","resizeHandleClasses","resizeHandleComponent","enableResizing","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","scale","allowAnyClick","dragPositionOffset"]),D=this.props.default?Ye({},this.props.default):void 0;delete A.default;var j=s||o?{cursor:"auto"}:{cursor:"move"},R=Ye(Ye(Ye({},zD),j),i),q=this.offsetFromParent,ne=q.left,ae=q.top,re;l&&(re={x:l.x-ne,y:l.y-ae});var z=this.state.resizing?void 0:re,K=this.state.resizing?"both":h;return V.createElement(PD,{ref:function(Q){Q&&(n.draggable=Q)},handle:o?".".concat(o):void 0,defaultPosition:D,onMouseDown:u,onMouseUp:d,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,axis:K,disabled:s,grid:g,bounds:y?this.state.bounds:void 0,position:z,enableUserSelectHack:C,cancel:k,scale:_,allowAnyClick:p,nodeRef:this.resizableElement,positionOffset:x},V.createElement(LD,Ye({},A,{ref:function(Q){Q&&(n.resizable=Q,n.resizableElement.current=Q.resizable)},defaultSize:D,size:this.props.size,enable:typeof v=="boolean"?BD(v):v,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,style:R,minWidth:this.props.minWidth,minHeight:this.props.minHeight,maxWidth:this.state.resizing?this.state.maxWidth:this.props.maxWidth,maxHeight:this.state.resizing?this.state.maxHeight:this.props.maxHeight,grid:S,handleWrapperClass:P,handleWrapperStyle:I,lockAspectRatio:this.props.lockAspectRatio,lockAspectRatioExtraWidth:this.props.lockAspectRatioExtraWidth,lockAspectRatioExtraHeight:this.props.lockAspectRatioExtraHeight,handleStyles:N,handleClasses:b,handleComponent:E,scale:this.props.scale}),w))},e.defaultProps={maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,scale:1,onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},onDragStart:function(){},onDrag:function(){},onDragStop:function(){}},e}(V.PureComponent);const HD="/assets/storycraft-bg-classic-DHho0FOo.png",Au={input:{name:"Campo de Input (Texto)",color:"rgba(3, 169, 244, 0.4)",borderColor:"#03a9f4"},textarea:{name:"rea de Texto (Grande)",color:"rgba(76, 175, 80, 0.4)",borderColor:"#4caf50"},rollable:{name:"rea Clicvel (Roll)",color:"rgba(244, 67, 54, 0.4)",borderColor:"#f44336"},label:{name:"Texto Calculado (Label)",color:"rgba(255, 152, 0, 0.4)",borderColor:"#ff9800"},image:{name:"Zona de Imagem (Foto)",color:"rgba(156, 39, 176, 0.4)",borderColor:"#9c27b0"}},ho=827,fo=1170,WD=({id:t,data:e,onUpdate:n,onSelect:r,isSelected:s})=>{const{type:i,top:o,left:l,width:u,height:d}=e,h=Au[i]||Au.input,g={border:`2px solid ${s?h.borderColor:"transparent"}`,backgroundColor:h.color,boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontFamily:"monospace",fontSize:"12px",textShadow:"0 0 2px black"};return c.jsx($D,{style:g,size:{width:u,height:d},position:{x:l,y:o},onDragStart:r,onDragStop:(y,C)=>{n(t,{top:C.y,left:C.x})},onResizeStop:(y,C,k,w,N)=>{n(t,{width:parseInt(k.style.width,10),height:parseInt(k.style.height,10),...N})},onClick:y=>{y.stopPropagation(),r()},className:"z-10",children:t})},qD=({onBack:t})=>{const[e,n]=V.useState({}),[r,s]=V.useState(null),i=V.useRef(null),o=V.useMemo(()=>r?e[r]:null,[r,e]),l=w=>{if(!w)return;const N=prompt('Digite o ID nico para este elemento (ex: "name", "attr_for", "roll_des"):');if(N){if(e[N]){alert("Erro: Este ID j est em uso.");return}n(b=>({...b,[N]:{type:w,top:10,left:10,width:150,height:30}})),s(N)}},u=(w,N)=>{n(b=>({...b,[w]:{...b[w],...N}}))},d=w=>{if(!r)return;const{name:N,value:b}=w.target;u(r,{[N]:parseInt(b,10)||0})},h=w=>{const N=w.target.value.trim();if(!(!N||N===r)){if(e[N]){console.warn(`ID "${N}" j existe.`);return}n(b=>{const{[r]:E,...v}=b;return{...v,[N]:E}}),s(N)}},g=w=>{if(!r)return;const{value:N}=w.target;u(r,{type:N})},y=()=>{if(!r||!e[r])return;const w=e[r];let N=prompt("Digite o NOVO ID nico para a cpia:",`${r}_copia`);if(!N)return;for(;e[N];)if(alert(`Erro: O ID "${N}" j est em uso.`),N=prompt("Por favor, digite um ID DIFERENTE:",`${N}_2`),!N)return;const b={...w,top:w.top,left:w.left+20};n(E=>({...E,[N]:b})),s(N)},C=()=>{const w={};Object.entries(e).forEach(([S,P])=>{w[S]={type:P.type,top:P.top/fo*100,left:P.left/ho*100,width:P.width/ho*100,height:P.height/fo*100}});const N=JSON.stringify(w,null,2),b=new Blob([N],{type:"application/json"}),E=URL.createObjectURL(b),v=document.createElement("a");v.href=E,v.download="sheet_layout.json",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(E)},k=w=>{const N=w.target.files[0];if(!N)return;const b=new FileReader;b.onload=E=>{try{const v=JSON.parse(E.target.result),S={};Object.entries(v).forEach(([P,I])=>{if(!I.type||I.top==null)throw new Error(`Elemento "${P}"  invlido.`);S[P]={type:I.type,top:I.top/100*fo,left:I.left/100*ho,width:I.width/100*ho,height:I.height/100*fo}}),n(S)}catch(v){console.error("Erro ao importar JSON:",v),alert(`Arquivo JSON invlido: ${v.message}`)}},b.readAsText(N),w.target.value=null};return c.jsxs("div",{className:"w-full min-h-screen bg-gray-900 text-white",children:[c.jsx("input",{type:"file",ref:i,onChange:k,accept:".json",className:"hidden"}),c.jsxs("header",{className:"p-2 bg-gray-800 flex items-center gap-4 sticky top-0 z-50",children:[c.jsx("button",{onClick:t,className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 rounded",children:" Voltar"}),c.jsxs("select",{onChange:w=>{l(w.target.value),w.target.value=""},className:"bg-gray-700 text-white px-3 py-1 rounded",value:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Adicionar Zona..."}),Object.entries(Au).map(([w,N])=>c.jsx("option",{value:w,children:N.name},w))]}),c.jsx("button",{onClick:()=>i.current.click(),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded",children:"Importar JSON"}),c.jsx("button",{onClick:C,className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded",children:"Exportar JSON (%)"}),r&&c.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[c.jsx("button",{onClick:y,className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded",title:`Copiar ${r}`,children:"Copiar"}),c.jsx("button",{onClick:()=>{if(window.confirm(`Tem certeza que quer remover o elemento "${r}"?`)){const{[r]:w,...N}=e;n(N),s(null)}},className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded",title:`Remover ${r}`,children:"Remover"})]})]}),c.jsxs("div",{className:"flex",style:{height:"calc(100vh - 48px)"},children:[c.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-900",children:c.jsx("div",{className:"mx-auto",style:{position:"relative",width:`${ho}px`,height:`${fo}px`,backgroundImage:`url(${HD})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"},onClick:()=>s(null),children:Object.entries(e).map(([w,N])=>c.jsx(WD,{id:w,data:N,onUpdate:u,onSelect:()=>s(w),isSelected:w===r},w))})}),c.jsxs("aside",{className:"w-64 bg-gray-800 p-4 overflow-y-auto",children:[c.jsx("h2",{className:"text-lg font-bold mb-4",children:"Propriedades"}),o?c.jsxs("div",{className:"space-y-2",children:[c.jsxs("fieldset",{className:"border border-gray-600 p-2 rounded",children:[c.jsx("legend",{className:"text-sm px-1",children:"Elemento"}),c.jsx(po,{label:"ID",name:"id",value:r,onChange:h,onBlur:h,type:"text"}),c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("label",{htmlFor:"type",className:"text-sm text-gray-300",children:"Tipo:"}),c.jsx("select",{id:"type",name:"type",value:o.type,onChange:g,className:"w-2/3 p-1 rounded bg-gray-700 text-white",children:Object.entries(Au).map(([w,N])=>c.jsx("option",{value:w,children:N.name},w))})]})]}),c.jsxs("fieldset",{className:"border border-gray-600 p-2 rounded",children:[c.jsx("legend",{className:"text-sm px-1",children:"Posio (em pixels)"}),c.jsx(po,{label:"Top",name:"top",value:o.top,onChange:d}),c.jsx(po,{label:"Left",name:"left",value:o.left,onChange:d}),c.jsx(po,{label:"Width",name:"width",value:o.width,onChange:d}),c.jsx(po,{label:"Height",name:"height",value:o.height,onChange:d})]})]}):c.jsx("p",{className:"text-gray-400",children:"Selecione um elemento ou adicione uma nova zona."})]})]})]})},po=({label:t,name:e,value:n,onChange:r,onBlur:s,readOnly:i=!1,type:o="number"})=>c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsxs("label",{htmlFor:e,className:"text-sm text-gray-300",children:[t,":"]}),c.jsx("input",{type:o,id:e,name:e,value:n,onChange:r,onBlur:s,readOnly:i,className:`w-2/3 p-1 rounded ${i?"bg-gray-600 text-gray-400":"bg-gray-700 text-white"}`})]}),GD=({activeTheme:t,setActiveTheme:e,setPreviewTheme:n})=>{const{user:r,googleSignOut:s,isMaster:i}=Fe(),[o,l]=V.useState(null),[u,d]=V.useState([]),h=V.useRef(null),[g,y]=V.useState(!1),[C,k]=V.useState(!1),{currentSystem:w,setCurrentSystem:N,characterDataCollectionRoot:b,GLOBAL_APP_IDENTIFIER:E}=Rs(),[v,S]=V.useState({type:null,props:{}}),P=()=>S({type:null,props:{}}),I=R=>{l(R)},_=async()=>{if(r){console.log("%c[DIAGNSTICO DASHBOARD V2]","color: #f59e0b; font-weight: bold;",`Buscando fichas V2. isMaster: ${i}, viewingAll: ${g}`);const R=await Xw(b,r.uid,i&&g);d(R)}};V.useEffect(()=>{_()},[r,g,i,b]);const p=async()=>{await Jw(b,r.uid)&&_()},x=()=>{h.current.click()},A=R=>{const q=R.target.files[0];if(!q)return;const ne=new FileReader;ne.onload=ae=>{try{const re=JSON.parse(ae.target.result);if(!re.name)throw new Error("Ficheiro JSON invlido ou incompatvel.");S({type:"confirm",props:{message:`Deseja criar um novo personagem para o sistema ${w.toUpperCase()} com os dados de "${re.name}"?`,onConfirm:async()=>{const z=$t(Jt(Pe,`${b}/users/${r.uid}/characterSheets`)),K={...re,ownerUid:r.uid,system:w};delete K.id,await Ps(z,K),_(),P()},onCancel:P}})}catch(re){S({type:"info",props:{message:`Erro ao ler arquivo: ${re.message}`,onConfirm:P}})}},ne.readAsText(q),R.target.value=null},D=R=>{const q=R.ownerUid||r.uid;S({type:"confirm",props:{message:`Tem a certeza que deseja excluir permanentemente a ficha de "${R.name}" do sistema ${w.toUpperCase()}?`,onConfirm:async()=>{await Zw(b,q,R.id)?d(ae=>ae.filter(re=>re.id!==R.id)):alert("No foi possvel excluir a ficha."),P()},onCancel:P}})},j=c.jsx(iE,{onCharacterClick:I});return c.jsxs(c.Fragment,{children:[j,o?c.jsx(qD,{onBack:()=>l(null)}):c.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 md:p-8",children:[c.jsx(dc,{modalState:v,closeModal:P}),c.jsx("input",{type:"file",ref:h,onChange:A,accept:".json",className:"hidden"}),c.jsxs("header",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-textPrimary",children:"Painel StoryCraft V2 (Clssico)"}),c.jsxs("p",{className:"text-textSecondary",children:["Bem-vindo, ",r.displayName,"!"]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>N(null),className:"px-4 py-2 bg-bgElement hover:bg-opacity-80 text-textPrimary font-semibold rounded-lg shadow-lg",children:"Trocar Sistema"}),c.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg",children:"Sair"})]})]}),c.jsx("main",{children:c.jsx(Qw,{user:r,onSelectCharacter:l,handleImportClick:x,handleDeleteClick:D,handleCreateClick:p,characters:u,isMaster:i,viewingAll:g,onToggleView:y})})]})]})},KD=t=>{const{currentSystem:e,setCurrentSystem:n}=Rs();return e?c.jsxs(c.Fragment,{children:[e==="v1"&&c.jsx(Fk,{...t}),e==="v2"&&c.jsx(GD,{...t})]}):c.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-bgPage p-4",children:[c.jsx("h1",{className:"text-4xl font-bold text-textPrimary mb-10",children:"Selecione o Sistema"}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[c.jsxs("div",{onClick:()=>n("v1"),className:"bg-bgSurface border-2 border-borderAccent rounded-lg p-8 w-80 h-60 flex flex-col justify-center items-center text-center cursor-pointer transform hover:scale-105 transition-transform duration-300 shadow-lg",children:[c.jsx("h2",{className:"text-3xl font-bold text-textAccent mb-2",children:"StoryCraft V1"}),c.jsx("p",{className:"text-textSecondary",children:"A experincia clssica com temas personalizveis."})]}),c.jsxs("div",{onClick:()=>n("v2"),className:"bg-bgSurface border-2 border-borderAccent rounded-lg p-8 w-80 h-60 flex flex-col justify-center items-center text-center cursor-pointer transform hover:scale-105 transition-transform duration-300 shadow-lg",children:[c.jsx("h2",{className:"text-3xl font-bold text-textAccent mb-2",children:"StoryCraft V2"}),c.jsx("p",{className:"text-textSecondary",children:"O novo sistema com regras de Escala de Poder."})]})]})]})},QD=()=>{const{googleSignIn:t}=Fe(),[e,n]=V.useState(!1),[r,s]=V.useState(""),i=async()=>{n(!0),s("");try{await t()}catch(o){console.error("Erro ao fazer login com o Google:",o),o.code!=="auth/popup-closed-by-user"&&s("Ocorreu um erro ao tentar fazer login. Tente novamente.")}finally{n(!1)}};return c.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background p-4",children:c.jsxs("div",{className:"text-center max-w-md w-full",children:[c.jsx("h1",{className:"text-5xl font-bold text-primary mb-2",children:"StoryCraft V2"}),c.jsx("p",{className:"text-xl text-secondary mb-8",children:"Sua ficha de RPG, do seu jeito."}),c.jsx("button",{onClick:i,disabled:e,className:"px-8 py-4 bg-highlight hover:bg-opacity-80 text-primary font-bold rounded-lg shadow-lg text-lg transition-opacity duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e?"Carregando...":"Entrar com Google"}),r&&c.jsx("p",{className:"text-red-500 mt-4",children:r})]})})};function YD(t){if(!t)return"55, 65, 81";const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?`${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)}`:"55, 65, 81"}const XD=t=>{const e=document.documentElement;t?(e.style.setProperty("--background-image",t.backgroundImage||"none"),e.style.setProperty("--font-family",t.fontFamily||"ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb",YD(t.colors.bgSurface)),e.style.setProperty("--surface-opacity",(t.surfaceOpacity||80)/100),e.style.setProperty("--color-bgPage",t.colors.bgPage),e.style.setProperty("--color-bgElement",t.colors.bgElement),e.style.setProperty("--color-bgInput",t.colors.bgInput),e.style.setProperty("--color-textPrimary",t.colors.textPrimary),e.style.setProperty("--color-textSecondary",t.colors.textSecondary),e.style.setProperty("--color-borderAccent",t.colors.borderAccent),e.style.setProperty("--color-textAccent",t.colors.textAccent),e.style.setProperty("--color-btnHighlightBg",t.colors.btnHighlightBg),e.style.setProperty("--color-btnHighlightText",t.colors.btnHighlightText)):(e.style.setProperty("--background-image","none"),e.style.setProperty("--font-family","ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb","55, 65, 81"),e.style.setProperty("--surface-opacity","0.8"),e.style.setProperty("--color-bgPage","#111827"),e.style.setProperty("--color-bgElement","#374151"),e.style.setProperty("--color-bgInput","#4b5563"),e.style.setProperty("--color-textPrimary","#f9fafb"),e.style.setProperty("--color-textSecondary","#9ca3af"),e.style.setProperty("--color-borderAccent","#f59e0b"),e.style.setProperty("--color-textAccent","#fcd34d"),e.style.setProperty("--color-btnHighlightBg","#8b5cf6"),e.style.setProperty("--color-btnHighlightText","#ffffff"))};function JD(){const{user:t,loading:e}=Fe(),[n,r]=V.useState(null),[s,i]=V.useState(null);return V.useEffect(()=>{const o=s||n;XD(o?o.styles:null)},[n,s]),e?c.jsx("div",{className:"bg-bgPage text-textPrimary min-h-screen flex items-center justify-center",children:c.jsx("h1",{className:"text-3xl",children:"A carregar StoryCraft..."})}):c.jsxs("div",{className:"bg-bgPage bg-theme bg-cover bg-center bg-fixed text-textPrimary min-h-screen",children:[t?c.jsxs(c.Fragment,{children:[c.jsx(KD,{activeTheme:n,setActiveTheme:r,previewTheme:s,setPreviewTheme:i}),c.jsx(hk,{})," "]}):c.jsx(QD,{})," "]})}Sd.createRoot(document.getElementById("root")).render(c.jsx(Pv.StrictMode,{children:c.jsx(JN,{children:c.jsx(XN,{children:c.jsx(dk,{children:c.jsxs(s1,{children:[c.jsx(JD,{})," "]})})})})}));
