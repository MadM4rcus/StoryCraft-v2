(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function d0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dy={exports:{}},Wl={},hy={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jo=Symbol.for("react.element"),h0=Symbol.for("react.portal"),f0=Symbol.for("react.fragment"),p0=Symbol.for("react.strict_mode"),m0=Symbol.for("react.profiler"),g0=Symbol.for("react.provider"),y0=Symbol.for("react.context"),v0=Symbol.for("react.forward_ref"),_0=Symbol.for("react.suspense"),x0=Symbol.for("react.memo"),w0=Symbol.for("react.lazy"),Vp=Symbol.iterator;function E0(t){return t===null||typeof t!="object"?null:(t=Vp&&t[Vp]||t["@@iterator"],typeof t=="function"?t:null)}var fy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},py=Object.assign,my={};function ii(t,e,n){this.props=t,this.context=e,this.refs=my,this.updater=n||fy}ii.prototype.isReactComponent={};ii.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ii.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gy(){}gy.prototype=ii.prototype;function Gd(t,e,n){this.props=t,this.context=e,this.refs=my,this.updater=n||fy}var Qd=Gd.prototype=new gy;Qd.constructor=Gd;py(Qd,ii.prototype);Qd.isPureReactComponent=!0;var Op=Array.isArray,yy=Object.prototype.hasOwnProperty,Yd={current:null},vy={key:!0,ref:!0,__self:!0,__source:!0};function _y(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)yy.call(e,r)&&!vy.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:jo,type:t,key:i,ref:o,props:s,_owner:Yd.current}}function I0(t,e){return{$$typeof:jo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Xd(t){return typeof t=="object"&&t!==null&&t.$$typeof===jo}function T0(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Lp=/\/+/g;function Wu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?T0(""+t.key):e.toString(36)}function Oa(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case jo:case h0:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Wu(o,0):r,Op(s)?(n="",t!=null&&(n=t.replace(Lp,"$&/")+"/"),Oa(s,e,n,"",function(d){return d})):s!=null&&(Xd(s)&&(s=I0(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Lp,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Op(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Wu(i,l);o+=Oa(i,e,n,u,s)}else if(u=E0(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Wu(i,l++),o+=Oa(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function pa(t,e,n){if(t==null)return t;var r=[],s=0;return Oa(t,r,"","",function(i){return e.call(n,i,s++)}),r}function b0(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var wt={current:null},La={transition:null},S0={ReactCurrentDispatcher:wt,ReactCurrentBatchConfig:La,ReactCurrentOwner:Yd};function xy(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:pa,forEach:function(t,e,n){pa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return pa(t,function(){e++}),e},toArray:function(t){return pa(t,function(e){return e})||[]},only:function(t){if(!Xd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ae.Component=ii;ae.Fragment=f0;ae.Profiler=m0;ae.PureComponent=Gd;ae.StrictMode=p0;ae.Suspense=_0;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=S0;ae.act=xy;ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=py({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Yd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)yy.call(e,u)&&!vy.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:jo,type:t.type,key:s,ref:i,props:r,_owner:o}};ae.createContext=function(t){return t={$$typeof:y0,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:g0,_context:t},t.Consumer=t};ae.createElement=_y;ae.createFactory=function(t){var e=_y.bind(null,t);return e.type=t,e};ae.createRef=function(){return{current:null}};ae.forwardRef=function(t){return{$$typeof:v0,render:t}};ae.isValidElement=Xd;ae.lazy=function(t){return{$$typeof:w0,_payload:{_status:-1,_result:t},_init:b0}};ae.memo=function(t,e){return{$$typeof:x0,type:t,compare:e===void 0?null:e}};ae.startTransition=function(t){var e=La.transition;La.transition={};try{t()}finally{La.transition=e}};ae.unstable_act=xy;ae.useCallback=function(t,e){return wt.current.useCallback(t,e)};ae.useContext=function(t){return wt.current.useContext(t)};ae.useDebugValue=function(){};ae.useDeferredValue=function(t){return wt.current.useDeferredValue(t)};ae.useEffect=function(t,e){return wt.current.useEffect(t,e)};ae.useId=function(){return wt.current.useId()};ae.useImperativeHandle=function(t,e,n){return wt.current.useImperativeHandle(t,e,n)};ae.useInsertionEffect=function(t,e){return wt.current.useInsertionEffect(t,e)};ae.useLayoutEffect=function(t,e){return wt.current.useLayoutEffect(t,e)};ae.useMemo=function(t,e){return wt.current.useMemo(t,e)};ae.useReducer=function(t,e,n){return wt.current.useReducer(t,e,n)};ae.useRef=function(t){return wt.current.useRef(t)};ae.useState=function(t){return wt.current.useState(t)};ae.useSyncExternalStore=function(t,e,n){return wt.current.useSyncExternalStore(t,e,n)};ae.useTransition=function(){return wt.current.useTransition()};ae.version="18.3.1";hy.exports=ae;var L=hy.exports;const ql=d0(L);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C0=L,A0=Symbol.for("react.element"),P0=Symbol.for("react.fragment"),N0=Object.prototype.hasOwnProperty,R0=C0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,k0={key:!0,ref:!0,__self:!0,__source:!0};function wy(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)N0.call(e,r)&&!k0.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:A0,type:t,key:i,ref:o,props:s,_owner:R0.current}}Wl.Fragment=P0;Wl.jsx=wy;Wl.jsxs=wy;dy.exports=Wl;var c=dy.exports,Rc={},Ey={exports:{}},Lt={},Iy={exports:{}},Ty={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,Z){var ee=H.length;H.push(Z);e:for(;0<ee;){var z=ee-1>>>1,W=H[z];if(0<s(W,Z))H[z]=Z,H[ee]=W,ee=z;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Z=H[0],ee=H.pop();if(ee!==Z){H[0]=ee;e:for(var z=0,W=H.length,K=W>>>1;z<K;){var me=2*(z+1)-1,ge=H[me],ie=me+1,he=H[ie];if(0>s(ge,ee))ie<W&&0>s(he,ge)?(H[z]=he,H[ie]=ee,z=ie):(H[z]=ge,H[me]=ee,z=me);else if(ie<W&&0>s(he,ee))H[z]=he,H[ie]=ee,z=ie;else break e}}return Z}function s(H,Z){var ee=H.sortIndex-Z.sortIndex;return ee!==0?ee:H.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],p=1,g=null,m=3,E=!1,N=!1,S=!1,D=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(H){for(var Z=n(d);Z!==null;){if(Z.callback===null)r(d);else if(Z.startTime<=H)r(d),Z.sortIndex=Z.expirationTime,e(u,Z);else break;Z=n(d)}}function P(H){if(S=!1,C(H),!N)if(n(u)!==null)N=!0,X(R);else{var Z=n(d);Z!==null&&Fe(P,Z.startTime-H)}}function R(H,Z){N=!1,S&&(S=!1,T(y),y=-1),E=!0;var ee=m;try{for(C(Z),g=n(u);g!==null&&(!(g.expirationTime>Z)||H&&!_());){var z=g.callback;if(typeof z=="function"){g.callback=null,m=g.priorityLevel;var W=z(g.expirationTime<=Z);Z=t.unstable_now(),typeof W=="function"?g.callback=W:g===n(u)&&r(u),C(Z)}else r(u);g=n(u)}if(g!==null)var K=!0;else{var me=n(d);me!==null&&Fe(P,me.startTime-Z),K=!1}return K}finally{g=null,m=ee,E=!1}}var j=!1,v=null,y=-1,I=5,A=-1;function _(){return!(t.unstable_now()-A<I)}function k(){if(v!==null){var H=t.unstable_now();A=H;var Z=!0;try{Z=v(!0,H)}finally{Z?b():(j=!1,v=null)}}else j=!1}var b;if(typeof w=="function")b=function(){w(k)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,B=q.port2;q.port1.onmessage=k,b=function(){B.postMessage(null)}}else b=function(){D(k,0)};function X(H){v=H,j||(j=!0,b())}function Fe(H,Z){y=D(function(){H(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){N||E||(N=!0,X(R))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(H){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var ee=m;m=Z;try{return H()}finally{m=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,Z){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ee=m;m=H;try{return Z()}finally{m=ee}},t.unstable_scheduleCallback=function(H,Z,ee){var z=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?z+ee:z):ee=z,H){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=ee+W,H={id:p++,callback:Z,priorityLevel:H,startTime:ee,expirationTime:W,sortIndex:-1},ee>z?(H.sortIndex=ee,e(d,H),n(u)===null&&H===n(d)&&(S?(T(y),y=-1):S=!0,Fe(P,ee-z))):(H.sortIndex=W,e(u,H),N||E||(N=!0,X(R))),H},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(H){var Z=m;return function(){var ee=m;m=Z;try{return H.apply(this,arguments)}finally{m=ee}}}})(Ty);Iy.exports=Ty;var D0=Iy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j0=L,Ot=D0;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var by=new Set,io={};function os(t,e){zs(t,e),zs(t+"Capture",e)}function zs(t,e){for(io[t]=e,t=0;t<e.length;t++)by.add(e[t])}var Ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kc=Object.prototype.hasOwnProperty,V0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mp={},Fp={};function O0(t){return kc.call(Fp,t)?!0:kc.call(Mp,t)?!1:V0.test(t)?Fp[t]=!0:(Mp[t]=!0,!1)}function L0(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function M0(t,e,n,r){if(e===null||typeof e>"u"||L0(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Et(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rt[t]=new Et(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rt[e]=new Et(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rt[t]=new Et(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rt[t]=new Et(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rt[t]=new Et(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rt[t]=new Et(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rt[t]=new Et(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rt[t]=new Et(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rt[t]=new Et(t,5,!1,t.toLowerCase(),null,!1,!1)});var Jd=/[\-:]([a-z])/g;function Zd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Jd,Zd);rt[e]=new Et(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Jd,Zd);rt[e]=new Et(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Jd,Zd);rt[e]=new Et(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rt[t]=new Et(t,1,!1,t.toLowerCase(),null,!1,!1)});rt.xlinkHref=new Et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rt[t]=new Et(t,1,!1,t.toLowerCase(),null,!0,!0)});function eh(t,e,n,r){var s=rt.hasOwnProperty(e)?rt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(M0(e,n,s,r)&&(n=null),r||s===null?O0(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Wn=j0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ma=Symbol.for("react.element"),ws=Symbol.for("react.portal"),Es=Symbol.for("react.fragment"),th=Symbol.for("react.strict_mode"),Dc=Symbol.for("react.profiler"),Sy=Symbol.for("react.provider"),Cy=Symbol.for("react.context"),nh=Symbol.for("react.forward_ref"),jc=Symbol.for("react.suspense"),Vc=Symbol.for("react.suspense_list"),rh=Symbol.for("react.memo"),nr=Symbol.for("react.lazy"),Ay=Symbol.for("react.offscreen"),Up=Symbol.iterator;function Ci(t){return t===null||typeof t!="object"?null:(t=Up&&t[Up]||t["@@iterator"],typeof t=="function"?t:null)}var De=Object.assign,qu;function Oi(t){if(qu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qu=e&&e[1]||""}return`
`+qu+t}var Ku=!1;function Gu(t,e){if(!t||Ku)return"";Ku=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Ku=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oi(t):""}function F0(t){switch(t.tag){case 5:return Oi(t.type);case 16:return Oi("Lazy");case 13:return Oi("Suspense");case 19:return Oi("SuspenseList");case 0:case 2:case 15:return t=Gu(t.type,!1),t;case 11:return t=Gu(t.type.render,!1),t;case 1:return t=Gu(t.type,!0),t;default:return""}}function Oc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Es:return"Fragment";case ws:return"Portal";case Dc:return"Profiler";case th:return"StrictMode";case jc:return"Suspense";case Vc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Cy:return(t.displayName||"Context")+".Consumer";case Sy:return(t._context.displayName||"Context")+".Provider";case nh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case rh:return e=t.displayName||null,e!==null?e:Oc(t.type)||"Memo";case nr:e=t._payload,t=t._init;try{return Oc(t(e))}catch{}}return null}function U0(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oc(e);case 8:return e===th?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Tr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Py(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function B0(t){var e=Py(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ga(t){t._valueTracker||(t._valueTracker=B0(t))}function Ny(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Py(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Lc(t,e){var n=e.checked;return De({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Bp(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Tr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ry(t,e){e=e.checked,e!=null&&eh(t,"checked",e,!1)}function Mc(t,e){Ry(t,e);var n=Tr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Fc(t,e.type,n):e.hasOwnProperty("defaultValue")&&Fc(t,e.type,Tr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function $p(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Fc(t,e,n){(e!=="number"||sl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Li=Array.isArray;function Ds(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Tr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Uc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return De({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function zp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(Li(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Tr(n)}}function ky(t,e){var n=Tr(e.value),r=Tr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Hp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Dy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Dy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ya,jy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ya=ya||document.createElement("div"),ya.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ya.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function oo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Hi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$0=["Webkit","ms","Moz","O"];Object.keys(Hi).forEach(function(t){$0.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Hi[e]=Hi[t]})});function Vy(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Hi.hasOwnProperty(t)&&Hi[t]?(""+e).trim():e+"px"}function Oy(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Vy(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var z0=De({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $c(t,e){if(e){if(z0[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function zc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hc=null;function sh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Wc=null,js=null,Vs=null;function Wp(t){if(t=Lo(t)){if(typeof Wc!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Xl(e),Wc(t.stateNode,t.type,e))}}function Ly(t){js?Vs?Vs.push(t):Vs=[t]:js=t}function My(){if(js){var t=js,e=Vs;if(Vs=js=null,Wp(t),e)for(t=0;t<e.length;t++)Wp(e[t])}}function Fy(t,e){return t(e)}function Uy(){}var Qu=!1;function By(t,e,n){if(Qu)return t(e,n);Qu=!0;try{return Fy(t,e,n)}finally{Qu=!1,(js!==null||Vs!==null)&&(Uy(),My())}}function ao(t,e){var n=t.stateNode;if(n===null)return null;var r=Xl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var qc=!1;if(Ln)try{var Ai={};Object.defineProperty(Ai,"passive",{get:function(){qc=!0}}),window.addEventListener("test",Ai,Ai),window.removeEventListener("test",Ai,Ai)}catch{qc=!1}function H0(t,e,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(p){this.onError(p)}}var Wi=!1,il=null,ol=!1,Kc=null,W0={onError:function(t){Wi=!0,il=t}};function q0(t,e,n,r,s,i,o,l,u){Wi=!1,il=null,H0.apply(W0,arguments)}function K0(t,e,n,r,s,i,o,l,u){if(q0.apply(this,arguments),Wi){if(Wi){var d=il;Wi=!1,il=null}else throw Error(U(198));ol||(ol=!0,Kc=d)}}function as(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function $y(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function qp(t){if(as(t)!==t)throw Error(U(188))}function G0(t){var e=t.alternate;if(!e){if(e=as(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return qp(s),t;if(i===r)return qp(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function zy(t){return t=G0(t),t!==null?Hy(t):null}function Hy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Hy(t);if(e!==null)return e;t=t.sibling}return null}var Wy=Ot.unstable_scheduleCallback,Kp=Ot.unstable_cancelCallback,Q0=Ot.unstable_shouldYield,Y0=Ot.unstable_requestPaint,Me=Ot.unstable_now,X0=Ot.unstable_getCurrentPriorityLevel,ih=Ot.unstable_ImmediatePriority,qy=Ot.unstable_UserBlockingPriority,al=Ot.unstable_NormalPriority,J0=Ot.unstable_LowPriority,Ky=Ot.unstable_IdlePriority,Kl=null,hn=null;function Z0(t){if(hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(Kl,t,void 0,(t.current.flags&128)===128)}catch{}}var en=Math.clz32?Math.clz32:nE,eE=Math.log,tE=Math.LN2;function nE(t){return t>>>=0,t===0?32:31-(eE(t)/tE|0)|0}var va=64,_a=4194304;function Mi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ll(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Mi(l):(i&=o,i!==0&&(r=Mi(i)))}else o=n&~s,o!==0?r=Mi(o):i!==0&&(r=Mi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-en(e),s=1<<n,r|=t[n],e&=~s;return r}function rE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-en(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=rE(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Gc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Gy(){var t=va;return va<<=1,!(va&4194240)&&(va=64),t}function Yu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-en(e),t[e]=n}function iE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-en(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function oh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-en(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ye=0;function Qy(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Yy,ah,Xy,Jy,Zy,Qc=!1,xa=[],hr=null,fr=null,pr=null,lo=new Map,uo=new Map,sr=[],oE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gp(t,e){switch(t){case"focusin":case"focusout":hr=null;break;case"dragenter":case"dragleave":fr=null;break;case"mouseover":case"mouseout":pr=null;break;case"pointerover":case"pointerout":lo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":uo.delete(e.pointerId)}}function Pi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Lo(e),e!==null&&ah(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function aE(t,e,n,r,s){switch(e){case"focusin":return hr=Pi(hr,t,e,n,r,s),!0;case"dragenter":return fr=Pi(fr,t,e,n,r,s),!0;case"mouseover":return pr=Pi(pr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return lo.set(i,Pi(lo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,uo.set(i,Pi(uo.get(i)||null,t,e,n,r,s)),!0}return!1}function ev(t){var e=Br(t.target);if(e!==null){var n=as(e);if(n!==null){if(e=n.tag,e===13){if(e=$y(n),e!==null){t.blockedOn=e,Zy(t.priority,function(){Xy(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ma(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Yc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Hc=r,n.target.dispatchEvent(r),Hc=null}else return e=Lo(n),e!==null&&ah(e),t.blockedOn=n,!1;e.shift()}return!0}function Qp(t,e,n){Ma(t)&&n.delete(e)}function lE(){Qc=!1,hr!==null&&Ma(hr)&&(hr=null),fr!==null&&Ma(fr)&&(fr=null),pr!==null&&Ma(pr)&&(pr=null),lo.forEach(Qp),uo.forEach(Qp)}function Ni(t,e){t.blockedOn===e&&(t.blockedOn=null,Qc||(Qc=!0,Ot.unstable_scheduleCallback(Ot.unstable_NormalPriority,lE)))}function co(t){function e(s){return Ni(s,t)}if(0<xa.length){Ni(xa[0],t);for(var n=1;n<xa.length;n++){var r=xa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(hr!==null&&Ni(hr,t),fr!==null&&Ni(fr,t),pr!==null&&Ni(pr,t),lo.forEach(e),uo.forEach(e),n=0;n<sr.length;n++)r=sr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<sr.length&&(n=sr[0],n.blockedOn===null);)ev(n),n.blockedOn===null&&sr.shift()}var Os=Wn.ReactCurrentBatchConfig,ul=!0;function uE(t,e,n,r){var s=ye,i=Os.transition;Os.transition=null;try{ye=1,lh(t,e,n,r)}finally{ye=s,Os.transition=i}}function cE(t,e,n,r){var s=ye,i=Os.transition;Os.transition=null;try{ye=4,lh(t,e,n,r)}finally{ye=s,Os.transition=i}}function lh(t,e,n,r){if(ul){var s=Yc(t,e,n,r);if(s===null)oc(t,e,r,cl,n),Gp(t,r);else if(aE(s,t,e,n,r))r.stopPropagation();else if(Gp(t,r),e&4&&-1<oE.indexOf(t)){for(;s!==null;){var i=Lo(s);if(i!==null&&Yy(i),i=Yc(t,e,n,r),i===null&&oc(t,e,r,cl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else oc(t,e,r,null,n)}}var cl=null;function Yc(t,e,n,r){if(cl=null,t=sh(r),t=Br(t),t!==null)if(e=as(t),e===null)t=null;else if(n=e.tag,n===13){if(t=$y(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cl=t,null}function tv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(X0()){case ih:return 1;case qy:return 4;case al:case J0:return 16;case Ky:return 536870912;default:return 16}default:return 16}}var ur=null,uh=null,Fa=null;function nv(){if(Fa)return Fa;var t,e=uh,n=e.length,r,s="value"in ur?ur.value:ur.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Fa=s.slice(t,1<r?1-r:void 0)}function Ua(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function wa(){return!0}function Yp(){return!1}function Mt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?wa:Yp,this.isPropagationStopped=Yp,this}return De(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=wa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=wa)},persist:function(){},isPersistent:wa}),e}var oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ch=Mt(oi),Oo=De({},oi,{view:0,detail:0}),dE=Mt(Oo),Xu,Ju,Ri,Gl=De({},Oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ri&&(Ri&&t.type==="mousemove"?(Xu=t.screenX-Ri.screenX,Ju=t.screenY-Ri.screenY):Ju=Xu=0,Ri=t),Xu)},movementY:function(t){return"movementY"in t?t.movementY:Ju}}),Xp=Mt(Gl),hE=De({},Gl,{dataTransfer:0}),fE=Mt(hE),pE=De({},Oo,{relatedTarget:0}),Zu=Mt(pE),mE=De({},oi,{animationName:0,elapsedTime:0,pseudoElement:0}),gE=Mt(mE),yE=De({},oi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vE=Mt(yE),_E=De({},oi,{data:0}),Jp=Mt(_E),xE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=EE[t])?!!e[t]:!1}function dh(){return IE}var TE=De({},Oo,{key:function(t){if(t.key){var e=xE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ua(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dh,charCode:function(t){return t.type==="keypress"?Ua(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ua(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bE=Mt(TE),SE=De({},Gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zp=Mt(SE),CE=De({},Oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dh}),AE=Mt(CE),PE=De({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),NE=Mt(PE),RE=De({},Gl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),kE=Mt(RE),DE=[9,13,27,32],hh=Ln&&"CompositionEvent"in window,qi=null;Ln&&"documentMode"in document&&(qi=document.documentMode);var jE=Ln&&"TextEvent"in window&&!qi,rv=Ln&&(!hh||qi&&8<qi&&11>=qi),em=" ",tm=!1;function sv(t,e){switch(t){case"keyup":return DE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Is=!1;function VE(t,e){switch(t){case"compositionend":return iv(e);case"keypress":return e.which!==32?null:(tm=!0,em);case"textInput":return t=e.data,t===em&&tm?null:t;default:return null}}function OE(t,e){if(Is)return t==="compositionend"||!hh&&sv(t,e)?(t=nv(),Fa=uh=ur=null,Is=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rv&&e.locale!=="ko"?null:e.data;default:return null}}var LE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!LE[t.type]:e==="textarea"}function ov(t,e,n,r){Ly(r),e=dl(e,"onChange"),0<e.length&&(n=new ch("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ki=null,ho=null;function ME(t){yv(t,0)}function Ql(t){var e=Ss(t);if(Ny(e))return t}function FE(t,e){if(t==="change")return e}var av=!1;if(Ln){var ec;if(Ln){var tc="oninput"in document;if(!tc){var rm=document.createElement("div");rm.setAttribute("oninput","return;"),tc=typeof rm.oninput=="function"}ec=tc}else ec=!1;av=ec&&(!document.documentMode||9<document.documentMode)}function sm(){Ki&&(Ki.detachEvent("onpropertychange",lv),ho=Ki=null)}function lv(t){if(t.propertyName==="value"&&Ql(ho)){var e=[];ov(e,ho,t,sh(t)),By(ME,e)}}function UE(t,e,n){t==="focusin"?(sm(),Ki=e,ho=n,Ki.attachEvent("onpropertychange",lv)):t==="focusout"&&sm()}function BE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ql(ho)}function $E(t,e){if(t==="click")return Ql(e)}function zE(t,e){if(t==="input"||t==="change")return Ql(e)}function HE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sn=typeof Object.is=="function"?Object.is:HE;function fo(t,e){if(sn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!kc.call(e,s)||!sn(t[s],e[s]))return!1}return!0}function im(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function om(t,e){var n=im(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=im(n)}}function uv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?uv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function cv(){for(var t=window,e=sl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sl(t.document)}return e}function fh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function WE(t){var e=cv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&uv(n.ownerDocument.documentElement,n)){if(r!==null&&fh(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=om(n,i);var o=om(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var qE=Ln&&"documentMode"in document&&11>=document.documentMode,Ts=null,Xc=null,Gi=null,Jc=!1;function am(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jc||Ts==null||Ts!==sl(r)||(r=Ts,"selectionStart"in r&&fh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gi&&fo(Gi,r)||(Gi=r,r=dl(Xc,"onSelect"),0<r.length&&(e=new ch("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ts)))}function Ea(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var bs={animationend:Ea("Animation","AnimationEnd"),animationiteration:Ea("Animation","AnimationIteration"),animationstart:Ea("Animation","AnimationStart"),transitionend:Ea("Transition","TransitionEnd")},nc={},dv={};Ln&&(dv=document.createElement("div").style,"AnimationEvent"in window||(delete bs.animationend.animation,delete bs.animationiteration.animation,delete bs.animationstart.animation),"TransitionEvent"in window||delete bs.transitionend.transition);function Yl(t){if(nc[t])return nc[t];if(!bs[t])return t;var e=bs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in dv)return nc[t]=e[n];return t}var hv=Yl("animationend"),fv=Yl("animationiteration"),pv=Yl("animationstart"),mv=Yl("transitionend"),gv=new Map,lm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(t,e){gv.set(t,e),os(e,[t])}for(var rc=0;rc<lm.length;rc++){var sc=lm[rc],KE=sc.toLowerCase(),GE=sc[0].toUpperCase()+sc.slice(1);Nr(KE,"on"+GE)}Nr(hv,"onAnimationEnd");Nr(fv,"onAnimationIteration");Nr(pv,"onAnimationStart");Nr("dblclick","onDoubleClick");Nr("focusin","onFocus");Nr("focusout","onBlur");Nr(mv,"onTransitionEnd");zs("onMouseEnter",["mouseout","mouseover"]);zs("onMouseLeave",["mouseout","mouseover"]);zs("onPointerEnter",["pointerout","pointerover"]);zs("onPointerLeave",["pointerout","pointerover"]);os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));os("onBeforeInput",["compositionend","keypress","textInput","paste"]);os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fi));function um(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,K0(r,e,void 0,t),t.currentTarget=null}function yv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;um(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;um(s,l,d),i=u}}}if(ol)throw t=Kc,ol=!1,Kc=null,t}function Se(t,e){var n=e[rd];n===void 0&&(n=e[rd]=new Set);var r=t+"__bubble";n.has(r)||(vv(e,t,2,!1),n.add(r))}function ic(t,e,n){var r=0;e&&(r|=4),vv(n,t,r,e)}var Ia="_reactListening"+Math.random().toString(36).slice(2);function po(t){if(!t[Ia]){t[Ia]=!0,by.forEach(function(n){n!=="selectionchange"&&(QE.has(n)||ic(n,!1,t),ic(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ia]||(e[Ia]=!0,ic("selectionchange",!1,e))}}function vv(t,e,n,r){switch(tv(e)){case 1:var s=uE;break;case 4:s=cE;break;default:s=lh}n=s.bind(null,e,n,t),s=void 0,!qc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function oc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Br(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}By(function(){var d=i,p=sh(n),g=[];e:{var m=gv.get(t);if(m!==void 0){var E=ch,N=t;switch(t){case"keypress":if(Ua(n)===0)break e;case"keydown":case"keyup":E=bE;break;case"focusin":N="focus",E=Zu;break;case"focusout":N="blur",E=Zu;break;case"beforeblur":case"afterblur":E=Zu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=Xp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=fE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=AE;break;case hv:case fv:case pv:E=gE;break;case mv:E=NE;break;case"scroll":E=dE;break;case"wheel":E=kE;break;case"copy":case"cut":case"paste":E=vE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=Zp}var S=(e&4)!==0,D=!S&&t==="scroll",T=S?m!==null?m+"Capture":null:m;S=[];for(var w=d,C;w!==null;){C=w;var P=C.stateNode;if(C.tag===5&&P!==null&&(C=P,T!==null&&(P=ao(w,T),P!=null&&S.push(mo(w,P,C)))),D)break;w=w.return}0<S.length&&(m=new E(m,N,null,n,p),g.push({event:m,listeners:S}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",m&&n!==Hc&&(N=n.relatedTarget||n.fromElement)&&(Br(N)||N[Mn]))break e;if((E||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,E?(N=n.relatedTarget||n.toElement,E=d,N=N?Br(N):null,N!==null&&(D=as(N),N!==D||N.tag!==5&&N.tag!==6)&&(N=null)):(E=null,N=d),E!==N)){if(S=Xp,P="onMouseLeave",T="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(S=Zp,P="onPointerLeave",T="onPointerEnter",w="pointer"),D=E==null?m:Ss(E),C=N==null?m:Ss(N),m=new S(P,w+"leave",E,n,p),m.target=D,m.relatedTarget=C,P=null,Br(p)===d&&(S=new S(T,w+"enter",N,n,p),S.target=C,S.relatedTarget=D,P=S),D=P,E&&N)t:{for(S=E,T=N,w=0,C=S;C;C=ys(C))w++;for(C=0,P=T;P;P=ys(P))C++;for(;0<w-C;)S=ys(S),w--;for(;0<C-w;)T=ys(T),C--;for(;w--;){if(S===T||T!==null&&S===T.alternate)break t;S=ys(S),T=ys(T)}S=null}else S=null;E!==null&&cm(g,m,E,S,!1),N!==null&&D!==null&&cm(g,D,N,S,!0)}}e:{if(m=d?Ss(d):window,E=m.nodeName&&m.nodeName.toLowerCase(),E==="select"||E==="input"&&m.type==="file")var R=FE;else if(nm(m))if(av)R=zE;else{R=BE;var j=UE}else(E=m.nodeName)&&E.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(R=$E);if(R&&(R=R(t,d))){ov(g,R,n,p);break e}j&&j(t,m,d),t==="focusout"&&(j=m._wrapperState)&&j.controlled&&m.type==="number"&&Fc(m,"number",m.value)}switch(j=d?Ss(d):window,t){case"focusin":(nm(j)||j.contentEditable==="true")&&(Ts=j,Xc=d,Gi=null);break;case"focusout":Gi=Xc=Ts=null;break;case"mousedown":Jc=!0;break;case"contextmenu":case"mouseup":case"dragend":Jc=!1,am(g,n,p);break;case"selectionchange":if(qE)break;case"keydown":case"keyup":am(g,n,p)}var v;if(hh)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Is?sv(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(rv&&n.locale!=="ko"&&(Is||y!=="onCompositionStart"?y==="onCompositionEnd"&&Is&&(v=nv()):(ur=p,uh="value"in ur?ur.value:ur.textContent,Is=!0)),j=dl(d,y),0<j.length&&(y=new Jp(y,t,null,n,p),g.push({event:y,listeners:j}),v?y.data=v:(v=iv(n),v!==null&&(y.data=v)))),(v=jE?VE(t,n):OE(t,n))&&(d=dl(d,"onBeforeInput"),0<d.length&&(p=new Jp("onBeforeInput","beforeinput",null,n,p),g.push({event:p,listeners:d}),p.data=v))}yv(g,e)})}function mo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ao(t,n),i!=null&&r.unshift(mo(t,i,s)),i=ao(t,e),i!=null&&r.push(mo(t,i,s))),t=t.return}return r}function ys(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function cm(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=ao(n,i),u!=null&&o.unshift(mo(n,u,l))):s||(u=ao(n,i),u!=null&&o.push(mo(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var YE=/\r\n?/g,XE=/\u0000|\uFFFD/g;function dm(t){return(typeof t=="string"?t:""+t).replace(YE,`
`).replace(XE,"")}function Ta(t,e,n){if(e=dm(e),dm(t)!==e&&n)throw Error(U(425))}function hl(){}var Zc=null,ed=null;function td(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var nd=typeof setTimeout=="function"?setTimeout:void 0,JE=typeof clearTimeout=="function"?clearTimeout:void 0,hm=typeof Promise=="function"?Promise:void 0,ZE=typeof queueMicrotask=="function"?queueMicrotask:typeof hm<"u"?function(t){return hm.resolve(null).then(t).catch(eI)}:nd;function eI(t){setTimeout(function(){throw t})}function ac(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),co(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);co(e)}function mr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function fm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ai=Math.random().toString(36).slice(2),dn="__reactFiber$"+ai,go="__reactProps$"+ai,Mn="__reactContainer$"+ai,rd="__reactEvents$"+ai,tI="__reactListeners$"+ai,nI="__reactHandles$"+ai;function Br(t){var e=t[dn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Mn]||n[dn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=fm(t);t!==null;){if(n=t[dn])return n;t=fm(t)}return e}t=n,n=t.parentNode}return null}function Lo(t){return t=t[dn]||t[Mn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ss(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Xl(t){return t[go]||null}var sd=[],Cs=-1;function Rr(t){return{current:t}}function Ae(t){0>Cs||(t.current=sd[Cs],sd[Cs]=null,Cs--)}function Ie(t,e){Cs++,sd[Cs]=t.current,t.current=e}var br={},pt=Rr(br),Ct=Rr(!1),Yr=br;function Hs(t,e){var n=t.type.contextTypes;if(!n)return br;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function At(t){return t=t.childContextTypes,t!=null}function fl(){Ae(Ct),Ae(pt)}function pm(t,e,n){if(pt.current!==br)throw Error(U(168));Ie(pt,e),Ie(Ct,n)}function _v(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,U0(t)||"Unknown",s));return De({},n,r)}function pl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||br,Yr=pt.current,Ie(pt,t),Ie(Ct,Ct.current),!0}function mm(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=_v(t,e,Yr),r.__reactInternalMemoizedMergedChildContext=t,Ae(Ct),Ae(pt),Ie(pt,t)):Ae(Ct),Ie(Ct,n)}var Sn=null,Jl=!1,lc=!1;function xv(t){Sn===null?Sn=[t]:Sn.push(t)}function rI(t){Jl=!0,xv(t)}function kr(){if(!lc&&Sn!==null){lc=!0;var t=0,e=ye;try{var n=Sn;for(ye=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Sn=null,Jl=!1}catch(s){throw Sn!==null&&(Sn=Sn.slice(t+1)),Wy(ih,kr),s}finally{ye=e,lc=!1}}return null}var As=[],Ps=0,ml=null,gl=0,Ut=[],Bt=0,Xr=null,An=1,Pn="";function Mr(t,e){As[Ps++]=gl,As[Ps++]=ml,ml=t,gl=e}function wv(t,e,n){Ut[Bt++]=An,Ut[Bt++]=Pn,Ut[Bt++]=Xr,Xr=t;var r=An;t=Pn;var s=32-en(r)-1;r&=~(1<<s),n+=1;var i=32-en(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,An=1<<32-en(e)+s|n<<s|r,Pn=i+t}else An=1<<i|n<<s|r,Pn=t}function ph(t){t.return!==null&&(Mr(t,1),wv(t,1,0))}function mh(t){for(;t===ml;)ml=As[--Ps],As[Ps]=null,gl=As[--Ps],As[Ps]=null;for(;t===Xr;)Xr=Ut[--Bt],Ut[Bt]=null,Pn=Ut[--Bt],Ut[Bt]=null,An=Ut[--Bt],Ut[Bt]=null}var Vt=null,jt=null,Ne=!1,Jt=null;function Ev(t,e){var n=zt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function gm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Vt=t,jt=mr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Vt=t,jt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xr!==null?{id:An,overflow:Pn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=zt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Vt=t,jt=null,!0):!1;default:return!1}}function id(t){return(t.mode&1)!==0&&(t.flags&128)===0}function od(t){if(Ne){var e=jt;if(e){var n=e;if(!gm(t,e)){if(id(t))throw Error(U(418));e=mr(n.nextSibling);var r=Vt;e&&gm(t,e)?Ev(r,n):(t.flags=t.flags&-4097|2,Ne=!1,Vt=t)}}else{if(id(t))throw Error(U(418));t.flags=t.flags&-4097|2,Ne=!1,Vt=t}}}function ym(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Vt=t}function ba(t){if(t!==Vt)return!1;if(!Ne)return ym(t),Ne=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!td(t.type,t.memoizedProps)),e&&(e=jt)){if(id(t))throw Iv(),Error(U(418));for(;e;)Ev(t,e),e=mr(e.nextSibling)}if(ym(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){jt=mr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}jt=null}}else jt=Vt?mr(t.stateNode.nextSibling):null;return!0}function Iv(){for(var t=jt;t;)t=mr(t.nextSibling)}function Ws(){jt=Vt=null,Ne=!1}function gh(t){Jt===null?Jt=[t]:Jt.push(t)}var sI=Wn.ReactCurrentBatchConfig;function ki(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function Sa(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vm(t){var e=t._init;return e(t._payload)}function Tv(t){function e(T,w){if(t){var C=T.deletions;C===null?(T.deletions=[w],T.flags|=16):C.push(w)}}function n(T,w){if(!t)return null;for(;w!==null;)e(T,w),w=w.sibling;return null}function r(T,w){for(T=new Map;w!==null;)w.key!==null?T.set(w.key,w):T.set(w.index,w),w=w.sibling;return T}function s(T,w){return T=_r(T,w),T.index=0,T.sibling=null,T}function i(T,w,C){return T.index=C,t?(C=T.alternate,C!==null?(C=C.index,C<w?(T.flags|=2,w):C):(T.flags|=2,w)):(T.flags|=1048576,w)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function l(T,w,C,P){return w===null||w.tag!==6?(w=mc(C,T.mode,P),w.return=T,w):(w=s(w,C),w.return=T,w)}function u(T,w,C,P){var R=C.type;return R===Es?p(T,w,C.props.children,P,C.key):w!==null&&(w.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===nr&&vm(R)===w.type)?(P=s(w,C.props),P.ref=ki(T,w,C),P.return=T,P):(P=Ka(C.type,C.key,C.props,null,T.mode,P),P.ref=ki(T,w,C),P.return=T,P)}function d(T,w,C,P){return w===null||w.tag!==4||w.stateNode.containerInfo!==C.containerInfo||w.stateNode.implementation!==C.implementation?(w=gc(C,T.mode,P),w.return=T,w):(w=s(w,C.children||[]),w.return=T,w)}function p(T,w,C,P,R){return w===null||w.tag!==7?(w=Kr(C,T.mode,P,R),w.return=T,w):(w=s(w,C),w.return=T,w)}function g(T,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return w=mc(""+w,T.mode,C),w.return=T,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ma:return C=Ka(w.type,w.key,w.props,null,T.mode,C),C.ref=ki(T,null,w),C.return=T,C;case ws:return w=gc(w,T.mode,C),w.return=T,w;case nr:var P=w._init;return g(T,P(w._payload),C)}if(Li(w)||Ci(w))return w=Kr(w,T.mode,C,null),w.return=T,w;Sa(T,w)}return null}function m(T,w,C,P){var R=w!==null?w.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return R!==null?null:l(T,w,""+C,P);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case ma:return C.key===R?u(T,w,C,P):null;case ws:return C.key===R?d(T,w,C,P):null;case nr:return R=C._init,m(T,w,R(C._payload),P)}if(Li(C)||Ci(C))return R!==null?null:p(T,w,C,P,null);Sa(T,C)}return null}function E(T,w,C,P,R){if(typeof P=="string"&&P!==""||typeof P=="number")return T=T.get(C)||null,l(w,T,""+P,R);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case ma:return T=T.get(P.key===null?C:P.key)||null,u(w,T,P,R);case ws:return T=T.get(P.key===null?C:P.key)||null,d(w,T,P,R);case nr:var j=P._init;return E(T,w,C,j(P._payload),R)}if(Li(P)||Ci(P))return T=T.get(C)||null,p(w,T,P,R,null);Sa(w,P)}return null}function N(T,w,C,P){for(var R=null,j=null,v=w,y=w=0,I=null;v!==null&&y<C.length;y++){v.index>y?(I=v,v=null):I=v.sibling;var A=m(T,v,C[y],P);if(A===null){v===null&&(v=I);break}t&&v&&A.alternate===null&&e(T,v),w=i(A,w,y),j===null?R=A:j.sibling=A,j=A,v=I}if(y===C.length)return n(T,v),Ne&&Mr(T,y),R;if(v===null){for(;y<C.length;y++)v=g(T,C[y],P),v!==null&&(w=i(v,w,y),j===null?R=v:j.sibling=v,j=v);return Ne&&Mr(T,y),R}for(v=r(T,v);y<C.length;y++)I=E(v,T,y,C[y],P),I!==null&&(t&&I.alternate!==null&&v.delete(I.key===null?y:I.key),w=i(I,w,y),j===null?R=I:j.sibling=I,j=I);return t&&v.forEach(function(_){return e(T,_)}),Ne&&Mr(T,y),R}function S(T,w,C,P){var R=Ci(C);if(typeof R!="function")throw Error(U(150));if(C=R.call(C),C==null)throw Error(U(151));for(var j=R=null,v=w,y=w=0,I=null,A=C.next();v!==null&&!A.done;y++,A=C.next()){v.index>y?(I=v,v=null):I=v.sibling;var _=m(T,v,A.value,P);if(_===null){v===null&&(v=I);break}t&&v&&_.alternate===null&&e(T,v),w=i(_,w,y),j===null?R=_:j.sibling=_,j=_,v=I}if(A.done)return n(T,v),Ne&&Mr(T,y),R;if(v===null){for(;!A.done;y++,A=C.next())A=g(T,A.value,P),A!==null&&(w=i(A,w,y),j===null?R=A:j.sibling=A,j=A);return Ne&&Mr(T,y),R}for(v=r(T,v);!A.done;y++,A=C.next())A=E(v,T,y,A.value,P),A!==null&&(t&&A.alternate!==null&&v.delete(A.key===null?y:A.key),w=i(A,w,y),j===null?R=A:j.sibling=A,j=A);return t&&v.forEach(function(k){return e(T,k)}),Ne&&Mr(T,y),R}function D(T,w,C,P){if(typeof C=="object"&&C!==null&&C.type===Es&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case ma:e:{for(var R=C.key,j=w;j!==null;){if(j.key===R){if(R=C.type,R===Es){if(j.tag===7){n(T,j.sibling),w=s(j,C.props.children),w.return=T,T=w;break e}}else if(j.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===nr&&vm(R)===j.type){n(T,j.sibling),w=s(j,C.props),w.ref=ki(T,j,C),w.return=T,T=w;break e}n(T,j);break}else e(T,j);j=j.sibling}C.type===Es?(w=Kr(C.props.children,T.mode,P,C.key),w.return=T,T=w):(P=Ka(C.type,C.key,C.props,null,T.mode,P),P.ref=ki(T,w,C),P.return=T,T=P)}return o(T);case ws:e:{for(j=C.key;w!==null;){if(w.key===j)if(w.tag===4&&w.stateNode.containerInfo===C.containerInfo&&w.stateNode.implementation===C.implementation){n(T,w.sibling),w=s(w,C.children||[]),w.return=T,T=w;break e}else{n(T,w);break}else e(T,w);w=w.sibling}w=gc(C,T.mode,P),w.return=T,T=w}return o(T);case nr:return j=C._init,D(T,w,j(C._payload),P)}if(Li(C))return N(T,w,C,P);if(Ci(C))return S(T,w,C,P);Sa(T,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,w!==null&&w.tag===6?(n(T,w.sibling),w=s(w,C),w.return=T,T=w):(n(T,w),w=mc(C,T.mode,P),w.return=T,T=w),o(T)):n(T,w)}return D}var qs=Tv(!0),bv=Tv(!1),yl=Rr(null),vl=null,Ns=null,yh=null;function vh(){yh=Ns=vl=null}function _h(t){var e=yl.current;Ae(yl),t._currentValue=e}function ad(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ls(t,e){vl=t,yh=Ns=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(St=!0),t.firstContext=null)}function qt(t){var e=t._currentValue;if(yh!==t)if(t={context:t,memoizedValue:e,next:null},Ns===null){if(vl===null)throw Error(U(308));Ns=t,vl.dependencies={lanes:0,firstContext:t}}else Ns=Ns.next=t;return e}var $r=null;function xh(t){$r===null?$r=[t]:$r.push(t)}function Sv(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,xh(e)):(n.next=s.next,s.next=n),e.interleaved=n,Fn(t,r)}function Fn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var rr=!1;function wh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function jn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function gr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,de&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Fn(t,n)}return s=r.interleaved,s===null?(e.next=e,xh(r)):(e.next=s.next,s.next=e),r.interleaved=e,Fn(t,n)}function Ba(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,oh(t,n)}}function _m(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function _l(t,e,n,r){var s=t.updateQueue;rr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=d:l.next=d,p.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,p=d=u=null,l=i;do{var m=l.lane,E=l.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:E,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var N=t,S=l;switch(m=e,E=n,S.tag){case 1:if(N=S.payload,typeof N=="function"){g=N.call(E,g,m);break e}g=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=S.payload,m=typeof N=="function"?N.call(E,g,m):N,m==null)break e;g=De({},g,m);break e;case 2:rr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else E={eventTime:E,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(d=p=E,u=g):p=p.next=E,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(p===null&&(u=g),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Zr|=o,t.lanes=o,t.memoizedState=g}}function xm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var Mo={},fn=Rr(Mo),yo=Rr(Mo),vo=Rr(Mo);function zr(t){if(t===Mo)throw Error(U(174));return t}function Eh(t,e){switch(Ie(vo,e),Ie(yo,t),Ie(fn,Mo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Bc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Bc(e,t)}Ae(fn),Ie(fn,e)}function Ks(){Ae(fn),Ae(yo),Ae(vo)}function Av(t){zr(vo.current);var e=zr(fn.current),n=Bc(e,t.type);e!==n&&(Ie(yo,t),Ie(fn,n))}function Ih(t){yo.current===t&&(Ae(fn),Ae(yo))}var Re=Rr(0);function xl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var uc=[];function Th(){for(var t=0;t<uc.length;t++)uc[t]._workInProgressVersionPrimary=null;uc.length=0}var $a=Wn.ReactCurrentDispatcher,cc=Wn.ReactCurrentBatchConfig,Jr=0,ke=null,He=null,Ge=null,wl=!1,Qi=!1,_o=0,iI=0;function lt(){throw Error(U(321))}function bh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sn(t[n],e[n]))return!1;return!0}function Sh(t,e,n,r,s,i){if(Jr=i,ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$a.current=t===null||t.memoizedState===null?uI:cI,t=n(r,s),Qi){i=0;do{if(Qi=!1,_o=0,25<=i)throw Error(U(301));i+=1,Ge=He=null,e.updateQueue=null,$a.current=dI,t=n(r,s)}while(Qi)}if($a.current=El,e=He!==null&&He.next!==null,Jr=0,Ge=He=ke=null,wl=!1,e)throw Error(U(300));return t}function Ch(){var t=_o!==0;return _o=0,t}function cn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ge===null?ke.memoizedState=Ge=t:Ge=Ge.next=t,Ge}function Kt(){if(He===null){var t=ke.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var e=Ge===null?ke.memoizedState:Ge.next;if(e!==null)Ge=e,He=t;else{if(t===null)throw Error(U(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Ge===null?ke.memoizedState=Ge=t:Ge=Ge.next=t}return Ge}function xo(t,e){return typeof e=="function"?e(t):e}function dc(t){var e=Kt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=He,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var p=d.lane;if((Jr&p)===p)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var g={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=g,o=r):u=u.next=g,ke.lanes|=p,Zr|=p}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,sn(r,e.memoizedState)||(St=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ke.lanes|=i,Zr|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function hc(t){var e=Kt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);sn(i,e.memoizedState)||(St=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Pv(){}function Nv(t,e){var n=ke,r=Kt(),s=e(),i=!sn(r.memoizedState,s);if(i&&(r.memoizedState=s,St=!0),r=r.queue,Ah(Dv.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ge!==null&&Ge.memoizedState.tag&1){if(n.flags|=2048,wo(9,kv.bind(null,n,r,s,e),void 0,null),Qe===null)throw Error(U(349));Jr&30||Rv(n,e,s)}return s}function Rv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ke.updateQueue,e===null?(e={lastEffect:null,stores:null},ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function kv(t,e,n,r){e.value=n,e.getSnapshot=r,jv(e)&&Vv(t)}function Dv(t,e,n){return n(function(){jv(e)&&Vv(t)})}function jv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sn(t,n)}catch{return!0}}function Vv(t){var e=Fn(t,1);e!==null&&tn(e,t,1,-1)}function wm(t){var e=cn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xo,lastRenderedState:t},e.queue=t,t=t.dispatch=lI.bind(null,ke,t),[e.memoizedState,t]}function wo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ke.updateQueue,e===null?(e={lastEffect:null,stores:null},ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ov(){return Kt().memoizedState}function za(t,e,n,r){var s=cn();ke.flags|=t,s.memoizedState=wo(1|e,n,void 0,r===void 0?null:r)}function Zl(t,e,n,r){var s=Kt();r=r===void 0?null:r;var i=void 0;if(He!==null){var o=He.memoizedState;if(i=o.destroy,r!==null&&bh(r,o.deps)){s.memoizedState=wo(e,n,i,r);return}}ke.flags|=t,s.memoizedState=wo(1|e,n,i,r)}function Em(t,e){return za(8390656,8,t,e)}function Ah(t,e){return Zl(2048,8,t,e)}function Lv(t,e){return Zl(4,2,t,e)}function Mv(t,e){return Zl(4,4,t,e)}function Fv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Uv(t,e,n){return n=n!=null?n.concat([t]):null,Zl(4,4,Fv.bind(null,e,t),n)}function Ph(){}function Bv(t,e){var n=Kt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&bh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function $v(t,e){var n=Kt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&bh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function zv(t,e,n){return Jr&21?(sn(n,e)||(n=Gy(),ke.lanes|=n,Zr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,St=!0),t.memoizedState=n)}function oI(t,e){var n=ye;ye=n!==0&&4>n?n:4,t(!0);var r=cc.transition;cc.transition={};try{t(!1),e()}finally{ye=n,cc.transition=r}}function Hv(){return Kt().memoizedState}function aI(t,e,n){var r=vr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Wv(t))qv(e,n);else if(n=Sv(t,e,n,r),n!==null){var s=vt();tn(n,t,r,s),Kv(n,e,r)}}function lI(t,e,n){var r=vr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wv(t))qv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,sn(l,o)){var u=e.interleaved;u===null?(s.next=s,xh(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Sv(t,e,s,r),n!==null&&(s=vt(),tn(n,t,r,s),Kv(n,e,r))}}function Wv(t){var e=t.alternate;return t===ke||e!==null&&e===ke}function qv(t,e){Qi=wl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Kv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,oh(t,n)}}var El={readContext:qt,useCallback:lt,useContext:lt,useEffect:lt,useImperativeHandle:lt,useInsertionEffect:lt,useLayoutEffect:lt,useMemo:lt,useReducer:lt,useRef:lt,useState:lt,useDebugValue:lt,useDeferredValue:lt,useTransition:lt,useMutableSource:lt,useSyncExternalStore:lt,useId:lt,unstable_isNewReconciler:!1},uI={readContext:qt,useCallback:function(t,e){return cn().memoizedState=[t,e===void 0?null:e],t},useContext:qt,useEffect:Em,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,za(4194308,4,Fv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return za(4194308,4,t,e)},useInsertionEffect:function(t,e){return za(4,2,t,e)},useMemo:function(t,e){var n=cn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=cn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=aI.bind(null,ke,t),[r.memoizedState,t]},useRef:function(t){var e=cn();return t={current:t},e.memoizedState=t},useState:wm,useDebugValue:Ph,useDeferredValue:function(t){return cn().memoizedState=t},useTransition:function(){var t=wm(!1),e=t[0];return t=oI.bind(null,t[1]),cn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ke,s=cn();if(Ne){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),Qe===null)throw Error(U(349));Jr&30||Rv(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Em(Dv.bind(null,r,i,t),[t]),r.flags|=2048,wo(9,kv.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=cn(),e=Qe.identifierPrefix;if(Ne){var n=Pn,r=An;n=(r&~(1<<32-en(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=_o++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=iI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},cI={readContext:qt,useCallback:Bv,useContext:qt,useEffect:Ah,useImperativeHandle:Uv,useInsertionEffect:Lv,useLayoutEffect:Mv,useMemo:$v,useReducer:dc,useRef:Ov,useState:function(){return dc(xo)},useDebugValue:Ph,useDeferredValue:function(t){var e=Kt();return zv(e,He.memoizedState,t)},useTransition:function(){var t=dc(xo)[0],e=Kt().memoizedState;return[t,e]},useMutableSource:Pv,useSyncExternalStore:Nv,useId:Hv,unstable_isNewReconciler:!1},dI={readContext:qt,useCallback:Bv,useContext:qt,useEffect:Ah,useImperativeHandle:Uv,useInsertionEffect:Lv,useLayoutEffect:Mv,useMemo:$v,useReducer:hc,useRef:Ov,useState:function(){return hc(xo)},useDebugValue:Ph,useDeferredValue:function(t){var e=Kt();return He===null?e.memoizedState=t:zv(e,He.memoizedState,t)},useTransition:function(){var t=hc(xo)[0],e=Kt().memoizedState;return[t,e]},useMutableSource:Pv,useSyncExternalStore:Nv,useId:Hv,unstable_isNewReconciler:!1};function Yt(t,e){if(t&&t.defaultProps){e=De({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ld(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:De({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var eu={isMounted:function(t){return(t=t._reactInternals)?as(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=vt(),s=vr(t),i=jn(r,s);i.payload=e,n!=null&&(i.callback=n),e=gr(t,i,s),e!==null&&(tn(e,t,s,r),Ba(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=vt(),s=vr(t),i=jn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=gr(t,i,s),e!==null&&(tn(e,t,s,r),Ba(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vt(),r=vr(t),s=jn(n,r);s.tag=2,e!=null&&(s.callback=e),e=gr(t,s,r),e!==null&&(tn(e,t,r,n),Ba(e,t,r))}};function Im(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!fo(n,r)||!fo(s,i):!0}function Gv(t,e,n){var r=!1,s=br,i=e.contextType;return typeof i=="object"&&i!==null?i=qt(i):(s=At(e)?Yr:pt.current,r=e.contextTypes,i=(r=r!=null)?Hs(t,s):br),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=eu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Tm(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&eu.enqueueReplaceState(e,e.state,null)}function ud(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},wh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=qt(i):(i=At(e)?Yr:pt.current,s.context=Hs(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(ld(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&eu.enqueueReplaceState(s,s.state,null),_l(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Gs(t,e){try{var n="",r=e;do n+=F0(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function fc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function cd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var hI=typeof WeakMap=="function"?WeakMap:Map;function Qv(t,e,n){n=jn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Tl||(Tl=!0,xd=r),cd(t,e)},n}function Yv(t,e,n){n=jn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){cd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){cd(t,e),typeof r!="function"&&(yr===null?yr=new Set([this]):yr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function bm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new hI;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=SI.bind(null,t,e,n),e.then(t,t))}function Sm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Cm(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=jn(-1,1),e.tag=2,gr(n,e,1))),n.lanes|=1),t)}var fI=Wn.ReactCurrentOwner,St=!1;function yt(t,e,n,r){e.child=t===null?bv(e,null,n,r):qs(e,t.child,n,r)}function Am(t,e,n,r,s){n=n.render;var i=e.ref;return Ls(e,s),r=Sh(t,e,n,r,i,s),n=Ch(),t!==null&&!St?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Un(t,e,s)):(Ne&&n&&ph(e),e.flags|=1,yt(t,e,r,s),e.child)}function Pm(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Lh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Xv(t,e,i,r,s)):(t=Ka(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:fo,n(o,r)&&t.ref===e.ref)return Un(t,e,s)}return e.flags|=1,t=_r(i,r),t.ref=e.ref,t.return=e,e.child=t}function Xv(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(fo(i,r)&&t.ref===e.ref)if(St=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(St=!0);else return e.lanes=t.lanes,Un(t,e,s)}return dd(t,e,n,r,s)}function Jv(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ie(ks,Dt),Dt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ie(ks,Dt),Dt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ie(ks,Dt),Dt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ie(ks,Dt),Dt|=r;return yt(t,e,s,n),e.child}function Zv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function dd(t,e,n,r,s){var i=At(n)?Yr:pt.current;return i=Hs(e,i),Ls(e,s),n=Sh(t,e,n,r,i,s),r=Ch(),t!==null&&!St?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Un(t,e,s)):(Ne&&r&&ph(e),e.flags|=1,yt(t,e,n,s),e.child)}function Nm(t,e,n,r,s){if(At(n)){var i=!0;pl(e)}else i=!1;if(Ls(e,s),e.stateNode===null)Ha(t,e),Gv(e,n,r),ud(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=qt(d):(d=At(n)?Yr:pt.current,d=Hs(e,d));var p=n.getDerivedStateFromProps,g=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&Tm(e,o,r,d),rr=!1;var m=e.memoizedState;o.state=m,_l(e,r,o,s),u=e.memoizedState,l!==r||m!==u||Ct.current||rr?(typeof p=="function"&&(ld(e,n,p,r),u=e.memoizedState),(l=rr||Im(e,n,l,r,m,u,d))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Cv(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Yt(e.type,l),o.props=d,g=e.pendingProps,m=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=qt(u):(u=At(n)?Yr:pt.current,u=Hs(e,u));var E=n.getDerivedStateFromProps;(p=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==g||m!==u)&&Tm(e,o,r,u),rr=!1,m=e.memoizedState,o.state=m,_l(e,r,o,s);var N=e.memoizedState;l!==g||m!==N||Ct.current||rr?(typeof E=="function"&&(ld(e,n,E,r),N=e.memoizedState),(d=rr||Im(e,n,d,r,m,N,u)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,N,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,N,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=N),o.props=r,o.state=N,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return hd(t,e,n,r,i,s)}function hd(t,e,n,r,s,i){Zv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&mm(e,n,!1),Un(t,e,i);r=e.stateNode,fI.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=qs(e,t.child,null,i),e.child=qs(e,null,l,i)):yt(t,e,l,i),e.memoizedState=r.state,s&&mm(e,n,!0),e.child}function e_(t){var e=t.stateNode;e.pendingContext?pm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&pm(t,e.context,!1),Eh(t,e.containerInfo)}function Rm(t,e,n,r,s){return Ws(),gh(s),e.flags|=256,yt(t,e,n,r),e.child}var fd={dehydrated:null,treeContext:null,retryLane:0};function pd(t){return{baseLanes:t,cachePool:null,transitions:null}}function t_(t,e,n){var r=e.pendingProps,s=Re.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ie(Re,s&1),t===null)return od(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ru(o,r,0,null),t=Kr(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=pd(n),e.memoizedState=fd,t):Nh(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return pI(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=_r(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=_r(l,i):(i=Kr(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?pd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=fd,r}return i=t.child,t=i.sibling,r=_r(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Nh(t,e){return e=ru({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ca(t,e,n,r){return r!==null&&gh(r),qs(e,t.child,null,n),t=Nh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function pI(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=fc(Error(U(422))),Ca(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=ru({mode:"visible",children:r.children},s,0,null),i=Kr(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&qs(e,t.child,null,o),e.child.memoizedState=pd(o),e.memoizedState=fd,i);if(!(e.mode&1))return Ca(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(U(419)),r=fc(i,r,void 0),Ca(t,e,o,r)}if(l=(o&t.childLanes)!==0,St||l){if(r=Qe,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Fn(t,s),tn(r,t,s,-1))}return Oh(),r=fc(Error(U(421))),Ca(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=CI.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,jt=mr(s.nextSibling),Vt=e,Ne=!0,Jt=null,t!==null&&(Ut[Bt++]=An,Ut[Bt++]=Pn,Ut[Bt++]=Xr,An=t.id,Pn=t.overflow,Xr=e),e=Nh(e,r.children),e.flags|=4096,e)}function km(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ad(t.return,e,n)}function pc(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function n_(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(yt(t,e,r.children,n),r=Re.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&km(t,n,e);else if(t.tag===19)km(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ie(Re,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&xl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),pc(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&xl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}pc(e,!0,n,null,i);break;case"together":pc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ha(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Un(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Zr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=_r(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=_r(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function mI(t,e,n){switch(e.tag){case 3:e_(e),Ws();break;case 5:Av(e);break;case 1:At(e.type)&&pl(e);break;case 4:Eh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ie(yl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ie(Re,Re.current&1),e.flags|=128,null):n&e.child.childLanes?t_(t,e,n):(Ie(Re,Re.current&1),t=Un(t,e,n),t!==null?t.sibling:null);Ie(Re,Re.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return n_(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ie(Re,Re.current),r)break;return null;case 22:case 23:return e.lanes=0,Jv(t,e,n)}return Un(t,e,n)}var r_,md,s_,i_;r_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};md=function(){};s_=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,zr(fn.current);var i=null;switch(n){case"input":s=Lc(t,s),r=Lc(t,r),i=[];break;case"select":s=De({},s,{value:void 0}),r=De({},r,{value:void 0}),i=[];break;case"textarea":s=Uc(t,s),r=Uc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hl)}$c(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(io.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(io.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Se("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};i_=function(t,e,n,r){n!==r&&(e.flags|=4)};function Di(t,e){if(!Ne)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ut(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function gI(t,e,n){var r=e.pendingProps;switch(mh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(e),null;case 1:return At(e.type)&&fl(),ut(e),null;case 3:return r=e.stateNode,Ks(),Ae(Ct),Ae(pt),Th(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ba(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Jt!==null&&(Id(Jt),Jt=null))),md(t,e),ut(e),null;case 5:Ih(e);var s=zr(vo.current);if(n=e.type,t!==null&&e.stateNode!=null)s_(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return ut(e),null}if(t=zr(fn.current),ba(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[dn]=e,r[go]=i,t=(e.mode&1)!==0,n){case"dialog":Se("cancel",r),Se("close",r);break;case"iframe":case"object":case"embed":Se("load",r);break;case"video":case"audio":for(s=0;s<Fi.length;s++)Se(Fi[s],r);break;case"source":Se("error",r);break;case"img":case"image":case"link":Se("error",r),Se("load",r);break;case"details":Se("toggle",r);break;case"input":Bp(r,i),Se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Se("invalid",r);break;case"textarea":zp(r,i),Se("invalid",r)}$c(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ta(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ta(r.textContent,l,t),s=["children",""+l]):io.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Se("scroll",r)}switch(n){case"input":ga(r),$p(r,i,!0);break;case"textarea":ga(r),Hp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=hl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Dy(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[dn]=e,t[go]=r,r_(t,e,!1,!1),e.stateNode=t;e:{switch(o=zc(n,r),n){case"dialog":Se("cancel",t),Se("close",t),s=r;break;case"iframe":case"object":case"embed":Se("load",t),s=r;break;case"video":case"audio":for(s=0;s<Fi.length;s++)Se(Fi[s],t);s=r;break;case"source":Se("error",t),s=r;break;case"img":case"image":case"link":Se("error",t),Se("load",t),s=r;break;case"details":Se("toggle",t),s=r;break;case"input":Bp(t,r),s=Lc(t,r),Se("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=De({},r,{value:void 0}),Se("invalid",t);break;case"textarea":zp(t,r),s=Uc(t,r),Se("invalid",t);break;default:s=r}$c(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?Oy(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&jy(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&oo(t,u):typeof u=="number"&&oo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(io.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Se("scroll",t):u!=null&&eh(t,i,u,o))}switch(n){case"input":ga(t),$p(t,r,!1);break;case"textarea":ga(t),Hp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Tr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ds(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ds(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=hl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ut(e),null;case 6:if(t&&e.stateNode!=null)i_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=zr(vo.current),zr(fn.current),ba(e)){if(r=e.stateNode,n=e.memoizedProps,r[dn]=e,(i=r.nodeValue!==n)&&(t=Vt,t!==null))switch(t.tag){case 3:Ta(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ta(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dn]=e,e.stateNode=r}return ut(e),null;case 13:if(Ae(Re),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ne&&jt!==null&&e.mode&1&&!(e.flags&128))Iv(),Ws(),e.flags|=98560,i=!1;else if(i=ba(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[dn]=e}else Ws(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ut(e),i=!1}else Jt!==null&&(Id(Jt),Jt=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Re.current&1?We===0&&(We=3):Oh())),e.updateQueue!==null&&(e.flags|=4),ut(e),null);case 4:return Ks(),md(t,e),t===null&&po(e.stateNode.containerInfo),ut(e),null;case 10:return _h(e.type._context),ut(e),null;case 17:return At(e.type)&&fl(),ut(e),null;case 19:if(Ae(Re),i=e.memoizedState,i===null)return ut(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Di(i,!1);else{if(We!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=xl(t),o!==null){for(e.flags|=128,Di(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ie(Re,Re.current&1|2),e.child}t=t.sibling}i.tail!==null&&Me()>Qs&&(e.flags|=128,r=!0,Di(i,!1),e.lanes=4194304)}else{if(!r)if(t=xl(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Di(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ne)return ut(e),null}else 2*Me()-i.renderingStartTime>Qs&&n!==1073741824&&(e.flags|=128,r=!0,Di(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Me(),e.sibling=null,n=Re.current,Ie(Re,r?n&1|2:n&1),e):(ut(e),null);case 22:case 23:return Vh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Dt&1073741824&&(ut(e),e.subtreeFlags&6&&(e.flags|=8192)):ut(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function yI(t,e){switch(mh(e),e.tag){case 1:return At(e.type)&&fl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ks(),Ae(Ct),Ae(pt),Th(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ih(e),null;case 13:if(Ae(Re),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Ws()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ae(Re),null;case 4:return Ks(),null;case 10:return _h(e.type._context),null;case 22:case 23:return Vh(),null;case 24:return null;default:return null}}var Aa=!1,ht=!1,vI=typeof WeakSet=="function"?WeakSet:Set,G=null;function Rs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Oe(t,e,r)}else n.current=null}function gd(t,e,n){try{n()}catch(r){Oe(t,e,r)}}var Dm=!1;function _I(t,e){if(Zc=ul,t=cv(),fh(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,p=0,g=t,m=null;t:for(;;){for(var E;g!==n||s!==0&&g.nodeType!==3||(l=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(E=g.firstChild)!==null;)m=g,g=E;for(;;){if(g===t)break t;if(m===n&&++d===s&&(l=o),m===i&&++p===r&&(u=o),(E=g.nextSibling)!==null)break;g=m,m=g.parentNode}g=E}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ed={focusedElem:t,selectionRange:n},ul=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var N=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var S=N.memoizedProps,D=N.memoizedState,T=e.stateNode,w=T.getSnapshotBeforeUpdate(e.elementType===e.type?S:Yt(e.type,S),D);T.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(P){Oe(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return N=Dm,Dm=!1,N}function Yi(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&gd(e,n,i)}s=s.next}while(s!==r)}}function tu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function yd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function o_(t){var e=t.alternate;e!==null&&(t.alternate=null,o_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dn],delete e[go],delete e[rd],delete e[tI],delete e[nI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function a_(t){return t.tag===5||t.tag===3||t.tag===4}function jm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||a_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hl));else if(r!==4&&(t=t.child,t!==null))for(vd(t,e,n),t=t.sibling;t!==null;)vd(t,e,n),t=t.sibling}function _d(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(_d(t,e,n),t=t.sibling;t!==null;)_d(t,e,n),t=t.sibling}var Je=null,Xt=!1;function er(t,e,n){for(n=n.child;n!==null;)l_(t,e,n),n=n.sibling}function l_(t,e,n){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(Kl,n)}catch{}switch(n.tag){case 5:ht||Rs(n,e);case 6:var r=Je,s=Xt;Je=null,er(t,e,n),Je=r,Xt=s,Je!==null&&(Xt?(t=Je,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Je.removeChild(n.stateNode));break;case 18:Je!==null&&(Xt?(t=Je,n=n.stateNode,t.nodeType===8?ac(t.parentNode,n):t.nodeType===1&&ac(t,n),co(t)):ac(Je,n.stateNode));break;case 4:r=Je,s=Xt,Je=n.stateNode.containerInfo,Xt=!0,er(t,e,n),Je=r,Xt=s;break;case 0:case 11:case 14:case 15:if(!ht&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&gd(n,e,o),s=s.next}while(s!==r)}er(t,e,n);break;case 1:if(!ht&&(Rs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Oe(n,e,l)}er(t,e,n);break;case 21:er(t,e,n);break;case 22:n.mode&1?(ht=(r=ht)||n.memoizedState!==null,er(t,e,n),ht=r):er(t,e,n);break;default:er(t,e,n)}}function Vm(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new vI),e.forEach(function(r){var s=AI.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Qt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Je=l.stateNode,Xt=!1;break e;case 3:Je=l.stateNode.containerInfo,Xt=!0;break e;case 4:Je=l.stateNode.containerInfo,Xt=!0;break e}l=l.return}if(Je===null)throw Error(U(160));l_(i,o,s),Je=null,Xt=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Oe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)u_(e,t),e=e.sibling}function u_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qt(e,t),un(t),r&4){try{Yi(3,t,t.return),tu(3,t)}catch(S){Oe(t,t.return,S)}try{Yi(5,t,t.return)}catch(S){Oe(t,t.return,S)}}break;case 1:Qt(e,t),un(t),r&512&&n!==null&&Rs(n,n.return);break;case 5:if(Qt(e,t),un(t),r&512&&n!==null&&Rs(n,n.return),t.flags&32){var s=t.stateNode;try{oo(s,"")}catch(S){Oe(t,t.return,S)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Ry(s,i),zc(l,o);var d=zc(l,i);for(o=0;o<u.length;o+=2){var p=u[o],g=u[o+1];p==="style"?Oy(s,g):p==="dangerouslySetInnerHTML"?jy(s,g):p==="children"?oo(s,g):eh(s,p,g,d)}switch(l){case"input":Mc(s,i);break;case"textarea":ky(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var E=i.value;E!=null?Ds(s,!!i.multiple,E,!1):m!==!!i.multiple&&(i.defaultValue!=null?Ds(s,!!i.multiple,i.defaultValue,!0):Ds(s,!!i.multiple,i.multiple?[]:"",!1))}s[go]=i}catch(S){Oe(t,t.return,S)}}break;case 6:if(Qt(e,t),un(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(S){Oe(t,t.return,S)}}break;case 3:if(Qt(e,t),un(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{co(e.containerInfo)}catch(S){Oe(t,t.return,S)}break;case 4:Qt(e,t),un(t);break;case 13:Qt(e,t),un(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Dh=Me())),r&4&&Vm(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(ht=(d=ht)||p,Qt(e,t),ht=d):Qt(e,t),un(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!p&&t.mode&1)for(G=t,p=t.child;p!==null;){for(g=G=p;G!==null;){switch(m=G,E=m.child,m.tag){case 0:case 11:case 14:case 15:Yi(4,m,m.return);break;case 1:Rs(m,m.return);var N=m.stateNode;if(typeof N.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,N.props=e.memoizedProps,N.state=e.memoizedState,N.componentWillUnmount()}catch(S){Oe(r,n,S)}}break;case 5:Rs(m,m.return);break;case 22:if(m.memoizedState!==null){Lm(g);continue}}E!==null?(E.return=m,G=E):Lm(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{s=g.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Vy("display",o))}catch(S){Oe(t,t.return,S)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(S){Oe(t,t.return,S)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Qt(e,t),un(t),r&4&&Vm(t);break;case 21:break;default:Qt(e,t),un(t)}}function un(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(a_(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(oo(s,""),r.flags&=-33);var i=jm(t);_d(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=jm(t);vd(t,l,o);break;default:throw Error(U(161))}}catch(u){Oe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function xI(t,e,n){G=t,c_(t)}function c_(t,e,n){for(var r=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Aa;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||ht;l=Aa;var d=ht;if(Aa=o,(ht=u)&&!d)for(G=s;G!==null;)o=G,u=o.child,o.tag===22&&o.memoizedState!==null?Mm(s):u!==null?(u.return=o,G=u):Mm(s);for(;i!==null;)G=i,c_(i),i=i.sibling;G=s,Aa=l,ht=d}Om(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):Om(t)}}function Om(t){for(;G!==null;){var e=G;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ht||tu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ht)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Yt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&xm(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}xm(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var p=d.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&co(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}ht||e.flags&512&&yd(e)}catch(m){Oe(e,e.return,m)}}if(e===t){G=null;break}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}}function Lm(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var n=e.sibling;if(n!==null){n.return=e.return,G=n;break}G=e.return}}function Mm(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{tu(4,e)}catch(u){Oe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Oe(e,s,u)}}var i=e.return;try{yd(e)}catch(u){Oe(e,i,u)}break;case 5:var o=e.return;try{yd(e)}catch(u){Oe(e,o,u)}}}catch(u){Oe(e,e.return,u)}if(e===t){G=null;break}var l=e.sibling;if(l!==null){l.return=e.return,G=l;break}G=e.return}}var wI=Math.ceil,Il=Wn.ReactCurrentDispatcher,Rh=Wn.ReactCurrentOwner,Ht=Wn.ReactCurrentBatchConfig,de=0,Qe=null,Be=null,tt=0,Dt=0,ks=Rr(0),We=0,Eo=null,Zr=0,nu=0,kh=0,Xi=null,bt=null,Dh=0,Qs=1/0,bn=null,Tl=!1,xd=null,yr=null,Pa=!1,cr=null,bl=0,Ji=0,wd=null,Wa=-1,qa=0;function vt(){return de&6?Me():Wa!==-1?Wa:Wa=Me()}function vr(t){return t.mode&1?de&2&&tt!==0?tt&-tt:sI.transition!==null?(qa===0&&(qa=Gy()),qa):(t=ye,t!==0||(t=window.event,t=t===void 0?16:tv(t.type)),t):1}function tn(t,e,n,r){if(50<Ji)throw Ji=0,wd=null,Error(U(185));Vo(t,n,r),(!(de&2)||t!==Qe)&&(t===Qe&&(!(de&2)&&(nu|=n),We===4&&ir(t,tt)),Pt(t,r),n===1&&de===0&&!(e.mode&1)&&(Qs=Me()+500,Jl&&kr()))}function Pt(t,e){var n=t.callbackNode;sE(t,e);var r=ll(t,t===Qe?tt:0);if(r===0)n!==null&&Kp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Kp(n),e===1)t.tag===0?rI(Fm.bind(null,t)):xv(Fm.bind(null,t)),ZE(function(){!(de&6)&&kr()}),n=null;else{switch(Qy(r)){case 1:n=ih;break;case 4:n=qy;break;case 16:n=al;break;case 536870912:n=Ky;break;default:n=al}n=v_(n,d_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function d_(t,e){if(Wa=-1,qa=0,de&6)throw Error(U(327));var n=t.callbackNode;if(Ms()&&t.callbackNode!==n)return null;var r=ll(t,t===Qe?tt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Sl(t,r);else{e=r;var s=de;de|=2;var i=f_();(Qe!==t||tt!==e)&&(bn=null,Qs=Me()+500,qr(t,e));do try{TI();break}catch(l){h_(t,l)}while(!0);vh(),Il.current=i,de=s,Be!==null?e=0:(Qe=null,tt=0,e=We)}if(e!==0){if(e===2&&(s=Gc(t),s!==0&&(r=s,e=Ed(t,s))),e===1)throw n=Eo,qr(t,0),ir(t,r),Pt(t,Me()),n;if(e===6)ir(t,r);else{if(s=t.current.alternate,!(r&30)&&!EI(s)&&(e=Sl(t,r),e===2&&(i=Gc(t),i!==0&&(r=i,e=Ed(t,i))),e===1))throw n=Eo,qr(t,0),ir(t,r),Pt(t,Me()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:Fr(t,bt,bn);break;case 3:if(ir(t,r),(r&130023424)===r&&(e=Dh+500-Me(),10<e)){if(ll(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){vt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=nd(Fr.bind(null,t,bt,bn),e);break}Fr(t,bt,bn);break;case 4:if(ir(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-en(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Me()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wI(r/1960))-r,10<r){t.timeoutHandle=nd(Fr.bind(null,t,bt,bn),r);break}Fr(t,bt,bn);break;case 5:Fr(t,bt,bn);break;default:throw Error(U(329))}}}return Pt(t,Me()),t.callbackNode===n?d_.bind(null,t):null}function Ed(t,e){var n=Xi;return t.current.memoizedState.isDehydrated&&(qr(t,e).flags|=256),t=Sl(t,e),t!==2&&(e=bt,bt=n,e!==null&&Id(e)),t}function Id(t){bt===null?bt=t:bt.push.apply(bt,t)}function EI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!sn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ir(t,e){for(e&=~kh,e&=~nu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-en(e),r=1<<n;t[n]=-1,e&=~r}}function Fm(t){if(de&6)throw Error(U(327));Ms();var e=ll(t,0);if(!(e&1))return Pt(t,Me()),null;var n=Sl(t,e);if(t.tag!==0&&n===2){var r=Gc(t);r!==0&&(e=r,n=Ed(t,r))}if(n===1)throw n=Eo,qr(t,0),ir(t,e),Pt(t,Me()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fr(t,bt,bn),Pt(t,Me()),null}function jh(t,e){var n=de;de|=1;try{return t(e)}finally{de=n,de===0&&(Qs=Me()+500,Jl&&kr())}}function es(t){cr!==null&&cr.tag===0&&!(de&6)&&Ms();var e=de;de|=1;var n=Ht.transition,r=ye;try{if(Ht.transition=null,ye=1,t)return t()}finally{ye=r,Ht.transition=n,de=e,!(de&6)&&kr()}}function Vh(){Dt=ks.current,Ae(ks)}function qr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,JE(n)),Be!==null)for(n=Be.return;n!==null;){var r=n;switch(mh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fl();break;case 3:Ks(),Ae(Ct),Ae(pt),Th();break;case 5:Ih(r);break;case 4:Ks();break;case 13:Ae(Re);break;case 19:Ae(Re);break;case 10:_h(r.type._context);break;case 22:case 23:Vh()}n=n.return}if(Qe=t,Be=t=_r(t.current,null),tt=Dt=e,We=0,Eo=null,kh=nu=Zr=0,bt=Xi=null,$r!==null){for(e=0;e<$r.length;e++)if(n=$r[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}$r=null}return t}function h_(t,e){do{var n=Be;try{if(vh(),$a.current=El,wl){for(var r=ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}wl=!1}if(Jr=0,Ge=He=ke=null,Qi=!1,_o=0,Rh.current=null,n===null||n.return===null){We=1,Eo=e,Be=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=tt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,p=l,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=Sm(o);if(E!==null){E.flags&=-257,Cm(E,o,l,i,e),E.mode&1&&bm(i,d,e),e=E,u=d;var N=e.updateQueue;if(N===null){var S=new Set;S.add(u),e.updateQueue=S}else N.add(u);break e}else{if(!(e&1)){bm(i,d,e),Oh();break e}u=Error(U(426))}}else if(Ne&&l.mode&1){var D=Sm(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),Cm(D,o,l,i,e),gh(Gs(u,l));break e}}i=u=Gs(u,l),We!==4&&(We=2),Xi===null?Xi=[i]:Xi.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=Qv(i,u,e);_m(i,T);break e;case 1:l=u;var w=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(yr===null||!yr.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=Yv(i,l,e);_m(i,P);break e}}i=i.return}while(i!==null)}m_(n)}catch(R){e=R,Be===n&&n!==null&&(Be=n=n.return);continue}break}while(!0)}function f_(){var t=Il.current;return Il.current=El,t===null?El:t}function Oh(){(We===0||We===3||We===2)&&(We=4),Qe===null||!(Zr&268435455)&&!(nu&268435455)||ir(Qe,tt)}function Sl(t,e){var n=de;de|=2;var r=f_();(Qe!==t||tt!==e)&&(bn=null,qr(t,e));do try{II();break}catch(s){h_(t,s)}while(!0);if(vh(),de=n,Il.current=r,Be!==null)throw Error(U(261));return Qe=null,tt=0,We}function II(){for(;Be!==null;)p_(Be)}function TI(){for(;Be!==null&&!Q0();)p_(Be)}function p_(t){var e=y_(t.alternate,t,Dt);t.memoizedProps=t.pendingProps,e===null?m_(t):Be=e,Rh.current=null}function m_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=yI(n,e),n!==null){n.flags&=32767,Be=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{We=6,Be=null;return}}else if(n=gI(n,e,Dt),n!==null){Be=n;return}if(e=e.sibling,e!==null){Be=e;return}Be=e=t}while(e!==null);We===0&&(We=5)}function Fr(t,e,n){var r=ye,s=Ht.transition;try{Ht.transition=null,ye=1,bI(t,e,n,r)}finally{Ht.transition=s,ye=r}return null}function bI(t,e,n,r){do Ms();while(cr!==null);if(de&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(iE(t,i),t===Qe&&(Be=Qe=null,tt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Pa||(Pa=!0,v_(al,function(){return Ms(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ht.transition,Ht.transition=null;var o=ye;ye=1;var l=de;de|=4,Rh.current=null,_I(t,n),u_(n,t),WE(ed),ul=!!Zc,ed=Zc=null,t.current=n,xI(n),Y0(),de=l,ye=o,Ht.transition=i}else t.current=n;if(Pa&&(Pa=!1,cr=t,bl=s),i=t.pendingLanes,i===0&&(yr=null),Z0(n.stateNode),Pt(t,Me()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Tl)throw Tl=!1,t=xd,xd=null,t;return bl&1&&t.tag!==0&&Ms(),i=t.pendingLanes,i&1?t===wd?Ji++:(Ji=0,wd=t):Ji=0,kr(),null}function Ms(){if(cr!==null){var t=Qy(bl),e=Ht.transition,n=ye;try{if(Ht.transition=null,ye=16>t?16:t,cr===null)var r=!1;else{if(t=cr,cr=null,bl=0,de&6)throw Error(U(331));var s=de;for(de|=4,G=t.current;G!==null;){var i=G,o=i.child;if(G.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(G=d;G!==null;){var p=G;switch(p.tag){case 0:case 11:case 15:Yi(8,p,i)}var g=p.child;if(g!==null)g.return=p,G=g;else for(;G!==null;){p=G;var m=p.sibling,E=p.return;if(o_(p),p===d){G=null;break}if(m!==null){m.return=E,G=m;break}G=E}}}var N=i.alternate;if(N!==null){var S=N.child;if(S!==null){N.child=null;do{var D=S.sibling;S.sibling=null,S=D}while(S!==null)}}G=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,G=o;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Yi(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,G=T;break e}G=i.return}}var w=t.current;for(G=w;G!==null;){o=G;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,G=C;else e:for(o=w;G!==null;){if(l=G,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:tu(9,l)}}catch(R){Oe(l,l.return,R)}if(l===o){G=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,G=P;break e}G=l.return}}if(de=s,kr(),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(Kl,t)}catch{}r=!0}return r}finally{ye=n,Ht.transition=e}}return!1}function Um(t,e,n){e=Gs(n,e),e=Qv(t,e,1),t=gr(t,e,1),e=vt(),t!==null&&(Vo(t,1,e),Pt(t,e))}function Oe(t,e,n){if(t.tag===3)Um(t,t,n);else for(;e!==null;){if(e.tag===3){Um(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(yr===null||!yr.has(r))){t=Gs(n,t),t=Yv(e,t,1),e=gr(e,t,1),t=vt(),e!==null&&(Vo(e,1,t),Pt(e,t));break}}e=e.return}}function SI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=vt(),t.pingedLanes|=t.suspendedLanes&n,Qe===t&&(tt&n)===n&&(We===4||We===3&&(tt&130023424)===tt&&500>Me()-Dh?qr(t,0):kh|=n),Pt(t,e)}function g_(t,e){e===0&&(t.mode&1?(e=_a,_a<<=1,!(_a&130023424)&&(_a=4194304)):e=1);var n=vt();t=Fn(t,e),t!==null&&(Vo(t,e,n),Pt(t,n))}function CI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),g_(t,n)}function AI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),g_(t,n)}var y_;y_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ct.current)St=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return St=!1,mI(t,e,n);St=!!(t.flags&131072)}else St=!1,Ne&&e.flags&1048576&&wv(e,gl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ha(t,e),t=e.pendingProps;var s=Hs(e,pt.current);Ls(e,n),s=Sh(null,e,r,t,s,n);var i=Ch();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,At(r)?(i=!0,pl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,wh(e),s.updater=eu,e.stateNode=s,s._reactInternals=e,ud(e,r,t,n),e=hd(null,e,r,!0,i,n)):(e.tag=0,Ne&&i&&ph(e),yt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ha(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=NI(r),t=Yt(r,t),s){case 0:e=dd(null,e,r,t,n);break e;case 1:e=Nm(null,e,r,t,n);break e;case 11:e=Am(null,e,r,t,n);break e;case 14:e=Pm(null,e,r,Yt(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yt(r,s),dd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yt(r,s),Nm(t,e,r,s,n);case 3:e:{if(e_(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Cv(t,e),_l(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Gs(Error(U(423)),e),e=Rm(t,e,r,n,s);break e}else if(r!==s){s=Gs(Error(U(424)),e),e=Rm(t,e,r,n,s);break e}else for(jt=mr(e.stateNode.containerInfo.firstChild),Vt=e,Ne=!0,Jt=null,n=bv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ws(),r===s){e=Un(t,e,n);break e}yt(t,e,r,n)}e=e.child}return e;case 5:return Av(e),t===null&&od(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,td(r,s)?o=null:i!==null&&td(r,i)&&(e.flags|=32),Zv(t,e),yt(t,e,o,n),e.child;case 6:return t===null&&od(e),null;case 13:return t_(t,e,n);case 4:return Eh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=qs(e,null,r,n):yt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yt(r,s),Am(t,e,r,s,n);case 7:return yt(t,e,e.pendingProps,n),e.child;case 8:return yt(t,e,e.pendingProps.children,n),e.child;case 12:return yt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ie(yl,r._currentValue),r._currentValue=o,i!==null)if(sn(i.value,o)){if(i.children===s.children&&!Ct.current){e=Un(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=jn(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var p=d.pending;p===null?u.next=u:(u.next=p.next,p.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),ad(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ad(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}yt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ls(e,n),s=qt(s),r=r(s),e.flags|=1,yt(t,e,r,n),e.child;case 14:return r=e.type,s=Yt(r,e.pendingProps),s=Yt(r.type,s),Pm(t,e,r,s,n);case 15:return Xv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yt(r,s),Ha(t,e),e.tag=1,At(r)?(t=!0,pl(e)):t=!1,Ls(e,n),Gv(e,r,s),ud(e,r,s,n),hd(null,e,r,!0,t,n);case 19:return n_(t,e,n);case 22:return Jv(t,e,n)}throw Error(U(156,e.tag))};function v_(t,e){return Wy(t,e)}function PI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zt(t,e,n,r){return new PI(t,e,n,r)}function Lh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function NI(t){if(typeof t=="function")return Lh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===nh)return 11;if(t===rh)return 14}return 2}function _r(t,e){var n=t.alternate;return n===null?(n=zt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ka(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Lh(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Es:return Kr(n.children,s,i,e);case th:o=8,s|=8;break;case Dc:return t=zt(12,n,e,s|2),t.elementType=Dc,t.lanes=i,t;case jc:return t=zt(13,n,e,s),t.elementType=jc,t.lanes=i,t;case Vc:return t=zt(19,n,e,s),t.elementType=Vc,t.lanes=i,t;case Ay:return ru(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Sy:o=10;break e;case Cy:o=9;break e;case nh:o=11;break e;case rh:o=14;break e;case nr:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=zt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Kr(t,e,n,r){return t=zt(7,t,r,e),t.lanes=n,t}function ru(t,e,n,r){return t=zt(22,t,r,e),t.elementType=Ay,t.lanes=n,t.stateNode={isHidden:!1},t}function mc(t,e,n){return t=zt(6,t,null,e),t.lanes=n,t}function gc(t,e,n){return e=zt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function RI(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yu(0),this.expirationTimes=Yu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Mh(t,e,n,r,s,i,o,l,u){return t=new RI(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=zt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},wh(i),t}function kI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ws,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function __(t){if(!t)return br;t=t._reactInternals;e:{if(as(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(At(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(At(n))return _v(t,n,e)}return e}function x_(t,e,n,r,s,i,o,l,u){return t=Mh(n,r,!0,t,s,i,o,l,u),t.context=__(null),n=t.current,r=vt(),s=vr(n),i=jn(r,s),i.callback=e??null,gr(n,i,s),t.current.lanes=s,Vo(t,s,r),Pt(t,r),t}function su(t,e,n,r){var s=e.current,i=vt(),o=vr(s);return n=__(n),e.context===null?e.context=n:e.pendingContext=n,e=jn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=gr(s,e,o),t!==null&&(tn(t,s,o,i),Ba(t,s,o)),o}function Cl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Bm(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Fh(t,e){Bm(t,e),(t=t.alternate)&&Bm(t,e)}function DI(){return null}var w_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Uh(t){this._internalRoot=t}iu.prototype.render=Uh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));su(t,e,null,null)};iu.prototype.unmount=Uh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;es(function(){su(null,t,null,null)}),e[Mn]=null}};function iu(t){this._internalRoot=t}iu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Jy();t={blockedOn:null,target:t,priority:e};for(var n=0;n<sr.length&&e!==0&&e<sr[n].priority;n++);sr.splice(n,0,t),n===0&&ev(t)}};function Bh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ou(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function $m(){}function jI(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Cl(o);i.call(d)}}var o=x_(e,r,t,0,null,!1,!1,"",$m);return t._reactRootContainer=o,t[Mn]=o.current,po(t.nodeType===8?t.parentNode:t),es(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Cl(u);l.call(d)}}var u=Mh(t,0,!1,null,null,!1,!1,"",$m);return t._reactRootContainer=u,t[Mn]=u.current,po(t.nodeType===8?t.parentNode:t),es(function(){su(e,u,n,r)}),u}function au(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=Cl(o);l.call(u)}}su(e,o,t,s)}else o=jI(n,e,t,s,r);return Cl(o)}Yy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Mi(e.pendingLanes);n!==0&&(oh(e,n|1),Pt(e,Me()),!(de&6)&&(Qs=Me()+500,kr()))}break;case 13:es(function(){var r=Fn(t,1);if(r!==null){var s=vt();tn(r,t,1,s)}}),Fh(t,1)}};ah=function(t){if(t.tag===13){var e=Fn(t,134217728);if(e!==null){var n=vt();tn(e,t,134217728,n)}Fh(t,134217728)}};Xy=function(t){if(t.tag===13){var e=vr(t),n=Fn(t,e);if(n!==null){var r=vt();tn(n,t,e,r)}Fh(t,e)}};Jy=function(){return ye};Zy=function(t,e){var n=ye;try{return ye=t,e()}finally{ye=n}};Wc=function(t,e,n){switch(e){case"input":if(Mc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Xl(r);if(!s)throw Error(U(90));Ny(r),Mc(r,s)}}}break;case"textarea":ky(t,n);break;case"select":e=n.value,e!=null&&Ds(t,!!n.multiple,e,!1)}};Fy=jh;Uy=es;var VI={usingClientEntryPoint:!1,Events:[Lo,Ss,Xl,Ly,My,jh]},ji={findFiberByHostInstance:Br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},OI={bundleType:ji.bundleType,version:ji.version,rendererPackageName:ji.rendererPackageName,rendererConfig:ji.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=zy(t),t===null?null:t.stateNode},findFiberByHostInstance:ji.findFiberByHostInstance||DI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Na=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Na.isDisabled&&Na.supportsFiber)try{Kl=Na.inject(OI),hn=Na}catch{}}Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VI;Lt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bh(e))throw Error(U(200));return kI(t,e,null,n)};Lt.createRoot=function(t,e){if(!Bh(t))throw Error(U(299));var n=!1,r="",s=w_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Mh(t,1,!1,null,null,n,!1,r,s),t[Mn]=e.current,po(t.nodeType===8?t.parentNode:t),new Uh(e)};Lt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=zy(e),t=t===null?null:t.stateNode,t};Lt.flushSync=function(t){return es(t)};Lt.hydrate=function(t,e,n){if(!ou(e))throw Error(U(200));return au(null,t,e,!0,n)};Lt.hydrateRoot=function(t,e,n){if(!Bh(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=w_;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=x_(e,null,t,1,n??null,s,!1,i,o),t[Mn]=e.current,po(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new iu(e)};Lt.render=function(t,e,n){if(!ou(e))throw Error(U(200));return au(null,t,e,!1,n)};Lt.unmountComponentAtNode=function(t){if(!ou(t))throw Error(U(40));return t._reactRootContainer?(es(function(){au(null,null,t,!1,function(){t._reactRootContainer=null,t[Mn]=null})}),!0):!1};Lt.unstable_batchedUpdates=jh;Lt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ou(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return au(t,e,n,!1,r)};Lt.version="18.3.1-next-f1338f8080-20240426";function E_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E_)}catch(t){console.error(t)}}E_(),Ey.exports=Lt;var LI=Ey.exports,zm=LI;Rc.createRoot=zm.createRoot,Rc.hydrateRoot=zm.hydrateRoot;var Hm={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},MI=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},T_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,p=i>>2,g=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,E=d&63;u||(E=64,o||(m=64)),r.push(n[p],n[g],n[m],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(I_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):MI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||g==null)throw new FI;const m=i<<2|l>>4;if(r.push(m),d!==64){const E=l<<4&240|d>>2;if(r.push(E),g!==64){const N=d<<6&192|g;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class FI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const UI=function(t){const e=I_(t);return T_.encodeByteArray(e,!0)},Al=function(t){return UI(t).replace(/\./g,"")},b_=function(t){try{return T_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I=()=>BI().__FIREBASE_DEFAULTS__,zI=()=>{if(typeof process>"u"||typeof Hm>"u")return;const t=Hm.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},HI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&b_(t[1]);return e&&JSON.parse(e)},lu=()=>{try{return $I()||zI()||HI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},S_=t=>{var e,n;return(n=(e=lu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},WI=t=>{const e=S_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},C_=()=>{var t;return(t=lu())===null||t===void 0?void 0:t.config},A_=t=>{var e;return(e=lu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Al(JSON.stringify(n)),Al(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function GI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mt())}function QI(){var t;const e=(t=lu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function JI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ZI(){const t=mt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function eT(){return!QI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tT(){try{return typeof indexedDB=="object"}catch{return!1}}function nT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT="FirebaseError";class qn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=rT,Object.setPrototypeOf(this,qn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fo.prototype.create)}}class Fo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?sT(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new qn(s,l,r)}}function sT(t,e){return t.replace(iT,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const iT=/\{\$([^}]+)}/g;function oT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Pl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Wm(i)&&Wm(o)){if(!Pl(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Wm(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function aT(t,e){const n=new lT(t,e);return n.subscribe.bind(n)}class lT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");uT(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=yc),s.error===void 0&&(s.error=yc),s.complete===void 0&&(s.complete=yc);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function yc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t){return t&&t._delegate?t._delegate:t}class ts{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ur="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new qI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hT(e))try{this.getOrInitializeService({instanceIdentifier:Ur})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ur){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ur){return this.instances.has(e)}getOptions(e=Ur){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:dT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ur){return this.component?this.component.multipleInstances?e:Ur:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dT(t){return t===Ur?void 0:t}function hT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new cT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ue;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ue||(ue={}));const pT={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},mT=ue.INFO,gT={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},yT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=gT[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $h{constructor(e){this.name=e,this._logLevel=mT,this._logHandler=yT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}}const vT=(t,e)=>e.some(n=>t instanceof n);let qm,Km;function _T(){return qm||(qm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xT(){return Km||(Km=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const P_=new WeakMap,Td=new WeakMap,N_=new WeakMap,vc=new WeakMap,zh=new WeakMap;function wT(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(xr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&P_.set(n,t)}).catch(()=>{}),zh.set(e,t),e}function ET(t){if(Td.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Td.set(t,e)}let bd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Td.get(t);if(e==="objectStoreNames")return t.objectStoreNames||N_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function IT(t){bd=t(bd)}function TT(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_c(this),e,...n);return N_.set(r,e.sort?e.sort():[e]),xr(r)}:xT().includes(t)?function(...e){return t.apply(_c(this),e),xr(P_.get(this))}:function(...e){return xr(t.apply(_c(this),e))}}function bT(t){return typeof t=="function"?TT(t):(t instanceof IDBTransaction&&ET(t),vT(t,_T())?new Proxy(t,bd):t)}function xr(t){if(t instanceof IDBRequest)return wT(t);if(vc.has(t))return vc.get(t);const e=bT(t);return e!==t&&(vc.set(t,e),zh.set(e,t)),e}const _c=t=>zh.get(t);function ST(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=xr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(xr(o.result),u.oldVersion,u.newVersion,xr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const CT=["get","getKey","getAll","getAllKeys","count"],AT=["put","add","delete","clear"],xc=new Map;function Gm(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xc.get(e))return xc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=AT.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||CT.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return xc.set(e,i),i}IT(t=>({...t,get:(e,n,r)=>Gm(e,n)||t.get(e,n,r),has:(e,n)=>!!Gm(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(NT(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function NT(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sd="@firebase/app",Qm="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn=new $h("@firebase/app"),RT="@firebase/app-compat",kT="@firebase/analytics-compat",DT="@firebase/analytics",jT="@firebase/app-check-compat",VT="@firebase/app-check",OT="@firebase/auth",LT="@firebase/auth-compat",MT="@firebase/database",FT="@firebase/data-connect",UT="@firebase/database-compat",BT="@firebase/functions",$T="@firebase/functions-compat",zT="@firebase/installations",HT="@firebase/installations-compat",WT="@firebase/messaging",qT="@firebase/messaging-compat",KT="@firebase/performance",GT="@firebase/performance-compat",QT="@firebase/remote-config",YT="@firebase/remote-config-compat",XT="@firebase/storage",JT="@firebase/storage-compat",ZT="@firebase/firestore",eb="@firebase/vertexai-preview",tb="@firebase/firestore-compat",nb="firebase",rb="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd="[DEFAULT]",sb={[Sd]:"fire-core",[RT]:"fire-core-compat",[DT]:"fire-analytics",[kT]:"fire-analytics-compat",[VT]:"fire-app-check",[jT]:"fire-app-check-compat",[OT]:"fire-auth",[LT]:"fire-auth-compat",[MT]:"fire-rtdb",[FT]:"fire-data-connect",[UT]:"fire-rtdb-compat",[BT]:"fire-fn",[$T]:"fire-fn-compat",[zT]:"fire-iid",[HT]:"fire-iid-compat",[WT]:"fire-fcm",[qT]:"fire-fcm-compat",[KT]:"fire-perf",[GT]:"fire-perf-compat",[QT]:"fire-rc",[YT]:"fire-rc-compat",[XT]:"fire-gcs",[JT]:"fire-gcs-compat",[ZT]:"fire-fst",[tb]:"fire-fst-compat",[eb]:"fire-vertex","fire-js":"fire-js",[nb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl=new Map,ib=new Map,Ad=new Map;function Ym(t,e){try{t.container.addComponent(e)}catch(n){Bn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ys(t){const e=t.name;if(Ad.has(e))return Bn.debug(`There were multiple attempts to register component ${e}.`),!1;Ad.set(e,t);for(const n of Nl.values())Ym(n,t);for(const n of ib.values())Ym(n,t);return!0}function Hh(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Nn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wr=new Fo("app","Firebase",ob);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ts("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li=rb;function R_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Cd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw wr.create("bad-app-name",{appName:String(s)});if(n||(n=C_()),!n)throw wr.create("no-options");const i=Nl.get(s);if(i){if(Pl(n,i.options)&&Pl(r,i.config))return i;throw wr.create("duplicate-app",{appName:s})}const o=new fT(s);for(const u of Ad.values())o.addComponent(u);const l=new ab(n,r,o);return Nl.set(s,l),l}function k_(t=Cd){const e=Nl.get(t);if(!e&&t===Cd&&C_())return R_();if(!e)throw wr.create("no-app",{appName:t});return e}function Er(t,e,n){var r;let s=(r=sb[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bn.warn(l.join(" "));return}Ys(new ts(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb="firebase-heartbeat-database",ub=1,Io="firebase-heartbeat-store";let wc=null;function D_(){return wc||(wc=ST(lb,ub,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Io)}catch(n){console.warn(n)}}}}).catch(t=>{throw wr.create("idb-open",{originalErrorMessage:t.message})})),wc}async function cb(t){try{const n=(await D_()).transaction(Io),r=await n.objectStore(Io).get(j_(t));return await n.done,r}catch(e){if(e instanceof qn)Bn.warn(e.message);else{const n=wr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Bn.warn(n.message)}}}async function Xm(t,e){try{const r=(await D_()).transaction(Io,"readwrite");await r.objectStore(Io).put(e,j_(t)),await r.done}catch(n){if(n instanceof qn)Bn.warn(n.message);else{const r=wr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Bn.warn(r.message)}}}function j_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db=1024,hb=30*24*60*60*1e3;class fb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new mb(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Jm();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=hb}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Bn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Jm(),{heartbeatsToSend:r,unsentEntries:s}=pb(this._heartbeatsCache.heartbeats),i=Al(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Bn.warn(n),""}}}function Jm(){return new Date().toISOString().substring(0,10)}function pb(t,e=db){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Zm(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Zm(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class mb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return tT()?nT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await cb(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Xm(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Xm(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Zm(t){return Al(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(t){Ys(new ts("platform-logger",e=>new PT(e),"PRIVATE")),Ys(new ts("heartbeat",e=>new fb(e),"PRIVATE")),Er(Sd,Qm,t),Er(Sd,Qm,"esm2017"),Er("fire-js","")}gb("");function Wh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function V_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yb=V_,O_=new Fo("auth","Firebase",V_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl=new $h("@firebase/auth");function vb(t,...e){Rl.logLevel<=ue.WARN&&Rl.warn(`Auth (${li}): ${t}`,...e)}function Ga(t,...e){Rl.logLevel<=ue.ERROR&&Rl.error(`Auth (${li}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(t,...e){throw Kh(t,...e)}function nn(t,...e){return Kh(t,...e)}function qh(t,e,n){const r=Object.assign(Object.assign({},yb()),{[e]:n});return new Fo("auth","Firebase",r).create(e,{appName:t.name})}function Gr(t){return qh(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _b(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&yn(t,"argument-error"),qh(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Kh(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return O_.create(t,...e)}function te(t,e,...n){if(!t)throw Kh(e,...n)}function Rn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ga(e),new Error(e)}function $n(t,e){t||Rn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function xb(){return eg()==="http:"||eg()==="https:"}function eg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xb()||XI()||"connection"in navigator)?navigator.onLine:!0}function Eb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,n){this.shortDelay=e,this.longDelay=n,$n(n>e,"Short delay should be less than long delay!"),this.isMobile=GI()||JI()}get(){return wb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(t,e){$n(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Rn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Rn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Rn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tb=new Bo(3e4,6e4);function Qh(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ui(t,e,n,r,s={}){return M_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Uo(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return YI()||(d.referrerPolicy="no-referrer"),L_.fetch()(F_(t,t.config.apiHost,n,l),d)})}async function M_(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Ib),e);try{const s=new Sb(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ra(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ra(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ra(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ra(t,"user-disabled",o);const p=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw qh(t,p,d);yn(t,p)}}catch(s){if(s instanceof qn)throw s;yn(t,"network-request-failed",{message:String(s)})}}async function bb(t,e,n,r,s={}){const i=await ui(t,e,n,r,s);return"mfaPendingCredential"in i&&yn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function F_(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Gh(t.config,s):`${t.config.apiScheme}://${s}`}class Sb{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(nn(this.auth,"network-request-failed")),Tb.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ra(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=nn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cb(t,e){return ui(t,"POST","/v1/accounts:delete",e)}async function U_(t,e){return ui(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zi(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ab(t,e=!1){const n=xt(t),r=await n.getIdToken(e),s=Yh(r);te(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Zi(Ec(s.auth_time)),issuedAtTime:Zi(Ec(s.iat)),expirationTime:Zi(Ec(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ec(t){return Number(t)*1e3}function Yh(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ga("JWT malformed, contained fewer than 3 sections"),null;try{const s=b_(n);return s?JSON.parse(s):(Ga("Failed to decode base64 JWT payload"),null)}catch(s){return Ga("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function tg(t){const e=Yh(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function To(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof qn&&Pb(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Pb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zi(this.lastLoginAt),this.creationTime=Zi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kl(t){var e;const n=t.auth,r=await t.getIdToken(),s=await To(t,U_(n,{idToken:r}));te(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?B_(i.providerUserInfo):[],l=kb(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),p=u?d:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Nd(i.createdAt,i.lastLoginAt),isAnonymous:p};Object.assign(t,g)}async function Rb(t){const e=xt(t);await kl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kb(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function B_(t){return t.map(e=>{var{providerId:n}=e,r=Wh(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Db(t,e){const n=await M_(t,{},async()=>{const r=Uo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=F_(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",L_.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function jb(t,e){return ui(t,"POST","/v2/accounts:revokeToken",Qh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){te(e.length!==0,"internal-error");const n=tg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await Db(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Fs;return r&&(te(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(te(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(te(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fs,this.toJSON())}_performRefresh(){return Rn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class kn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Wh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Nb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Nd(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await To(this,this.stsTokenManager.getToken(this.auth,e));return te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Ab(this,e)}reload(){return Rb(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new kn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await kl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nn(this.auth.app))return Promise.reject(Gr(this.auth));const e=await this.getIdToken();return await To(this,Cb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,u,d,p;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,E=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,N=(o=n.photoURL)!==null&&o!==void 0?o:void 0,S=(l=n.tenantId)!==null&&l!==void 0?l:void 0,D=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,T=(d=n.createdAt)!==null&&d!==void 0?d:void 0,w=(p=n.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:C,emailVerified:P,isAnonymous:R,providerData:j,stsTokenManager:v}=n;te(C&&v,e,"internal-error");const y=Fs.fromJSON(this.name,v);te(typeof C=="string",e,"internal-error"),tr(g,e.name),tr(m,e.name),te(typeof P=="boolean",e,"internal-error"),te(typeof R=="boolean",e,"internal-error"),tr(E,e.name),tr(N,e.name),tr(S,e.name),tr(D,e.name),tr(T,e.name),tr(w,e.name);const I=new kn({uid:C,auth:e,email:m,emailVerified:P,displayName:g,isAnonymous:R,photoURL:N,phoneNumber:E,tenantId:S,stsTokenManager:y,createdAt:T,lastLoginAt:w});return j&&Array.isArray(j)&&(I.providerData=j.map(A=>Object.assign({},A))),D&&(I._redirectEventId=D),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new Fs;s.updateFromServerResponse(n);const i=new kn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await kl(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];te(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?B_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Fs;l.updateFromIdToken(r);const u=new kn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Nd(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=new Map;function Dn(t){$n(t instanceof Function,"Expected a class definition");let e=ng.get(t);return e?($n(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ng.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}$_.type="NONE";const rg=$_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(t,e,n){return`firebase:${t}:${e}:${n}`}class Us{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Qa(this.userKey,s.apiKey,i),this.fullPersistenceKey=Qa("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?kn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Us(Dn(rg),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Dn(rg);const o=Qa(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const p=await d._get(o);if(p){const g=kn._fromJSON(e,p);d!==i&&(l=g),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Us(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Us(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(q_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(z_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(G_(e))return"Blackberry";if(Q_(e))return"Webos";if(H_(e))return"Safari";if((e.includes("chrome/")||W_(e))&&!e.includes("edge/"))return"Chrome";if(K_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function z_(t=mt()){return/firefox\//i.test(t)}function H_(t=mt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function W_(t=mt()){return/crios\//i.test(t)}function q_(t=mt()){return/iemobile/i.test(t)}function K_(t=mt()){return/android/i.test(t)}function G_(t=mt()){return/blackberry/i.test(t)}function Q_(t=mt()){return/webos/i.test(t)}function Xh(t=mt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Vb(t=mt()){var e;return Xh(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Ob(){return ZI()&&document.documentMode===10}function Y_(t=mt()){return Xh(t)||K_(t)||Q_(t)||G_(t)||/windows phone/i.test(t)||q_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(t,e=[]){let n;switch(t){case"Browser":n=sg(mt());break;case"Worker":n=`${sg(mt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${li}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mb(t,e={}){return ui(t,"GET","/v2/passwordPolicy",Qh(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb=6;class Ub{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Fb,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ig(this),this.idTokenSubscription=new ig(this),this.beforeStateQueue=new Lb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=O_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Dn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Us.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await U_(this,{idToken:e}),r=await kn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Nn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await kl(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Eb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nn(this.app))return Promise.reject(Gr(this));const n=e?xt(e):null;return n&&te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nn(this.app)?Promise.reject(Gr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nn(this.app)?Promise.reject(Gr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Dn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Mb(this),n=new Ub(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await jb(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Dn(e)||this._popupRedirectResolver;te(n,this,"argument-error"),this.redirectPersistenceManager=await Us.create(this,[Dn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=X_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&vb(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function uu(t){return xt(t)}class ig{constructor(e){this.auth=e,this.observer=null,this.addObserver=aT(n=>this.observer=n)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $b(t){Jh=t}function zb(t){return Jh.loadJS(t)}function Hb(){return Jh.gapiScript}function Wb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(t,e){const n=Hh(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Pl(i,e??{}))return s;yn(s,"already-initialized")}return n.initialize({options:e})}function Kb(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Dn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Gb(t,e,n){const r=uu(t);te(r._canInitEmulator,r,"emulator-config-failed"),te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=J_(e),{host:o,port:l}=Qb(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),Yb()}function J_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Qb(t){const e=J_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:og(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:og(o)}}}function og(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Yb(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Rn("not implemented")}_getIdTokenResponse(e){return Rn("not implemented")}_linkToIdToken(e,n){return Rn("not implemented")}_getReauthenticationResolver(e){return Rn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bs(t,e){return bb(t,"POST","/v1/accounts:signInWithIdp",Qh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="http://localhost";class ns extends Z_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ns(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):yn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Wh(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new ns(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Bs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Bs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Bs(e,n)}buildRequest(){const e={requestUri:Xb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Uo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o extends Zh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or extends $o{constructor(){super("facebook.com")}static credential(e){return ns._fromParams({providerId:or.PROVIDER_ID,signInMethod:or.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return or.credentialFromTaggedObject(e)}static credentialFromError(e){return or.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return or.credential(e.oauthAccessToken)}catch{return null}}}or.FACEBOOK_SIGN_IN_METHOD="facebook.com";or.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn extends $o{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ns._fromParams({providerId:Cn.PROVIDER_ID,signInMethod:Cn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Cn.credentialFromTaggedObject(e)}static credentialFromError(e){return Cn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Cn.credential(n,r)}catch{return null}}}Cn.GOOGLE_SIGN_IN_METHOD="google.com";Cn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar extends $o{constructor(){super("github.com")}static credential(e){return ns._fromParams({providerId:ar.PROVIDER_ID,signInMethod:ar.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ar.credentialFromTaggedObject(e)}static credentialFromError(e){return ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ar.credential(e.oauthAccessToken)}catch{return null}}}ar.GITHUB_SIGN_IN_METHOD="github.com";ar.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr extends $o{constructor(){super("twitter.com")}static credential(e,n){return ns._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return lr.credentialFromTaggedObject(e)}static credentialFromError(e){return lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return lr.credential(n,r)}catch{return null}}}lr.TWITTER_SIGN_IN_METHOD="twitter.com";lr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await kn._fromIdTokenResponse(e,r,s),o=ag(r);return new Xs({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=ag(r);return new Xs({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function ag(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl extends qn{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Dl.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Dl(e,n,r,s)}}function ex(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Dl._fromErrorAndOperation(t,i,e,r):i})}async function Jb(t,e,n=!1){const r=await To(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Xs._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zb(t,e,n=!1){const{auth:r}=t;if(Nn(r.app))return Promise.reject(Gr(r));const s="reauthenticate";try{const i=await To(t,ex(r,s,e,t),n);te(i.idToken,r,"internal-error");const o=Yh(i.idToken);te(o,r,"internal-error");const{sub:l}=o;return te(t.uid===l,r,"user-mismatch"),Xs._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&yn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eS(t,e,n=!1){if(Nn(t.app))return Promise.reject(Gr(t));const r="signIn",s=await ex(t,r,e),i=await Xs._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function tS(t,e,n,r){return xt(t).onIdTokenChanged(e,n,r)}function nS(t,e,n){return xt(t).beforeAuthStateChanged(e,n)}function rS(t,e,n,r){return xt(t).onAuthStateChanged(e,n,r)}function sS(t){return xt(t).signOut()}const jl="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(jl,"1"),this.storage.removeItem(jl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS=1e3,oS=10;class nx extends tx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Y_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Ob()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,oS):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},iS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}nx.type="LOCAL";const aS=nx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx extends tx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}rx.type="SESSION";const sx=rx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lS(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new cu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),u=await lS(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}cu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=ef("",20);s.port1.start();const p=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const m=g;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(p),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(p),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return window}function cS(t){pn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function dS(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hS(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function fS(){return ix()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ox="firebaseLocalStorageDb",pS=1,Vl="firebaseLocalStorage",ax="fbase_key";class zo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function du(t,e){return t.transaction([Vl],e?"readwrite":"readonly").objectStore(Vl)}function mS(){const t=indexedDB.deleteDatabase(ox);return new zo(t).toPromise()}function Rd(){const t=indexedDB.open(ox,pS);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Vl,{keyPath:ax})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Vl)?e(r):(r.close(),await mS(),e(await Rd()))})})}async function lg(t,e,n){const r=du(t,!0).put({[ax]:e,value:n});return new zo(r).toPromise()}async function gS(t,e){const n=du(t,!1).get(e),r=await new zo(n).toPromise();return r===void 0?null:r.value}function ug(t,e){const n=du(t,!0).delete(e);return new zo(n).toPromise()}const yS=800,vS=3;class lx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Rd(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>vS)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ix()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=cu._getInstance(fS()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await dS(),!this.activeServiceWorker)return;this.sender=new uS(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hS()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rd();return await lg(e,jl,"1"),await ug(e,jl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>lg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>gS(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ug(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=du(s,!1).getAll();return new zo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lx.type="LOCAL";const _S=lx;new Bo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(t,e){return e?Dn(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends Z_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Bs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Bs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function xS(t){return eS(t.auth,new tf(t),t.bypassAuthState)}function wS(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),Zb(n,new tf(t),t.bypassAuthState)}async function ES(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),Jb(n,new tf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xS;case"linkViaPopup":case"linkViaRedirect":return ES;case"reauthViaPopup":case"reauthViaRedirect":return wS;default:yn(this.auth,"internal-error")}}resolve(e){$n(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$n(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS=new Bo(2e3,1e4);async function TS(t,e,n){if(Nn(t.app))return Promise.reject(nn(t,"operation-not-supported-in-this-environment"));const r=uu(t);_b(t,e,Zh);const s=ux(r,n);return new Hr(r,"signInViaPopup",e,s).executeNotNull()}class Hr extends cx{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Hr.currentPopupAction&&Hr.currentPopupAction.cancel(),Hr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){$n(this.filter.length===1,"Popup operations only handle one event");const e=ef();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(nn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(nn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,IS.get())};e()}}Hr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS="pendingRedirect",Ya=new Map;class SS extends cx{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ya.get(this.auth._key());if(!e){try{const r=await CS(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ya.set(this.auth._key(),e)}return this.bypassAuthState||Ya.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CS(t,e){const n=NS(e),r=PS(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function AS(t,e){Ya.set(t._key(),e)}function PS(t){return Dn(t._redirectPersistence)}function NS(t){return Qa(bS,t.config.apiKey,t.name)}async function RS(t,e,n=!1){if(Nn(t.app))return Promise.reject(Gr(t));const r=uu(t),s=ux(r,e),o=await new SS(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kS=10*60*1e3;class DS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!jS(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!dx(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(nn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=kS&&this.cachedEventUids.clear(),this.cachedEventUids.has(cg(e))}saveEventToCache(e){this.cachedEventUids.add(cg(e)),this.lastProcessedEventTime=Date.now()}}function cg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function dx({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function jS(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dx(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VS(t,e={}){return ui(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,LS=/^https?/;async function MS(t){if(t.config.emulator)return;const{authorizedDomains:e}=await VS(t);for(const n of e)try{if(FS(n))return}catch{}yn(t,"unauthorized-domain")}function FS(t){const e=Pd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!LS.test(n))return!1;if(OS.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const US=new Bo(3e4,6e4);function dg(){const t=pn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function BS(t){return new Promise((e,n)=>{var r,s,i;function o(){dg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dg(),n(nn(t,"network-request-failed"))},timeout:US.get()})}if(!((s=(r=pn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=pn().gapi)===null||i===void 0)&&i.load)o();else{const l=Wb("iframefcb");return pn()[l]=()=>{gapi.load?o():n(nn(t,"network-request-failed"))},zb(`${Hb()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw Xa=null,e})}let Xa=null;function $S(t){return Xa=Xa||BS(t),Xa}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS=new Bo(5e3,15e3),HS="__/auth/iframe",WS="emulator/auth/iframe",qS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},KS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GS(t){const e=t.config;te(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Gh(e,WS):`https://${t.config.authDomain}/${HS}`,r={apiKey:e.apiKey,appName:t.name,v:li},s=KS.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Uo(r).slice(1)}`}async function QS(t){const e=await $S(t),n=pn().gapi;return te(n,t,"internal-error"),e.open({where:document.body,url:GS(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qS,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=nn(t,"network-request-failed"),l=pn().setTimeout(()=>{i(o)},zS.get());function u(){pn().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},XS=500,JS=600,ZS="_blank",eC="http://localhost";class hg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tC(t,e,n,r=XS,s=JS){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},YS),{width:r.toString(),height:s.toString(),top:i,left:o}),d=mt().toLowerCase();n&&(l=W_(d)?ZS:n),z_(d)&&(e=e||eC,u.scrollbars="yes");const p=Object.entries(u).reduce((m,[E,N])=>`${m}${E}=${N},`,"");if(Vb(d)&&l!=="_self")return nC(e||"",l),new hg(null);const g=window.open(e||"",l,p);te(g,t,"popup-blocked");try{g.focus()}catch{}return new hg(g)}function nC(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC="__/auth/handler",sC="emulator/auth/handler",iC=encodeURIComponent("fac");async function fg(t,e,n,r,s,i){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:li,eventId:s};if(e instanceof Zh){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",oT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,g]of Object.entries({}))o[p]=g}if(e instanceof $o){const p=e.getScopes().filter(g=>g!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const u=await t._getAppCheckToken(),d=u?`#${iC}=${encodeURIComponent(u)}`:"";return`${oC(t)}?${Uo(l).slice(1)}${d}`}function oC({config:t}){return t.emulator?Gh(t,sC):`https://${t.authDomain}/${rC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic="webStorageSupport";class aC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=sx,this._completeRedirectFn=RS,this._overrideRedirectResult=AS}async _openPopup(e,n,r,s){var i;$n((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await fg(e,n,r,Pd(),s);return tC(e,o,ef())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await fg(e,n,r,Pd(),s);return cS(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):($n(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await QS(e),r=new DS(e);return n.register("authEvent",s=>(te(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ic,{type:Ic},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Ic];o!==void 0&&n(!!o),yn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=MS(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Y_()||H_()||Xh()}}const lC=aC;var pg="@firebase/auth",mg="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dC(t){Ys(new ts("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;te(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:X_(t)},d=new Bb(r,s,i,u);return Kb(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ys(new ts("auth-internal",e=>{const n=uu(e.getProvider("auth").getImmediate());return(r=>new uC(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Er(pg,mg,cC(t)),Er(pg,mg,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC=5*60,fC=A_("authIdTokenMaxAge")||hC;let gg=null;const pC=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>fC)return;const s=n==null?void 0:n.token;gg!==s&&(gg=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function mC(t=k_()){const e=Hh(t,"auth");if(e.isInitialized())return e.getImmediate();const n=qb(t,{popupRedirectResolver:lC,persistence:[_S,aS,sx]}),r=A_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=pC(i.toString());nS(n,o,()=>o(n.currentUser)),tS(n,l=>o(l))}}const s=S_("auth");return s&&Gb(n,`http://${s}`),n}function gC(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}$b({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=nn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",gC().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dC("Browser");var yC="firebase",vC="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er(yC,vC,"app");var yg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qr,hx;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,y){function I(){}I.prototype=y.prototype,v.D=y.prototype,v.prototype=new I,v.prototype.constructor=v,v.C=function(A,_,k){for(var b=Array(arguments.length-2),q=2;q<arguments.length;q++)b[q-2]=arguments[q];return y.prototype[_].apply(A,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(v,y,I){I||(I=0);var A=Array(16);if(typeof y=="string")for(var _=0;16>_;++_)A[_]=y.charCodeAt(I++)|y.charCodeAt(I++)<<8|y.charCodeAt(I++)<<16|y.charCodeAt(I++)<<24;else for(_=0;16>_;++_)A[_]=y[I++]|y[I++]<<8|y[I++]<<16|y[I++]<<24;y=v.g[0],I=v.g[1],_=v.g[2];var k=v.g[3],b=y+(k^I&(_^k))+A[0]+3614090360&4294967295;y=I+(b<<7&4294967295|b>>>25),b=k+(_^y&(I^_))+A[1]+3905402710&4294967295,k=y+(b<<12&4294967295|b>>>20),b=_+(I^k&(y^I))+A[2]+606105819&4294967295,_=k+(b<<17&4294967295|b>>>15),b=I+(y^_&(k^y))+A[3]+3250441966&4294967295,I=_+(b<<22&4294967295|b>>>10),b=y+(k^I&(_^k))+A[4]+4118548399&4294967295,y=I+(b<<7&4294967295|b>>>25),b=k+(_^y&(I^_))+A[5]+1200080426&4294967295,k=y+(b<<12&4294967295|b>>>20),b=_+(I^k&(y^I))+A[6]+2821735955&4294967295,_=k+(b<<17&4294967295|b>>>15),b=I+(y^_&(k^y))+A[7]+4249261313&4294967295,I=_+(b<<22&4294967295|b>>>10),b=y+(k^I&(_^k))+A[8]+1770035416&4294967295,y=I+(b<<7&4294967295|b>>>25),b=k+(_^y&(I^_))+A[9]+2336552879&4294967295,k=y+(b<<12&4294967295|b>>>20),b=_+(I^k&(y^I))+A[10]+4294925233&4294967295,_=k+(b<<17&4294967295|b>>>15),b=I+(y^_&(k^y))+A[11]+2304563134&4294967295,I=_+(b<<22&4294967295|b>>>10),b=y+(k^I&(_^k))+A[12]+1804603682&4294967295,y=I+(b<<7&4294967295|b>>>25),b=k+(_^y&(I^_))+A[13]+4254626195&4294967295,k=y+(b<<12&4294967295|b>>>20),b=_+(I^k&(y^I))+A[14]+2792965006&4294967295,_=k+(b<<17&4294967295|b>>>15),b=I+(y^_&(k^y))+A[15]+1236535329&4294967295,I=_+(b<<22&4294967295|b>>>10),b=y+(_^k&(I^_))+A[1]+4129170786&4294967295,y=I+(b<<5&4294967295|b>>>27),b=k+(I^_&(y^I))+A[6]+3225465664&4294967295,k=y+(b<<9&4294967295|b>>>23),b=_+(y^I&(k^y))+A[11]+643717713&4294967295,_=k+(b<<14&4294967295|b>>>18),b=I+(k^y&(_^k))+A[0]+3921069994&4294967295,I=_+(b<<20&4294967295|b>>>12),b=y+(_^k&(I^_))+A[5]+3593408605&4294967295,y=I+(b<<5&4294967295|b>>>27),b=k+(I^_&(y^I))+A[10]+38016083&4294967295,k=y+(b<<9&4294967295|b>>>23),b=_+(y^I&(k^y))+A[15]+3634488961&4294967295,_=k+(b<<14&4294967295|b>>>18),b=I+(k^y&(_^k))+A[4]+3889429448&4294967295,I=_+(b<<20&4294967295|b>>>12),b=y+(_^k&(I^_))+A[9]+568446438&4294967295,y=I+(b<<5&4294967295|b>>>27),b=k+(I^_&(y^I))+A[14]+3275163606&4294967295,k=y+(b<<9&4294967295|b>>>23),b=_+(y^I&(k^y))+A[3]+4107603335&4294967295,_=k+(b<<14&4294967295|b>>>18),b=I+(k^y&(_^k))+A[8]+1163531501&4294967295,I=_+(b<<20&4294967295|b>>>12),b=y+(_^k&(I^_))+A[13]+2850285829&4294967295,y=I+(b<<5&4294967295|b>>>27),b=k+(I^_&(y^I))+A[2]+4243563512&4294967295,k=y+(b<<9&4294967295|b>>>23),b=_+(y^I&(k^y))+A[7]+1735328473&4294967295,_=k+(b<<14&4294967295|b>>>18),b=I+(k^y&(_^k))+A[12]+2368359562&4294967295,I=_+(b<<20&4294967295|b>>>12),b=y+(I^_^k)+A[5]+4294588738&4294967295,y=I+(b<<4&4294967295|b>>>28),b=k+(y^I^_)+A[8]+2272392833&4294967295,k=y+(b<<11&4294967295|b>>>21),b=_+(k^y^I)+A[11]+1839030562&4294967295,_=k+(b<<16&4294967295|b>>>16),b=I+(_^k^y)+A[14]+4259657740&4294967295,I=_+(b<<23&4294967295|b>>>9),b=y+(I^_^k)+A[1]+2763975236&4294967295,y=I+(b<<4&4294967295|b>>>28),b=k+(y^I^_)+A[4]+1272893353&4294967295,k=y+(b<<11&4294967295|b>>>21),b=_+(k^y^I)+A[7]+4139469664&4294967295,_=k+(b<<16&4294967295|b>>>16),b=I+(_^k^y)+A[10]+3200236656&4294967295,I=_+(b<<23&4294967295|b>>>9),b=y+(I^_^k)+A[13]+681279174&4294967295,y=I+(b<<4&4294967295|b>>>28),b=k+(y^I^_)+A[0]+3936430074&4294967295,k=y+(b<<11&4294967295|b>>>21),b=_+(k^y^I)+A[3]+3572445317&4294967295,_=k+(b<<16&4294967295|b>>>16),b=I+(_^k^y)+A[6]+76029189&4294967295,I=_+(b<<23&4294967295|b>>>9),b=y+(I^_^k)+A[9]+3654602809&4294967295,y=I+(b<<4&4294967295|b>>>28),b=k+(y^I^_)+A[12]+3873151461&4294967295,k=y+(b<<11&4294967295|b>>>21),b=_+(k^y^I)+A[15]+530742520&4294967295,_=k+(b<<16&4294967295|b>>>16),b=I+(_^k^y)+A[2]+3299628645&4294967295,I=_+(b<<23&4294967295|b>>>9),b=y+(_^(I|~k))+A[0]+4096336452&4294967295,y=I+(b<<6&4294967295|b>>>26),b=k+(I^(y|~_))+A[7]+1126891415&4294967295,k=y+(b<<10&4294967295|b>>>22),b=_+(y^(k|~I))+A[14]+2878612391&4294967295,_=k+(b<<15&4294967295|b>>>17),b=I+(k^(_|~y))+A[5]+4237533241&4294967295,I=_+(b<<21&4294967295|b>>>11),b=y+(_^(I|~k))+A[12]+1700485571&4294967295,y=I+(b<<6&4294967295|b>>>26),b=k+(I^(y|~_))+A[3]+2399980690&4294967295,k=y+(b<<10&4294967295|b>>>22),b=_+(y^(k|~I))+A[10]+4293915773&4294967295,_=k+(b<<15&4294967295|b>>>17),b=I+(k^(_|~y))+A[1]+2240044497&4294967295,I=_+(b<<21&4294967295|b>>>11),b=y+(_^(I|~k))+A[8]+1873313359&4294967295,y=I+(b<<6&4294967295|b>>>26),b=k+(I^(y|~_))+A[15]+4264355552&4294967295,k=y+(b<<10&4294967295|b>>>22),b=_+(y^(k|~I))+A[6]+2734768916&4294967295,_=k+(b<<15&4294967295|b>>>17),b=I+(k^(_|~y))+A[13]+1309151649&4294967295,I=_+(b<<21&4294967295|b>>>11),b=y+(_^(I|~k))+A[4]+4149444226&4294967295,y=I+(b<<6&4294967295|b>>>26),b=k+(I^(y|~_))+A[11]+3174756917&4294967295,k=y+(b<<10&4294967295|b>>>22),b=_+(y^(k|~I))+A[2]+718787259&4294967295,_=k+(b<<15&4294967295|b>>>17),b=I+(k^(_|~y))+A[9]+3951481745&4294967295,v.g[0]=v.g[0]+y&4294967295,v.g[1]=v.g[1]+(_+(b<<21&4294967295|b>>>11))&4294967295,v.g[2]=v.g[2]+_&4294967295,v.g[3]=v.g[3]+k&4294967295}r.prototype.u=function(v,y){y===void 0&&(y=v.length);for(var I=y-this.blockSize,A=this.B,_=this.h,k=0;k<y;){if(_==0)for(;k<=I;)s(this,v,k),k+=this.blockSize;if(typeof v=="string"){for(;k<y;)if(A[_++]=v.charCodeAt(k++),_==this.blockSize){s(this,A),_=0;break}}else for(;k<y;)if(A[_++]=v[k++],_==this.blockSize){s(this,A),_=0;break}}this.h=_,this.o+=y},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var y=1;y<v.length-8;++y)v[y]=0;var I=8*this.o;for(y=v.length-8;y<v.length;++y)v[y]=I&255,I/=256;for(this.u(v),v=Array(16),y=I=0;4>y;++y)for(var A=0;32>A;A+=8)v[I++]=this.g[y]>>>A&255;return v};function i(v,y){var I=l;return Object.prototype.hasOwnProperty.call(I,v)?I[v]:I[v]=y(v)}function o(v,y){this.h=y;for(var I=[],A=!0,_=v.length-1;0<=_;_--){var k=v[_]|0;A&&k==y||(I[_]=k,A=!1)}this.g=I}var l={};function u(v){return-128<=v&&128>v?i(v,function(y){return new o([y|0],0>y?-1:0)}):new o([v|0],0>v?-1:0)}function d(v){if(isNaN(v)||!isFinite(v))return g;if(0>v)return D(d(-v));for(var y=[],I=1,A=0;v>=I;A++)y[A]=v/I|0,I*=4294967296;return new o(y,0)}function p(v,y){if(v.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(v.charAt(0)=="-")return D(p(v.substring(1),y));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(y,8)),A=g,_=0;_<v.length;_+=8){var k=Math.min(8,v.length-_),b=parseInt(v.substring(_,_+k),y);8>k?(k=d(Math.pow(y,k)),A=A.j(k).add(d(b))):(A=A.j(I),A=A.add(d(b)))}return A}var g=u(0),m=u(1),E=u(16777216);t=o.prototype,t.m=function(){if(S(this))return-D(this).m();for(var v=0,y=1,I=0;I<this.g.length;I++){var A=this.i(I);v+=(0<=A?A:4294967296+A)*y,y*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(N(this))return"0";if(S(this))return"-"+D(this).toString(v);for(var y=d(Math.pow(v,6)),I=this,A="";;){var _=P(I,y).g;I=T(I,_.j(y));var k=((0<I.g.length?I.g[0]:I.h)>>>0).toString(v);if(I=_,N(I))return k+A;for(;6>k.length;)k="0"+k;A=k+A}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function N(v){if(v.h!=0)return!1;for(var y=0;y<v.g.length;y++)if(v.g[y]!=0)return!1;return!0}function S(v){return v.h==-1}t.l=function(v){return v=T(this,v),S(v)?-1:N(v)?0:1};function D(v){for(var y=v.g.length,I=[],A=0;A<y;A++)I[A]=~v.g[A];return new o(I,~v.h).add(m)}t.abs=function(){return S(this)?D(this):this},t.add=function(v){for(var y=Math.max(this.g.length,v.g.length),I=[],A=0,_=0;_<=y;_++){var k=A+(this.i(_)&65535)+(v.i(_)&65535),b=(k>>>16)+(this.i(_)>>>16)+(v.i(_)>>>16);A=b>>>16,k&=65535,b&=65535,I[_]=b<<16|k}return new o(I,I[I.length-1]&-2147483648?-1:0)};function T(v,y){return v.add(D(y))}t.j=function(v){if(N(this)||N(v))return g;if(S(this))return S(v)?D(this).j(D(v)):D(D(this).j(v));if(S(v))return D(this.j(D(v)));if(0>this.l(E)&&0>v.l(E))return d(this.m()*v.m());for(var y=this.g.length+v.g.length,I=[],A=0;A<2*y;A++)I[A]=0;for(A=0;A<this.g.length;A++)for(var _=0;_<v.g.length;_++){var k=this.i(A)>>>16,b=this.i(A)&65535,q=v.i(_)>>>16,B=v.i(_)&65535;I[2*A+2*_]+=b*B,w(I,2*A+2*_),I[2*A+2*_+1]+=k*B,w(I,2*A+2*_+1),I[2*A+2*_+1]+=b*q,w(I,2*A+2*_+1),I[2*A+2*_+2]+=k*q,w(I,2*A+2*_+2)}for(A=0;A<y;A++)I[A]=I[2*A+1]<<16|I[2*A];for(A=y;A<2*y;A++)I[A]=0;return new o(I,0)};function w(v,y){for(;(v[y]&65535)!=v[y];)v[y+1]+=v[y]>>>16,v[y]&=65535,y++}function C(v,y){this.g=v,this.h=y}function P(v,y){if(N(y))throw Error("division by zero");if(N(v))return new C(g,g);if(S(v))return y=P(D(v),y),new C(D(y.g),D(y.h));if(S(y))return y=P(v,D(y)),new C(D(y.g),y.h);if(30<v.g.length){if(S(v)||S(y))throw Error("slowDivide_ only works with positive integers.");for(var I=m,A=y;0>=A.l(v);)I=R(I),A=R(A);var _=j(I,1),k=j(A,1);for(A=j(A,2),I=j(I,2);!N(A);){var b=k.add(A);0>=b.l(v)&&(_=_.add(I),k=b),A=j(A,1),I=j(I,1)}return y=T(v,_.j(y)),new C(_,y)}for(_=g;0<=v.l(y);){for(I=Math.max(1,Math.floor(v.m()/y.m())),A=Math.ceil(Math.log(I)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),k=d(I),b=k.j(y);S(b)||0<b.l(v);)I-=A,k=d(I),b=k.j(y);N(k)&&(k=m),_=_.add(k),v=T(v,b)}return new C(_,v)}t.A=function(v){return P(this,v).h},t.and=function(v){for(var y=Math.max(this.g.length,v.g.length),I=[],A=0;A<y;A++)I[A]=this.i(A)&v.i(A);return new o(I,this.h&v.h)},t.or=function(v){for(var y=Math.max(this.g.length,v.g.length),I=[],A=0;A<y;A++)I[A]=this.i(A)|v.i(A);return new o(I,this.h|v.h)},t.xor=function(v){for(var y=Math.max(this.g.length,v.g.length),I=[],A=0;A<y;A++)I[A]=this.i(A)^v.i(A);return new o(I,this.h^v.h)};function R(v){for(var y=v.g.length+1,I=[],A=0;A<y;A++)I[A]=v.i(A)<<1|v.i(A-1)>>>31;return new o(I,v.h)}function j(v,y){var I=y>>5;y%=32;for(var A=v.g.length-I,_=[],k=0;k<A;k++)_[k]=0<y?v.i(k+I)>>>y|v.i(k+I+1)<<32-y:v.i(k+I);return new o(_,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,hx=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,Qr=o}).apply(typeof yg<"u"?yg:typeof self<"u"?self:typeof window<"u"?window:{});var ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fx,Ui,px,Ja,kd,mx,gx,yx;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,f){return a==Array.prototype||a==Object.prototype||(a[h]=f.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ka=="object"&&ka];for(var h=0;h<a.length;++h){var f=a[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var f=r;a=a.split(".");for(var x=0;x<a.length-1;x++){var V=a[x];if(!(V in f))break e;f=f[V]}a=a[a.length-1],x=f[a],h=h(x),h!=x&&h!=null&&e(f,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var f=0,x=!1,V={next:function(){if(!x&&f<a.length){var O=f++;return{value:h(O,a[O]),done:!1}}return x=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function d(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function p(a,h,f){return a.call.apply(a.bind,arguments)}function g(a,h,f){if(!a)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,x),a.apply(h,V)}}return function(){return a.apply(h,arguments)}}function m(a,h,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,m.apply(null,arguments)}function E(a,h){var f=Array.prototype.slice.call(arguments,1);return function(){var x=f.slice();return x.push.apply(x,arguments),a.apply(this,x)}}function N(a,h){function f(){}f.prototype=h.prototype,a.aa=h.prototype,a.prototype=new f,a.prototype.constructor=a,a.Qb=function(x,V,O){for(var $=Array(arguments.length-2),we=2;we<arguments.length;we++)$[we-2]=arguments[we];return h.prototype[V].apply(x,$)}}function S(a){const h=a.length;if(0<h){const f=Array(h);for(let x=0;x<h;x++)f[x]=a[x];return f}return[]}function D(a,h){for(let f=1;f<arguments.length;f++){const x=arguments[f];if(u(x)){const V=a.length||0,O=x.length||0;a.length=V+O;for(let $=0;$<O;$++)a[V+$]=x[$]}else a.push(x)}}class T{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function w(a){return/^[\s\xa0]*$/.test(a)}function C(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function P(a){return P[" "](a),a}P[" "]=function(){};var R=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function j(a,h,f){for(const x in a)h.call(f,a[x],x,a)}function v(a,h){for(const f in a)h.call(void 0,a[f],f,a)}function y(a){const h={};for(const f in a)h[f]=a[f];return h}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(a,h){let f,x;for(let V=1;V<arguments.length;V++){x=arguments[V];for(f in x)a[f]=x[f];for(let O=0;O<I.length;O++)f=I[O],Object.prototype.hasOwnProperty.call(x,f)&&(a[f]=x[f])}}function _(a){var h=1;a=a.split(":");const f=[];for(;0<h&&a.length;)f.push(a.shift()),h--;return a.length&&f.push(a.join(":")),f}function k(a){l.setTimeout(()=>{throw a},0)}function b(){var a=Z;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class q{constructor(){this.h=this.g=null}add(h,f){const x=B.get();x.set(h,f),this.h?this.h.next=x:this.g=x,this.h=x}}var B=new T(()=>new X,a=>a.reset());class X{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Fe,H=!1,Z=new q,ee=()=>{const a=l.Promise.resolve(void 0);Fe=()=>{a.then(z)}};var z=()=>{for(var a;a=b();){try{a.h.call(a.g)}catch(f){k(f)}var h=B;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}H=!1};function W(){this.s=this.s,this.C=this.C}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var me=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const f=()=>{};l.addEventListener("test",f,h),l.removeEventListener("test",f,h)}catch{}return a}();function ge(a,h){if(K.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var f=this.type=a.type,x=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(R){e:{try{P(h.nodeName);var V=!0;break e}catch{}V=!1}V||(h=null)}}else f=="mouseover"?h=a.fromElement:f=="mouseout"&&(h=a.toElement);this.relatedTarget=h,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:ie[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ge.aa.h.call(this)}}N(ge,K);var ie={2:"touch",3:"pen",4:"mouse"};ge.prototype.h=function(){ge.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),Ft=0;function Kn(a,h,f,x,V){this.listener=a,this.proxy=null,this.src=h,this.type=f,this.capture=!!x,this.ha=V,this.key=++Ft,this.da=this.fa=!1}function Rt(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function _n(a){this.src=a,this.g={},this.h=0}_n.prototype.add=function(a,h,f,x,V){var O=a.toString();a=this.g[O],a||(a=this.g[O]=[],this.h++);var $=Gn(a,h,x,V);return-1<$?(h=a[$],f||(h.fa=!1)):(h=new Kn(h,this.src,O,!!x,V),h.fa=f,a.push(h)),h};function xn(a,h){var f=h.type;if(f in a.g){var x=a.g[f],V=Array.prototype.indexOf.call(x,h,void 0),O;(O=0<=V)&&Array.prototype.splice.call(x,V,1),O&&(Rt(h),a.g[f].length==0&&(delete a.g[f],a.h--))}}function Gn(a,h,f,x){for(var V=0;V<a.length;++V){var O=a[V];if(!O.da&&O.listener==h&&O.capture==!!f&&O.ha==x)return V}return-1}var ln="closure_lm_"+(1e6*Math.random()|0),It={};function wn(a,h,f,x,V){if(Array.isArray(h)){for(var O=0;O<h.length;O++)wn(a,h[O],f,x,V);return null}return f=it(f),a&&a[he]?a.K(h,f,d(x)?!!x.capture:!1,V):Cu(a,h,f,!1,x,V)}function Cu(a,h,f,x,V,O){if(!h)throw Error("Invalid event type");var $=d(V)?!!V.capture:!!V,we=Pe(a);if(we||(a[ln]=we=new _n(a)),f=we.add(h,f,x,$,O),f.proxy)return f;if(x=Au(),f.proxy=x,x.src=a,x.listener=f,a.addEventListener)me||(V=$),V===void 0&&(V=!1),a.addEventListener(h.toString(),x,V);else if(a.attachEvent)a.attachEvent(oe(h.toString()),x);else if(a.addListener&&a.removeListener)a.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Au(){function a(f){return h.call(a.src,a.listener,f)}const h=Te;return a}function ds(a,h,f,x,V){if(Array.isArray(h))for(var O=0;O<h.length;O++)ds(a,h[O],f,x,V);else x=d(x)?!!x.capture:!!x,f=it(f),a&&a[he]?(a=a.i,h=String(h).toString(),h in a.g&&(O=a.g[h],f=Gn(O,f,x,V),-1<f&&(Rt(O[f]),Array.prototype.splice.call(O,f,1),O.length==0&&(delete a.g[h],a.h--)))):a&&(a=Pe(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Gn(h,f,x,V)),(f=-1<a?h[a]:null)&&pi(f))}function pi(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[he])xn(h.i,a);else{var f=a.type,x=a.proxy;h.removeEventListener?h.removeEventListener(f,x,a.capture):h.detachEvent?h.detachEvent(oe(f),x):h.addListener&&h.removeListener&&h.removeListener(x),(f=Pe(h))?(xn(f,a),f.h==0&&(f.src=null,h[ln]=null)):Rt(a)}}}function oe(a){return a in It?It[a]:It[a]="on"+a}function Te(a,h){if(a.da)a=!0;else{h=new ge(h,this);var f=a.listener,x=a.ha||a.src;a.fa&&pi(a),a=f.call(x,h)}return a}function Pe(a){return a=a[ln],a instanceof _n?a:null}var Ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function it(a){return typeof a=="function"?a:(a[Ee]||(a[Ee]=function(h){return a.handleEvent(h)}),a[Ee])}function _e(){W.call(this),this.i=new _n(this),this.M=this,this.F=null}N(_e,W),_e.prototype[he]=!0,_e.prototype.removeEventListener=function(a,h,f,x){ds(this,a,h,f,x)};function xe(a,h){var f,x=a.F;if(x)for(f=[];x;x=x.F)f.push(x);if(a=a.M,x=h.type||h,typeof h=="string")h=new K(h,a);else if(h instanceof K)h.target=h.target||a;else{var V=h;h=new K(x,a),A(h,V)}if(V=!0,f)for(var O=f.length-1;0<=O;O--){var $=h.g=f[O];V=Tt($,x,!0,h)&&V}if($=h.g=a,V=Tt($,x,!0,h)&&V,V=Tt($,x,!1,h)&&V,f)for(O=0;O<f.length;O++)$=h.g=f[O],V=Tt($,x,!1,h)&&V}_e.prototype.N=function(){if(_e.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var f=a.g[h],x=0;x<f.length;x++)Rt(f[x]);delete a.g[h],a.h--}}this.F=null},_e.prototype.K=function(a,h,f,x){return this.i.add(String(a),h,!1,f,x)},_e.prototype.L=function(a,h,f,x){return this.i.add(String(a),h,!0,f,x)};function Tt(a,h,f,x){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var V=!0,O=0;O<h.length;++O){var $=h[O];if($&&!$.da&&$.capture==f){var we=$.listener,Xe=$.ha||$.src;$.fa&&xn(a.i,$),V=we.call(Xe,x)!==!1&&V}}return V&&!x.defaultPrevented}function En(a,h,f){if(typeof a=="function")f&&(a=m(a,f));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function hs(a){a.g=En(()=>{a.g=null,a.i&&(a.i=!1,hs(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class Qn extends W{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:hs(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yn(a){W.call(this),this.h=a,this.g={}}N(Yn,W);var Dr=[];function Jo(a){j(a.g,function(h,f){this.g.hasOwnProperty(f)&&pi(h)},a),a.g={}}Yn.prototype.N=function(){Yn.aa.N.call(this),Jo(this)},Yn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pu=l.JSON.stringify,Uw=l.JSON.parse,Bw=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Nu(){}Nu.prototype.h=null;function Hf(a){return a.h||(a.h=a.i())}function Wf(){}var mi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ru(){K.call(this,"d")}N(Ru,K);function ku(){K.call(this,"c")}N(ku,K);var jr={},qf=null;function Zo(){return qf=qf||new _e}jr.La="serverreachability";function Kf(a){K.call(this,jr.La,a)}N(Kf,K);function gi(a){const h=Zo();xe(h,new Kf(h))}jr.STAT_EVENT="statevent";function Gf(a,h){K.call(this,jr.STAT_EVENT,a),this.stat=h}N(Gf,K);function gt(a){const h=Zo();xe(h,new Gf(h,a))}jr.Ma="timingevent";function Qf(a,h){K.call(this,jr.Ma,a),this.size=h}N(Qf,K);function yi(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function vi(){this.g=!0}vi.prototype.xa=function(){this.g=!1};function $w(a,h,f,x,V,O){a.info(function(){if(a.g)if(O)for(var $="",we=O.split("&"),Xe=0;Xe<we.length;Xe++){var fe=we[Xe].split("=");if(1<fe.length){var ot=fe[0];fe=fe[1];var at=ot.split("_");$=2<=at.length&&at[1]=="type"?$+(ot+"="+fe+"&"):$+(ot+"=redacted&")}}else $=null;else $=O;return"XMLHTTP REQ ("+x+") [attempt "+V+"]: "+h+`
`+f+`
`+$})}function zw(a,h,f,x,V,O,$){a.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+V+"]: "+h+`
`+f+`
`+O+" "+$})}function fs(a,h,f,x){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+Ww(a,f)+(x?" "+x:"")})}function Hw(a,h){a.info(function(){return"TIMEOUT: "+h})}vi.prototype.info=function(){};function Ww(a,h){if(!a.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(a=0;a<f.length;a++)if(Array.isArray(f[a])){var x=f[a];if(!(2>x.length)){var V=x[1];if(Array.isArray(V)&&!(1>V.length)){var O=V[0];if(O!="noop"&&O!="stop"&&O!="close")for(var $=1;$<V.length;$++)V[$]=""}}}}return Pu(f)}catch{return h}}var ea={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Yf={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Du;function ta(){}N(ta,Nu),ta.prototype.g=function(){return new XMLHttpRequest},ta.prototype.i=function(){return{}},Du=new ta;function Xn(a,h,f,x){this.j=a,this.i=h,this.l=f,this.R=x||1,this.U=new Yn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Xf}function Xf(){this.i=null,this.g="",this.h=!1}var Jf={},ju={};function Vu(a,h,f){a.L=1,a.v=ia(In(h)),a.m=f,a.P=!0,Zf(a,null)}function Zf(a,h){a.F=Date.now(),na(a),a.A=In(a.v);var f=a.A,x=a.R;Array.isArray(x)||(x=[String(x)]),fp(f.i,"t",x),a.C=0,f=a.j.J,a.h=new Xf,a.g=Rp(a.j,f?h:null,!a.m),0<a.O&&(a.M=new Qn(m(a.Y,a,a.g),a.O)),h=a.U,f=a.g,x=a.ca;var V="readystatechange";Array.isArray(V)||(V&&(Dr[0]=V.toString()),V=Dr);for(var O=0;O<V.length;O++){var $=wn(f,V[O],x||h.handleEvent,!1,h.h||h);if(!$)break;h.g[$.key]=$}h=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),gi(),$w(a.i,a.u,a.A,a.l,a.R,a.m)}Xn.prototype.ca=function(a){a=a.target;const h=this.M;h&&Tn(a)==3?h.j():this.Y(a)},Xn.prototype.Y=function(a){try{if(a==this.g)e:{const at=Tn(this.g);var h=this.g.Ba();const gs=this.g.Z();if(!(3>at)&&(at!=3||this.g&&(this.h.h||this.g.oa()||xp(this.g)))){this.J||at!=4||h==7||(h==8||0>=gs?gi(3):gi(2)),Ou(this);var f=this.g.Z();this.X=f;t:if(ep(this)){var x=xp(this.g);a="";var V=x.length,O=Tn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vr(this),_i(this);var $="";break t}this.h.i=new l.TextDecoder}for(h=0;h<V;h++)this.h.h=!0,a+=this.h.i.decode(x[h],{stream:!(O&&h==V-1)});x.length=0,this.h.g+=a,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=f==200,zw(this.i,this.u,this.A,this.l,this.R,at,f),this.o){if(this.T&&!this.K){t:{if(this.g){var we,Xe=this.g;if((we=Xe.g?Xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(we)){var fe=we;break t}}fe=null}if(f=fe)fs(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Lu(this,f);else{this.o=!1,this.s=3,gt(12),Vr(this),_i(this);break e}}if(this.P){f=!0;let Gt;for(;!this.J&&this.C<$.length;)if(Gt=qw(this,$),Gt==ju){at==4&&(this.s=4,gt(14),f=!1),fs(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==Jf){this.s=4,gt(15),fs(this.i,this.l,$,"[Invalid Chunk]"),f=!1;break}else fs(this.i,this.l,Gt,null),Lu(this,Gt);if(ep(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),at!=4||$.length!=0||this.h.h||(this.s=1,gt(16),f=!1),this.o=this.o&&f,!f)fs(this.i,this.l,$,"[Invalid Chunked Response]"),Vr(this),_i(this);else if(0<$.length&&!this.W){this.W=!0;var ot=this.j;ot.g==this&&ot.ba&&!ot.M&&(ot.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),zu(ot),ot.M=!0,gt(11))}}else fs(this.i,this.l,$,null),Lu(this,$);at==4&&Vr(this),this.o&&!this.J&&(at==4?Cp(this.j,this):(this.o=!1,na(this)))}else u0(this.g),f==400&&0<$.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),Vr(this),_i(this)}}}catch{}finally{}};function ep(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function qw(a,h){var f=a.C,x=h.indexOf(`
`,f);return x==-1?ju:(f=Number(h.substring(f,x)),isNaN(f)?Jf:(x+=1,x+f>h.length?ju:(h=h.slice(x,x+f),a.C=x+f,h)))}Xn.prototype.cancel=function(){this.J=!0,Vr(this)};function na(a){a.S=Date.now()+a.I,tp(a,a.I)}function tp(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=yi(m(a.ba,a),h)}function Ou(a){a.B&&(l.clearTimeout(a.B),a.B=null)}Xn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Hw(this.i,this.A),this.L!=2&&(gi(),gt(17)),Vr(this),this.s=2,_i(this)):tp(this,this.S-a)};function _i(a){a.j.G==0||a.J||Cp(a.j,a)}function Vr(a){Ou(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,Jo(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Lu(a,h){try{var f=a.j;if(f.G!=0&&(f.g==a||Mu(f.h,a))){if(!a.K&&Mu(f.h,a)&&f.G==3){try{var x=f.Da.g.parse(h)}catch{x=null}if(Array.isArray(x)&&x.length==3){var V=x;if(V[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<a.F)da(f),ua(f);else break e;$u(f),gt(18)}}else f.za=V[1],0<f.za-f.T&&37500>V[2]&&f.F&&f.v==0&&!f.C&&(f.C=yi(m(f.Za,f),6e3));if(1>=sp(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Lr(f,11)}else if((a.K||f.g==a)&&da(f),!w(h))for(V=f.Da.g.parse(h),h=0;h<V.length;h++){let fe=V[h];if(f.T=fe[0],fe=fe[1],f.G==2)if(fe[0]=="c"){f.K=fe[1],f.ia=fe[2];const ot=fe[3];ot!=null&&(f.la=ot,f.j.info("VER="+f.la));const at=fe[4];at!=null&&(f.Aa=at,f.j.info("SVER="+f.Aa));const gs=fe[5];gs!=null&&typeof gs=="number"&&0<gs&&(x=1.5*gs,f.L=x,f.j.info("backChannelRequestTimeoutMs_="+x)),x=f;const Gt=a.g;if(Gt){const fa=Gt.g?Gt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fa){var O=x.h;O.g||fa.indexOf("spdy")==-1&&fa.indexOf("quic")==-1&&fa.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(Fu(O,O.h),O.h=null))}if(x.D){const Hu=Gt.g?Gt.g.getResponseHeader("X-HTTP-Session-Id"):null;Hu&&(x.ya=Hu,be(x.I,x.D,Hu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-a.F,f.j.info("Handshake RTT: "+f.R+"ms")),x=f;var $=a;if(x.qa=Np(x,x.J?x.ia:null,x.W),$.K){ip(x.h,$);var we=$,Xe=x.L;Xe&&(we.I=Xe),we.B&&(Ou(we),na(we)),x.g=$}else bp(x);0<f.i.length&&ca(f)}else fe[0]!="stop"&&fe[0]!="close"||Lr(f,7);else f.G==3&&(fe[0]=="stop"||fe[0]=="close"?fe[0]=="stop"?Lr(f,7):Bu(f):fe[0]!="noop"&&f.l&&f.l.ta(fe),f.v=0)}}gi(4)}catch{}}var Kw=class{constructor(a,h){this.g=a,this.map=h}};function np(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function rp(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function sp(a){return a.h?1:a.g?a.g.size:0}function Mu(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Fu(a,h){a.g?a.g.add(h):a.h=h}function ip(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}np.prototype.cancel=function(){if(this.i=op(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function op(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const f of a.g.values())h=h.concat(f.D);return h}return S(a.i)}function Gw(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var h=[],f=a.length,x=0;x<f;x++)h.push(a[x]);return h}h=[],f=0;for(x in a)h[f++]=a[x];return h}function Qw(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var h=[];a=a.length;for(var f=0;f<a;f++)h.push(f);return h}h=[],f=0;for(const x in a)h[f++]=x;return h}}}function ap(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var f=Qw(a),x=Gw(a),V=x.length,O=0;O<V;O++)h.call(void 0,x[O],f&&f[O],a)}var lp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yw(a,h){if(a){a=a.split("&");for(var f=0;f<a.length;f++){var x=a[f].indexOf("="),V=null;if(0<=x){var O=a[f].substring(0,x);V=a[f].substring(x+1)}else O=a[f];h(O,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Or(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Or){this.h=a.h,ra(this,a.j),this.o=a.o,this.g=a.g,sa(this,a.s),this.l=a.l;var h=a.i,f=new Ei;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),up(this,f),this.m=a.m}else a&&(h=String(a).match(lp))?(this.h=!1,ra(this,h[1]||"",!0),this.o=xi(h[2]||""),this.g=xi(h[3]||"",!0),sa(this,h[4]),this.l=xi(h[5]||"",!0),up(this,h[6]||"",!0),this.m=xi(h[7]||"")):(this.h=!1,this.i=new Ei(null,this.h))}Or.prototype.toString=function(){var a=[],h=this.j;h&&a.push(wi(h,cp,!0),":");var f=this.g;return(f||h=="file")&&(a.push("//"),(h=this.o)&&a.push(wi(h,cp,!0),"@"),a.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&a.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(wi(f,f.charAt(0)=="/"?Zw:Jw,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",wi(f,t0)),a.join("")};function In(a){return new Or(a)}function ra(a,h,f){a.j=f?xi(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function sa(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function up(a,h,f){h instanceof Ei?(a.i=h,n0(a.i,a.h)):(f||(h=wi(h,e0)),a.i=new Ei(h,a.h))}function be(a,h,f){a.i.set(h,f)}function ia(a){return be(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function xi(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function wi(a,h,f){return typeof a=="string"?(a=encodeURI(a).replace(h,Xw),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Xw(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var cp=/[#\/\?@]/g,Jw=/[#\?:]/g,Zw=/[#\?]/g,e0=/[#\?@]/g,t0=/#/g;function Ei(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function Jn(a){a.g||(a.g=new Map,a.h=0,a.i&&Yw(a.i,function(h,f){a.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}t=Ei.prototype,t.add=function(a,h){Jn(this),this.i=null,a=ps(this,a);var f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(h),this.h+=1,this};function dp(a,h){Jn(a),h=ps(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function hp(a,h){return Jn(a),h=ps(a,h),a.g.has(h)}t.forEach=function(a,h){Jn(this),this.g.forEach(function(f,x){f.forEach(function(V){a.call(h,V,x,this)},this)},this)},t.na=function(){Jn(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let x=0;x<h.length;x++){const V=a[x];for(let O=0;O<V.length;O++)f.push(h[x])}return f},t.V=function(a){Jn(this);let h=[];if(typeof a=="string")hp(this,a)&&(h=h.concat(this.g.get(ps(this,a))));else{a=Array.from(this.g.values());for(let f=0;f<a.length;f++)h=h.concat(a[f])}return h},t.set=function(a,h){return Jn(this),this.i=null,a=ps(this,a),hp(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function fp(a,h,f){dp(a,h),0<f.length&&(a.i=null,a.g.set(ps(a,h),S(f)),a.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var x=h[f];const O=encodeURIComponent(String(x)),$=this.V(x);for(x=0;x<$.length;x++){var V=O;$[x]!==""&&(V+="="+encodeURIComponent(String($[x]))),a.push(V)}}return this.i=a.join("&")};function ps(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function n0(a,h){h&&!a.j&&(Jn(a),a.i=null,a.g.forEach(function(f,x){var V=x.toLowerCase();x!=V&&(dp(this,x),fp(this,V,f))},a)),a.j=h}function r0(a,h){const f=new vi;if(l.Image){const x=new Image;x.onload=E(Zn,f,"TestLoadImage: loaded",!0,h,x),x.onerror=E(Zn,f,"TestLoadImage: error",!1,h,x),x.onabort=E(Zn,f,"TestLoadImage: abort",!1,h,x),x.ontimeout=E(Zn,f,"TestLoadImage: timeout",!1,h,x),l.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=a}else h(!1)}function s0(a,h){const f=new vi,x=new AbortController,V=setTimeout(()=>{x.abort(),Zn(f,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:x.signal}).then(O=>{clearTimeout(V),O.ok?Zn(f,"TestPingServer: ok",!0,h):Zn(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(V),Zn(f,"TestPingServer: error",!1,h)})}function Zn(a,h,f,x,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),x(f)}catch{}}function i0(){this.g=new Bw}function o0(a,h,f){const x=f||"";try{ap(a,function(V,O){let $=V;d(V)&&($=Pu(V)),h.push(x+O+"="+encodeURIComponent($))})}catch(V){throw h.push(x+"type="+encodeURIComponent("_badmap")),V}}function oa(a){this.l=a.Ub||null,this.j=a.eb||!1}N(oa,Nu),oa.prototype.g=function(){return new aa(this.l,this.j)},oa.prototype.i=function(a){return function(){return a}}({});function aa(a,h){_e.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(aa,_e),t=aa.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Ti(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ii(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ti(this)),this.g&&(this.readyState=3,Ti(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;pp(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function pp(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Ii(this):Ti(this),this.readyState==3&&pp(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Ii(this))},t.Qa=function(a){this.g&&(this.response=a,Ii(this))},t.ga=function(){this.g&&Ii(this)};function Ii(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ti(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=h.next();return a.join(`\r
`)};function Ti(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(aa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function mp(a){let h="";return j(a,function(f,x){h+=x,h+=":",h+=f,h+=`\r
`}),h}function Uu(a,h,f){e:{for(x in f){var x=!1;break e}x=!0}x||(f=mp(f),typeof a=="string"?f!=null&&encodeURIComponent(String(f)):be(a,h,f))}function Ve(a){_e.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(Ve,_e);var a0=/^https?$/i,l0=["POST","PUT"];t=Ve.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,f,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Du.g(),this.v=this.o?Hf(this.o):Hf(Du),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(O){gp(this,O);return}if(a=f||"",f=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var V in x)f.set(V,x[V]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const O of x.keys())f.set(O,x.get(O));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(f.keys()).find(O=>O.toLowerCase()=="content-type"),V=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(l0,h,void 0))||x||V||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,$]of f)this.g.setRequestHeader(O,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_p(this),this.u=!0,this.g.send(a),this.u=!1}catch(O){gp(this,O)}};function gp(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,yp(a),la(a)}function yp(a){a.A||(a.A=!0,xe(a,"complete"),xe(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,xe(this,"complete"),xe(this,"abort"),la(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),la(this,!0)),Ve.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?vp(this):this.bb())},t.bb=function(){vp(this)};function vp(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Tn(a)!=4||a.Z()!=2)){if(a.u&&Tn(a)==4)En(a.Ea,0,a);else if(xe(a,"readystatechange"),Tn(a)==4){a.h=!1;try{const $=a.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var x;if(x=$===0){var V=String(a.D).match(lp)[1]||null;!V&&l.self&&l.self.location&&(V=l.self.location.protocol.slice(0,-1)),x=!a0.test(V?V.toLowerCase():"")}f=x}if(f)xe(a,"complete"),xe(a,"success");else{a.m=6;try{var O=2<Tn(a)?a.g.statusText:""}catch{O=""}a.l=O+" ["+a.Z()+"]",yp(a)}}finally{la(a)}}}}function la(a,h){if(a.g){_p(a);const f=a.g,x=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||xe(a,"ready");try{f.onreadystatechange=x}catch{}}}function _p(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Tn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Tn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),Uw(h)}};function xp(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function u0(a){const h={};a=(a.g&&2<=Tn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<a.length;x++){if(w(a[x]))continue;var f=_(a[x]);const V=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const O=h[V]||[];h[V]=O,O.push(f)}v(h,function(x){return x.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bi(a,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||h}function wp(a){this.Aa=0,this.i=[],this.j=new vi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bi("baseRetryDelayMs",5e3,a),this.cb=bi("retryDelaySeedMs",1e4,a),this.Wa=bi("forwardChannelMaxRetries",2,a),this.wa=bi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new np(a&&a.concurrentRequestLimit),this.Da=new i0,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=wp.prototype,t.la=8,t.G=1,t.connect=function(a,h,f,x){gt(0),this.W=a,this.H=h||{},f&&x!==void 0&&(this.H.OSID=f,this.H.OAID=x),this.F=this.X,this.I=Np(this,null,this.W),ca(this)};function Bu(a){if(Ep(a),a.G==3){var h=a.U++,f=In(a.I);if(be(f,"SID",a.K),be(f,"RID",h),be(f,"TYPE","terminate"),Si(a,f),h=new Xn(a,a.j,h),h.L=2,h.v=ia(In(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=h.v,f=!0),f||(h.g=Rp(h.j,null),h.g.ea(h.v)),h.F=Date.now(),na(h)}Pp(a)}function ua(a){a.g&&(zu(a),a.g.cancel(),a.g=null)}function Ep(a){ua(a),a.u&&(l.clearTimeout(a.u),a.u=null),da(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function ca(a){if(!rp(a.h)&&!a.s){a.s=!0;var h=a.Ga;Fe||ee(),H||(Fe(),H=!0),Z.add(h,a),a.B=0}}function c0(a,h){return sp(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=yi(m(a.Ga,a,h),Ap(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const V=new Xn(this,this.j,a);let O=this.o;if(this.S&&(O?(O=y(O),A(O,this.S)):O=this.S),this.m!==null||this.O||(V.H=O,O=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var x=this.i[f];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(h+=x,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=Tp(this,V,h),f=In(this.I),be(f,"RID",a),be(f,"CVER",22),this.D&&be(f,"X-HTTP-Session-Id",this.D),Si(this,f),O&&(this.O?h="headers="+encodeURIComponent(String(mp(O)))+"&"+h:this.m&&Uu(f,this.m,O)),Fu(this.h,V),this.Ua&&be(f,"TYPE","init"),this.P?(be(f,"$req",h),be(f,"SID","null"),V.T=!0,Vu(V,f,null)):Vu(V,f,h),this.G=2}}else this.G==3&&(a?Ip(this,a):this.i.length==0||rp(this.h)||Ip(this))};function Ip(a,h){var f;h?f=h.l:f=a.U++;const x=In(a.I);be(x,"SID",a.K),be(x,"RID",f),be(x,"AID",a.T),Si(a,x),a.m&&a.o&&Uu(x,a.m,a.o),f=new Xn(a,a.j,f,a.B+1),a.m===null&&(f.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Tp(a,f,1e3),f.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Fu(a.h,f),Vu(f,x,h)}function Si(a,h){a.H&&j(a.H,function(f,x){be(h,x,f)}),a.l&&ap({},function(f,x){be(h,x,f)})}function Tp(a,h,f){f=Math.min(a.i.length,f);var x=a.l?m(a.l.Na,a.l,a):null;e:{var V=a.i;let O=-1;for(;;){const $=["count="+f];O==-1?0<f?(O=V[0].g,$.push("ofs="+O)):O=0:$.push("ofs="+O);let we=!0;for(let Xe=0;Xe<f;Xe++){let fe=V[Xe].g;const ot=V[Xe].map;if(fe-=O,0>fe)O=Math.max(0,V[Xe].g-100),we=!1;else try{o0(ot,$,"req"+fe+"_")}catch{x&&x(ot)}}if(we){x=$.join("&");break e}}}return a=a.i.splice(0,f),h.D=a,x}function bp(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;Fe||ee(),H||(Fe(),H=!0),Z.add(h,a),a.v=0}}function $u(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=yi(m(a.Fa,a),Ap(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Sp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=yi(m(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),ua(this),Sp(this))};function zu(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Sp(a){a.g=new Xn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=In(a.qa);be(h,"RID","rpc"),be(h,"SID",a.K),be(h,"AID",a.T),be(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&be(h,"TO",a.ja),be(h,"TYPE","xmlhttp"),Si(a,h),a.m&&a.o&&Uu(h,a.m,a.o),a.L&&(a.g.I=a.L);var f=a.g;a=a.ia,f.L=1,f.v=ia(In(h)),f.m=null,f.P=!0,Zf(f,a)}t.Za=function(){this.C!=null&&(this.C=null,ua(this),$u(this),gt(19))};function da(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Cp(a,h){var f=null;if(a.g==h){da(a),zu(a),a.g=null;var x=2}else if(Mu(a.h,h))f=h.D,ip(a.h,h),x=1;else return;if(a.G!=0){if(h.o)if(x==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var V=a.B;x=Zo(),xe(x,new Qf(x,f)),ca(a)}else bp(a);else if(V=h.s,V==3||V==0&&0<h.X||!(x==1&&c0(a,h)||x==2&&$u(a)))switch(f&&0<f.length&&(h=a.h,h.i=h.i.concat(f)),V){case 1:Lr(a,5);break;case 4:Lr(a,10);break;case 3:Lr(a,6);break;default:Lr(a,2)}}}function Ap(a,h){let f=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(f*=2),f*h}function Lr(a,h){if(a.j.info("Error code "+h),h==2){var f=m(a.fb,a),x=a.Xa;const V=!x;x=new Or(x||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ra(x,"https"),ia(x),V?r0(x.toString(),f):s0(x.toString(),f)}else gt(2);a.G=0,a.l&&a.l.sa(h),Pp(a),Ep(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Pp(a){if(a.G=0,a.ka=[],a.l){const h=op(a.h);(h.length!=0||a.i.length!=0)&&(D(a.ka,h),D(a.ka,a.i),a.h.i.length=0,S(a.i),a.i.length=0),a.l.ra()}}function Np(a,h,f){var x=f instanceof Or?In(f):new Or(f);if(x.g!="")h&&(x.g=h+"."+x.g),sa(x,x.s);else{var V=l.location;x=V.protocol,h=h?h+"."+V.hostname:V.hostname,V=+V.port;var O=new Or(null);x&&ra(O,x),h&&(O.g=h),V&&sa(O,V),f&&(O.l=f),x=O}return f=a.D,h=a.ya,f&&h&&be(x,f,h),be(x,"VER",a.la),Si(a,x),x}function Rp(a,h,f){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Ve(new oa({eb:f})):new Ve(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function kp(){}t=kp.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ha(){}ha.prototype.g=function(a,h){return new kt(a,h)};function kt(a,h){_e.call(this),this.g=new wp(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!w(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!w(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new ms(this)}N(kt,_e),kt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kt.prototype.close=function(){Bu(this.g)},kt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.u&&(f={},f.__data__=Pu(a),a=f);h.i.push(new Kw(h.Ya++,a)),h.G==3&&ca(h)},kt.prototype.N=function(){this.g.l=null,delete this.j,Bu(this.g),delete this.g,kt.aa.N.call(this)};function Dp(a){Ru.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const f in h){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}N(Dp,Ru);function jp(){ku.call(this),this.status=1}N(jp,ku);function ms(a){this.g=a}N(ms,kp),ms.prototype.ua=function(){xe(this.g,"a")},ms.prototype.ta=function(a){xe(this.g,new Dp(a))},ms.prototype.sa=function(a){xe(this.g,new jp)},ms.prototype.ra=function(){xe(this.g,"b")},ha.prototype.createWebChannel=ha.prototype.g,kt.prototype.send=kt.prototype.o,kt.prototype.open=kt.prototype.m,kt.prototype.close=kt.prototype.close,yx=function(){return new ha},gx=function(){return Zo()},mx=jr,kd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ea.NO_ERROR=0,ea.TIMEOUT=8,ea.HTTP_ERROR=6,Ja=ea,Yf.COMPLETE="complete",px=Yf,Wf.EventType=mi,mi.OPEN="a",mi.CLOSE="b",mi.ERROR="c",mi.MESSAGE="d",_e.prototype.listen=_e.prototype.K,Ui=Wf,Ve.prototype.listenOnce=Ve.prototype.L,Ve.prototype.getLastError=Ve.prototype.Ka,Ve.prototype.getLastErrorCode=Ve.prototype.Ba,Ve.prototype.getStatus=Ve.prototype.Z,Ve.prototype.getResponseJson=Ve.prototype.Oa,Ve.prototype.getResponseText=Ve.prototype.oa,Ve.prototype.send=Ve.prototype.ea,Ve.prototype.setWithCredentials=Ve.prototype.Ha,fx=Ve}).apply(typeof ka<"u"?ka:typeof self<"u"?self:typeof window<"u"?window:{});const vg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}dt.UNAUTHENTICATED=new dt(null),dt.GOOGLE_CREDENTIALS=new dt("google-credentials-uid"),dt.FIRST_PARTY=new dt("first-party-uid"),dt.MOCK_USER=new dt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ci="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=new $h("@firebase/firestore");function Vi(){return rs.logLevel}function Y(t,...e){if(rs.logLevel<=ue.DEBUG){const n=e.map(nf);rs.debug(`Firestore (${ci}): ${t}`,...n)}}function zn(t,...e){if(rs.logLevel<=ue.ERROR){const n=e.map(nf);rs.error(`Firestore (${ci}): ${t}`,...n)}}function Js(t,...e){if(rs.logLevel<=ue.WARN){const n=e.map(nf);rs.warn(`Firestore (${ci}): ${t}`,...n)}}function nf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(t="Unexpected state"){const e=`FIRESTORE (${ci}) INTERNAL ASSERTION FAILED: `+t;throw zn(e),new Error(e)}function ve(t,e){t||ne()}function se(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends qn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _C{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(dt.UNAUTHENTICATED))}shutdown(){}}class xC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class wC{constructor(e){this.t=e,this.currentUser=dt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ve(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Vn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Vn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Vn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string"),new vx(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string"),new dt(e)}}class EC{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=dt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class IC{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new EC(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(dt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class TC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bC{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ve(this.o===void 0);const r=i=>{i.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ve(typeof n.token=="string"),this.R=n.token,new TC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=SC(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function pe(t,e){return t<e?-1:t>e?1:0}function Zs(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Q(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new qe(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new qe(0,0))}static max(){return new re(new qe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,n,r){n===void 0?n=0:n>e.length&&ne(),r===void 0?r=e.length-n:r>e.length-n&&ne(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return bo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof bo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ce extends bo{construct(e,n,r){return new Ce(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ce(n)}static emptyPath(){return new Ce([])}}const CC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class et extends bo{construct(e,n,r){return new et(e,n,r)}static isValidIdentifier(e){return CC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),et.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new et(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Q(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Q(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Q(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new Q(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new et(n)}static emptyPath(){return new et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.path=e}static fromPath(e){return new J(Ce.fromString(e))}static fromName(e){return new J(Ce.fromString(e).popFirst(5))}static empty(){return new J(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new J(new Ce(e.slice()))}}function AC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=re.fromTimestamp(r===1e9?new qe(n+1,0):new qe(n,r));return new Sr(s,J.empty(),e)}function PC(t){return new Sr(t.readTime,t.key,-1)}class Sr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Sr(re.min(),J.empty(),-1)}static max(){return new Sr(re.max(),J.empty(),-1)}}function NC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=J.comparator(t.documentKey,e.documentKey),n!==0?n:pe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class kC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(t){if(t.code!==M.FAILED_PRECONDITION||t.message!==RC)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ne(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(s=>s?F.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new F((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(p=>{o[d]=p,++l,l===i&&r(o)},p=>s(p))}})}static doWhile(e,n){return new F((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function DC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Wo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}rf.oe=-1;function hu(t){return t==null}function Ol(t){return t===0&&1/t==-1/0}function jC(t){return typeof t=="number"&&Number.isInteger(t)&&!Ol(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function di(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xx(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,n){this.comparator=e,this.root=n||Ze.EMPTY}insert(e,n){return new je(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new je(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Da(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Da(this.root,e,this.comparator,!1)}getReverseIterator(){return new Da(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Da(this.root,e,this.comparator,!0)}}class Da{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ze{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ze.RED,this.left=s??Ze.EMPTY,this.right=i??Ze.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ze(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ze.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ze.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ze.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ze.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ne();const e=this.left.check();if(e!==this.right.check())throw ne();return e+(this.isRed()?0:1)}}Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1;Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw ne()}get value(){throw ne()}get color(){throw ne()}get left(){throw ne()}get right(){throw ne()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Ze(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.comparator=e,this.data=new je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xg(this.data.getIterator())}getIteratorFrom(e){return new xg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof nt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new nt(this.comparator);return n.data=e,n}}class xg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.fields=e,e.sort(et.comparator)}static empty(){return new Zt([])}unionWith(e){let n=new nt(et.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Zt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Zs(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new wx("Invalid base64 string: "+i):i}}(e);return new st(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new st(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}st.EMPTY_BYTE_STRING=new st("");const VC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Cr(t){if(ve(!!t),typeof t=="string"){let e=0;const n=VC.exec(t);if(ve(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Le(t.seconds),nanos:Le(t.nanos)}}function Le(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ss(t){return typeof t=="string"?st.fromBase64String(t):st.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function of(t){const e=t.mapValue.fields.__previous_value__;return sf(e)?of(e):e}function So(t){const e=Cr(t.mapValue.fields.__local_write_time__.timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,n,r,s,i,o,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}class Co{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Co("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Co&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja={mapValue:{}};function is(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?sf(t)?4:MC(t)?9007199254740991:LC(t)?10:11:ne()}function vn(t,e){if(t===e)return!0;const n=is(t);if(n!==is(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return So(t).isEqual(So(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Cr(s.timestampValue),l=Cr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ss(s.bytesValue).isEqual(ss(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Le(s.geoPointValue.latitude)===Le(i.geoPointValue.latitude)&&Le(s.geoPointValue.longitude)===Le(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Le(s.integerValue)===Le(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Le(s.doubleValue),l=Le(i.doubleValue);return o===l?Ol(o)===Ol(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Zs(t.arrayValue.values||[],e.arrayValue.values||[],vn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(_g(o)!==_g(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!vn(o[u],l[u])))return!1;return!0}(t,e);default:return ne()}}function Ao(t,e){return(t.values||[]).find(n=>vn(n,e))!==void 0}function ei(t,e){if(t===e)return 0;const n=is(t),r=is(e);if(n!==r)return pe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return pe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Le(i.integerValue||i.doubleValue),u=Le(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return wg(t.timestampValue,e.timestampValue);case 4:return wg(So(t),So(e));case 5:return pe(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ss(i),u=ss(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const p=pe(l[d],u[d]);if(p!==0)return p}return pe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=pe(Le(i.latitude),Le(o.latitude));return l!==0?l:pe(Le(i.longitude),Le(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Eg(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,d,p;const g=i.fields||{},m=o.fields||{},E=(l=g.value)===null||l===void 0?void 0:l.arrayValue,N=(u=m.value)===null||u===void 0?void 0:u.arrayValue,S=pe(((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0,((p=N==null?void 0:N.values)===null||p===void 0?void 0:p.length)||0);return S!==0?S:Eg(E,N)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===ja.mapValue&&o===ja.mapValue)return 0;if(i===ja.mapValue)return 1;if(o===ja.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},p=Object.keys(d);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const m=pe(u[g],p[g]);if(m!==0)return m;const E=ei(l[u[g]],d[p[g]]);if(E!==0)return E}return pe(u.length,p.length)}(t.mapValue,e.mapValue);default:throw ne()}}function wg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return pe(t,e);const n=Cr(t),r=Cr(e),s=pe(n.seconds,r.seconds);return s!==0?s:pe(n.nanos,r.nanos)}function Eg(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=ei(n[s],r[s]);if(i)return i}return pe(n.length,r.length)}function ti(t){return Dd(t)}function Dd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Cr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ss(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return J.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Dd(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Dd(n.fields[o])}`;return s+"}"}(t.mapValue):ne()}function Ig(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function jd(t){return!!t&&"integerValue"in t}function af(t){return!!t&&"arrayValue"in t}function Tg(t){return!!t&&"nullValue"in t}function bg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Za(t){return!!t&&"mapValue"in t}function LC(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function eo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return di(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=eo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=eo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function MC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.value=e}static empty(){return new $t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Za(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=eo(n)}setAll(e){let n=et.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=eo(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Za(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return vn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Za(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){di(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new $t(eo(this.value))}}function Ex(t){const e=[];return di(t.fields,(n,r)=>{const s=new et([n]);if(Za(r)){const i=Ex(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Zt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ft(e,0,re.min(),re.min(),re.min(),$t.empty(),0)}static newFoundDocument(e,n,r,s){return new ft(e,1,n,re.min(),r,s,0)}static newNoDocument(e,n){return new ft(e,2,n,re.min(),re.min(),$t.empty(),0)}static newUnknownDocument(e,n){return new ft(e,3,n,re.min(),re.min(),$t.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$t.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$t.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ft&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ft(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n){this.position=e,this.inclusive=n}}function Sg(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=J.comparator(J.fromName(o.referenceValue),n.key):r=ei(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Cg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!vn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,n="asc"){this.field=e,this.dir=n}}function FC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ix{}class $e extends Ix{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new BC(e,n,r):n==="array-contains"?new HC(e,r):n==="in"?new WC(e,r):n==="not-in"?new qC(e,r):n==="array-contains-any"?new KC(e,r):new $e(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new $C(e,r):new zC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ei(n,this.value)):n!==null&&is(this.value)===is(n)&&this.matchesComparison(ei(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ne()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class on extends Ix{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new on(e,n)}matches(e){return Tx(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Tx(t){return t.op==="and"}function bx(t){return UC(t)&&Tx(t)}function UC(t){for(const e of t.filters)if(e instanceof on)return!1;return!0}function Vd(t){if(t instanceof $e)return t.field.canonicalString()+t.op.toString()+ti(t.value);if(bx(t))return t.filters.map(e=>Vd(e)).join(",");{const e=t.filters.map(n=>Vd(n)).join(",");return`${t.op}(${e})`}}function Sx(t,e){return t instanceof $e?function(r,s){return s instanceof $e&&r.op===s.op&&r.field.isEqual(s.field)&&vn(r.value,s.value)}(t,e):t instanceof on?function(r,s){return s instanceof on&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&Sx(o,s.filters[l]),!0):!1}(t,e):void ne()}function Cx(t){return t instanceof $e?function(n){return`${n.field.canonicalString()} ${n.op} ${ti(n.value)}`}(t):t instanceof on?function(n){return n.op.toString()+" {"+n.getFilters().map(Cx).join(" ,")+"}"}(t):"Filter"}class BC extends $e{constructor(e,n,r){super(e,n,r),this.key=J.fromName(r.referenceValue)}matches(e){const n=J.comparator(e.key,this.key);return this.matchesComparison(n)}}class $C extends $e{constructor(e,n){super(e,"in",n),this.keys=Ax("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class zC extends $e{constructor(e,n){super(e,"not-in",n),this.keys=Ax("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Ax(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>J.fromName(r.referenceValue))}class HC extends $e{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return af(n)&&Ao(n.arrayValue,this.value)}}class WC extends $e{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ao(this.value.arrayValue,n)}}class qC extends $e{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ao(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ao(this.value.arrayValue,n)}}class KC extends $e{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!af(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ao(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function Ag(t,e=null,n=[],r=[],s=null,i=null,o=null){return new GC(t,e,n,r,s,i,o)}function lf(t){const e=se(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Vd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),hu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ti(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ti(r)).join(",")),e.ue=n}return e.ue}function uf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!FC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Sx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cg(t.startAt,e.startAt)&&Cg(t.endAt,e.endAt)}function Od(t){return J.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function QC(t,e,n,r,s,i,o,l){return new qo(t,e,n,r,s,i,o,l)}function fu(t){return new qo(t)}function Pg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Px(t){return t.collectionGroup!==null}function to(t){const e=se(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new nt(et.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Ml(i,r))}),n.has(et.keyField().canonicalString())||e.ce.push(new Ml(et.keyField(),r))}return e.ce}function mn(t){const e=se(t);return e.le||(e.le=YC(e,to(t))),e.le}function YC(t,e){if(t.limitType==="F")return Ag(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ml(s.field,i)});const n=t.endAt?new Ll(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ll(t.startAt.position,t.startAt.inclusive):null;return Ag(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ld(t,e){const n=t.filters.concat([e]);return new qo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Md(t,e,n){return new qo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function pu(t,e){return uf(mn(t),mn(e))&&t.limitType===e.limitType}function Nx(t){return`${lf(mn(t))}|lt:${t.limitType}`}function vs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Cx(s)).join(", ")}]`),hu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ti(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ti(s)).join(",")),`Target(${r})`}(mn(t))}; limitType=${t.limitType})`}function mu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):J.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of to(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const d=Sg(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,to(r),s)||r.endAt&&!function(o,l,u){const d=Sg(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,to(r),s))}(t,e)}function XC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Rx(t){return(e,n)=>{let r=!1;for(const s of to(t)){const i=JC(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function JC(t,e,n){const r=t.field.isKeyField()?J.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?ei(u,d):ne()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ne()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){di(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return xx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC=new je(J.comparator);function Hn(){return ZC}const kx=new je(J.comparator);function Bi(...t){let e=kx;for(const n of t)e=e.insert(n.key,n);return e}function Dx(t){let e=kx;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Wr(){return no()}function jx(){return no()}function no(){return new hi(t=>t.toString(),(t,e)=>t.isEqual(e))}const eA=new je(J.comparator),tA=new nt(J.comparator);function le(...t){let e=tA;for(const n of t)e=e.add(n);return e}const nA=new nt(pe);function rA(){return nA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ol(e)?"-0":e}}function Vx(t){return{integerValue:""+t}}function sA(t,e){return jC(e)?Vx(e):cf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){this._=void 0}}function iA(t,e,n){return t instanceof Po?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&sf(i)&&(i=of(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof No?Lx(t,e):t instanceof Ro?Mx(t,e):function(s,i){const o=Ox(s,i),l=Ng(o)+Ng(s.Pe);return jd(o)&&jd(s.Pe)?Vx(l):cf(s.serializer,l)}(t,e)}function oA(t,e,n){return t instanceof No?Lx(t,e):t instanceof Ro?Mx(t,e):n}function Ox(t,e){return t instanceof Fl?function(r){return jd(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Po extends gu{}class No extends gu{constructor(e){super(),this.elements=e}}function Lx(t,e){const n=Fx(e);for(const r of t.elements)n.some(s=>vn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ro extends gu{constructor(e){super(),this.elements=e}}function Mx(t,e){let n=Fx(e);for(const r of t.elements)n=n.filter(s=>!vn(s,r));return{arrayValue:{values:n}}}class Fl extends gu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Ng(t){return Le(t.integerValue||t.doubleValue)}function Fx(t){return af(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(e,n){this.field=e,this.transform=n}}function lA(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof No&&s instanceof No||r instanceof Ro&&s instanceof Ro?Zs(r.elements,s.elements,vn):r instanceof Fl&&s instanceof Fl?vn(r.Pe,s.Pe):r instanceof Po&&s instanceof Po}(t.transform,e.transform)}class uA{constructor(e,n){this.version=e,this.transformResults=n}}class rn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function el(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class yu{}function Ux(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new df(t.key,rn.none()):new Ko(t.key,t.data,rn.none());{const n=t.data,r=$t.empty();let s=new nt(et.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ls(t.key,r,new Zt(s.toArray()),rn.none())}}function cA(t,e,n){t instanceof Ko?function(s,i,o){const l=s.value.clone(),u=kg(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ls?function(s,i,o){if(!el(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=kg(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Bx(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ro(t,e,n,r){return t instanceof Ko?function(i,o,l,u){if(!el(i.precondition,o))return l;const d=i.value.clone(),p=Dg(i.fieldTransforms,u,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ls?function(i,o,l,u){if(!el(i.precondition,o))return l;const d=Dg(i.fieldTransforms,u,o),p=o.data;return p.setAll(Bx(i)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,l){return el(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function dA(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Ox(r.transform,s||null);i!=null&&(n===null&&(n=$t.empty()),n.set(r.field,i))}return n||null}function Rg(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Zs(r,s,(i,o)=>lA(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ko extends yu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ls extends yu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Bx(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function kg(t,e,n){const r=new Map;ve(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,oA(o,l,n[s]))}return r}function Dg(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,iA(i,o,e))}return r}class df extends yu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hA extends yu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&cA(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ro(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ro(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=jx();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=Ux(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),le())}isEqual(e){return this.batchId===e.batchId&&Zs(this.mutations,e.mutations,(n,r)=>Rg(n,r))&&Zs(this.baseMutations,e.baseMutations,(n,r)=>Rg(n,r))}}class hf{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ve(e.mutations.length===r.length);let s=function(){return eA}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new hf(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue,ce;function gA(t){switch(t){default:return ne();case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0}}function $x(t){if(t===void 0)return zn("GRPC error has no .code"),M.UNKNOWN;switch(t){case Ue.OK:return M.OK;case Ue.CANCELLED:return M.CANCELLED;case Ue.UNKNOWN:return M.UNKNOWN;case Ue.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case Ue.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case Ue.INTERNAL:return M.INTERNAL;case Ue.UNAVAILABLE:return M.UNAVAILABLE;case Ue.UNAUTHENTICATED:return M.UNAUTHENTICATED;case Ue.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case Ue.NOT_FOUND:return M.NOT_FOUND;case Ue.ALREADY_EXISTS:return M.ALREADY_EXISTS;case Ue.PERMISSION_DENIED:return M.PERMISSION_DENIED;case Ue.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case Ue.ABORTED:return M.ABORTED;case Ue.OUT_OF_RANGE:return M.OUT_OF_RANGE;case Ue.UNIMPLEMENTED:return M.UNIMPLEMENTED;case Ue.DATA_LOSS:return M.DATA_LOSS;default:return ne()}}(ce=Ue||(Ue={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=new Qr([4294967295,4294967295],0);function jg(t){const e=yA().encode(t),n=new hx;return n.update(e),new Uint8Array(n.digest())}function Vg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Qr([n,r],0),new Qr([s,i],0)]}class ff{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $i(`Invalid padding: ${n}`);if(r<0)throw new $i(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $i(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new $i(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Qr.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Qr.fromNumber(r)));return s.compare(vA)===1&&(s=new Qr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=jg(e),[r,s]=Vg(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ff(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=jg(e),[r,s]=Vg(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class $i extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Go.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new vu(re.min(),s,new je(pe),Hn(),le())}}class Go{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Go(r,n,le(),le(),le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class zx{constructor(e,n){this.targetId=e,this.me=n}}class Hx{constructor(e,n,r=st.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Og{constructor(){this.fe=0,this.ge=Mg(),this.pe=st.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=le(),n=le(),r=le();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ne()}}),new Go(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Mg()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ve(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class _A{constructor(e){this.Le=e,this.Be=new Map,this.ke=Hn(),this.qe=Lg(),this.Qe=new je(pe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ne()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Od(i))if(r===0){const o=new J(i.path);this.Ue(n,o,ft.newNoDocument(o,re.min()))}else ve(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=ss(r).toUint8Array()}catch(u){if(u instanceof wx)return Js("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new ff(o,s,i)}catch(u){return Js(u instanceof $i?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&Od(l.target)){const u=new J(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,ft.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=le();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new vu(e,n,this.Qe,this.ke,r);return this.ke=Hn(),this.qe=Lg(),this.Qe=new je(pe),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Og,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new nt(pe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Y("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Og),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Lg(){return new je(J.comparator)}function Mg(){return new je(J.comparator)}const xA={asc:"ASCENDING",desc:"DESCENDING"},wA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EA={and:"AND",or:"OR"};class IA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Fd(t,e){return t.useProto3Json||hu(e)?e:{value:e}}function Ul(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Wx(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function TA(t,e){return Ul(t,e.toTimestamp())}function gn(t){return ve(!!t),re.fromTimestamp(function(n){const r=Cr(n);return new qe(r.seconds,r.nanos)}(t))}function pf(t,e){return Ud(t,e).canonicalString()}function Ud(t,e){const n=function(s){return new Ce(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function qx(t){const e=Ce.fromString(t);return ve(Xx(e)),e}function Bd(t,e){return pf(t.databaseId,e.path)}function Tc(t,e){const n=qx(e);if(n.get(1)!==t.databaseId.projectId)throw new Q(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new J(Gx(n))}function Kx(t,e){return pf(t.databaseId,e)}function bA(t){const e=qx(t);return e.length===4?Ce.emptyPath():Gx(e)}function $d(t){return new Ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Gx(t){return ve(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Fg(t,e,n){return{name:Bd(t,e),fields:n.value.mapValue.fields}}function SA(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ne()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,p){return d.useProto3Json?(ve(p===void 0||typeof p=="string"),st.fromBase64String(p||"")):(ve(p===void 0||p instanceof Buffer||p instanceof Uint8Array),st.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const p=d.code===void 0?M.UNKNOWN:$x(d.code);return new Q(p,d.message||"")}(o);n=new Hx(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Tc(t,r.document.name),i=gn(r.document.updateTime),o=r.document.createTime?gn(r.document.createTime):re.min(),l=new $t({mapValue:{fields:r.document.fields}}),u=ft.newFoundDocument(s,i,o,l),d=r.targetIds||[],p=r.removedTargetIds||[];n=new tl(d,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Tc(t,r.document),i=r.readTime?gn(r.readTime):re.min(),o=ft.newNoDocument(s,i),l=r.removedTargetIds||[];n=new tl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Tc(t,r.document),i=r.removedTargetIds||[];n=new tl([],i,s,null)}else{if(!("filter"in e))return ne();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new mA(s,i),l=r.targetId;n=new zx(l,o)}}return n}function CA(t,e){let n;if(e instanceof Ko)n={update:Fg(t,e.key,e.value)};else if(e instanceof df)n={delete:Bd(t,e.key)};else if(e instanceof ls)n={update:Fg(t,e.key,e.data),updateMask:OA(e.fieldMask)};else{if(!(e instanceof hA))return ne();n={verify:Bd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Po)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof No)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ro)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Fl)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ne()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:TA(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ne()}(t,e.precondition)),n}function AA(t,e){return t&&t.length>0?(ve(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?gn(s.updateTime):gn(i);return o.isEqual(re.min())&&(o=gn(i)),new uA(o,s.transformResults||[])}(n,e))):[]}function PA(t,e){return{documents:[Kx(t,e.path)]}}function NA(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Kx(t,s);const i=function(d){if(d.length!==0)return Yx(on.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(p=>function(m){return{field:_s(m.field),direction:DA(m.dir)}}(p))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Fd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function RA(t){let e=bA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ve(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(g){const m=Qx(g);return m instanceof on&&bx(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(m=>function(N){return new Ml(xs(N.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(g){let m;return m=typeof g=="object"?g.value:g,hu(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(g){const m=!!g.before,E=g.values||[];return new Ll(E,m)}(n.startAt));let d=null;return n.endAt&&(d=function(g){const m=!g.before,E=g.values||[];return new Ll(E,m)}(n.endAt)),QC(e,s,o,i,l,"F",u,d)}function kA(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ne()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Qx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=xs(n.unaryFilter.field);return $e.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=xs(n.unaryFilter.field);return $e.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=xs(n.unaryFilter.field);return $e.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=xs(n.unaryFilter.field);return $e.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ne()}}(t):t.fieldFilter!==void 0?function(n){return $e.create(xs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ne()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return on.create(n.compositeFilter.filters.map(r=>Qx(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ne()}}(n.compositeFilter.op))}(t):ne()}function DA(t){return xA[t]}function jA(t){return wA[t]}function VA(t){return EA[t]}function _s(t){return{fieldPath:t.canonicalString()}}function xs(t){return et.fromServerFormat(t.fieldPath)}function Yx(t){return t instanceof $e?function(n){if(n.op==="=="){if(bg(n.value))return{unaryFilter:{field:_s(n.field),op:"IS_NAN"}};if(Tg(n.value))return{unaryFilter:{field:_s(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(bg(n.value))return{unaryFilter:{field:_s(n.field),op:"IS_NOT_NAN"}};if(Tg(n.value))return{unaryFilter:{field:_s(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_s(n.field),op:jA(n.op),value:n.value}}}(t):t instanceof on?function(n){const r=n.getFilters().map(s=>Yx(s));return r.length===1?r[0]:{compositeFilter:{op:VA(n.op),filters:r}}}(t):ne()}function OA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Xx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n,r,s,i=re.min(),o=re.min(),l=st.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new dr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new dr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new dr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new dr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e){this.ct=e}}function MA(t){const e=RA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Md(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(){this.un=new UA}addToCollectionParentIndex(e,n){return this.un.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(Sr.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(Sr.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class UA{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new nt(Ce.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new nt(Ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ni(0)}static kn(){return new ni(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(){this.changes=new hi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ft.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ro(r.mutation,s,Zt.empty(),qe.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,le()).next(()=>r))}getLocalViewOfDocuments(e,n,r=le()){const s=Wr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Bi();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Wr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,le()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Hn();const o=no(),l=function(){return no()}();return n.forEach((u,d)=>{const p=r.get(d.key);s.has(d.key)&&(p===void 0||p.mutation instanceof ls)?i=i.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),ro(p.mutation,d,p.mutation.getFieldMask(),qe.now())):o.set(d.key,Zt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,p)=>o.set(d,p)),n.forEach((d,p)=>{var g;return l.set(d,new $A(p,(g=o.get(d))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=no();let s=new je((o,l)=>o-l),i=le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let p=r.get(u)||Zt.empty();p=l.applyToLocalView(d,p),r.set(u,p);const g=(s.get(l.batchId)||le()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,p=u.value,g=jx();p.forEach(m=>{if(!i.has(m)){const E=Ux(n.get(m),r.get(m));E!==null&&g.set(m,E),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return J.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Px(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):F.resolve(Wr());let l=-1,u=i;return o.next(d=>F.forEach(d,(p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(p)?F.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{u=u.insert(p,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,le())).next(p=>({batchId:l,changes:Dx(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new J(n)).next(r=>{let s=Bi();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Bi();return this.indexManager.getCollectionParents(e,i).next(l=>F.forEach(l,u=>{const d=function(g,m){return new qo(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(p=>{p.forEach((g,m)=>{o=o.insert(g,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,ft.newInvalidDocument(p)))});let l=Bi();return o.forEach((u,d)=>{const p=i.get(u);p!==void 0&&ro(p.mutation,d,Zt.empty(),qe.now()),mu(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return F.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:gn(s.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:MA(s.bundledQuery),readTime:gn(s.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(){this.overlays=new je(J.comparator),this.Ir=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Wr();return F.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const s=Wr(),i=n.length+1,o=new J(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return F.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new je((d,p)=>d-p);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let p=i.get(d.largestBatchId);p===null&&(p=Wr(),i=i.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const l=Wr(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,p)=>l.set(d,p)),!(l.size()>=s)););return F.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new pA(n,r));let i=this.Ir.get(n);i===void 0&&(i=le(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(){this.sessionToken=st.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(){this.Tr=new nt(Ke.Er),this.dr=new nt(Ke.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Ke(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Ke(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new J(new Ce([])),r=new Ke(n,e),s=new Ke(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new J(new Ce([])),r=new Ke(n,e),s=new Ke(n,e+1);let i=le();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ke(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ke{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return J.comparator(e.key,n.key)||pe(e.wr,n.wr)}static Ar(e,n){return pe(e.wr,n.wr)||J.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new nt(Ke.Er)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new fA(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Ke(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ke(n,0),s=new Ke(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new nt(pe);return n.forEach(s=>{const i=new Ke(s,0),o=new Ke(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),F.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;J.isDocumentKey(i)||(i=i.child(""));const o=new Ke(new J(i),0);let l=new nt(pe);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.wr)),!0)},o),F.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ve(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return F.forEach(n.mutations,s=>{const i=new Ke(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Ke(n,0),s=this.br.firstAfterOrEqual(r);return F.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e){this.Mr=e,this.docs=function(){return new je(J.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():ft.newInvalidDocument(n))}getEntries(e,n){let r=Hn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ft.newInvalidDocument(s))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Hn();const o=n.path,l=new J(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:p}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||NC(PC(p),r)<=0||(s.has(p.key)||mu(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ne()}Or(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new QA(this)}getSize(e){return F.resolve(this.size)}}class QA extends BA{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e){this.persistence=e,this.Nr=new hi(n=>lf(n),uf),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Lr=0,this.Br=new mf,this.targetCount=0,this.kr=ni.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),F.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ni(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.Kn(n),F.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),F.waitFor(i).next(()=>s)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e,n){this.qr={},this.overlays={},this.Qr=new rf(0),this.Kr=!1,this.Kr=!0,this.$r=new qA,this.referenceDelegate=e(this),this.Ur=new YA(this),this.indexManager=new FA,this.remoteDocumentCache=function(s){return new GA(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new LA(n),this.Gr=new HA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new WA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new KA(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Y("MemoryPersistence","Starting transaction:",e);const s=new JA(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return F.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class JA extends kC{constructor(e){super(),this.currentSequenceNumber=e}}class gf{constructor(e){this.persistence=e,this.Jr=new mf,this.Yr=null}static Zr(e){return new gf(e)}get Xr(){if(this.Yr)return this.Yr;throw ne()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),F.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.Xr,r=>{const s=J.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,re.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return F.or([()=>F.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=le(),s=le();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new yf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return eT()?8:DC(mt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new ZA;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Vi()<=ue.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",vs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),F.resolve()):(Vi()<=ue.DEBUG&&Y("QueryEngine","Query:",vs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Vi()<=ue.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",vs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,mn(n))):F.resolve())}Yi(e,n){if(Pg(n))return F.resolve(null);let r=mn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Md(n,null,"F"),r=mn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=le(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,l);return this.ns(n,d,o,u.readTime)?this.Yi(e,Md(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return Pg(n)||s.isEqual(re.min())?F.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?F.resolve(null):(Vi()<=ue.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),vs(n)),this.rs(e,o,n,AC(s,-1)).next(l=>l))})}ts(e,n){let r=new nt(Rx(e));return n.forEach((s,i)=>{mu(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Vi()<=ue.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",vs(n)),this.Ji.getDocumentsMatchingQuery(e,n,Sr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new je(pe),this._s=new hi(i=>lf(i),uf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zA(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function n1(t,e,n,r){return new t1(t,e,n,r)}async function Jx(t,e){const n=se(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=le();for(const d of s){o.push(d.batchId);for(const p of d.mutations)u=u.add(p.key)}for(const d of i){l.push(d.batchId);for(const p of d.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function r1(t,e){const n=se(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,p){const g=d.batch,m=g.keys();let E=F.resolve();return m.forEach(N=>{E=E.next(()=>p.getEntry(u,N)).next(S=>{const D=d.docVersions.get(N);ve(D!==null),S.version.compareTo(D)<0&&(g.applyToRemoteDocument(S,d),S.isValidDocument()&&(S.setReadTime(d.commitVersion),p.addEntry(S)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=le();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Zx(t){const e=se(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function s1(t,e){const n=se(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,g)=>{const m=s.get(g);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,g)));let E=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?E=E.withResumeToken(st.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,r)),s=s.insert(g,E),function(S,D,T){return S.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(m,E,p)&&l.push(n.Ur.updateTargetData(i,E))});let u=Hn(),d=le();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(i1(i,o,e.documentUpdates).next(p=>{u=p.Ps,d=p.Is})),!r.isEqual(re.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return F.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=s,i))}function i1(t,e,n){let r=le(),s=le();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Hn();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(re.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Y("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function o1(t,e){const n=se(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function a1(t,e){const n=se(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,F.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new dr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function zd(t,e,n){const r=se(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Wo(o))throw o;Y("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Ug(t,e,n){const r=se(t);let s=re.min(),i=le();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,p){const g=se(u),m=g._s.get(p);return m!==void 0?F.resolve(g.os.get(m)):g.Ur.getTargetData(d,p)}(r,o,mn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:re.min(),n?i:le())).next(l=>(l1(r,XC(e),l),{documents:l,Ts:i})))}function l1(t,e,n){let r=t.us.get(e)||re.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Bg{constructor(){this.activeTargetIds=rA()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class u1{constructor(){this.so=new Bg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Bg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Va=null;function bc(){return Va===null?Va=function(){return 268435456+Math.round(2147483648*Math.random())}():Va++,"0x"+Va.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct="WebChannelConnection";class f1 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=bc(),u=this.xo(n,r.toUriEncodedString());Y("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(n,u,d,s).then(p=>(Y("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw Js("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",s),p})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ci}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=d1[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=bc();return new Promise((o,l)=>{const u=new fx;u.setWithCredentials(!0),u.listenOnce(px.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ja.NO_ERROR:const p=u.getResponseJson();Y(ct,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),o(p);break;case Ja.TIMEOUT:Y(ct,`RPC '${e}' ${i} timed out`),l(new Q(M.DEADLINE_EXCEEDED,"Request time out"));break;case Ja.HTTP_ERROR:const g=u.getStatus();if(Y(ct,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m==null?void 0:m.error;if(E&&E.status&&E.message){const N=function(D){const T=D.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(T)>=0?T:M.UNKNOWN}(E.status);l(new Q(N,E.message))}else l(new Q(M.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Q(M.UNAVAILABLE,"Connection failed."));break;default:ne()}}finally{Y(ct,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);Y(ct,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=bc(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=yx(),l=gx(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");Y(ct,`Creating RPC '${e}' stream ${s}: ${p}`,u);const g=o.createWebChannel(p,u);let m=!1,E=!1;const N=new h1({Io:D=>{E?Y(ct,`Not sending because RPC '${e}' stream ${s} is closed:`,D):(m||(Y(ct,`Opening RPC '${e}' stream ${s} transport.`),g.open(),m=!0),Y(ct,`RPC '${e}' stream ${s} sending:`,D),g.send(D))},To:()=>g.close()}),S=(D,T,w)=>{D.listen(T,C=>{try{w(C)}catch(P){setTimeout(()=>{throw P},0)}})};return S(g,Ui.EventType.OPEN,()=>{E||(Y(ct,`RPC '${e}' stream ${s} transport opened.`),N.yo())}),S(g,Ui.EventType.CLOSE,()=>{E||(E=!0,Y(ct,`RPC '${e}' stream ${s} transport closed`),N.So())}),S(g,Ui.EventType.ERROR,D=>{E||(E=!0,Js(ct,`RPC '${e}' stream ${s} transport errored:`,D),N.So(new Q(M.UNAVAILABLE,"The operation could not be completed")))}),S(g,Ui.EventType.MESSAGE,D=>{var T;if(!E){const w=D.data[0];ve(!!w);const C=w,P=C.error||((T=C[0])===null||T===void 0?void 0:T.error);if(P){Y(ct,`RPC '${e}' stream ${s} received error:`,P);const R=P.status;let j=function(I){const A=Ue[I];if(A!==void 0)return $x(A)}(R),v=P.message;j===void 0&&(j=M.INTERNAL,v="Unknown error status: "+R+" with message "+P.message),E=!0,N.So(new Q(j,v)),g.close()}else Y(ct,`RPC '${e}' stream ${s} received:`,w),N.bo(w)}}),S(l,mx.STAT_EVENT,D=>{D.stat===kd.PROXY?Y(ct,`RPC '${e}' stream ${s} detected buffering proxy`):D.stat===kd.NOPROXY&&Y(ct,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}}function Sc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(t){return new IA(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,n,r,s,i,o,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ew(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===M.RESOURCE_EXHAUSTED?(zn(n.toString()),zn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new Q(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class p1 extends tw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=SA(this.serializer,e),r=function(i){if(!("targetChange"in i))return re.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?re.min():o.readTime?gn(o.readTime):re.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=$d(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=Od(u)?{documents:PA(i,u)}:{query:NA(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Wx(i,o.resumeToken);const d=Fd(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(re.min())>0){l.readTime=Ul(i,o.snapshotVersion.toTimestamp());const d=Fd(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=kA(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=$d(this.serializer),n.removeTarget=e,this.a_(n)}}class m1 extends tw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return ve(!!e.streamToken),this.lastStreamToken=e.streamToken,ve(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ve(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=AA(e.writeResults,e.commitTime),r=gn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=$d(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>CA(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Q(M.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Ud(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Q(M.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Ud(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(M.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class y1{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(zn(n),this.D_=!1):Y("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{us(this)&&(Y("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=se(u);d.L_.add(4),await Qo(d),d.q_.set("Unknown"),d.L_.delete(4),await xu(d)}(this))})}),this.q_=new y1(r,s)}}async function xu(t){if(us(t))for(const e of t.B_)await e(!0)}async function Qo(t){for(const e of t.B_)await e(!1)}function nw(t,e){const n=se(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),wf(n)?xf(n):fi(n).r_()&&_f(n,e))}function vf(t,e){const n=se(t),r=fi(n);n.N_.delete(e),r.r_()&&rw(n,e),n.N_.size===0&&(r.r_()?r.o_():us(n)&&n.q_.set("Unknown"))}function _f(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}fi(t).A_(e)}function rw(t,e){t.Q_.xe(e),fi(t).R_(e)}function xf(t){t.Q_=new _A({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),fi(t).start(),t.q_.v_()}function wf(t){return us(t)&&!fi(t).n_()&&t.N_.size>0}function us(t){return se(t).L_.size===0}function sw(t){t.Q_=void 0}async function _1(t){t.q_.set("Online")}async function x1(t){t.N_.forEach((e,n)=>{_f(t,e)})}async function w1(t,e){sw(t),wf(t)?(t.q_.M_(e),xf(t)):t.q_.set("Unknown")}async function E1(t,e,n){if(t.q_.set("Online"),e instanceof Hx&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){Y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Bl(t,r)}else if(e instanceof tl?t.Q_.Ke(e):e instanceof zx?t.Q_.He(e):t.Q_.We(e),!n.isEqual(re.min()))try{const r=await Zx(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.N_.get(d);p&&i.N_.set(d,p.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const p=i.N_.get(u);if(!p)return;i.N_.set(u,p.withResumeToken(st.EMPTY_BYTE_STRING,p.snapshotVersion)),rw(i,u);const g=new dr(p.target,u,d,p.sequenceNumber);_f(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Y("RemoteStore","Failed to raise snapshot:",r),await Bl(t,r)}}async function Bl(t,e,n){if(!Wo(e))throw e;t.L_.add(1),await Qo(t),t.q_.set("Offline"),n||(n=()=>Zx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await xu(t)})}function iw(t,e){return e().catch(n=>Bl(t,n,e))}async function wu(t){const e=se(t),n=Ar(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;I1(e);)try{const s=await o1(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,T1(e,s)}catch(s){await Bl(e,s)}ow(e)&&aw(e)}function I1(t){return us(t)&&t.O_.length<10}function T1(t,e){t.O_.push(e);const n=Ar(t);n.r_()&&n.V_&&n.m_(e.mutations)}function ow(t){return us(t)&&!Ar(t).n_()&&t.O_.length>0}function aw(t){Ar(t).start()}async function b1(t){Ar(t).p_()}async function S1(t){const e=Ar(t);for(const n of t.O_)e.m_(n.mutations)}async function C1(t,e,n){const r=t.O_.shift(),s=hf.from(r,e,n);await iw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await wu(t)}async function A1(t,e){e&&Ar(t).V_&&await async function(r,s){if(function(o){return gA(o)&&o!==M.ABORTED}(s.code)){const i=r.O_.shift();Ar(r).s_(),await iw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await wu(r)}}(t,e),ow(t)&&aw(t)}async function zg(t,e){const n=se(t);n.asyncQueue.verifyOperationInProgress(),Y("RemoteStore","RemoteStore received new credentials");const r=us(n);n.L_.add(3),await Qo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await xu(n)}async function P1(t,e){const n=se(t);e?(n.L_.delete(2),await xu(n)):e||(n.L_.add(2),await Qo(n),n.q_.set("Unknown"))}function fi(t){return t.K_||(t.K_=function(n,r,s){const i=se(n);return i.w_(),new p1(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:_1.bind(null,t),Ro:x1.bind(null,t),mo:w1.bind(null,t),d_:E1.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),wf(t)?xf(t):t.q_.set("Unknown")):(await t.K_.stop(),sw(t))})),t.K_}function Ar(t){return t.U_||(t.U_=function(n,r,s){const i=se(n);return i.w_(),new m1(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:b1.bind(null,t),mo:A1.bind(null,t),f_:S1.bind(null,t),g_:C1.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await wu(t)):(await t.U_.stop(),t.O_.length>0&&(Y("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Vn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Ef(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function If(t,e){if(zn("AsyncQueue",`${e}: ${t}`),Wo(t))return new Q(M.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e){this.comparator=e?(n,r)=>e(n,r)||J.comparator(n.key,r.key):(n,r)=>J.comparator(n.key,r.key),this.keyedMap=Bi(),this.sortedSet=new je(this.comparator)}static emptySet(e){return new $s(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof $s)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new $s;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(){this.W_=new je(J.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ne():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ri{constructor(e,n,r,s,i,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new ri(e,n,$s.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class R1{constructor(){this.queries=Wg(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=se(n),i=s.queries;s.queries=Wg(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new Q(M.ABORTED,"Firestore shutting down"))}}function Wg(){return new hi(t=>Nx(t),pu)}async function Tf(t,e){const n=se(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new N1,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=If(o,`Initialization of query '${vs(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Sf(n)}async function bf(t,e){const n=se(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function k1(t,e){const n=se(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Sf(n)}function D1(t,e,n){const r=se(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Sf(t){t.Y_.forEach(e=>{e.next()})}var Hd,qg;(qg=Hd||(Hd={})).ea="default",qg.Cache="cache";class Cf{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ri(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ri.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Hd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e){this.key=e}}class uw{constructor(e){this.key=e}}class j1{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=le(),this.mutatedKeys=le(),this.Aa=Rx(e),this.Ra=new $s(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Hg,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,g)=>{const m=s.get(p),E=mu(this.query,g)?g:null,N=!!m&&this.mutatedKeys.has(m.key),S=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let D=!1;m&&E?m.data.isEqual(E.data)?N!==S&&(r.track({type:3,doc:E}),D=!0):this.ga(m,E)||(r.track({type:2,doc:E}),D=!0,(u&&this.Aa(E,u)>0||d&&this.Aa(E,d)<0)&&(l=!0)):!m&&E?(r.track({type:0,doc:E}),D=!0):m&&!E&&(r.track({type:1,doc:m}),D=!0,(u||d)&&(l=!0)),D&&(E?(o=o.add(E),i=S?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,g)=>function(E,N){const S=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne()}};return S(E)-S(N)}(p.type,g.type)||this.Aa(p.doc,g.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new ri(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Hg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=le(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new uw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new lw(r))}),n}ba(e){this.Ta=e.Ts,this.da=le();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ri.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class V1{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class O1{constructor(e){this.key=e,this.va=!1}}class L1{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new hi(l=>Nx(l),pu),this.Ma=new Map,this.xa=new Set,this.Oa=new je(J.comparator),this.Na=new Map,this.La=new mf,this.Ba={},this.ka=new Map,this.qa=ni.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function M1(t,e,n=!0){const r=mw(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await cw(r,e,n,!0),s}async function F1(t,e){const n=mw(t);await cw(n,e,!0,!1)}async function cw(t,e,n,r){const s=await a1(t.localStore,mn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await U1(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&nw(t.remoteStore,s),l}async function U1(t,e,n,r,s){t.Ka=(g,m,E)=>async function(S,D,T,w){let C=D.view.ma(T);C.ns&&(C=await Ug(S.localStore,D.query,!1).then(({documents:v})=>D.view.ma(v,C)));const P=w&&w.targetChanges.get(D.targetId),R=w&&w.targetMismatches.get(D.targetId)!=null,j=D.view.applyChanges(C,S.isPrimaryClient,P,R);return Gg(S,D.targetId,j.wa),j.snapshot}(t,g,m,E);const i=await Ug(t.localStore,e,!0),o=new j1(e,i.Ts),l=o.ma(i.documents),u=Go.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,u);Gg(t,n,d.wa);const p=new V1(e,n,o);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function B1(t,e,n){const r=se(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!pu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await zd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&vf(r.remoteStore,s.targetId),Wd(r,s.targetId)}).catch(Ho)):(Wd(r,s.targetId),await zd(r.localStore,s.targetId,!0))}async function $1(t,e){const n=se(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),vf(n.remoteStore,r.targetId))}async function z1(t,e,n){const r=Y1(t);try{const s=await function(o,l){const u=se(o),d=qe.now(),p=l.reduce((E,N)=>E.add(N.key),le());let g,m;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let N=Hn(),S=le();return u.cs.getEntries(E,p).next(D=>{N=D,N.forEach((T,w)=>{w.isValidDocument()||(S=S.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,N)).next(D=>{g=D;const T=[];for(const w of l){const C=dA(w,g.get(w.key).overlayedDocument);C!=null&&T.push(new ls(w.key,C,Ex(C.value.mapValue),rn.exists(!0)))}return u.mutationQueue.addMutationBatch(E,d,T,l)}).next(D=>{m=D;const T=D.applyToLocalDocumentSet(g,S);return u.documentOverlayCache.saveOverlays(E,D.batchId,T)})}).then(()=>({batchId:m.batchId,changes:Dx(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new je(pe)),d=d.insert(l,u),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,n),await Yo(r,s.changes),await wu(r.remoteStore)}catch(s){const i=If(s,"Failed to persist write");n.reject(i)}}async function dw(t,e){const n=se(t);try{const r=await s1(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?ve(o.va):s.removedDocuments.size>0&&(ve(o.va),o.va=!1))}),await Yo(n,r,e)}catch(r){await Ho(r)}}function Kg(t,e,n){const r=se(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=se(o);u.onlineState=l;let d=!1;u.queries.forEach((p,g)=>{for(const m of g.j_)m.Z_(l)&&(d=!0)}),d&&Sf(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function H1(t,e,n){const r=se(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new je(J.comparator);o=o.insert(i,ft.newNoDocument(i,re.min()));const l=le().add(i),u=new vu(re.min(),new Map,new je(pe),o,l);await dw(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Af(r)}else await zd(r.localStore,e,!1).then(()=>Wd(r,e,n)).catch(Ho)}async function W1(t,e){const n=se(t),r=e.batch.batchId;try{const s=await r1(n.localStore,e);fw(n,r,null),hw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Yo(n,s)}catch(s){await Ho(s)}}async function q1(t,e,n){const r=se(t);try{const s=await function(o,l){const u=se(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return u.mutationQueue.lookupMutationBatch(d,l).next(g=>(ve(g!==null),p=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>u.localDocuments.getDocuments(d,p))})}(r.localStore,e);fw(r,e,n),hw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Yo(r,s)}catch(s){await Ho(s)}}function hw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function fw(t,e,n){const r=se(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Wd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||pw(t,r)})}function pw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(vf(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Af(t))}function Gg(t,e,n){for(const r of n)r instanceof lw?(t.La.addReference(r.key,e),K1(t,r)):r instanceof uw?(Y("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||pw(t,r.key)):ne()}function K1(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Y("SyncEngine","New document in limbo: "+n),t.xa.add(r),Af(t))}function Af(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new J(Ce.fromString(e)),r=t.qa.next();t.Na.set(r,new O1(n)),t.Oa=t.Oa.insert(n,r),nw(t.remoteStore,new dr(mn(fu(n.path)),r,"TargetPurposeLimboResolution",rf.oe))}}async function Yo(t,e,n){const r=se(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(d=>{var p;if((d||n)&&r.isPrimaryClient){const g=d?!d.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(d){s.push(d);const g=yf.Wi(u.targetId,d);i.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,d){const p=se(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>F.forEach(d,m=>F.forEach(m.$i,E=>p.persistence.referenceDelegate.addReference(g,m.targetId,E)).next(()=>F.forEach(m.Ui,E=>p.persistence.referenceDelegate.removeReference(g,m.targetId,E)))))}catch(g){if(!Wo(g))throw g;Y("LocalStore","Failed to update sequence numbers: "+g)}for(const g of d){const m=g.targetId;if(!g.fromCache){const E=p.os.get(m),N=E.snapshotVersion,S=E.withLastLimboFreeSnapshotVersion(N);p.os=p.os.insert(m,S)}}}(r.localStore,i))}async function G1(t,e){const n=se(t);if(!n.currentUser.isEqual(e)){Y("SyncEngine","User change. New user:",e.toKey());const r=await Jx(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new Q(M.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Yo(n,r.hs)}}function Q1(t,e){const n=se(t),r=n.Na.get(e);if(r&&r.va)return le().add(r.key);{let s=le();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function mw(t){const e=se(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Q1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=H1.bind(null,e),e.Ca.d_=k1.bind(null,e.eventManager),e.Ca.$a=D1.bind(null,e.eventManager),e}function Y1(t){const e=se(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=W1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=q1.bind(null,e),e}class $l{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_u(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return n1(this.persistence,new e1,e.initialUser,this.serializer)}Ga(e){return new XA(gf.Zr,this.serializer)}Wa(e){return new u1}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$l.provider={build:()=>new $l};class qd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Kg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=G1.bind(null,this.syncEngine),await P1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new R1}()}createDatastore(e){const n=_u(e.databaseInfo.databaseId),r=function(i){return new f1(i)}(e.databaseInfo);return function(i,o,l,u){return new g1(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new v1(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Kg(this.syncEngine,n,0),function(){return $g.D()?new $g:new c1}())}createSyncEngine(e,n){return function(s,i,o,l,u,d,p){const g=new L1(s,i,o,l,u,d);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=se(s);Y("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Qo(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}qd.provider={build:()=>new qd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):zn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=dt.UNAUTHENTICATED,this.clientId=_x.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Y("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Y("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=If(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Cc(t,e){t.asyncQueue.verifyOperationInProgress(),Y("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Jx(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Qg(t,e){t.asyncQueue.verifyOperationInProgress();const n=await J1(t);Y("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>zg(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>zg(e.remoteStore,s)),t._onlineComponents=e}async function J1(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y("FirestoreClient","Using user provided OfflineComponentProvider");try{await Cc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===M.FAILED_PRECONDITION||s.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Js("Error using user provided cache. Falling back to memory cache: "+n),await Cc(t,new $l)}}else Y("FirestoreClient","Using default OfflineComponentProvider"),await Cc(t,new $l);return t._offlineComponents}async function gw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y("FirestoreClient","Using user provided OnlineComponentProvider"),await Qg(t,t._uninitializedComponentsProvider._online)):(Y("FirestoreClient","Using default OnlineComponentProvider"),await Qg(t,new qd))),t._onlineComponents}function Z1(t){return gw(t).then(e=>e.syncEngine)}async function zl(t){const e=await gw(t),n=e.eventManager;return n.onListen=M1.bind(null,e.syncEngine),n.onUnlisten=B1.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=F1.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=$1.bind(null,e.syncEngine),n}function eP(t,e,n={}){const r=new Vn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const p=new Pf({next:m=>{p.Za(),o.enqueueAndForget(()=>bf(i,g));const E=m.docs.has(l);!E&&m.fromCache?d.reject(new Q(M.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&m.fromCache&&u&&u.source==="server"?d.reject(new Q(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),g=new Cf(fu(l.path),p,{includeMetadataChanges:!0,_a:!0});return Tf(i,g)}(await zl(t),t.asyncQueue,e,n,r)),r.promise}function tP(t,e,n={}){const r=new Vn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const p=new Pf({next:m=>{p.Za(),o.enqueueAndForget(()=>bf(i,g)),m.fromCache&&u.source==="server"?d.reject(new Q(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),g=new Cf(l,p,{includeMetadataChanges:!0,_a:!0});return Tf(i,g)}(await zl(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t,e,n){if(!n)throw new Q(M.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nP(t,e,n,r){if(e===!0&&r===!0)throw new Q(M.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Xg(t){if(!J.isDocumentKey(t))throw new Q(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Jg(t){if(J.isDocumentKey(t))throw new Q(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Eu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ne()}function Wt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Eu(t);throw new Q(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Q(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Q(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Q(M.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Q(M.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Q(M.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Iu{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zg({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new _C;switch(r.type){case"firstParty":return new IC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Yg.get(n);r&&(Y("ComponentProvider","Removing Datastore"),Yg.delete(n),r.terminate())}(this),Promise.resolve()}}function rP(t,e,n,r={}){var s;const i=(t=Wt(t,Iu))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Js("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=dt.MOCK_USER;else{l=KI(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new Q(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new dt(d)}t._authCredentials=new xC(new vx(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new cs(this.firestore,e,this._query)}}class _t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ir(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}}class Ir extends cs{constructor(e,n,r){super(e,n,fu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new J(e))}withConverter(e){return new Ir(this.firestore,e,this._path)}}function On(t,e,...n){if(t=xt(t),vw("collection","path",e),t instanceof Iu){const r=Ce.fromString(e,...n);return Jg(r),new Ir(t,null,r)}{if(!(t instanceof _t||t instanceof Ir))throw new Q(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return Jg(r),new Ir(t.firestore,null,r)}}function an(t,e,...n){if(t=xt(t),arguments.length===1&&(e=_x.newId()),vw("doc","path",e),t instanceof Iu){const r=Ce.fromString(e,...n);return Xg(r),new _t(t,null,new J(r))}{if(!(t instanceof _t||t instanceof Ir))throw new Q(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return Xg(r),new _t(t.firestore,t instanceof Ir?t.converter:null,new J(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ew(this,"async_queue_retry"),this.Vu=()=>{const r=Sc();r&&Y("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Sc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Sc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Vn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Wo(e))throw e;Y("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw zn("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Ef.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ne()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function ty(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Pr extends Iu{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new ey,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ey(e),this._firestoreClient=void 0,await e}}}function sP(t,e){const n=typeof t=="object"?t:k_(),r=typeof t=="string"?t:"(default)",s=Hh(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=WI("firestore");i&&rP(s,...i)}return s}function Tu(t){if(t._terminated)throw new Q(M.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||iP(t),t._firestoreClient}function iP(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,d,p){return new OC(l,u,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,yw(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new X1(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this._byteString=e}static fromBase64String(e){try{return new si(st.fromBase64String(e))}catch(n){throw new Q(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new si(st.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=/^__.*__$/;class aP{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ls(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ko(e,this.data,n,this.fieldTransforms)}}function _w(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne()}}class jf{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new jf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Hl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(_w(this.Cu)&&oP.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class lP{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||_u(e)}Qu(e,n,r,s=!1){return new jf({Cu:e,methodName:n,qu:r,path:et.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Vf(t){const e=t._freezeSettings(),n=_u(t._databaseId);return new lP(t._databaseId,!!e.ignoreUndefinedProperties,n)}function xw(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Iw("Data must be an object, but it was:",o,r);const l=ww(r,o);let u,d;if(i.merge)u=new Zt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const g of i.mergeFields){const m=cP(e,g,n);if(!o.contains(m))throw new Q(M.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);hP(p,m)||p.push(m)}u=new Zt(p),d=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=o.fieldTransforms;return new aP(new $t(l),u,d)}class Of extends Rf{_toFieldTransform(e){return new aA(e.path,new Po)}isEqual(e){return e instanceof Of}}function uP(t,e,n,r=!1){return Lf(n,t.Qu(r?4:3,e))}function Lf(t,e){if(Ew(t=xt(t)))return Iw("Unsupported field value:",e,t),ww(t,e);if(t instanceof Rf)return function(r,s){if(!_w(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=Lf(l,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=xt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return sA(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=qe.fromDate(r);return{timestampValue:Ul(s.serializer,i)}}if(r instanceof qe){const i=new qe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ul(s.serializer,i)}}if(r instanceof kf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof si)return{bytesValue:Wx(s.serializer,r._byteString)};if(r instanceof _t){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:pf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Df)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return cf(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Eu(r)}`)}(t,e)}function ww(t,e){const n={};return xx(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):di(t,(r,s)=>{const i=Lf(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Ew(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qe||t instanceof kf||t instanceof si||t instanceof _t||t instanceof Rf||t instanceof Df)}function Iw(t,e,n){if(!Ew(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Eu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function cP(t,e,n){if((e=xt(e))instanceof Nf)return e._internalPath;if(typeof e=="string")return Tw(t,e);throw Hl("Field path arguments must be of type string or ",t,!1,void 0,n)}const dP=new RegExp("[~\\*/\\[\\]]");function Tw(t,e,n){if(e.search(dP)>=0)throw Hl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Nf(...e.split("."))._internalPath}catch{throw Hl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Hl(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Q(M.INVALID_ARGUMENT,l+t+u)}function hP(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Mf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class fP extends bw{data(){return super.data()}}function Mf(t,e){return typeof e=="string"?Tw(t,e):e instanceof Nf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Q(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ff{}class pP extends Ff{}function Kd(t,e,...n){let r=[];e instanceof Ff&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Uf).length,l=i.filter(u=>u instanceof bu).length;if(o>1||o>0&&l>0)throw new Q(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class bu extends pP{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new bu(e,n,r)}_apply(e){const n=this._parse(e);return Cw(e._query,n),new cs(e.firestore,e.converter,Ld(e._query,n))}_parse(e){const n=Vf(e.firestore);return function(i,o,l,u,d,p,g){let m;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new Q(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){ry(g,p);const E=[];for(const N of g)E.push(ny(u,i,N));m={arrayValue:{values:E}}}else m=ny(u,i,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||ry(g,p),m=uP(l,o,g,p==="in"||p==="not-in");return $e.create(d,p,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function mP(t,e,n){const r=e,s=Mf("where",t);return bu._create(s,r,n)}class Uf extends Ff{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Uf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:on.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)Cw(o,u),o=Ld(o,u)}(e._query,n),new cs(e.firestore,e.converter,Ld(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function ny(t,e,n){if(typeof(n=xt(n))=="string"){if(n==="")throw new Q(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Px(e)&&n.indexOf("/")!==-1)throw new Q(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ce.fromString(n));if(!J.isDocumentKey(r))throw new Q(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ig(t,new J(r))}if(n instanceof _t)return Ig(t,n._key);throw new Q(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Eu(n)}.`)}function ry(t,e){if(!Array.isArray(t)||t.length===0)throw new Q(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cw(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Q(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class gP{convertValue(e,n="none"){switch(is(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ss(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ne()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return di(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Le(o.doubleValue));return new Df(i)}convertGeoPoint(e){return new kf(Le(e.latitude),Le(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=of(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(So(e));default:return null}}convertTimestamp(e){const n=Cr(e);return new qe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ce.fromString(e);ve(Xx(r));const s=new Co(r.get(1),r.get(3)),i=new J(r.popFirst(5));return s.isEqual(n)||zn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pw extends bw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new nl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Mf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class nl extends Pw{data(e={}){return super.data(e)}}class Nw{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new zi(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new nl(this._firestore,this._userDataWriter,r.key,r,new zi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new nl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new zi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new nl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new zi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,p=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:yP(l.type),doc:u,oldIndex:d,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function yP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vP(t){t=Wt(t,_t);const e=Wt(t.firestore,Pr);return eP(Tu(e),t._key).then(n=>Dw(e,t,n))}class Bf extends gP{constructor(e){super(),this.firestore=e}convertBytes(e){return new si(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,n)}}function rl(t){t=Wt(t,cs);const e=Wt(t.firestore,Pr),n=Tu(e),r=new Bf(e);return Sw(t._query),tP(n,t._query).then(s=>new Nw(e,r,t,s))}function Xo(t,e,n){t=Wt(t,_t);const r=Wt(t.firestore,Pr),s=Aw(t.converter,e,n);return $f(r,[xw(Vf(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,rn.none())])}function Rw(t){return $f(Wt(t.firestore,Pr),[new df(t._key,rn.none())])}function kw(t,e){const n=Wt(t.firestore,Pr),r=an(t),s=Aw(t.converter,e);return $f(n,[xw(Vf(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,rn.exists(!1))]).then(()=>r)}function ko(t,...e){var n,r,s;t=xt(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ty(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(ty(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(s=g.complete)===null||s===void 0?void 0:s.bind(g)}let u,d,p;if(t instanceof _t)d=Wt(t.firestore,Pr),p=fu(t._key.path),u={next:g=>{e[o]&&e[o](Dw(d,t,g))},error:e[o+1],complete:e[o+2]};else{const g=Wt(t,cs);d=Wt(g.firestore,Pr),p=g._query;const m=new Bf(d);u={next:E=>{e[o]&&e[o](new Nw(d,m,g,E))},error:e[o+1],complete:e[o+2]},Sw(t._query)}return function(m,E,N,S){const D=new Pf(S),T=new Cf(E,D,N);return m.asyncQueue.enqueueAndForget(async()=>Tf(await zl(m),T)),()=>{D.Za(),m.asyncQueue.enqueueAndForget(async()=>bf(await zl(m),T))}}(Tu(d),p,l,u)}function $f(t,e){return function(r,s){const i=new Vn;return r.asyncQueue.enqueueAndForget(async()=>z1(await Z1(r),s,i)),i.promise}(Tu(t),e)}function Dw(t,e,n){const r=n.docs.get(e._key),s=new Bf(t);return new Pw(t,s,e._key,r,new zi(n.hasPendingWrites,n.fromCache),e.converter)}function _P(){return new Of("serverTimestamp")}(function(e,n=!0){(function(s){ci=s})(li),Ys(new ts("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Pr(new wC(r.getProvider("auth-internal")),new bC(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Q(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Co(d.options.projectId,p)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Er(vg,"4.7.3",e),Er(vg,"4.7.3","esm2017")})();const xP={apiKey:"AIzaSyDfsK4K4vhOmSSGeVHOlLnJuNlHGNha4LU",authDomain:"storycraft-a5f7e.firebaseapp.com",projectId:"storycraft-a5f7e",storageBucket:"storycraft-a5f7e.firebasestorage.app",messagingSenderId:"727724875985",appId:"1:727724875985:web:97411448885c68c289e5f0",measurementId:"G-JH03Y2NZDK"},jw=R_(xP),Ac=mC(jw),Ye=sP(jw),wP="1:727724875985:web:97411448885c68c289e5f0",Vw=L.createContext(),EP=({children:t})=>{const[e,n]=L.useState(null),[r,s]=L.useState(!1),[i,o]=L.useState(!0);L.useEffect(()=>{const p=rS(Ac,g=>{n(g),g||(o(!1),s(!1))});return()=>p()},[]),L.useEffect(()=>{if(e){const p=an(Ye,`artifacts2/${wP}/users/${e.uid}`),g=ko(p,async m=>{if(m.exists())s(m.data().isMaster===!0);else try{await Xo(p,{displayName:e.displayName,email:e.email,isMaster:!1}),s(!1)}catch(E){console.error("Erro ao criar o documento do utilizador:",E)}o(!1)},m=>{console.error("Erro ao escutar documento do utilizador:",m),o(!1)});return()=>g()}},[e]);const d={user:e,loading:i,isMaster:r,googleSignIn:()=>{const p=new Cn;return TS(Ac,p)},googleSignOut:()=>sS(Ac)};return c.jsx(Vw.Provider,{value:d,children:!i&&t})},ze=()=>{const t=L.useContext(Vw);if(!t)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return t},sy="1:727724875985:web:97411448885c68c289e5f0",IP=(t,e)=>{const[n,r]=L.useState(null),[s,i]=L.useState(!0);L.useEffect(()=>{if(!t||!e){i(!1);return}const u=an(Ye,`artifacts2/${sy}/users/${e}/characterSheets/${t}`),d=ko(u,p=>{if(p.exists()){const m={...p.data()};Object.keys(m).forEach(E=>{if(typeof m[E]=="string")try{m[E]=JSON.parse(m[E])}catch{}}),r({id:p.id,...m})}else console.error("Personagem não encontrado!"),r(null);i(!1)},p=>{console.error("Erro ao carregar o personagem:",p),i(!1)});return()=>d()},[t,e]);const o=L.useCallback(async(u,d)=>{if(!t||!e)return;const p=an(Ye,`artifacts2/${sy}/users/${e}/characterSheets/${t}`),g=typeof d=="object"&&d!==null?JSON.stringify(d):d;try{await Xo(p,{[u]:g},{merge:!0})}catch(m){console.error(`Erro ao atualizar o campo ${u}:`,m)}},[t,e]),l=L.useCallback(u=>{var d;if(n){const p=((d=n.collapsedStates)==null?void 0:d[u])??!1,g={...n.collapsedStates,[u]:!p};o("collapsedStates",g)}},[n,o]);return{character:n,loading:s,updateCharacterField:o,toggleSection:l}},Ow=L.createContext(),Su=()=>L.useContext(Ow),Lw=({children:t})=>{const[e,n]=L.useState([]),r=L.useCallback(o=>{const l={...o,type:"roll",id:Date.now()+Math.random(),timestamp:new Date};n(u=>[l,...u].slice(0,50))},[]),s=L.useCallback(o=>{const l={...o,type:"message",id:Date.now()+Math.random(),timestamp:new Date};n(u=>[l,...u].slice(0,50))},[]),i={feedItems:e,addRollToFeed:r,addMessageToFeed:s};return c.jsx(Ow.Provider,{value:i,children:t})},so="1:727724875985:web:97411448885c68c289e5f0",TP=async(t,e=!1)=>{if(!t)return[];try{let n=[];if(e){const r=On(Ye,`artifacts2/${so}/users`),s=await rl(r);for(const i of s.docs){const o=On(Ye,`artifacts2/${so}/users/${i.id}/characterSheets`),l=Kd(o);(await rl(l)).forEach(d=>{n.push({id:d.id,ownerUid:i.id,...d.data()})})}}else{const r=On(Ye,`artifacts2/${so}/users/${t}/characterSheets`),s=Kd(r);(await rl(s)).forEach(o=>{n.push({id:o.id,...o.data()})})}return n}catch(n){return console.error("Erro ao buscar personagens:",n),[]}},bP=async t=>{if(!t)return null;const e=prompt("Qual o nome do novo personagem?");if(!e)return null;try{const n=On(Ye,`artifacts2/${so}/users/${t}/characterSheets`),r={name:e,ownerUid:t,createdAt:_P(),level:1,mainAttributes:{hp:{current:100,max:100,temp:0},mp:{current:50,max:50}}};return{id:(await kw(n,r)).id,...r}}catch(n){return console.error("Erro ao criar novo personagem:",n),null}},SP=async(t,e)=>{if(!t||!e)return!1;try{const n=an(Ye,`artifacts2/${so}/users/${t}/characterSheets/${e}`);return await Rw(n),console.log("Ficha deletada com sucesso!"),!0}catch(n){return console.error("Erro ao deletar personagem:",n),!1}},CP="1:727724875985:web:97411448885c68c289e5f0",Pc=async t=>{if(!t)return[];try{const e=On(Ye,"themes"),n=Kd(e,mP("ownerUid","==",t)),r=await rl(n),s=[];return r.forEach(i=>{s.push({id:i.id,...i.data()})}),s}catch(e){return console.error("Erro ao buscar temas:",e),[]}},AP=async t=>{if(!t)return null;try{const e=an(Ye,"themes",t),n=await vP(e);return n.exists()?{id:n.id,...n.data()}:null}catch(e){return console.error("Erro ao buscar tema por ID:",e),null}},iy=async t=>{try{if(t.id){const e=an(Ye,"themes",t.id);return await Xo(e,t,{merge:!0}),t.id}else{const e=On(Ye,"themes");return(await kw(e,t)).id}}catch(e){return console.error("Erro ao salvar tema:",e),null}},PP=async t=>{if(!t)return!1;try{const e=an(Ye,"themes",t);return await Rw(e),!0}catch(e){return console.error("Erro ao deletar tema:",e),!1}},NP=async(t,e,n)=>{if(!(!t||!e))try{const r=an(Ye,`artifacts2/${CP}/users/${t}/characterSheets/${e}`);await Xo(r,{activeThemeId:n},{merge:!0})}catch(r){console.error("Erro ao aplicar tema ao personagem:",r)}},Mw=L.createContext(),RP=()=>L.useContext(Mw),oy="1:727724875985:web:97411448885c68c289e5f0",kP=({children:t})=>{const{user:e,isMaster:n}=ze(),[r,s]=L.useState([]),[i,o]=L.useState([]),[l,u]=L.useState(!0);L.useEffect(()=>{if(!n){s([]),u(!1);return}u(!0);const m=new Map;let E=[];const N=On(Ye,`artifacts2/${oy}/users`),S=ko(N,D=>{if(E.forEach(T=>T()),E=[],D.empty){m.clear(),s([]),u(!1);return}D.docs.forEach(T=>{const w=T.id,C=On(Ye,`artifacts2/${oy}/users/${w}/characterSheets`),P=ko(C,R=>{let j=!1;R.docChanges().forEach(v=>{const y=v.doc.data();let I=y.mainAttributes;if(typeof I=="string")try{I=JSON.parse(I)}catch(_){console.error(`Erro ao parsear mainAttributes para o personagem ${v.doc.id}:`,_)}const A={id:v.doc.id,ownerUid:w,...y,mainAttributes:I};v.type==="added"||v.type==="modified"?(m.set(A.id,A),j=!0):v.type==="removed"&&(m.delete(A.id),j=!0)}),j&&s(Array.from(m.values())),u(!1)},R=>{console.error(`Erro ao ouvir fichas do usuário ${w}:`,R),u(!1)});E.push(P)})},D=>{console.error("Erro ao ouvir coleção de usuários:",D),u(!1)});return()=>{S(),E.forEach(D=>D())}},[n]);const d=L.useMemo(()=>r.filter(m=>i.includes(m.id)),[r,i]),p=L.useCallback(m=>{o(E=>E.includes(m)?E.filter(N=>N!==m):[...E,m])},[]),g={allCharacters:r,selectedCharIds:i,partyHealthData:d,isLoading:l,toggleCharacterSelection:p};return c.jsx(Mw.Provider,{value:g,children:t})},DP=()=>{const{googleSignIn:t}=ze(),e=async()=>{try{await t()}catch(n){console.error("Erro ao fazer login com o Google:",n)}};return c.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background p-4",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-5xl font-bold text-primary mb-2",children:"StoryCraft V2"}),c.jsx("p",{className:"text-xl text-secondary mb-8",children:"Sua ficha de RPG, do seu jeito."}),c.jsx("button",{onClick:e,className:"px-8 py-4 bg-highlight hover:bg-opacity-80 text-primary font-bold rounded-lg shadow-lg text-lg",children:"Entrar com Google"})]})})},jP=()=>{const{feedItems:t}=Su(),[e,n]=L.useState(!0),r=l=>l?l.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):"",s=l=>c.jsxs("div",{className:"p-3 mb-2",children:[c.jsxs("div",{className:"flex justify-between items-center text-xs text-textSecondary mb-1",children:[c.jsx("span",{className:"font-bold",children:l.characterName}),c.jsx("span",{children:r(l.timestamp)})]}),c.jsx("p",{className:"text-sm text-textPrimary break-words",children:l.text})]},l.id),i=l=>{const u=l.results.reduce((p,g)=>p+g.value,0),d=l.results.map(p=>p.displayValue).join(" + ");return c.jsxs("div",{className:"p-3 bg-bgElement rounded-md border border-bgInput mb-2",children:[c.jsxs("div",{className:"flex justify-between items-center text-xs text-textSecondary mb-1",children:[c.jsx("span",{children:l.characterName}),c.jsx("span",{children:r(l.timestamp)})]}),c.jsx("p",{className:"font-semibold text-textPrimary",children:l.rollName}),c.jsxs("p",{className:"text-sm text-textSecondary break-all",children:[d," = ",c.jsx("span",{className:"font-bold text-lg text-textAccent",children:u})]}),l.discordText&&c.jsxs("p",{className:"text-xs italic text-textSecondary mt-1",children:['"',l.discordText,'"']})]},l.id)},o=l=>{switch(l.type){case"roll":return i(l);case"message":return s(l);default:return null}};return e?c.jsx("div",{className:"fixed bottom-4 left-4 bg-btnHighlightBg text-btnHighlightText p-3 rounded-full shadow-lg cursor-pointer hover:opacity-90 z-50",onClick:()=>n(!1),children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}):c.jsxs("div",{className:"fixed bottom-4 left-4 w-full max-w-sm h-[60vh] bg-bgSurface/90 backdrop-blur-md rounded-lg shadow-2xl border border-bgElement flex flex-col z-50",children:[c.jsxs("div",{className:"flex justify-between items-center p-3 bg-bgElement cursor-pointer",onClick:()=>n(!0),children:[c.jsx("h3",{className:"font-bold text-textAccent",children:"Feed de Rolagens"}),c.jsx("button",{className:"text-textSecondary hover:text-textPrimary",children:"—"})]}),c.jsxs("div",{className:"flex-grow p-3 overflow-y-auto",children:[t.length===0&&c.jsx("p",{className:"text-textSecondary italic",children:"Nenhuma rolagem ou mensagem ainda..."}),t.map(o)]}),c.jsx(FP,{})]})},VP=({message:t,onConfirm:e,onCancel:n,type:r,showCopyButton:s,copyText:i})=>{const[o,l]=L.useState(""),u=()=>{navigator.clipboard.writeText(i).then(()=>{l("Copiado!"),setTimeout(()=>l(""),2e3)},()=>{l("Falhou em copiar.")})},d=r==="confirm"?"Confirmar":"OK",p=r==="confirm"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700";return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-lg text-textPrimary mb-4 text-center whitespace-pre-wrap",children:t}),s&&c.jsxs("div",{className:"my-4 p-2 bg-bgElement rounded-md text-center",children:[c.jsx("p",{className:"text-textSecondary text-sm mb-1",children:"Comando para Discord/Roll20:"}),c.jsx("code",{className:"text-textAccent break-words",children:i}),c.jsx("button",{onClick:u,className:"ml-4 px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-xs font-bold rounded-md",children:o||"Copiar"})]}),c.jsxs("div",{className:"flex justify-around gap-4 mt-4",children:[c.jsx("button",{onClick:e,className:`px-5 py-2 rounded-lg font-bold shadow-md text-white ${p}`,children:d}),r!=="info"&&c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},OP=({title:t,onConfirm:e,onClose:n,type:r})=>{const[s,i]=L.useState(""),[o,l]=L.useState("HP"),u=()=>{const p=parseInt(s,10);!isNaN(p)&&p>0?e(p,o):console.error("Valor inválido.")},d=p=>{p.key==="Enter"&&u()};return c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center",children:t}),c.jsx("input",{type:"number",value:s,onChange:p=>i(p.target.value),onKeyDown:d,className:"w-full p-2 mb-4 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg focus:ring-btnHighlightBg focus:border-btnHighlightBg",placeholder:"Valor",autoFocus:!0}),c.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"HP",checked:o==="HP",onChange:()=>l("HP"),className:"form-radio text-btnHighlightBg"})," HP"]}),r==="heal"&&c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"HP Bonus",checked:o==="HP Bonus",onChange:()=>l("HP Bonus"),className:"form-radio text-btnHighlightBg"})," HP Bonus"]}),c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"MP",checked:o==="MP",onChange:()=>l("MP"),className:"form-radio text-btnHighlightBg"})," MP"]})]}),c.jsxs("div",{className:"flex justify-around gap-4",children:[c.jsx("button",{onClick:u,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Confirmar"}),c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},LP=({attributeName:t,onConfirm:e,onClose:n})=>{const[r,s]=L.useState("1d20"),[i,o]=L.useState(""),l=()=>e(r,parseInt(i,10)||0),u=d=>{d.key==="Enter"&&l()};return c.jsxs(c.Fragment,{children:[c.jsxs("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center",children:["Rolar ",t]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{htmlFor:"dice-input",className:"block text-sm font-medium text-textSecondary mb-1",children:"Dado:"}),c.jsx("input",{id:"dice-input",type:"text",value:r,onChange:d=>s(d.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"Ex: 1d20, 2d6",autoFocus:!0})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{htmlFor:"bonus-input",className:"block text-sm font-medium text-textSecondary mb-1",children:"Bónus Adicional:"}),c.jsx("input",{id:"bonus-input",type:"number",value:i,onChange:d=>o(d.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"0"})]}),c.jsxs("div",{className:"flex justify-around gap-4",children:[c.jsx("button",{onClick:l,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Confirmar"}),c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},zf=({modalState:t,closeModal:e})=>{if(!t.type)return null;const n=()=>{const{type:r,props:s}=t;switch(r){case"info":case"confirm":return c.jsx(VP,{...s});case"action":return c.jsx(OP,{...s});case"rollAttribute":return c.jsx(LP,{...s});default:return null}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",onClick:e,children:c.jsx("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-sm border border-bgElement",onClick:r=>r.stopPropagation(),children:n()})})},Nc={name:"Novo Tema",ownerUid:"",isPublic:!1,styles:{backgroundImage:"url('')",fontFamily:"'Roboto', sans-serif",surfaceOpacity:80,colors:{bgPage:"#111827",bgSurface:"#1f2937",bgElement:"#374151",bgInput:"#4b5563",textPrimary:"#f9fafb",textSecondary:"#9ca3af",borderAccent:"#f59e0b",textAccent:"#fcd34d",btnHighlightBg:"#8b5cf6",btnHighlightText:"#ffffff"}}},MP=["'Roboto', sans-serif","'Merriweather', serif","'Lato', sans-serif","'Noto Sans', sans-serif","'Slabo 27px', serif"],ay=({character:t,setPreviewTheme:e,onClose:n})=>{const{user:r}=ze(),[s,i]=L.useState([]),[o,l]=L.useState(Nc),[u,d]=L.useState({type:null,props:{}}),p=()=>d({type:null,props:{}});L.useEffect(()=>{r&&(Pc(r.uid).then(i),l(w=>({...Nc,ownerUid:r.uid})))},[r]),L.useEffect(()=>{e(o)},[o,e]);const g=w=>{if(w==="new")l({...Nc,ownerUid:r.uid});else{const C=s.find(P=>P.id===w);C&&l(C)}},m=(w,C)=>l(P=>({...P,styles:{...P.styles,[w]:C}})),E=(w,C)=>l(P=>({...P,styles:{...P.styles,colors:{...P.styles.colors,[w]:C}}})),N=w=>l(C=>({...C,name:w.target.value})),S=async()=>{const w={...o,ownerUid:r.uid};try{const C=await iy(w);if(C){d({type:"info",props:{message:"Tema salvo com sucesso!",onConfirm:p}});const P=await Pc(r.uid);i(P);const R=P.find(j=>j.id===(w.id||C));R&&l(R)}else throw new Error("Ocorreu um erro desconhecido ao salvar.")}catch(C){console.error("Falha ao salvar o tema:",C),d({type:"info",props:{message:"Falha ao salvar o tema.",onConfirm:p}})}},D=()=>{if(!o.id){d({type:"info",props:{message:"Não pode apagar um tema que ainda não foi salvo.",onConfirm:p}});return}d({type:"confirm",props:{message:`Tem a certeza que quer apagar o tema "${o.name}"?`,onConfirm:async()=>{await PP(o.id),p(),Pc(r.uid).then(i),g("new")},onCancel:p}})},T=async()=>{if(!t||!o.id){d({type:"info",props:{message:"Precisa ter uma ficha selecionada e um tema salvo para aplicar.",onConfirm:p}});return}await iy(o),await NP(t.ownerUid,t.id,o.id),d({type:"info",props:{message:`Tema "${o.name}" aplicado!`,onConfirm:()=>{p(),n()}}})};return c.jsxs(c.Fragment,{children:[c.jsx(zf,{modalState:u,closeModal:p}),c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-3xl border border-bgElement max-h-[90vh] flex flex-col",children:[c.jsx("h2",{className:"text-2xl font-bold text-textAccent mb-4",children:"Editor de Temas"}),c.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Tema a Editar"}),c.jsxs("select",{onChange:w=>g(w.target.value),value:o.id||"new",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",children:[c.jsx("option",{value:"new",children:"-- Criar Novo Tema --"}),s.map(w=>c.jsx("option",{value:w.id,children:w.name},w.id))]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Nome do Tema"}),c.jsx("input",{type:"text",value:o.name,onChange:N,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"URL da Imagem de Fundo"}),c.jsx("input",{type:"text",value:o.styles.backgroundImage.replace(/url\(['"]?(.*?)['"]?\)/,"$1"),onChange:w=>m("backgroundImage",`url('${w.target.value}')`),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Fonte Principal"}),c.jsx("select",{value:o.styles.fontFamily,onChange:w=>m("fontFamily",w.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",children:MP.map(w=>c.jsx("option",{value:w,children:w.split(",")[0].replace(/'/g,"")},w))})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:["Transparência dos Módulos (",o.styles.surfaceOpacity||80,"%)"]}),c.jsx("input",{type:"range",min:"10",max:"100",step:"5",value:o.styles.surfaceOpacity||80,onChange:w=>m("surfaceOpacity",parseInt(w.target.value)),className:"w-full h-2 bg-bgElement rounded-lg appearance-none cursor-pointer mt-2"})]})]}),c.jsx("h3",{className:"text-lg font-semibold text-textAccent mt-6 mb-2",children:"Cores"}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Object.entries(o.styles.colors).map(([w,C])=>c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary capitalize",children:w.replace(/([A-Z])/g," $1")}),c.jsxs("div",{className:"flex items-center gap-2 p-1 bg-bgInput border border-bgElement rounded-md",children:[c.jsx("input",{type:"color",value:C,onChange:P=>E(w,P.target.value),className:"w-8 h-8 rounded border-none bg-transparent cursor-pointer"}),c.jsx("input",{type:"text",value:C,onChange:P=>E(w,P.target.value),className:"w-full bg-transparent text-textPrimary text-sm"})]})]},w))})]}),c.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-6 pt-4 border-t border-bgElement",children:[c.jsxs("div",{children:[c.jsx("button",{onClick:S,className:"px-4 py-2 bg-green-600 text-white font-bold rounded-lg mr-2",children:"Salvar"}),c.jsx("button",{onClick:D,className:"px-4 py-2 bg-red-600 text-white font-bold rounded-lg",children:"Apagar"})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:T,disabled:!t||!o.id,className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg disabled:opacity-50",children:"Aplicar"}),c.jsx("button",{onClick:n,className:"px-4 py-2 bg-textSecondary/50 text-textPrimary font-bold rounded-lg",children:"Fechar"})]})]})]})})]})},FP=({characterName:t})=>{const[e,n]=L.useState(""),{addMessageToFeed:r}=Su(),{user:s}=ze(),i=o=>{o.preventDefault(),e.trim()!==""&&(r({characterName:t||s.displayName||"Usuário",text:e,ownerUid:s.uid}),n(""))};return c.jsx("form",{onSubmit:i,className:"p-3 border-t border-bgElement",children:c.jsxs("div",{className:"flex items-center bg-bgInput rounded-md",children:[c.jsx("input",{type:"text",value:e,onChange:o=>n(o.target.value),placeholder:"Digite uma mensagem...",className:"w-full bg-transparent p-2 text-textPrimary placeholder-textSecondary focus:outline-none"}),c.jsx("button",{type:"submit",className:"p-2 text-textAccent hover:opacity-80 disabled:opacity-50",disabled:!e.trim(),children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",clipRule:"evenodd"})})})]})})},ly=({onCharacterClick:t})=>{const{isMaster:e}=ze(),{allCharacters:n,selectedCharIds:r,partyHealthData:s,toggleCharacterSelection:i}=RP(),[o,l]=L.useState(!1),[u,d]=L.useState(!1);if(!e)return null;const p=m=>{t&&t(m)},g=m=>{var S,D;const E=((S=m.mainAttributes)==null?void 0:S.hp)||{current:"?",max:"?",temp:0},N=((D=m.mainAttributes)==null?void 0:D.mp)||{current:"?",max:"?"};return c.jsxs("div",{className:"p-2 bg-bgElement rounded-md border border-bgInput cursor-pointer hover:border-btnHighlightBg",onClick:()=>p(m),title:`Clique para ir para a ficha de ${m.name}`,children:[c.jsx("p",{className:"font-bold text-textPrimary truncate",children:m.name}),c.jsxs("div",{className:"text-sm flex justify-between",children:[c.jsxs("span",{className:"text-red-400",children:["HP: ",E.current,"/",E.max," ",E.temp>0?`(+${E.temp})`:""]}),c.jsxs("span",{className:"text-blue-400",children:["MP: ",N.current,"/",N.max]})]})]},m.id)};return o?c.jsx("div",{className:"fixed top-4 left-4 bg-btnHighlightBg text-btnHighlightText p-3 rounded-full shadow-lg cursor-pointer hover:opacity-90 z-50",onClick:()=>l(!1),title:"Expandir Monitor de Grupo",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-5M3 4h5V9"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 16l-4-4M3 8l4 4"})]})}):c.jsxs("div",{className:"fixed top-4 left-4 w-full max-w-xs bg-bgSurface/90 backdrop-blur-md rounded-lg shadow-2xl border border-bgElement flex flex-col z-50",children:[c.jsxs("div",{className:"flex justify-between items-center p-3 bg-bgElement cursor-pointer",onClick:()=>l(!0),children:[c.jsx("h3",{className:"font-bold text-textAccent",children:"Monitor de Grupo"}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{className:"text-textSecondary hover:text-textPrimary mr-2",onClick:m=>{m.stopPropagation(),d(!u)},title:"Selecionar Personagens",children:"⚙️"}),c.jsx("button",{className:"text-textSecondary hover:text-textPrimary",title:"Recolher",children:"—"})]})]}),u&&c.jsxs("div",{className:"p-3 border-b border-bgElement max-h-48 overflow-y-auto",children:[c.jsx("h4",{className:"text-sm font-semibold text-textSecondary mb-2",children:"Selecionar Personagens"}),n.length>0?n.map(m=>c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`char-select-${m.id}`,checked:r.includes(m.id),onChange:()=>i(m.id),className:"form-checkbox h-4 w-4 text-btnHighlightBg bg-bgInput border-bgElement rounded"}),c.jsx("label",{htmlFor:`char-select-${m.id}`,className:"ml-2 text-textPrimary text-sm truncate",children:m.name})]},m.id)):c.jsx("p",{className:"text-xs text-textSecondary italic",children:"Nenhuma ficha encontrada."})]}),c.jsx("div",{className:"flex-grow p-3 overflow-y-auto space-y-2 max-h-[60vh]",children:s.length>0?s.map(g):c.jsx("p",{className:"text-textSecondary italic text-sm text-center py-4",children:"Nenhum personagem selecionado. Clique na engrenagem ⚙️ para selecionar."})})]})},UP=({character:t,onExport:e,onReset:n})=>c.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mt-8 p-4 bg-bgSurface/80 backdrop-blur-sm rounded-xl border border-bgElement",children:[c.jsx("button",{onClick:e,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!t,children:"Exportar Ficha (JSON)"}),c.jsx("button",{onClick:n,className:"px-8 py-3 bg-red-700 hover:bg-red-800 text-white font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!t,children:"Resetar Ficha"})]}),Nt=({title:t,isCollapsed:e,toggleSection:n,actions:r,children:s,isComplexTitle:i})=>c.jsxs("section",{className:"mb-8 p-6 bg-bgSurface backdrop-blur-sm rounded-xl shadow-inner border border-bgElement",children:[c.jsxs("div",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2 cursor-pointer flex justify-between items-center",onClick:n,children:[c.jsx("h2",{className:`flex-grow ${i?"":"truncate"}`.trim(),children:t}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{onClick:o=>o.stopPropagation(),children:r}),c.jsx("span",{children:e?"▼":"▲"})]})]}),!e&&c.jsx("div",{className:"mt-4",children:s})]}),BP=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i})=>{const o=L.useRef(null);return ql.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),c.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i})},$P=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,onOpenActionModal:s,allAttributes:i,onUpdate:o,onExecuteFormula:l})=>{const{user:u}=ze();if(!t||!u)return null;const d=u.uid===t.ownerUid||e,[p,g]=L.useState(t.formulaActions||[]);L.useEffect(()=>{g(t.formulaActions||[])},[t.formulaActions]);const m=()=>{const R={id:crypto.randomUUID(),name:"Nova Ação",components:[{id:crypto.randomUUID(),type:"dice",value:"1d6"}],multiplier:1,discordText:"",isCollapsed:!1,costValue:0,costType:"",recoverHP:!1,recoverMP:!1};o("formulaActions",[...t.formulaActions||[],R])},E=R=>{o("formulaActions",(t.formulaActions||[]).filter(j=>j.id!==R))},N=(R,j,v)=>{g(y=>y.map(I=>I.id===R?{...I,[j]:v}:I))},S=L.useCallback((R,j,v)=>{const y=p.find(A=>A.id===R),I=(t.formulaActions||[]).find(A=>A.id===R);if(y&&I){const A=v!==void 0?v:y[j];A!==I[j]&&o("formulaActions",(t.formulaActions||[]).map(_=>_.id===R?{..._,[j]:A}:_))}},[p,t.formulaActions,o]),D=(R,j)=>{let v;j==="dice"?v={id:crypto.randomUUID(),type:j,value:"1d6"}:j==="attribute"?v={id:crypto.randomUUID(),type:j,value:""}:j==="critDice"&&(v={id:crypto.randomUUID(),type:j,value:"1d6",critValue:6,critBonusAttribute:"",critBonusMultiplier:1}),o("formulaActions",(t.formulaActions||[]).map(y=>y.id===R?{...y,components:[...y.components||[],v]}:y))},T=(R,j)=>{o("formulaActions",(t.formulaActions||[]).map(v=>v.id===R?{...v,components:(v.components||[]).filter(y=>y.id!==j)}:v))},w=(R,j,v,y)=>{g(I=>I.map(A=>A.id===R?{...A,components:A.components.map(_=>_.id===j?{..._,[v]:y}:_)}:A))},C=L.useCallback((R,j,v,y)=>{const I=p.find(b=>b.id===R),A=I==null?void 0:I.components.find(b=>b.id===j),_=(t.formulaActions||[]).find(b=>b.id===R),k=_==null?void 0:_.components.find(b=>b.id===j);if(A&&k){const b=y!==void 0?y:A[v];b!==k[v]&&o("formulaActions",(t.formulaActions||[]).map(q=>q.id===R?{...q,components:q.components.map(B=>B.id===j?{...B,[v]:b}:B)}:q))}},[p,t.formulaActions,o]),P=R=>{o("formulaActions",(t.formulaActions||[]).map(j=>j.id===R?{...j,isCollapsed:!j.isCollapsed}:j))};return c.jsx(Nt,{title:"Ações",isCollapsed:n,toggleSection:r,children:c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 pb-4 border-b border-bgElement",children:[c.jsx("button",{onClick:()=>s("heal"),className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Curar"}),c.jsx("button",{onClick:()=>s("damage"),className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-md",children:"Receber Dano"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3",children:"Construtor de Ações Rápidas"}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(p||[]).map(R=>R.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>P(R.id),children:R.name||"Ação Sem Nome"}),c.jsx("button",{onClick:()=>l(R),className:"px-4 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-2 text-sm",children:"Usar"})]},R.id):c.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center gap-2 mb-3",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>P(R.id),children:R.name||"Ação Sem Nome"}),c.jsx("button",{onClick:()=>l(R),className:"px-5 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap",children:"Usar"}),d&&c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>P(R.id),children:"Recolher ▲"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 border-t border-bgInput pt-3 mt-3 flex-grow",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome da Ação:"}),c.jsx("input",{type:"text",placeholder:"Nome da Ação",value:R.name,onChange:v=>N(R.id,"name",v.target.value),onBlur:()=>S(R.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-3",disabled:!d}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Componentes da Fórmula:"}),c.jsx("div",{className:"space-y-2 mb-3",children:(R.components||[]).map(v=>c.jsx("div",{className:"flex flex-col gap-2 p-2 rounded-md border border-dashed border-textSecondary/30",children:v.type==="dice"?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",placeholder:"1d6 ou 10",value:v.value,onChange:y=>w(R.id,v.id,"value",y.target.value),onBlur:()=>C(R.id,v.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!d}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Dado/Nº"}),d&&c.jsx("button",{onClick:()=>T(R.id,v.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}):v.type==="attribute"?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:v.value,onChange:y=>w(R.id,v.id,"value",y.target.value),onBlur:()=>C(R.id,v.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!d,children:[c.jsx("option",{value:"",children:"Selecione Atributo"}),i.map(y=>c.jsx("option",{value:y,children:y},y))]}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Atributo"}),d&&c.jsx("button",{onClick:()=>T(R.id,v.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}):v.type==="critDice"?c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",placeholder:"1d6",value:v.value,onChange:y=>w(R.id,v.id,"value",y.target.value),onBlur:()=>C(R.id,v.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!d}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Dado Crítico"}),d&&c.jsx("button",{onClick:()=>T(R.id,v.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-textSecondary",children:[c.jsx("span",{className:"flex-shrink-0",children:"Crit. ≥"}),c.jsx("input",{type:"number",placeholder:"6",value:v.critValue||"",onChange:y=>w(R.id,v.id,"critValue",y.target.value),onBlur:()=>C(R.id,v.id,"critValue"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!d}),c.jsx("span",{className:"flex-shrink-0",children:"Bônus:"}),c.jsxs("select",{value:v.critBonusAttribute||"",onChange:y=>w(R.id,v.id,"critBonusAttribute",y.target.value),onBlur:()=>C(R.id,v.id,"critBonusAttribute"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!d,children:[c.jsx("option",{value:"",children:"Nenhum"}),i.map(y=>c.jsx("option",{value:y,children:y},y))]}),c.jsx("span",{className:"flex-shrink-0",children:"x"}),c.jsx("input",{type:"number",placeholder:"1",value:v.critBonusMultiplier||"",onChange:y=>w(R.id,v.id,"critBonusMultiplier",y.target.value),onBlur:()=>C(R.id,v.id,"critBonusMultiplier"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!d})]})]}):null},v.id))}),d&&c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsx("button",{onClick:()=>D(R.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Dado/Nº"}),c.jsx("button",{onClick:()=>D(R.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Atributo"}),c.jsx("button",{onClick:()=>D(R.id,"critDice"),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md",children:"+ Dado Crítico"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Multiplicador:"}),c.jsx("input",{type:"number",value:R.multiplier||"",onChange:v=>N(R.id,"multiplier",v.target.value),onBlur:()=>S(R.id,"multiplier"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-3",placeholder:"1",disabled:!d}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Descrição da Ação:"}),c.jsx(BP,{placeholder:"Descrição...",value:R.discordText,onChange:v=>N(R.id,"discordText",v.target.value),onBlur:()=>S(R.id,"discordText"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-sm",disabled:!d}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2 mt-3",children:"Custo da Ação:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",placeholder:"Custo",value:R.costValue||"",onChange:v=>N(R.id,"costValue",v.target.value),onBlur:()=>S(R.id,"costValue"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!d}),c.jsxs("select",{value:R.costType,onChange:v=>N(R.id,"costType",v.target.value),onBlur:()=>S(R.id,"costType"),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!d,children:[c.jsx("option",{value:"",children:"N/A"}),c.jsx("option",{value:"HP",children:"HP"}),c.jsx("option",{value:"MP",children:"MP"})]})]}),d&&c.jsxs("div",{className:"flex gap-4 mt-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`recover-hp-${R.id}`,checked:R.recoverHP||!1,onChange:v=>S(R.id,"recoverHP",v.target.checked),className:"form-checkbox text-green-500 rounded-sm",disabled:!d}),c.jsx("label",{htmlFor:`recover-hp-${R.id}`,className:"ml-2 text-sm text-textSecondary",children:"Recuperar HP"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`recover-mp-${R.id}`,checked:R.recoverMP||!1,onChange:v=>S(R.id,"recoverMP",v.target.checked),className:"form-checkbox text-blue-500 rounded-sm",disabled:!d}),c.jsx("label",{htmlFor:`recover-mp-${R.id}`,className:"ml-2 text-sm text-textSecondary",children:"Recuperar MP"})]})]})]})]}),d&&c.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>E(R.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Ação",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:"🗑️"})})})]},R.id))}),d&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:m,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"+ Adicionar Ação Rápida"})})]})]})})},zP=({character:t,onUpdate:e,isCollapsed:n,toggleSection:r,buffModifiers:s,onOpenRollModal:i})=>{const[o,l]=L.useState(t.attributes||[]);L.useEffect(()=>{l(t.attributes||[])},[t.attributes]);const u=()=>{const E={id:crypto.randomUUID(),name:"",base:0,perm:0,arma:0,isCollapsed:!1};e("attributes",[...t.attributes||[],E])},d=E=>{e("attributes",(t.attributes||[]).filter(N=>N.id!==E))},p=(E,N,S)=>{l(D=>D.map(T=>T.id===E?{...T,[N]:S}:T))},g=L.useCallback((E,N)=>{const S=o.find(T=>T.id===E),D=(t.attributes||[]).find(T=>T.id===E);if(S&&D&&S[N]!==D[N]){const T=(t.attributes||[]).map(w=>w.id===E?{...w,[N]:N==="name"?S[N]:parseInt(S[N],10)||0}:w);e("attributes",T)}},[o,t.attributes,e]),m=E=>{e("attributes",(t.attributes||[]).map(N=>N.id===E?{...N,isCollapsed:!N.isCollapsed}:N))};return c.jsx(Nt,{title:"Atributos",isCollapsed:n,toggleSection:r,children:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:(o||[]).map(E=>{const N=s[E.name]||0,S=(parseInt(E.base,10)||0)+(parseInt(E.perm,10)||0)+N+(parseInt(E.arma,10)||0);return E.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center gap-2 overflow-hidden",children:[c.jsx("div",{className:"flex-grow overflow-hidden relative group",onClick:()=>m(E.id),children:c.jsx("span",{className:"font-semibold text-lg text-textPrimary cursor-pointer whitespace-nowrap group-hover:animate-marquee",children:E.name||"Atributo Sem Nome"})}),c.jsx("div",{children:c.jsxs("span",{className:"font-bold text-btnHighlightBg text-lg",children:[S>=0?"+":"",S]})}),c.jsx("button",{onClick:()=>i(E.id),className:"px-4 py-1 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-4 text-sm shadow-md",children:"Rolar"})]},E.id):c.jsxs("div",{className:"col-span-1 md:col-span-2 p-3 bg-bgElement rounded-md shadow-sm border border-bgInput relative flex flex-col gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>m(E.id),children:[c.jsx("input",{type:"text",placeholder:"Nome do Atributo",value:E.name,onClick:T=>T.stopPropagation(),onChange:T=>p(E.id,"name",T.target.value),onBlur:()=>g(E.id,"name"),className:"w-full flex-grow p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold cursor-text"}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap",children:"Recolher ▲"})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 text-xs justify-end w-full",onClick:T=>T.stopPropagation(),children:[["base","perm","arma"].map(T=>c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-textSecondary text-xs text-center capitalize",children:T}),c.jsx("input",{type:"number",value:E[T]||"",onChange:w=>p(E.id,T,w.target.value),onBlur:()=>g(E.id,T),className:"w-12 p-1 border rounded-md text-textPrimary text-center bg-bgInput border-bgElement"})]},T)),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-textSecondary text-xs text-center capitalize",children:"temp"}),c.jsx("input",{type:"number",value:N||"",className:"w-12 p-1 border rounded-md text-textPrimary text-center bg-bgPage border-bgElement cursor-not-allowed",readOnly:!0})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-textSecondary text-xs text-center",children:"Total"}),c.jsx("input",{type:"number",value:S||"",readOnly:!0,className:"w-12 p-1 bg-bgPage border border-bgElement rounded-md text-textPrimary font-bold cursor-not-allowed text-center"})]})]}),c.jsx("div",{className:"flex justify-end pt-2 mt-2 border-t border-bgInput/50",onClick:T=>T.stopPropagation(),children:c.jsx("button",{onClick:()=>d(E.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Atributo",children:c.jsx("span",{role:"img","aria-label":"Remover",children:"🗑️"})})})]},E.id)})}),c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:u,className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})})},HP=({character:t,isMaster:e,onUpdate:n,allAttributes:r,isCollapsed:s,toggleSection:i})=>{const{user:o}=ze();if(!t||!o)return c.jsx("div",{className:"p-6 text-center text-textSecondary",children:"A carregar buffs..."});const l=o.uid===t.ownerUid||e,[u,d]=L.useState(t.buffs||[]);L.useEffect(()=>{d(t.buffs||[])},[t.buffs]);const p=()=>{const P={id:crypto.randomUUID(),name:"Novo Buff",effects:[],isActive:!1,isCollapsed:!1,costValue:0,costType:""};n("buffs",[...t.buffs||[],P])},g=P=>n("buffs",(t.buffs||[]).filter(R=>R.id!==P)),m=P=>n("buffs",(t.buffs||[]).map(R=>R.id===P?{...R,isActive:!R.isActive}:R)),E=P=>n("buffs",(t.buffs||[]).map(R=>R.id===P?{...R,isCollapsed:!R.isCollapsed}:R)),N=(P,R,j)=>{d(v=>v.map(y=>y.id===P?{...y,[R]:j}:y))},S=L.useCallback((P,R)=>{const j=u.find(y=>y.id===P),v=(t.buffs||[]).find(y=>y.id===P);if(j&&v&&j[R]!==v[R]){const y=R==="costValue"?parseInt(j[R],10)||0:j[R];n("buffs",(t.buffs||[]).map(I=>I.id===P?{...I,[R]:y}:I))}},[u,t.buffs,n]),D=(P,R)=>{const j={id:crypto.randomUUID(),type:R,target:"",value:R==="attribute"?0:"1d6"};n("buffs",(t.buffs||[]).map(v=>v.id===P?{...v,effects:[...v.effects||[],j]}:v))},T=(P,R)=>{n("buffs",(t.buffs||[]).map(j=>j.id===P?{...j,effects:(j.effects||[]).filter(v=>v.id!==R)}:j))},w=(P,R,j,v)=>{d(y=>y.map(I=>I.id===P?{...I,effects:I.effects.map(A=>{if(A.id===R){const _={...A,[j]:v};return j==="type"&&(_.target="",_.value=v==="attribute"?0:"1d6"),_}return A})}:I))},C=L.useCallback((P,R,j)=>{const v=u.find(_=>_.id===P),y=v==null?void 0:v.effects.find(_=>_.id===R),I=(t.buffs||[]).find(_=>_.id===P),A=I==null?void 0:I.effects.find(_=>_.id===R);y&&A&&y[j]!==A[j]&&n("buffs",(t.buffs||[]).map(_=>_.id===P?{..._,effects:_.effects.map(k=>k.id===R?{...k,[j]:y[j]}:k)}:_))},[u,t.buffs,n]);return c.jsx(Nt,{title:"Buffs",isCollapsed:s,toggleSection:i,children:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(P=>P.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>E(P.id),children:P.name||"Buff Sem Nome"}),c.jsx("label",{className:"flex items-center cursor-pointer ml-2",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"checkbox",checked:P.isActive,onChange:()=>m(P.id),className:"sr-only",disabled:!l}),c.jsx("div",{className:`block w-12 h-6 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),c.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})]})})]},P.id):c.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>E(P.id),children:P.name||"Buff Sem Nome"}),c.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[c.jsx("label",{className:"flex items-center cursor-pointer",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"checkbox",checked:P.isActive,onChange:()=>m(P.id),className:"sr-only",disabled:!l}),c.jsx("div",{className:`block w-14 h-8 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),c.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})]})}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>E(P.id),children:"Recolher ▲"})]})]}),c.jsxs("div",{className:"mt-3 pt-3 border-t border-bgInput/50 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome do Buff:"}),c.jsx("input",{type:"text",placeholder:"Nome do Buff",value:P.name,onChange:j=>N(P.id,"name",j.target.value),onBlur:()=>S(P.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-4",disabled:!l}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Custo de Manutenção:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",placeholder:"0",value:P.costValue||"",onChange:j=>N(P.id,"costValue",j.target.value),onBlur:()=>S(P.id,"costValue"),className:"w-20 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!l}),c.jsxs("select",{value:P.costType,onChange:j=>N(P.id,"costType",j.target.value),onBlur:()=>S(P.id,"costType"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!l,children:[c.jsx("option",{value:"",children:"N/A"}),c.jsx("option",{value:"HP",children:"HP"}),c.jsx("option",{value:"MP",children:"MP"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Efeitos do Buff:"}),c.jsx("div",{className:"space-y-2",children:(P.effects||[]).map(j=>c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("select",{value:j.type,onChange:v=>w(P.id,j.id,"type",v.target.value),onBlur:()=>C(P.id,j.id,"type"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!l,children:[c.jsx("option",{value:"attribute",children:"Modificar Atributo"}),c.jsx("option",{value:"dice",children:"Adicionar Dado/Nº"})]}),j.type==="attribute"?c.jsxs("select",{value:j.target,onChange:v=>w(P.id,j.id,"target",v.target.value),onBlur:()=>C(P.id,j.id,"target"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!l,children:[c.jsx("option",{value:"",children:"Selecione Atributo"}),r.map(v=>c.jsx("option",{value:v,children:v},v))]}):c.jsx("div",{className:"p-2 bg-bgPage border-bgElement rounded-md text-textSecondary text-center italic col-span-3 sm:col-span-1",children:"Não aplicável"}),c.jsxs("div",{className:"flex items-center gap-2 col-span-3 sm:col-span-1",children:[c.jsx("input",{type:"text",placeholder:j.type==="attribute"?"Valor (+/-)":"1d6 ou 6",value:j.value||"",onChange:v=>w(P.id,j.id,"value",v.target.value),onBlur:()=>C(P.id,j.id,"value"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center",disabled:!l}),l&&c.jsx("button",{onClick:()=>T(P.id,j.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Efeito",children:c.jsx("span",{role:"img","aria-label":"Remover",children:"🗑️"})})]})]},j.id))}),l&&c.jsxs("div",{className:"flex gap-2 mt-2",children:[c.jsx("button",{onClick:()=>D(P.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Atributo"}),c.jsx("button",{onClick:()=>D(P.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Dado/Nº"})]})]})]}),l&&c.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(P.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Buff",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:"🗑️"})})})]})]},P.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum buff criado."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:p,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})})},WP=({user:t,onSelectCharacter:e,handleCreateClick:n,handleImportClick:r,handleDeleteClick:s,characters:i,isMaster:o,viewingAll:l,onToggleView:u})=>c.jsxs("div",{className:"bg-bgSurface/80 backdrop-blur-sm p-6 rounded-lg shadow-lg border border-bgElement w-full",children:[c.jsx("h2",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2",children:l?"Todas as Fichas":"Meus Personagens"}),c.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[c.jsx("button",{onClick:n,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Criar Novo Personagem"}),c.jsx("button",{onClick:r,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md",children:"Importar Ficha (JSON)"}),o&&c.jsx("button",{onClick:()=>u(!l),className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md",children:l?"Ver Apenas Minhas Fichas":"Ver Todas as Fichas"})]}),i.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(d=>c.jsxs("div",{className:"bg-bgElement p-4 rounded-lg shadow-md flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-1",children:d.name}),c.jsxs("p",{className:"text-sm text-textSecondary",children:["Nível: ",d.level||"1"]}),o&&l&&c.jsxs("p",{className:"text-xs text-textSecondary mt-2 break-all",children:["Dono: ",d.ownerUid]})]}),c.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[c.jsx("button",{onClick:()=>e(d),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-lg",children:"Ver/Editar"}),t&&(t.uid===d.ownerUid||o)&&c.jsx("button",{onClick:()=>s(d),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-lg",children:"Excluir"})]})]},d.id))}):c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum personagem encontrado."})]}),qP=[2,3,4,6,8,10,12,20,50,100],KP=({character:t})=>{const[e,n]=L.useState(!1),{addRollToFeed:r}=Su(),s=L.useCallback(async(o,l)=>{const u=`${o}
${l}`;if(t&&t.discordWebhookUrl){try{await fetch(t.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[{title:o,description:l.replace(/\*/g,""),color:7506394}]})})}catch(d){return console.error("Failed to send to Discord:",d),null}return u}else return alert(`Webhook do Discord não configurado. Copie o comando:

${u}`),null},[t,r]),i=async o=>{const l=Math.floor(Math.random()*o)+1;n(!1);const u=await s(`Rolagem de d${o}`,`**Resultado: ${l}**`);r({characterName:(t==null?void 0:t.name)||"Narrador",rollName:`Rolagem Rápida de d${o}`,results:[{value:l,displayValue:`d${o} (${l})`}],discordText:u})};return c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>n(!e),title:"Rolagem Rápida",className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600",children:"🎲"}),e&&c.jsx("div",{className:"absolute bottom-12 right-0 bg-gray-900 bg-opacity-90 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700 w-40",children:c.jsx("div",{className:"grid grid-cols-2 gap-2",children:qP.map(o=>c.jsxs("button",{onClick:()=>i(o),className:"bg-gray-700 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:["d",o]},o))})})]})},GP=({href:t,title:e,children:n})=>c.jsx("a",{href:t,title:e,className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600",children:n}),QP=({character:t})=>{const e=[{href:"#info",title:"Informações",icon:"👤"},{href:"#main-attributes",title:"Atributos Principais",icon:"❤️"},{href:"#attributes",title:"Atributos",icon:"📊"},{href:"#actions",title:"Ações",icon:"⚔️"},{href:"#buffs",title:"Buffs",icon:"✨"},{href:"#wallet",title:"Carteira",icon:"💰"},{href:"#inventory",title:"Inventário",icon:"🎒"},{href:"#equipped",title:"Equipados",icon:"🛡️"},{href:"#perks",title:"Vantagens",icon:"🌟"},{href:"#skills",title:"Habilidades",icon:"🎯"},{href:"#specializations",title:"Especializações",icon:"📜"},{href:"#story",title:"História",icon:"📖"},{href:"#notes",title:"Anotações",icon:"📝"},{href:"#discord",title:"Discord",icon:"💬"}];return c.jsx("div",{className:"fixed bottom-4 right-4 z-40 bg-gray-900 bg-opacity-80 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700",children:c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.map(n=>c.jsx(GP,{href:n.href,title:n.title,children:n.icon},n.href)),c.jsx(KP,{character:t})]})})},YP=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s})=>{const{user:i}=ze(),[o,l]=L.useState({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""});L.useEffect(()=>{l({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""})},[t]);const u=m=>{const{name:E,value:N}=m.target;l(S=>({...S,[E]:N}))},d=L.useCallback(m=>{const E=o[m],N=t[m],D=["age","level","xp"].includes(m)?parseInt(E,10)||0:E;D!==N&&e(m,D)},[o,t,e]),p=()=>{const m=prompt("Insira a URL da imagem do personagem:",t.photoUrl||"");m!==null&&e("photoUrl",m)},g=["name","age","height","gender","race","class","alignment","level","xp"];return c.jsx(Nt,{title:"Informações do Personagem",isCollapsed:r,toggleSection:s,children:c.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[c.jsx("div",{className:"flex-shrink-0",children:t.photoUrl?c.jsx("img",{src:t.photoUrl,alt:"Foto",className:"w-48 h-48 object-cover rounded-full border-2 border-btnHighlightBg cursor-pointer",onClick:p,onError:m=>{m.target.onerror=null,m.target.src="https://placehold.co/192x192/1f2937/FFFFFF?text=Erro"}}):c.jsx("div",{className:"w-48 h-48 bg-bgElement rounded-full border-2 border-btnHighlightBg flex items-center justify-center text-6xl text-textSecondary cursor-pointer",onClick:p,children:"+"})}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 flex-grow w-full",children:g.map(m=>c.jsxs("div",{children:[c.jsxs("label",{htmlFor:m,className:"block text-sm font-medium text-textSecondary mb-1 capitalize",children:[m,":"]}),c.jsx("input",{type:["age","level","xp"].includes(m)?"number":"text",id:m,name:m,value:o[m],onChange:u,onBlur:()=>d(m),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary focus:ring-btnHighlightBg focus:border-btnHighlightBg",disabled:!i||i.uid!==t.ownerUid&&!n})]},m))})]})})},XP=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,buffModifiers:i})=>{var S,D,T,w,C;const{user:o}=ze(),l=o&&(o.uid===t.ownerUid||n),[u,d]=L.useState(t.mainAttributes||{hp:{},mp:{}});L.useEffect(()=>{d(t.mainAttributes||{hp:{},mp:{}})},[t.mainAttributes]);const p=L.useMemo(()=>{const P=["dex","des","agi"],R=(t.attributes||[]).find(v=>v.name?P.some(y=>v.name.toLowerCase().includes(y)):!1);if(!R)return 0;const j=i&&i[R.name]||0;return(R.base||0)+(R.perm||0)+j+(R.arma||0)},[t.attributes,i]),g=p+(i&&i.Iniciativa||0),m=(P,R)=>{const{name:j,value:v}=P.target,y=v===""?"":parseInt(v,10);d(I=>R?{...I,[R]:{...I[R]||{},[j]:y}}:{...I,[j]:y})},E=L.useCallback((P,R)=>{var v;if(!t)return;const j=t.mainAttributes||{};if(R){const y=(v=u==null?void 0:u[R])==null?void 0:v[P],I=j[R]||{},A=I[P],_=parseInt(y,10)||0;if(_!==(A||0)){const k={...I,[P]:_},b={...j,[R]:k};e("mainAttributes",b)}}else{const y=u==null?void 0:u[P],I=j[P],A=parseInt(y,10)||0;if(A!==(I||0)){const _={...j,[P]:A};e("mainAttributes",_)}}},[u,t,e]),N=(P,R)=>(parseInt(P,10)||0)+(i&&i[R]||0);return c.jsx(Nt,{title:"Atributos Principais",isCollapsed:r,toggleSection:s,children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase",children:"HP"}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",name:"current",value:((S=u.hp)==null?void 0:S.current)??"",onChange:P=>m(P,"hp"),onBlur:()=>E("current","hp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),c.jsx("span",{className:"text-textSecondary",children:"/"}),c.jsx("input",{type:"number",name:"max",value:((D=u.hp)==null?void 0:D.max)??"",onChange:P=>m(P,"hp"),onBlur:()=>E("max","hp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),c.jsx("span",{className:"text-blue-400 font-bold text-xl ml-1",children:"+"}),c.jsx("input",{type:"number",title:"HP Temporário",name:"temp",value:((T=u.hp)==null?void 0:T.temp)??"",onChange:P=>m(P,"hp"),onBlur:()=>E("temp","hp"),className:"w-16 p-2 text-center bg-bgInput border border-blue-400 rounded-md text-blue-300 text-xl font-bold",disabled:!n})]})]}),c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase",children:"MP"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",name:"current",value:((w=u.mp)==null?void 0:w.current)??"",onChange:P=>m(P,"mp"),onBlur:()=>E("current","mp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),c.jsx("span",{className:"text-textSecondary",children:"/"}),c.jsx("input",{type:"number",name:"max",value:((C=u.mp)==null?void 0:C.max)??"",onChange:P=>m(P,"mp"),onBlur:()=>E("max","mp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n})]})]}),["Iniciativa","fa","fm","fd"].map(P=>{const R=P==="Iniciativa",j=R?p:(u==null?void 0:u[P.toLowerCase()])??"",v=R?g:N((u==null?void 0:u[P.toLowerCase()])||0,P.toUpperCase());return c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsxs("label",{htmlFor:P,className:"capitalize text-lg font-medium text-textSecondary mb-1",children:[P.toUpperCase(),":"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",id:P,name:P.toLowerCase(),value:j,onChange:m,onBlur:()=>E(P.toLowerCase()),className:"w-14 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!l||R}),c.jsx("span",{className:"text-textSecondary",children:"="}),c.jsx("span",{className:"w-14 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",children:v})]})]},P)})]})})},JP=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s})=>{var T,w;const{user:i}=ze(),[o,l]=L.useState(0),u=((T=t.wallet)==null?void 0:T.zeni)||0,d=((w=t.wallet)==null?void 0:w.inspiration)||0,p=i&&(i.uid===t.ownerUid||e),g=(C,P)=>{const R={...t.wallet,[C]:Math.max(0,P)};n("wallet",R)},m=()=>{g("zeni",u+o),l(0)},E=()=>{g("zeni",u-o),l(0)},N=()=>g("inspiration",d+1),S=()=>g("inspiration",d-1),D=c.jsxs("div",{className:"flex justify-between items-center w-full",children:[c.jsxs("span",{children:["Zeni: ",u]}),c.jsxs("span",{className:"text-textPrimary text-base",children:["Inspiração: ",d]})]});return c.jsx(Nt,{title:D,isCollapsed:r,toggleSection:s,isComplexTitle:!0,children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"hidden sm:inline font-semibold text-textSecondary",children:"Zeni:"}),c.jsx("input",{type:"number",value:o===0?"":o,onChange:C=>l(parseInt(C.target.value,10)||0),className:"w-24 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-lg",placeholder:"Valor",disabled:!p}),c.jsx("button",{onClick:m,className:"px-3 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg text-sm",disabled:!p,children:"+"}),c.jsx("button",{onClick:E,className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm",disabled:!p,children:"-"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"hidden sm:inline font-semibold text-textSecondary",children:"Inspiração:"}),c.jsx("button",{onClick:N,className:"px-3 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg text-sm",disabled:!p,children:"+1"}),c.jsx("button",{onClick:S,className:"px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-lg text-sm",disabled:!p,children:"-1"})]})]})})},ZP=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s})=>{const{user:i}=ze(),o=i&&(i.uid===t.ownerUid||n),[l,u]=L.useState(t.discordWebhookUrl||"");L.useEffect(()=>{u(t.discordWebhookUrl||"")},[t.discordWebhookUrl]);const d=g=>{u(g.target.value)},p=L.useCallback(()=>{l!==t.discordWebhookUrl&&e("discordWebhookUrl",l)},[l,t.discordWebhookUrl,e]);return c.jsx(Nt,{title:"Integração com Discord",isCollapsed:r,toggleSection:s,children:c.jsxs("div",{children:[c.jsx("label",{htmlFor:"discordWebhookUrl",className:"block text-sm font-medium text-textSecondary mb-1",children:"URL do Webhook do Canal:"}),c.jsx("input",{type:"text",id:"discordWebhookUrl",name:"discordWebhookUrl",value:l,onChange:d,onBlur:p,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md focus:ring-btnHighlightBg focus:border-btnHighlightBg text-textPrimary",placeholder:"Cole a URL do Webhook do seu canal do Discord aqui",disabled:!o}),c.jsx("p",{className:"text-xs text-textSecondary mt-2",children:"Com a URL do Webhook configurada, os comandos de rolagem serão enviados diretamente para o seu canal do Discord."})]})})},Do=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i,name:o})=>{const l=L.useRef(null);return L.useEffect(()=>{l.current&&(l.current.style.height="auto",l.current.style.height=`${l.current.scrollHeight}px`)},[t]),c.jsx("textarea",{ref:l,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i,name:o})},eN=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,onShowDiscord:i})=>{const{user:o}=ze(),l=o.uid===t.ownerUid||n,[u,d]=L.useState(t.inventory||[]);L.useEffect(()=>{d(t.inventory||[])},[t.inventory]);const p=()=>e("inventory",[...t.inventory||[],{id:crypto.randomUUID(),name:"",description:"",isCollapsed:!1}]),g=S=>e("inventory",(t.inventory||[]).filter(D=>D.id!==S)),m=(S,D,T)=>{d(w=>w.map(C=>C.id===S?{...C,[D]:T}:C))},E=L.useCallback((S,D)=>{const T=u.find(C=>C.id===S),w=(t.inventory||[]).find(C=>C.id===S);T&&w&&T[D]!==w[D]&&e("inventory",(t.inventory||[]).map(C=>C.id===S?{...C,[D]:T[D]}:C))},[u,t.inventory,e]),N=S=>{u.find(T=>T.id===S)&&e("inventory",(t.inventory||[]).map(T=>T.id===S?{...T,isCollapsed:!T.isCollapsed}:T))};return c.jsxs(Nt,{title:"Inventário",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(S=>S.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(S.id),children:S.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>i(S.name,S.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},S.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(S.id),children:S.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>i(S.name,S.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-4",children:"Mostrar no Feed"})]}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer self-end",onClick:()=>N(S.id),children:"Recolher ▲"}),c.jsx("input",{type:"text",value:S.name,onChange:T=>m(S.id,"name",T.target.value),onBlur:()=>E(S.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome do Item",disabled:!l}),c.jsx(Do,{name:"description",value:S.description,onChange:T=>m(S.id,"description",T.target.value),onBlur:()=>E(S.id,"description"),placeholder:"Descrição do item",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(S.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Item",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:"🗑️"})})})]},S.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhum item no inventário."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:p,className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})},tN=({character:t,isMaster:e,onUpdate:n,onShowDiscord:r,isCollapsed:s,toggleSection:i})=>{const{user:o}=ze(),l=o.uid===t.ownerUid||e,[u,d]=L.useState(t.equippedItems||[]);L.useEffect(()=>{d(t.equippedItems||[])},[t.equippedItems]);const p=()=>n("equippedItems",[...t.equippedItems||[],{id:crypto.randomUUID(),name:"",description:"",attributes:"",isCollapsed:!1}]),g=S=>n("equippedItems",(t.equippedItems||[]).filter(D=>D.id!==S)),m=(S,D,T)=>{d(w=>w.map(C=>C.id===S?{...C,[D]:T}:C))},E=L.useCallback((S,D)=>{const T=u.find(C=>C.id===S),w=(t.equippedItems||[]).find(C=>C.id===S);T&&w&&T[D]!==w[D]&&n("equippedItems",(t.equippedItems||[]).map(C=>C.id===S?{...C,[D]:T[D]}:C))},[u,t.equippedItems,n]),N=S=>n("equippedItems",(t.equippedItems||[]).map(D=>D.id===S?{...D,isCollapsed:!D.isCollapsed}:D));return c.jsxs(Nt,{title:"Itens Equipados",isCollapsed:s,toggleSection:i,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(S=>S.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(S.id),children:S.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>r(S.name,S.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},S.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(S.id),children:S.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>r(S.name,S.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-4",children:"Mostrar no Feed"})]}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer self-end",onClick:()=>N(S.id),children:"Recolher ▲"}),c.jsx("input",{type:"text",value:S.name,onChange:T=>m(S.id,"name",T.target.value),onBlur:()=>E(S.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome",disabled:!l}),c.jsx(Do,{value:S.description,onChange:T=>m(S.id,"description",T.target.value),onBlur:()=>E(S.id,"description"),placeholder:"Descrição",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md mb-2",disabled:!l}),c.jsx(Do,{value:S.attributes,onChange:T=>m(S.id,"attributes",T.target.value),onBlur:()=>E(S.id,"attributes"),placeholder:"Atributos/Efeitos",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-sm text-textPrimary",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(S.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Item",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:"🗑️"})})})]},S.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhum item equipado."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:p,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})},nN=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,onShowDiscord:i})=>{const{user:o}=ze(),l=o.uid===t.ownerUid||e,[u,d]=L.useState(t.abilities||[]);L.useEffect(()=>{d(t.abilities||[])},[t.abilities]);const p=()=>n("abilities",[...t.abilities||[],{id:crypto.randomUUID(),title:"",description:"",isCollapsed:!1}]),g=S=>n("abilities",(t.abilities||[]).filter(D=>D.id!==S)),m=(S,D,T)=>{d(w=>w.map(C=>C.id===S?{...C,[D]:T}:C))},E=L.useCallback((S,D)=>{const T=u.find(C=>C.id===S),w=(t.abilities||[]).find(C=>C.id===S);T&&w&&T[D]!==w[D]&&n("abilities",(t.abilities||[]).map(C=>C.id===S?{...C,[D]:T[D]}:C))},[u,t.abilities,n]),N=S=>n("abilities",(t.abilities||[]).map(D=>D.id===S?{...D,isCollapsed:!D.isCollapsed}:D));return c.jsxs(Nt,{title:"Habilidades",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(S=>S.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(S.id),children:S.title||"Habilidade Sem Título"}),c.jsx("button",{onClick:()=>i(S.title,S.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},S.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(S.id),children:S.title||"Habilidade Sem Título"}),c.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[c.jsx("button",{onClick:()=>i(S.title,S.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap",children:"Mostrar no Feed"}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>N(S.id),children:"Recolher ▲"})]})]}),c.jsx("input",{type:"text",value:S.title,onChange:T=>m(S.id,"title",T.target.value),onBlur:()=>E(S.id,"title"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Título",disabled:!l}),c.jsx(Do,{value:S.description,onChange:T=>m(S.id,"description",T.target.value),onBlur:()=>E(S.id,"description"),placeholder:"Descrição",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(S.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Habilidade",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:"🗑️"})})})]},S.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhuma habilidade adicionada."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:p,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})},rN=({character:t,onUpdate:e,isCollapsed:n,toggleSection:r,onShowDiscord:s})=>{const o=g=>e(g,[...t[g]||[],{id:crypto.randomUUID(),name:"",description:"",origin:{class:!1,race:!1,manual:!0},value:0,isCollapsed:!1}]),l=(g,m)=>e(g,(t[g]||[]).filter(E=>E.id!==m)),u=(g,m,E)=>e(g,(t[g]||[]).map(N=>N.id===m?{...N,origin:{...N.origin,[E]:!N.origin[E]}}:N)),d=(g,m,E,N)=>e(g,(t[g]||[]).map(S=>S.id===m?{...S,[E]:N}:S)),p=(g,m)=>e(g,(t[g]||[]).map(E=>E.id===m?{...E,isCollapsed:!E.isCollapsed}:E));return c.jsx(Nt,{title:"Vantagens e Desvantagens",isCollapsed:n,toggleSection:r,children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1",children:"Vantagens"}),c.jsxs("div",{className:"space-y-2",children:[(t.advantages||[]).map(g=>c.jsx(uy,{perk:g,type:"advantages",canEdit:!0,onRemove:l,onChange:d,onOriginChange:u,onToggleCollapse:p,onShowDiscord:s},g.id)),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("button",{onClick:()=>o("advantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1",children:"Desvantagens"}),c.jsxs("div",{className:"space-y-2",children:[(t.disadvantages||[]).map(g=>c.jsx(uy,{perk:g,type:"disadvantages",canEdit:!0,onRemove:l,onChange:d,onOriginChange:u,onToggleCollapse:p,onShowDiscord:s},g.id)),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("button",{onClick:()=>o("disadvantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})]})]})})},uy=({perk:t,type:e,canEdit:n,onRemove:r,onChange:s,onOriginChange:i,onToggleCollapse:o,onShowDiscord:l})=>{const[u,d]=L.useState(t);L.useEffect(()=>{d(t)},[t.id]);const p=m=>{const{name:E,value:N,type:S}=m.target,D=S==="number"?parseInt(N,10)||0:N;d(T=>({...T,[E]:D}))},g=L.useCallback(m=>{u[m]!==t[m]&&s(e,u.id,m,u[m])},[u,t,e,s]);return c.jsxs("div",{className:"flex flex-col p-3 bg-bgElement rounded-md shadow-sm",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsxs("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>o(e,t.id),children:[u.name||"Sem Nome"," ",t.isCollapsed?"...":""]}),c.jsx("button",{onClick:()=>l(u.name,u.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]}),!t.isCollapsed&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("input",{type:"text",name:"name",value:u.name,onChange:p,onBlur:()=>g("name"),className:"font-semibold text-lg flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",placeholder:"Nome",disabled:!n}),c.jsx("input",{type:"number",name:"value",value:u.value===0?"":u.value,onChange:p,onBlur:()=>g("value"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary",placeholder:"Valor",disabled:!n})]}),c.jsx(Do,{name:"description",value:u.description,onChange:p,onBlur:()=>g("description"),placeholder:"Descrição",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!n}),c.jsx("div",{className:"flex gap-3 text-sm text-textSecondary mt-2",children:["class","race","manual"].map(m=>{var E;return c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"checkbox",checked:((E=t.origin)==null?void 0:E[m])||!1,onChange:()=>i(e,t.id,m),className:"form-checkbox text-btnHighlightBg rounded",disabled:!n}),m.charAt(0).toUpperCase()+m.slice(1)]},m)})}),n&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>r(e,t.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:`Remover ${e==="advantages"?"Vantagem":"Desvantagem"}`,children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:"🗑️"})})})]})]})},sN=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i})=>{const o=L.useRef(null);return ql.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),c.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i})},iN=({children:t,className:e,onClick:n})=>{const[r,s]=L.useState(!1),i=L.useRef(null);return ql.useLayoutEffect(()=>{const o=()=>{const u=i.current;if(u){const d=u.scrollWidth>u.clientWidth;d!==r&&s(d)}};o();const l=new ResizeObserver(o);return i.current&&l.observe(i.current),()=>{l.disconnect()}},[t,r]),c.jsx("span",{ref:i,className:`relative overflow-hidden whitespace-nowrap ${e}`,onClick:n,children:c.jsxs("span",{className:r?"animate-scroll-left":"inline-block",children:[c.jsx("span",{className:r?"inline-block pr-8":"inline-block",children:t}),r&&c.jsx("span",{className:"inline-block pr-8",children:t})]})})},oN=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,allAttributes:s,onUpdate:i,onExecuteFormula:o})=>{const{user:l}=ze(),u=l.uid===t.ownerUid||e,[d,p]=L.useState(t.specializations||[]);L.useEffect(()=>{p(t.specializations||[])},[t.specializations]);const g=_=>{i("specializations",_)},m=(_,k)=>{const b=k==="attribute"?s[0]||"":0,q={id:crypto.randomUUID(),type:k,value:b},B=(t.specializations||[]).map(X=>X.id===_?{...X,components:[...X.components||[],q]}:X);g(B)},E=(_,k)=>{const b=(t.specializations||[]).map(q=>q.id===_?{...q,components:(q.components||[]).filter(B=>B.id!==k)}:q);g(b)},N=(_,k,b)=>{p(q=>q.map(B=>B.id===_?{...B,components:B.components.map(X=>X.id===k?{...X,value:b}:X)}:B))},S=L.useCallback((_,k)=>{const b=d.find(q=>q.id===_);b==null||b.components.find(q=>q.id===k),g(d)},[d,g]),D=()=>{const _={id:crypto.randomUUID(),name:"Nova Perícia",isCollapsed:!1,mainDice:"1d20",components:[],description:"",trained:!1,bonusRules:[]};g([...t.specializations||[],_])},T=_=>{g((t.specializations||[]).filter(k=>k.id!==_))},w=(_,k,b)=>{p(q=>q.map(B=>B.id===_?{...B,[k]:b}:B))},C=L.useCallback((_,k,b)=>{const q=(t.specializations||[]).map(B=>B.id===_?{...B,[k]:b}:B);g(q)},[t.specializations,g]),P=_=>{const k=(t.specializations||[]).map(b=>b.id===_?{...b,isCollapsed:!b.isCollapsed}:b);g(k)},R=_=>{const k={id:crypto.randomUUID(),enabled:!0,bonus:1,each:1,source:"level",condition:"none"},b=(t.specializations||[]).map(q=>q.id===_?{...q,bonusRules:[...q.bonusRules||[],k]}:q);g(b)},j=(_,k)=>{const b=(t.specializations||[]).map(q=>q.id===_?{...q,bonusRules:(q.bonusRules||[]).filter(B=>B.id!==k)}:q);g(b)},v=(_,k,b,q)=>{p(B=>B.map(X=>X.id===_?{...X,bonusRules:X.bonusRules.map(Fe=>Fe.id===k?{...Fe,[b]:q}:Fe)}:X))},y=_=>{const k=d.find(q=>q.id===_),b=(t.specializations||[]).map(q=>q.id===_?k:q);g(b)},I=_=>{if(!t)return 0;if(t.mainAttributes&&["Iniciativa","FA","FM","FD"].includes(_))return t.mainAttributes[_.toLowerCase()]||0;const k=(t.attributes||[]).find(b=>b.name===_);return k?(k.base||0)+(k.perm||0)+(k.arma||0):0},A=_=>{let k=(_.components||[]).reduce((b,q)=>q.type==="number"?b+(parseInt(q.value,10)||0):q.type==="attribute"?b+I(q.value):b,0);return(_.bonusRules||[]).forEach(b=>{if(!b.enabled||b.condition==="trained"&&!_.trained)return;let q=0;b.source==="level"?q=t.level||1:b.source&&b.source.startsWith("attribute_")&&(q=I(b.source.replace("attribute_","")));const B=parseInt(b.each,10)||1,X=parseInt(b.bonus,10)||0;B>0&&(k+=Math.floor(q/B)*X)}),k};return c.jsxs(Nt,{title:"Perícias",isCollapsed:n,toggleSection:r,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(d||[]).map(_=>{const k=_.isCollapsed!==!1,b=A(_),q=()=>{const B=[..._.components||[]];B.push({id:crypto.randomUUID(),type:"dice",value:_.mainDice}),(_.bonusRules||[]).forEach(X=>{if(!X.enabled||X.condition==="trained"&&!_.trained)return;let Fe=0,H="";if(X.source==="level")Fe=t.level||1,H="Nível";else if(X.source&&X.source.startsWith("attribute_")){const z=X.source.replace("attribute_","");Fe=I(z),H=z}const Z=parseInt(X.each,10)||1,ee=parseInt(X.bonus,10)||0;if(Z>0){const z=Math.floor(Fe/Z)*ee;if(z!==0){const W=X.condition==="trained"?" (Treinado)":"";B.push({id:crypto.randomUUID(),type:"number",value:z,label:`Bônus ${H}${W}`})}}}),o({..._,discordText:_.description,components:B})};return k?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsxs(iN,{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>P(_.id),children:[_.trained&&"✅"," ",_.name||"Perícia Sem Nome"," ",b!==0&&` (${b>0?"+":""}${b})`]}),c.jsx("button",{onClick:q,className:"px-4 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-2 text-sm",children:"Rolar"})]},_.id):c.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center gap-2 mb-3",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>P(_.id),children:_.name||"Perícia Sem Nome"}),c.jsx("button",{onClick:q,className:"px-5 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap",children:"Rolar"}),u&&c.jsx("button",{onClick:()=>P(_.id),className:"w-10 h-10 bg-gray-600 text-white text-lg rounded-md flex items-center justify-center font-bold",children:"↑"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 border-t border-bgInput pt-3 mt-3",children:[c.jsxs("div",{className:"md:col-span-1",children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome da Perícia:"}),c.jsx("input",{type:"text",placeholder:"Nome da Perícia",value:_.name,onChange:B=>w(_.id,"name",B.target.value),onBlur:B=>C(_.id,"name",B.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-3",disabled:!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Dado Principal:"}),c.jsx("input",{type:"text",placeholder:"1d20",value:_.mainDice,onChange:B=>w(_.id,"mainDice",B.target.value),onBlur:B=>C(_.id,"mainDice",B.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-3",disabled:!u}),c.jsxs("div",{className:"flex items-center mb-3",children:[c.jsx("input",{type:"checkbox",id:`trained-${_.id}`,checked:_.trained,onChange:B=>C(_.id,"trained",B.target.checked),className:"form-checkbox text-green-500 rounded-sm",disabled:!u}),c.jsx("label",{htmlFor:`trained-${_.id}`,className:"ml-2 text-sm text-textSecondary",children:"Treinado"})]}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Descrição:"}),c.jsx(sN,{placeholder:"Descrição...",value:_.description,onChange:B=>w(_.id,"description",B.target.value),onBlur:B=>C(_.id,"description",B.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-sm mb-3",disabled:!u}),u&&c.jsx("button",{onClick:()=>T(_.id),className:"w-full px-3 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md",children:"Remover Perícia"})]}),c.jsxs("div",{className:"md:col-span-2 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Bônus Adicionais:"}),c.jsx("div",{className:"space-y-2",children:(_.components||[]).map(B=>c.jsxs("div",{className:"flex items-center gap-2",children:[B.type==="attribute"&&c.jsxs("select",{value:B.value,onChange:X=>N(_.id,B.id,X.target.value),onBlur:()=>S(_.id,B.id),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary w-full",disabled:!u,children:[c.jsx("option",{disabled:!0,value:"",children:"Selecione Atributo"}),s.map(X=>c.jsx("option",{value:X,children:X},X))]}),B.type==="number"&&c.jsx("input",{type:"number",value:B.value,onChange:X=>N(_.id,B.id,X.target.value),onBlur:()=>S(_.id,B.id),className:"w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),u&&c.jsx("button",{onClick:()=>E(_.id,B.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]},B.id))}),u&&c.jsxs("div",{className:"flex gap-2 mt-2",children:[c.jsx("button",{onClick:()=>m(_.id,"attribute"),className:"px-2 py-1 text-xs bg-green-600 text-white rounded-md",children:"+ Atributo"}),c.jsx("button",{onClick:()=>m(_.id,"number"),className:"px-2 py-1 text-xs bg-green-600 text-white rounded-md",children:"+ Número"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Bônus Condicionais:"}),c.jsx("div",{className:"space-y-2 mb-3",children:(_.bonusRules||[]).map(B=>c.jsxs("div",{className:"flex items-center gap-2 flex-wrap p-2 rounded-md border border-dashed border-textSecondary/30",children:[c.jsx("input",{type:"checkbox",checked:B.enabled,onChange:X=>v(_.id,B.id,"enabled",X.target.checked),onBlur:()=>y(_.id),disabled:!u}),c.jsx("span",{children:"Se"}),c.jsxs("select",{value:B.condition,onChange:X=>v(_.id,B.id,"condition",X.target.value),onBlur:()=>y(_.id),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u,children:[c.jsx("option",{value:"none",children:"Sempre"}),c.jsx("option",{value:"trained",children:"Treinado"})]}),c.jsx("span",{children:", a cada"}),c.jsx("input",{type:"number",value:B.each,onChange:X=>v(_.id,B.id,"each",X.target.value),onBlur:()=>y(_.id),className:"w-16 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),c.jsxs("select",{value:B.source,onChange:X=>v(_.id,B.id,"source",X.target.value),onBlur:()=>y(_.id),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u,children:[c.jsx("option",{value:"level",children:"Nível"}),s.map(X=>c.jsx("option",{value:`attribute_${X}`,children:X},X))]}),c.jsx("span",{children:", +"}),c.jsx("input",{type:"number",value:B.bonus,onChange:X=>v(_.id,B.id,"bonus",X.target.value),onBlur:()=>y(_.id),className:"w-16 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),u&&c.jsx("button",{onClick:()=>j(_.id,B.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]},B.id))}),u&&c.jsx("button",{onClick:()=>R(_.id),className:"px-2 py-1 text-xs bg-blue-600 text-white rounded-md",children:"+ Regra de Bônus"})]})]})]})]},_.id)})}),u&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:D,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"+ Adicionar Perícia"})})]})},aN=({value:t,onChange:e,placeholder:n,className:r,disabled:s,onBlur:i})=>{const o=L.useRef(null);return L.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),c.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:i,placeholder:n,className:`${r} resize-none overflow-hidden`,rows:"1",disabled:s})},lN=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s})=>{const{user:i}=ze(),o=i.uid===t.ownerUid||e,l=p=>{const g=p==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(p==="image"){const m=prompt("Cole a URL da imagem:");m&&n("history",[...t.history||[],{...g,value:m}])}else n("history",[...t.history||[],g])},u=(p,g,m)=>n("history",(t.history||[]).map(E=>E.id===p?{...E,[g]:m}:E)),d=p=>n("history",(t.history||[]).filter(g=>g.id!==p));return c.jsxs(Nt,{title:"História do Personagem",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"space-y-4 mb-4",children:(t.history||[]).length===0?c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum bloco de história adicionado."}):t.history.map(p=>Fw(p,o,u,d))}),o&&c.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 justify-center",children:[c.jsx("button",{onClick:()=>l("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Texto"}),c.jsx("button",{onClick:()=>l("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Imagem"})]})]})},uN=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s})=>{const{user:i}=ze(),o=i.uid===t.ownerUid||e,l=p=>{const g=p==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(p==="image"){const m=prompt("Cole a URL da imagem para a anotação:");m&&n("notes",[...t.notes||[],{...g,value:m}])}else n("notes",[...t.notes||[],g])},u=(p,g,m)=>n("notes",(t.notes||[]).map(E=>E.id===p?{...E,[g]:m}:E)),d=p=>n("notes",(t.notes||[]).filter(g=>g.id!==p));return c.jsxs(Nt,{title:"Anotações",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"space-y-4 mb-4",children:(t.notes||[]).length===0?c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum bloco de anotação adicionado."}):t.notes.map(p=>Fw(p,o,u,d))}),o&&c.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 justify-center",children:[c.jsx("button",{onClick:()=>l("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Texto"}),c.jsx("button",{onClick:()=>l("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Imagem"})]})]})},Fw=(t,e,n,r)=>c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput relative",children:[e&&c.jsx("button",{onClick:()=>r(t.id),className:"absolute top-2 right-2 p-1 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white z-10",title:"Remover Bloco",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-lg",children:"🗑️"})}),t.type==="text"?c.jsx(cN,{block:t,canEdit:e,updateBlock:n}):c.jsx(dN,{block:t,canEdit:e,updateBlock:n})]},t.id),cN=({block:t,canEdit:e,updateBlock:n})=>{const[r,s]=L.useState(t.value||"");L.useEffect(()=>{s(t.value||"")},[t.value]);const i=L.useCallback(()=>{r!==t.value&&n(t.id,"value",r)},[r,t.value,t.id,n]);return t.isCollapsed?c.jsxs("div",{className:"cursor-pointer",onClick:()=>n(t.id,"isCollapsed",!1),children:[c.jsx("p",{className:"text-lg font-semibold mb-1 text-textPrimary",children:"Bloco de Texto"}),c.jsx("p",{className:"text-sm italic text-textSecondary truncate",children:t.value||"Vazio..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(aN,{value:r,onChange:o=>s(o.target.value),onBlur:i,placeholder:"Digite aqui...",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!e}),c.jsx("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary",children:"Ocultar ▲"})]})},dN=({block:t,canEdit:e,updateBlock:n})=>{const[r,s]=L.useState(t.width===0?"":t.width),[i,o]=L.useState(t.height===0?"":t.height),[l,u]=L.useState(t.fitWidth);L.useEffect(()=>{s(t.width===0?"":t.width),o(t.height===0?"":t.height),u(t.fitWidth)},[t.width,t.height,t.fitWidth]);const d=L.useCallback(()=>n(t.id,"width",parseInt(r)||0),[t.id,n,r]),p=L.useCallback(()=>n(t.id,"height",parseInt(i)||0),[t.id,n,i]),g=L.useCallback(m=>n(t.id,"fitWidth",m.target.checked),[t.id,n]);return t.isCollapsed?c.jsx("div",{className:"cursor-pointer text-center py-2",onClick:()=>n(t.id,"isCollapsed",!1),children:c.jsx("p",{className:"text-lg font-semibold text-textPrimary",children:"Mostrar Imagem"})}):c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("img",{src:t.value,alt:"Imagem",className:"max-w-full h-auto rounded-md shadow-md",style:{width:l?"100%":r?`${r}px`:"auto",height:l?"auto":i?`${i}px`:"auto",objectFit:"contain"},onError:m=>{m.target.onerror=null,m.target.src="https://placehold.co/300x200/1f2937/FFFFFF?text=Erro"}}),e&&c.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 mt-2 text-sm text-textSecondary",children:[c.jsxs("label",{children:["Ajustar à Largura: ",c.jsx("input",{type:"checkbox",checked:l,onChange:m=>{u(m.target.checked),g(m)},className:"form-checkbox text-btnHighlightBg rounded"})]}),!l&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Largura (px): ",c.jsx("input",{type:"number",value:r,onChange:m=>s(m.target.value),onBlur:d,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})]}),c.jsxs("label",{children:["Altura (px): ",c.jsx("input",{type:"number",value:i,onChange:m=>o(m.target.value),onBlur:p,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})]})]})]}),c.jsx("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 w-full text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary",children:"Ocultar ▲"})]})},hN=({character:t,onBack:e,isMaster:n})=>{var v,y,I,A,_,k,b,q,B,X,Fe,H,Z,ee;const{character:r,loading:s,updateCharacterField:i,toggleSection:o}=IP(t.id,t.ownerUid),{addRollToFeed:l,addMessageToFeed:u}=Su(),{user:d}=ze(),[p,g]=L.useState({type:null,props:{}}),m=()=>g({type:null,props:{}}),E=L.useMemo(()=>{if(!r)return[];const z=["Iniciativa","FA","FM","FD"],W=(r.attributes||[]).map(K=>K.name).filter(Boolean);return[...z,...W]},[r]),N=L.useMemo(()=>{const z={attributes:{},dice:[]};return r!=null&&r.buffs&&r.buffs.forEach(W=>{W.isActive&&W.effects&&W.effects.forEach(K=>{if(K.type==="attribute"&&K.target){const me=parseInt(K.value,10)||0;z.attributes[K.target]=(z.attributes[K.target]||0)+me}else K.type==="dice"&&K.value&&z.dice.push({name:W.name,value:K.value})})}),z},[r==null?void 0:r.buffs]),S=async(z,W,K=[],me="",ge="")=>{if(!r)return;u({characterName:r.name||"Narrador",text:`${z}
${W||"Nenhuma descrição."}`});const ie={author:{name:r.name||"Personagem",icon_url:r.photoUrl||""},title:z||"Sem Título",description:W||"Sem Descrição.",fields:K,color:8141549,footer:me?{text:me}:void 0};if(r.discordWebhookUrl)try{await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[ie]})}),ge&&await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:ge})})}catch(he){g({type:"info",props:{message:`Falha ao enviar para o Discord: ${he.message}`,onConfirm:m}})}else{const he=`**${z||"Sem Título"}**
${W||"Sem Descrição."}`;g({type:"info",props:{message:"Webhook do Discord não configurado. Copie e cole no Discord:",copyText:he,showCopyButton:!0,onConfirm:m}})}},D=(z,W,K)=>{if(!(r!=null&&r.mainAttributes))return;let me="";const ge=r.name||"Personagem",ie=JSON.parse(JSON.stringify(r.mainAttributes));if(K==="heal")switch(W){case"HP":ie.hp.current=Math.min(ie.hp.max,ie.hp.current+z),me=`${ge} recuperou ${z} de HP.`;break;case"HP Bonus":ie.hp.temp=(ie.hp.temp||0)+z,me=`${ge} recebeu ${z} de HP Bonus.`;break;case"MP":ie.mp.current=Math.min(ie.mp.max,ie.mp.current+z),me=`${ge} recuperou ${z} de MP.`;break}else switch(W){case"HP":let he=z;const Ft=Math.min(he,ie.hp.temp||0);ie.hp.temp-=Ft,he-=Ft,he>0&&(ie.hp.current-=he),me=`${ge} perdeu ${z} de HP.`;break;case"MP":ie.mp.current=Math.max(0,ie.mp.current-z),me=`${ge} perdeu ${z} de MP.`;break}i("mainAttributes",ie),S(K==="heal"?"❤️ Cura / Restauração":"💥 Dano Sofrido",me),m()},T=z=>{g({type:"action",props:{type:z,title:z==="heal"?"Curar / Restaurar":"Receber Dano / Perder",onConfirm:(W,K)=>D(W,K,z),onClose:m}})},w=z=>{const W=(r.attributes||[]).find(K=>K.id===z);W&&g({type:"rollAttribute",props:{attributeName:W.name,onConfirm:(K,me)=>C(K,me,W),onClose:m}})},C=(z,W,K)=>{if(!K)return;const me=N.attributes[K.name]||0,ge=(K.base||0)+(K.perm||0)+me+(K.arma||0);let ie=0,he=[];const Ft=z.match(/(\d+)d(\d+)/i);if(Ft){const xn=parseInt(Ft[1],10),Gn=parseInt(Ft[2],10);let ln=[];for(let It=0;It<xn;It++){const wn=Math.floor(Math.random()*Gn)+1;ln.push(wn)}ie=ln.reduce((It,wn)=>It+wn,0),he.push({type:"dice",value:ie,displayValue:`${z}(${ln.join("+")})`})}else ie=parseInt(z,10)||0,he.push({type:"dice",value:ie,displayValue:`${ie}`});he.push({type:"attribute",value:ge,displayValue:`${K.name}(${ge})`}),W!==0&&he.push({type:"modifier",value:W,displayValue:`Bónus(${W>0?"+":""}${W})`});const Kn=ie+ge+W,Rt=he.map(xn=>xn.displayValue).join(" + "),_n=`**Resultado Final: ${Kn}**`;S(`Rolagem de ${K.name}`,_n,[{name:"Detalhes",value:Rt,inline:!1}]),l({characterId:r.id,characterName:r.name,ownerUid:d.uid,rollName:`Rolagem de ${K.name}`,results:he,discordText:_n}),m()},P=async z=>{if(!z)return;let W=0,K=[],me=[];const ge=z.multiplier||1;for(let oe=0;oe<ge;oe++)for(const Te of z.components||[])if(Te.type==="attribute"){const Pe=Te.value;let Ee=0;if(["Iniciativa","FA","FM","FD"].includes(Pe))Ee=(r.mainAttributes[Pe.toLowerCase()]||0)+(N.attributes[Pe]||0);else{const it=(r.attributes||[]).find(_e=>_e.name===Pe);it&&(Ee=(it.base||0)+(it.perm||0)+(it.arma||0)+(N.attributes[Pe]||0))}W+=Ee,K.push({type:"attribute",value:Ee,displayValue:`${Pe}(${Ee})`})}else if(Te.type==="critDice"){const Pe=String(Te.value||"").match(/(\d+)d(\d+)/i);if(Pe){const Ee=parseInt(Pe[1],10),it=parseInt(Pe[2],10);let _e=[],xe=0;for(let Tt=0;Tt<Ee;Tt++){const En=Math.floor(Math.random()*it)+1;if(_e.push(En),xe+=En,En>=(Te.critValue||it)){let hs=0;const Qn=Te.critBonusAttribute;if(["Iniciativa","FA","FM","FD"].includes(Qn))hs=(r.mainAttributes[Qn.toLowerCase()]||0)+(N.attributes[Qn]||0);else{const Dr=(r.attributes||[]).find(Jo=>Jo.name===Qn);Dr&&(hs=(Dr.base||0)+(Dr.perm||0)+(Dr.arma||0)+(N.attributes[Qn]||0))}const Yn=hs*(Te.critBonusMultiplier||1);xe+=Yn,me.push(`Crítico no ${En}! Adiciona ${Qn} (${Yn})`)}}W+=xe,K.push({type:"dice",value:xe,displayValue:`${Te.value}(${_e.join("+")})`})}else{const Ee=parseInt(Te.value,10)||0;W+=Ee,K.push({type:"number",value:Ee,displayValue:`${Ee}`})}}else{const Pe=String(Te.value||"").match(/(\d+)d(\d+)/i);if(Pe){const Ee=parseInt(Pe[1],10),it=parseInt(Pe[2],10);let _e=[];for(let Tt=0;Tt<Ee;Tt++)_e.push(Math.floor(Math.random()*it)+1);const xe=_e.reduce((Tt,En)=>Tt+En,0);W+=xe,K.push({type:"dice",value:xe,displayValue:`${Te.value}(${_e.join("+")})`})}else{const Ee=parseInt(Te.value,10)||0;W+=Ee,Te.label?K.push({type:"number",value:Ee,displayValue:`${Te.label}(${Ee>=0?"+":""}${Ee})`}):K.push({type:"number",value:Ee,displayValue:`${Ee}`})}}N.dice.forEach(oe=>{const Te=(oe.value||"").match(/(\d+)d(\d+)/i);if(Te){const Pe=parseInt(Te[1],10),Ee=parseInt(Te[2],10);let it=[];for(let xe=0;xe<Pe;xe++)it.push(Math.floor(Math.random()*Ee)+1);const _e=it.reduce((xe,Tt)=>xe+Tt,0);W+=_e,K.push({type:"dice",value:_e,displayValue:`${oe.name}(${it.join("+")})`})}else{const Pe=parseInt(oe.value,10)||0;W+=Pe,K.push({type:"number",value:Pe,displayValue:`${oe.name}(${Pe})`})}});const ie={HP:0,MP:0};let he=[];const Ft=(r.buffs||[]).filter(oe=>oe.isActive),Kn=z.costType&&z.costIsRollResult?-W:parseInt(z.costValue,10)||0;z.costType&&Kn!==0&&(ie[z.costType]+=Kn,he.push(`Ação: ${Kn>=0?"+":""}${Kn} ${z.costType}`));const Rt={HP:0,MP:0};z.recoverHP&&(Rt.HP=W,he.push(`Recupera: ${W} HP`)),z.recoverMP&&(Rt.MP=W,he.push(`Recupera: ${W} MP`)),Ft.forEach(oe=>{if(oe.costType&&oe.costValue!==void 0){const Te=parseInt(oe.costValue,10)||0;Te!==0&&(ie[oe.costType]+=Te,he.push(`${oe.name}: ${Te>=0?"+":""}${Te} ${oe.costType}`))}});const _n=Math.abs(Math.min(0,ie.HP)),xn=Math.abs(Math.min(0,ie.MP));if(r.mainAttributes.hp.current<_n||r.mainAttributes.mp.current<xn){g({type:"info",props:{message:"Custo de HP/MP insuficiente!",onConfirm:m}});return}const Gn=/(https?:\/\/[^\s]+)/i;let ln="",It=z.discordText||"";const wn=It.match(Gn);if(wn&&(ln=wn[0],It=It.replace(Gn,"").trim()),ie.HP!==0||ie.MP!==0||Rt.HP>0||Rt.MP>0){const oe={...r.mainAttributes};oe.hp.current=oe.hp.current-ie.HP+Rt.HP,oe.mp.current=oe.mp.current-ie.MP+Rt.MP,oe.hp.current=Math.min(oe.hp.current,oe.hp.max),oe.hp.current=Math.max(oe.hp.current,0),oe.mp.current=Math.min(oe.mp.current,oe.mp.max),oe.mp.current=Math.max(oe.mp.current,0),await i("mainAttributes",oe)}const Cu=K.map(oe=>oe.displayValue).join(" + "),Au=`${It}

**Resultado Final: ${W}**`,ds=[{name:"Detalhes da Rolagem",value:Cu||"N/A",inline:!1}];me.length>0&&ds.push({name:"Críticos",value:me.join(`
`),inline:!1}),Ft.length>0&&ds.push({name:"Buffs Ativos",value:Ft.map(oe=>oe.name).join(", "),inline:!1});const pi=he.length>0?`Custo Total: ${he.join(" | ")}`:"";S(z.name,Au,ds,pi,ln),l({characterId:r.id,characterName:r.name,ownerUid:d.uid,rollName:z.name,results:K,discordText:It})},R=()=>{g({type:"confirm",props:{message:`Tem a certeza que deseja resetar PERMANENTEMENTE a ficha de "${r.name}"?`,onConfirm:async()=>{const z={photoUrl:"",age:"",height:"",gender:"",race:"",class:"",alignment:"",level:1,xp:0,mainAttributes:{hp:{current:10,max:10,temp:0},mp:{current:10,max:10},initiative:0,fa:0,fm:0,fd:0},attributes:[],inventory:[],wallet:{zeni:0,inspiration:0},advantages:[],disadvantages:[],abilities:[],specializations:[],equippedItems:[],history:[],notes:[],buffs:[],formulaActions:[],discordWebhookUrl:""};for(const[W,K]of Object.entries(z))await i(W,K);m()},onCancel:m}})},j=()=>{const{collapsedStates:z,...W}=r,K=JSON.stringify(W,null,2),me=new Blob([K],{type:"application/json"}),ge=document.createElement("a");ge.href=URL.createObjectURL(me),ge.download=`${r.name||"ficha"}.json`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(ge.href)};return s?c.jsx("div",{className:"text-center p-8",children:c.jsx("p",{className:"text-xl text-textSecondary",children:"A carregar ficha..."})}):r?c.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4",children:[c.jsx(zf,{modalState:p,closeModal:m}),c.jsx(QP,{character:r}),c.jsx("button",{onClick:e,className:"mb-4 px-4 py-2 bg-bgSurface hover:opacity-80 text-textPrimary font-bold rounded-lg",children:"        ← Voltar para a Lista"}),c.jsx("div",{id:"info",children:c.jsx(YP,{character:r,onUpdate:i,isMaster:n,isCollapsed:(v=r.collapsedStates)==null?void 0:v.info,toggleSection:()=>o("info")})}),c.jsx("div",{id:"main-attributes",children:c.jsx(XP,{character:r,onUpdate:i,isMaster:n,buffModifiers:N.attributes,isCollapsed:(y=r.collapsedStates)==null?void 0:y.main,toggleSection:()=>o("main")})}),c.jsx("div",{id:"attributes",children:c.jsx(zP,{character:r,isMaster:n,onUpdate:i,buffModifiers:N.attributes,isCollapsed:(I=r.collapsedStates)==null?void 0:I.attributes,toggleSection:()=>o("attributes"),onOpenRollModal:w})}),c.jsx("div",{id:"actions",children:c.jsx($P,{character:r,isMaster:n,isCollapsed:(A=r.collapsedStates)==null?void 0:A.actions,toggleSection:()=>o("actions"),onOpenActionModal:T,allAttributes:E,onUpdate:i,onExecuteFormula:P})}),c.jsx("div",{id:"buffs",children:c.jsx(HP,{character:r,isMaster:n,onUpdate:i,allAttributes:E,isCollapsed:(_=r.collapsedStates)==null?void 0:_.buffs,toggleSection:()=>o("buffs")})}),c.jsx("div",{id:"wallet",children:c.jsx(JP,{character:r,isMaster:n,onUpdate:i,isCollapsed:(k=r.collapsedStates)==null?void 0:k.wallet,toggleSection:()=>o("wallet")})}),c.jsx("div",{id:"inventory",children:c.jsx(eN,{character:r,onUpdate:i,isMaster:n,onShowDiscord:S,isCollapsed:(b=r.collapsedStates)==null?void 0:b.inventory,toggleSection:()=>o("inventory")})}),c.jsx("div",{id:"equipped",children:c.jsx(tN,{character:r,onUpdate:i,isMaster:n,onShowDiscord:S,isCollapsed:(q=r.collapsedStates)==null?void 0:q.equipped,toggleSection:()=>o("equipped")})}),c.jsx("div",{id:"perks",children:c.jsx(rN,{character:r,onUpdate:i,onShowDiscord:S,isCollapsed:(B=r.collapsedStates)==null?void 0:B.perks,toggleSection:()=>o("perks")})}),c.jsx("div",{id:"skills",children:c.jsx(nN,{character:r,onUpdate:i,isMaster:n,onShowDiscord:S,isCollapsed:(X=r.collapsedStates)==null?void 0:X.skills,toggleSection:()=>o("skills")})}),c.jsx("div",{id:"specializations",children:c.jsx(oN,{character:r,onUpdate:i,isMaster:n,isCollapsed:(Fe=r.collapsedStates)==null?void 0:Fe.specializations,toggleSection:()=>o("specializations"),allAttributes:E,onExecuteFormula:P})}),c.jsx("div",{id:"story",children:c.jsx(lN,{character:r,onUpdate:i,isMaster:n,isCollapsed:(H=r.collapsedStates)==null?void 0:H.story,toggleSection:()=>o("story")})}),c.jsx("div",{id:"notes",children:c.jsx(uN,{character:r,onUpdate:i,isMaster:n,isCollapsed:(Z=r.collapsedStates)==null?void 0:Z.notes,toggleSection:()=>o("notes")})}),c.jsx("div",{id:"discord",children:c.jsx(ZP,{character:r,onUpdate:i,isMaster:n,isCollapsed:(ee=r.collapsedStates)==null?void 0:ee.discord,toggleSection:()=>o("discord")})}),c.jsx(UP,{character:r,onExport:j,onReset:R})]}):c.jsx("div",{className:"text-center p-8",children:c.jsx("p",{className:"text-xl text-red-400",children:"Erro: Personagem não encontrado."})})},cy="1:727724875985:web:97411448885c68c289e5f0",fN=({activeTheme:t,setActiveTheme:e,setPreviewTheme:n})=>{const{user:r,googleSignOut:s,isMaster:i}=ze(),[o,l]=L.useState(null),[u,d]=L.useState([]),p=L.useRef(null),[g,m]=L.useState(!1),[E,N]=L.useState(!1),[S,D]=L.useState({type:null,props:{}}),T=()=>D({type:null,props:{}});L.useEffect(()=>{if(o!=null&&o.id&&(o!=null&&o.ownerUid)){const I=an(Ye,`artifacts2/${cy}/users/${o.ownerUid}/characterSheets/${o.id}`),A=ko(I,async _=>{if(_.exists()){const k=_.data();if(k.activeThemeId){const b=await AP(k.activeThemeId);e(b)}else e(null)}});return()=>A()}else e(null)},[o,e]);const w=()=>{N(!1),n(null)},C=I=>{l(I)},P=async()=>{if(r){const I=await TP(r.uid,i&&g);d(I)}};L.useEffect(()=>{P()},[r,g,i]);const R=async()=>{await bP(r.uid)&&P()},j=()=>{p.current.click()},v=I=>{const A=I.target.files[0];if(!A)return;const _=new FileReader;_.onload=k=>{try{const b=JSON.parse(k.target.result);if(!b.name)throw new Error("Ficheiro JSON inválido ou incompatível.");D({type:"confirm",props:{message:`Deseja criar um novo personagem com os dados de "${b.name}"?`,onConfirm:async()=>{const q=an(On(Ye,`artifacts2/${cy}/users/${r.uid}/characterSheets`)),B={...b,ownerUid:r.uid};delete B.id,await Xo(q,B),P(),T()},onCancel:T}})}catch(b){D({type:"info",props:{message:`Erro ao ler arquivo: ${b.message}`,onConfirm:T}})}},_.readAsText(A),I.target.value=null},y=I=>{const A=I.ownerUid||r.uid;D({type:"confirm",props:{message:`Tem a certeza que deseja excluir permanentemente a ficha de "${I.name}"?`,onConfirm:async()=>{await SP(A,I.id)?d(k=>k.filter(b=>b.id!==I.id)):alert("Não foi possível excluir a ficha."),T()},onCancel:T}})};return o?c.jsxs(c.Fragment,{children:[i&&c.jsx(ly,{onCharacterClick:C}),E&&c.jsx(ay,{character:o,originalTheme:t,setPreviewTheme:n,onClose:w}),c.jsx("button",{onClick:()=>N(!0),className:"fixed top-4 right-4 z-[60] px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg shadow-lg",children:"Editor de Temas"}),c.jsx(hN,{character:o,onBack:()=>l(null),isMaster:i})]}):c.jsxs(c.Fragment,{children:[i&&c.jsx(ly,{onCharacterClick:C}),c.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 md:p-8",children:[c.jsx(zf,{modalState:S,closeModal:T}),c.jsx("input",{type:"file",ref:p,onChange:v,accept:".json",className:"hidden"}),E&&c.jsx(ay,{originalTheme:t,setPreviewTheme:n,onClose:w}),c.jsxs("header",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-textPrimary",children:"Seu Painel"}),c.jsxs("p",{className:"text-textSecondary",children:["Bem-vindo, ",r.displayName,"!"]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>N(!0),className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-semibold rounded-lg",children:"Editor de Temas"}),c.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg",children:"Sair"})]})]}),c.jsx("main",{children:c.jsx(WP,{user:r,onSelectCharacter:l,handleImportClick:j,handleDeleteClick:y,handleCreateClick:R,characters:u,isMaster:i,viewingAll:g,onToggleView:m})})]})]})};function pN(t){if(!t)return"55, 65, 81";const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?`${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)}`:"55, 65, 81"}const mN=t=>{const e=document.documentElement;t?(e.style.setProperty("--background-image",t.backgroundImage||"none"),e.style.setProperty("--font-family",t.fontFamily||"ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb",pN(t.colors.bgSurface)),e.style.setProperty("--surface-opacity",(t.surfaceOpacity||80)/100),e.style.setProperty("--color-bgPage",t.colors.bgPage),e.style.setProperty("--color-bgElement",t.colors.bgElement),e.style.setProperty("--color-bgInput",t.colors.bgInput),e.style.setProperty("--color-textPrimary",t.colors.textPrimary),e.style.setProperty("--color-textSecondary",t.colors.textSecondary),e.style.setProperty("--color-borderAccent",t.colors.borderAccent),e.style.setProperty("--color-textAccent",t.colors.textAccent),e.style.setProperty("--color-btnHighlightBg",t.colors.btnHighlightBg),e.style.setProperty("--color-btnHighlightText",t.colors.btnHighlightText)):(e.style.setProperty("--background-image","none"),e.style.setProperty("--font-family","ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb","55, 65, 81"),e.style.setProperty("--surface-opacity","0.8"),e.style.setProperty("--color-bgPage","#111827"),e.style.setProperty("--color-bgElement","#374151"),e.style.setProperty("--color-bgInput","#4b5563"),e.style.setProperty("--color-textPrimary","#f9fafb"),e.style.setProperty("--color-textSecondary","#9ca3af"),e.style.setProperty("--color-borderAccent","#f59e0b"),e.style.setProperty("--color-textAccent","#fcd34d"),e.style.setProperty("--color-btnHighlightBg","#8b5cf6"),e.style.setProperty("--color-btnHighlightText","#ffffff"))};function gN(){const{user:t,loading:e}=ze(),[n,r]=L.useState(null),[s,i]=L.useState(null);return L.useEffect(()=>{const o=s||n;mN(o?o.styles:null)},[n,s]),e?c.jsx("div",{className:"bg-bgPage text-textPrimary min-h-screen flex items-center justify-center",children:c.jsx("h1",{className:"text-3xl",children:"A carregar StoryCraft..."})}):c.jsx("div",{className:"bg-bgPage bg-theme bg-cover bg-center bg-fixed text-textPrimary min-h-screen",children:t?c.jsx(Lw,{children:c.jsxs(kP,{children:[c.jsx(fN,{activeTheme:n,setActiveTheme:r,setPreviewTheme:i}),c.jsx(jP,{})]})}):c.jsx(DP,{})})}Rc.createRoot(document.getElementById("root")).render(c.jsx(ql.StrictMode,{children:c.jsx(EP,{children:c.jsx(Lw,{children:c.jsx(gN,{})})})}));
