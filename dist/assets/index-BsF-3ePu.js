(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Qa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function $E(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var xv={exports:{}},ju={},wv={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ma=Symbol.for("react.element"),HE=Symbol.for("react.portal"),WE=Symbol.for("react.fragment"),qE=Symbol.for("react.strict_mode"),GE=Symbol.for("react.profiler"),KE=Symbol.for("react.provider"),QE=Symbol.for("react.context"),YE=Symbol.for("react.forward_ref"),XE=Symbol.for("react.suspense"),JE=Symbol.for("react.memo"),ZE=Symbol.for("react.lazy"),Dm=Symbol.iterator;function eb(t){return t===null||typeof t!="object"?null:(t=Dm&&t[Dm]||t["@@iterator"],typeof t=="function"?t:null)}var Ev={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bv=Object.assign,Sv={};function ji(t,e,n){this.props=t,this.context=e,this.refs=Sv,this.updater=n||Ev}ji.prototype.isReactComponent={};ji.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ji.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Tv(){}Tv.prototype=ji.prototype;function $h(t,e,n){this.props=t,this.context=e,this.refs=Sv,this.updater=n||Ev}var Hh=$h.prototype=new Tv;Hh.constructor=$h;bv(Hh,ji.prototype);Hh.isPureReactComponent=!0;var jm=Array.isArray,Iv=Object.prototype.hasOwnProperty,Wh={current:null},Cv={key:!0,ref:!0,__self:!0,__source:!0};function Av(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Iv.call(e,r)&&!Cv.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ma,type:t,key:i,ref:o,props:s,_owner:Wh.current}}function tb(t,e){return{$$typeof:ma,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qh(t){return typeof t=="object"&&t!==null&&t.$$typeof===ma}function nb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Om=/\/+/g;function Dc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nb(""+t.key):e.toString(36)}function bl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ma:case HE:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Dc(o,0):r,jm(s)?(n="",t!=null&&(n=t.replace(Om,"$&/")+"/"),bl(s,e,n,"",function(c){return c})):s!=null&&(qh(s)&&(s=tb(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Om,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",jm(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Dc(i,l);o+=bl(i,e,n,u,s)}else if(u=eb(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Dc(i,l++),o+=bl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ya(t,e,n){if(t==null)return t;var r=[],s=0;return bl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function rb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kt={current:null},Sl={transition:null},sb={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:Sl,ReactCurrentOwner:Wh};function Pv(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:Ya,forEach:function(t,e,n){Ya(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ya(t,function(){e++}),e},toArray:function(t){return Ya(t,function(e){return e})||[]},only:function(t){if(!qh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ae.Component=ji;ae.Fragment=WE;ae.Profiler=GE;ae.PureComponent=$h;ae.StrictMode=qE;ae.Suspense=XE;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sb;ae.act=Pv;ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=bv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Wh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Iv.call(e,u)&&!Cv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:ma,type:t.type,key:s,ref:i,props:r,_owner:o}};ae.createContext=function(t){return t={$$typeof:QE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:KE,_context:t},t.Consumer=t};ae.createElement=Av;ae.createFactory=function(t){var e=Av.bind(null,t);return e.type=t,e};ae.createRef=function(){return{current:null}};ae.forwardRef=function(t){return{$$typeof:YE,render:t}};ae.isValidElement=qh;ae.lazy=function(t){return{$$typeof:ZE,_payload:{_status:-1,_result:t},_init:rb}};ae.memo=function(t,e){return{$$typeof:JE,type:t,compare:e===void 0?null:e}};ae.startTransition=function(t){var e=Sl.transition;Sl.transition={};try{t()}finally{Sl.transition=e}};ae.unstable_act=Pv;ae.useCallback=function(t,e){return kt.current.useCallback(t,e)};ae.useContext=function(t){return kt.current.useContext(t)};ae.useDebugValue=function(){};ae.useDeferredValue=function(t){return kt.current.useDeferredValue(t)};ae.useEffect=function(t,e){return kt.current.useEffect(t,e)};ae.useId=function(){return kt.current.useId()};ae.useImperativeHandle=function(t,e,n){return kt.current.useImperativeHandle(t,e,n)};ae.useInsertionEffect=function(t,e){return kt.current.useInsertionEffect(t,e)};ae.useLayoutEffect=function(t,e){return kt.current.useLayoutEffect(t,e)};ae.useMemo=function(t,e){return kt.current.useMemo(t,e)};ae.useReducer=function(t,e,n){return kt.current.useReducer(t,e,n)};ae.useRef=function(t){return kt.current.useRef(t)};ae.useState=function(t){return kt.current.useState(t)};ae.useSyncExternalStore=function(t,e,n){return kt.current.useSyncExternalStore(t,e,n)};ae.useTransition=function(){return kt.current.useTransition()};ae.version="18.3.1";wv.exports=ae;var V=wv.exports;const Gh=Bh(V);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ib=V,ob=Symbol.for("react.element"),ab=Symbol.for("react.fragment"),lb=Object.prototype.hasOwnProperty,ub=ib.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cb={key:!0,ref:!0,__self:!0,__source:!0};function Rv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)lb.call(e,r)&&!cb.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ob,type:t,key:i,ref:o,props:s,_owner:ub.current}}ju.Fragment=ab;ju.jsx=Rv;ju.jsxs=Rv;xv.exports=ju;var d=xv.exports,Td={},Nv={exports:{}},nn={},kv={exports:{}},Dv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,K){var Q=F.length;F.push(K);e:for(;0<Q;){var we=Q-1>>>1,ye=F[we];if(0<s(ye,K))F[we]=K,F[Q]=ye,Q=we;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var K=F[0],Q=F.pop();if(Q!==K){F[0]=Q;e:for(var we=0,ye=F.length,ke=ye>>>1;we<ke;){var sn=2*(we+1)-1,on=F[sn],an=sn+1,$=F[an];if(0>s(on,Q))an<ye&&0>s($,on)?(F[we]=$,F[an]=Q,we=an):(F[we]=on,F[sn]=Q,we=sn);else if(an<ye&&0>s($,Q))F[we]=$,F[an]=Q,we=an;else break e}}return K}function s(F,K){var Q=F.sortIndex-K.sortIndex;return Q!==0?Q:F.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],f=1,p=null,y=3,I=!1,D=!1,E=!1,N=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(F){for(var K=n(c);K!==null;){if(K.callback===null)r(c);else if(K.startTime<=F)r(c),K.sortIndex=K.expirationTime,e(u,K);else break;K=n(c)}}function S(F){if(E=!1,v(F),!D)if(n(u)!==null)D=!0,re(P);else{var K=n(c);K!==null&&oe(S,K.startTime-F)}}function P(F,K){D=!1,E&&(E=!1,b(g),g=-1),I=!0;var Q=y;try{for(v(K),p=n(u);p!==null&&(!(p.expirationTime>K)||F&&!k());){var we=p.callback;if(typeof we=="function"){p.callback=null,y=p.priorityLevel;var ye=we(p.expirationTime<=K);K=t.unstable_now(),typeof ye=="function"?p.callback=ye:p===n(u)&&r(u),v(K)}else r(u);p=n(u)}if(p!==null)var ke=!0;else{var sn=n(c);sn!==null&&oe(S,sn.startTime-K),ke=!1}return ke}finally{p=null,y=Q,I=!1}}var C=!1,x=null,g=-1,_=5,A=-1;function k(){return!(t.unstable_now()-A<_)}function j(){if(x!==null){var F=t.unstable_now();A=F;var K=!0;try{K=x(!0,F)}finally{K?R():(C=!1,x=null)}}else C=!1}var R;if(typeof w=="function")R=function(){w(j)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,ne=H.port2;H.port1.onmessage=j,R=function(){ne.postMessage(null)}}else R=function(){N(j,0)};function re(F){x=F,C||(C=!0,R())}function oe(F,K){g=N(function(){F(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){D||I||(D=!0,re(P))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(F){switch(y){case 1:case 2:case 3:var K=3;break;default:K=y}var Q=y;y=K;try{return F()}finally{y=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,K){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var Q=y;y=F;try{return K()}finally{y=Q}},t.unstable_scheduleCallback=function(F,K,Q){var we=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?we+Q:we):Q=we,F){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=Q+ye,F={id:f++,callback:K,priorityLevel:F,startTime:Q,expirationTime:ye,sortIndex:-1},Q>we?(F.sortIndex=Q,e(c,F),n(u)===null&&F===n(c)&&(E?(b(g),g=-1):E=!0,oe(S,Q-we))):(F.sortIndex=ye,e(u,F),D||I||(D=!0,re(P))),F},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(F){var K=y;return function(){var Q=y;y=K;try{return F.apply(this,arguments)}finally{y=Q}}}})(Dv);kv.exports=Dv;var db=kv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hb=V,tn=db;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jv=new Set,zo={};function Rs(t,e){vi(t,e),vi(t+"Capture",e)}function vi(t,e){for(zo[t]=e,t=0;t<e.length;t++)jv.add(e[t])}var or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Id=Object.prototype.hasOwnProperty,fb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vm={},Mm={};function pb(t){return Id.call(Mm,t)?!0:Id.call(Vm,t)?!1:fb.test(t)?Mm[t]=!0:(Vm[t]=!0,!1)}function mb(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gb(t,e,n,r){if(e===null||typeof e>"u"||mb(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Dt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ft[t]=new Dt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ft[e]=new Dt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ft[t]=new Dt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ft[t]=new Dt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ft[t]=new Dt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ft[t]=new Dt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ft[t]=new Dt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ft[t]=new Dt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ft[t]=new Dt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kh=/[\-:]([a-z])/g;function Qh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kh,Qh);ft[e]=new Dt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kh,Qh);ft[e]=new Dt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kh,Qh);ft[e]=new Dt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ft[t]=new Dt(t,1,!1,t.toLowerCase(),null,!1,!1)});ft.xlinkHref=new Dt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ft[t]=new Dt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Yh(t,e,n,r){var s=ft.hasOwnProperty(e)?ft[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gb(e,n,s,r)&&(n=null),r||s===null?pb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var pr=hb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xa=Symbol.for("react.element"),Ks=Symbol.for("react.portal"),Qs=Symbol.for("react.fragment"),Xh=Symbol.for("react.strict_mode"),Cd=Symbol.for("react.profiler"),Ov=Symbol.for("react.provider"),Vv=Symbol.for("react.context"),Jh=Symbol.for("react.forward_ref"),Ad=Symbol.for("react.suspense"),Pd=Symbol.for("react.suspense_list"),Zh=Symbol.for("react.memo"),Ir=Symbol.for("react.lazy"),Mv=Symbol.for("react.offscreen"),Lm=Symbol.iterator;function so(t){return t===null||typeof t!="object"?null:(t=Lm&&t[Lm]||t["@@iterator"],typeof t=="function"?t:null)}var Me=Object.assign,jc;function _o(t){if(jc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);jc=e&&e[1]||""}return`
`+jc+t}var Oc=!1;function Vc(t,e){if(!t||Oc)return"";Oc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Oc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?_o(t):""}function yb(t){switch(t.tag){case 5:return _o(t.type);case 16:return _o("Lazy");case 13:return _o("Suspense");case 19:return _o("SuspenseList");case 0:case 2:case 15:return t=Vc(t.type,!1),t;case 11:return t=Vc(t.type.render,!1),t;case 1:return t=Vc(t.type,!0),t;default:return""}}function Rd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qs:return"Fragment";case Ks:return"Portal";case Cd:return"Profiler";case Xh:return"StrictMode";case Ad:return"Suspense";case Pd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vv:return(t.displayName||"Context")+".Consumer";case Ov:return(t._context.displayName||"Context")+".Provider";case Jh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Zh:return e=t.displayName||null,e!==null?e:Rd(t.type)||"Memo";case Ir:e=t._payload,t=t._init;try{return Rd(t(e))}catch{}}return null}function vb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Rd(e);case 8:return e===Xh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Kr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Lv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _b(t){var e=Lv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ja(t){t._valueTracker||(t._valueTracker=_b(t))}function Fv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Lv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ql(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Nd(t,e){var n=e.checked;return Me({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Fm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Kr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Uv(t,e){e=e.checked,e!=null&&Yh(t,"checked",e,!1)}function kd(t,e){Uv(t,e);var n=Kr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Dd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Dd(t,e.type,Kr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Um(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Dd(t,e,n){(e!=="number"||ql(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var xo=Array.isArray;function li(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Kr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function jd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return Me({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function zm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(xo(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Kr(n)}}function zv(t,e){var n=Kr(e.value),r=Kr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Bm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Bv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Od(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Bv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Za,$v=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Za=Za||document.createElement("div"),Za.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Za.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Co={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xb=["Webkit","ms","Moz","O"];Object.keys(Co).forEach(function(t){xb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Co[e]=Co[t]})});function Hv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Co.hasOwnProperty(t)&&Co[t]?(""+e).trim():e+"px"}function Wv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Hv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var wb=Me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vd(t,e){if(e){if(wb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function Md(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ld=null;function ef(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fd=null,ui=null,ci=null;function $m(t){if(t=va(t)){if(typeof Fd!="function")throw Error(z(280));var e=t.stateNode;e&&(e=Fu(e),Fd(t.stateNode,t.type,e))}}function qv(t){ui?ci?ci.push(t):ci=[t]:ui=t}function Gv(){if(ui){var t=ui,e=ci;if(ci=ui=null,$m(t),e)for(t=0;t<e.length;t++)$m(e[t])}}function Kv(t,e){return t(e)}function Qv(){}var Mc=!1;function Yv(t,e,n){if(Mc)return t(e,n);Mc=!0;try{return Kv(t,e,n)}finally{Mc=!1,(ui!==null||ci!==null)&&(Qv(),Gv())}}function $o(t,e){var n=t.stateNode;if(n===null)return null;var r=Fu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var Ud=!1;if(or)try{var io={};Object.defineProperty(io,"passive",{get:function(){Ud=!0}}),window.addEventListener("test",io,io),window.removeEventListener("test",io,io)}catch{Ud=!1}function Eb(t,e,n,r,s,i,o,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(f){this.onError(f)}}var Ao=!1,Gl=null,Kl=!1,zd=null,bb={onError:function(t){Ao=!0,Gl=t}};function Sb(t,e,n,r,s,i,o,l,u){Ao=!1,Gl=null,Eb.apply(bb,arguments)}function Tb(t,e,n,r,s,i,o,l,u){if(Sb.apply(this,arguments),Ao){if(Ao){var c=Gl;Ao=!1,Gl=null}else throw Error(z(198));Kl||(Kl=!0,zd=c)}}function Ns(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Xv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Hm(t){if(Ns(t)!==t)throw Error(z(188))}function Ib(t){var e=t.alternate;if(!e){if(e=Ns(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Hm(s),t;if(i===r)return Hm(s),e;i=i.sibling}throw Error(z(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function Jv(t){return t=Ib(t),t!==null?Zv(t):null}function Zv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Zv(t);if(e!==null)return e;t=t.sibling}return null}var e_=tn.unstable_scheduleCallback,Wm=tn.unstable_cancelCallback,Cb=tn.unstable_shouldYield,Ab=tn.unstable_requestPaint,He=tn.unstable_now,Pb=tn.unstable_getCurrentPriorityLevel,tf=tn.unstable_ImmediatePriority,t_=tn.unstable_UserBlockingPriority,Ql=tn.unstable_NormalPriority,Rb=tn.unstable_LowPriority,n_=tn.unstable_IdlePriority,Ou=null,Mn=null;function Nb(t){if(Mn&&typeof Mn.onCommitFiberRoot=="function")try{Mn.onCommitFiberRoot(Ou,t,void 0,(t.current.flags&128)===128)}catch{}}var Tn=Math.clz32?Math.clz32:jb,kb=Math.log,Db=Math.LN2;function jb(t){return t>>>=0,t===0?32:31-(kb(t)/Db|0)|0}var el=64,tl=4194304;function wo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Yl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=wo(l):(i&=o,i!==0&&(r=wo(i)))}else o=n&~s,o!==0?r=wo(o):i!==0&&(r=wo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Tn(e),s=1<<n,r|=t[n],e&=~s;return r}function Ob(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vb(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Tn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=Ob(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Bd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function r_(){var t=el;return el<<=1,!(el&4194240)&&(el=64),t}function Lc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ga(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Tn(e),t[e]=n}function Mb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Tn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function nf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Tn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var _e=0;function s_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var i_,rf,o_,a_,l_,$d=!1,nl=[],Vr=null,Mr=null,Lr=null,Ho=new Map,Wo=new Map,Ar=[],Lb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qm(t,e){switch(t){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":Mr=null;break;case"mouseover":case"mouseout":Lr=null;break;case"pointerover":case"pointerout":Ho.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wo.delete(e.pointerId)}}function oo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=va(e),e!==null&&rf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Fb(t,e,n,r,s){switch(e){case"focusin":return Vr=oo(Vr,t,e,n,r,s),!0;case"dragenter":return Mr=oo(Mr,t,e,n,r,s),!0;case"mouseover":return Lr=oo(Lr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ho.set(i,oo(Ho.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Wo.set(i,oo(Wo.get(i)||null,t,e,n,r,s)),!0}return!1}function u_(t){var e=cs(t.target);if(e!==null){var n=Ns(e);if(n!==null){if(e=n.tag,e===13){if(e=Xv(n),e!==null){t.blockedOn=e,l_(t.priority,function(){o_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Tl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Hd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ld=r,n.target.dispatchEvent(r),Ld=null}else return e=va(n),e!==null&&rf(e),t.blockedOn=n,!1;e.shift()}return!0}function Gm(t,e,n){Tl(t)&&n.delete(e)}function Ub(){$d=!1,Vr!==null&&Tl(Vr)&&(Vr=null),Mr!==null&&Tl(Mr)&&(Mr=null),Lr!==null&&Tl(Lr)&&(Lr=null),Ho.forEach(Gm),Wo.forEach(Gm)}function ao(t,e){t.blockedOn===e&&(t.blockedOn=null,$d||($d=!0,tn.unstable_scheduleCallback(tn.unstable_NormalPriority,Ub)))}function qo(t){function e(s){return ao(s,t)}if(0<nl.length){ao(nl[0],t);for(var n=1;n<nl.length;n++){var r=nl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Vr!==null&&ao(Vr,t),Mr!==null&&ao(Mr,t),Lr!==null&&ao(Lr,t),Ho.forEach(e),Wo.forEach(e),n=0;n<Ar.length;n++)r=Ar[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ar.length&&(n=Ar[0],n.blockedOn===null);)u_(n),n.blockedOn===null&&Ar.shift()}var di=pr.ReactCurrentBatchConfig,Xl=!0;function zb(t,e,n,r){var s=_e,i=di.transition;di.transition=null;try{_e=1,sf(t,e,n,r)}finally{_e=s,di.transition=i}}function Bb(t,e,n,r){var s=_e,i=di.transition;di.transition=null;try{_e=4,sf(t,e,n,r)}finally{_e=s,di.transition=i}}function sf(t,e,n,r){if(Xl){var s=Hd(t,e,n,r);if(s===null)Kc(t,e,r,Jl,n),qm(t,r);else if(Fb(s,t,e,n,r))r.stopPropagation();else if(qm(t,r),e&4&&-1<Lb.indexOf(t)){for(;s!==null;){var i=va(s);if(i!==null&&i_(i),i=Hd(t,e,n,r),i===null&&Kc(t,e,r,Jl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Kc(t,e,r,null,n)}}var Jl=null;function Hd(t,e,n,r){if(Jl=null,t=ef(r),t=cs(t),t!==null)if(e=Ns(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Xv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Jl=t,null}function c_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Pb()){case tf:return 1;case t_:return 4;case Ql:case Rb:return 16;case n_:return 536870912;default:return 16}default:return 16}}var Dr=null,of=null,Il=null;function d_(){if(Il)return Il;var t,e=of,n=e.length,r,s="value"in Dr?Dr.value:Dr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Il=s.slice(t,1<r?1-r:void 0)}function Cl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function rl(){return!0}function Km(){return!1}function rn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?rl:Km,this.isPropagationStopped=Km,this}return Me(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=rl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=rl)},persist:function(){},isPersistent:rl}),e}var Oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},af=rn(Oi),ya=Me({},Oi,{view:0,detail:0}),$b=rn(ya),Fc,Uc,lo,Vu=Me({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==lo&&(lo&&t.type==="mousemove"?(Fc=t.screenX-lo.screenX,Uc=t.screenY-lo.screenY):Uc=Fc=0,lo=t),Fc)},movementY:function(t){return"movementY"in t?t.movementY:Uc}}),Qm=rn(Vu),Hb=Me({},Vu,{dataTransfer:0}),Wb=rn(Hb),qb=Me({},ya,{relatedTarget:0}),zc=rn(qb),Gb=Me({},Oi,{animationName:0,elapsedTime:0,pseudoElement:0}),Kb=rn(Gb),Qb=Me({},Oi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Yb=rn(Qb),Xb=Me({},Oi,{data:0}),Ym=rn(Xb),Jb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eS[t])?!!e[t]:!1}function lf(){return tS}var nS=Me({},ya,{key:function(t){if(t.key){var e=Jb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Cl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Zb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lf,charCode:function(t){return t.type==="keypress"?Cl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Cl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rS=rn(nS),sS=Me({},Vu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xm=rn(sS),iS=Me({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lf}),oS=rn(iS),aS=Me({},Oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),lS=rn(aS),uS=Me({},Vu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),cS=rn(uS),dS=[9,13,27,32],uf=or&&"CompositionEvent"in window,Po=null;or&&"documentMode"in document&&(Po=document.documentMode);var hS=or&&"TextEvent"in window&&!Po,h_=or&&(!uf||Po&&8<Po&&11>=Po),Jm=" ",Zm=!1;function f_(t,e){switch(t){case"keyup":return dS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ys=!1;function fS(t,e){switch(t){case"compositionend":return p_(e);case"keypress":return e.which!==32?null:(Zm=!0,Jm);case"textInput":return t=e.data,t===Jm&&Zm?null:t;default:return null}}function pS(t,e){if(Ys)return t==="compositionend"||!uf&&f_(t,e)?(t=d_(),Il=of=Dr=null,Ys=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return h_&&e.locale!=="ko"?null:e.data;default:return null}}var mS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!mS[t.type]:e==="textarea"}function m_(t,e,n,r){qv(r),e=Zl(e,"onChange"),0<e.length&&(n=new af("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ro=null,Go=null;function gS(t){I_(t,0)}function Mu(t){var e=Zs(t);if(Fv(e))return t}function yS(t,e){if(t==="change")return e}var g_=!1;if(or){var Bc;if(or){var $c="oninput"in document;if(!$c){var tg=document.createElement("div");tg.setAttribute("oninput","return;"),$c=typeof tg.oninput=="function"}Bc=$c}else Bc=!1;g_=Bc&&(!document.documentMode||9<document.documentMode)}function ng(){Ro&&(Ro.detachEvent("onpropertychange",y_),Go=Ro=null)}function y_(t){if(t.propertyName==="value"&&Mu(Go)){var e=[];m_(e,Go,t,ef(t)),Yv(gS,e)}}function vS(t,e,n){t==="focusin"?(ng(),Ro=e,Go=n,Ro.attachEvent("onpropertychange",y_)):t==="focusout"&&ng()}function _S(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Mu(Go)}function xS(t,e){if(t==="click")return Mu(e)}function wS(t,e){if(t==="input"||t==="change")return Mu(e)}function ES(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Pn=typeof Object.is=="function"?Object.is:ES;function Ko(t,e){if(Pn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Id.call(e,s)||!Pn(t[s],e[s]))return!1}return!0}function rg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function sg(t,e){var n=rg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=rg(n)}}function v_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?v_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function __(){for(var t=window,e=ql();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ql(t.document)}return e}function cf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function bS(t){var e=__(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&v_(n.ownerDocument.documentElement,n)){if(r!==null&&cf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=sg(n,i);var o=sg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var SS=or&&"documentMode"in document&&11>=document.documentMode,Xs=null,Wd=null,No=null,qd=!1;function ig(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qd||Xs==null||Xs!==ql(r)||(r=Xs,"selectionStart"in r&&cf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),No&&Ko(No,r)||(No=r,r=Zl(Wd,"onSelect"),0<r.length&&(e=new af("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xs)))}function sl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Js={animationend:sl("Animation","AnimationEnd"),animationiteration:sl("Animation","AnimationIteration"),animationstart:sl("Animation","AnimationStart"),transitionend:sl("Transition","TransitionEnd")},Hc={},x_={};or&&(x_=document.createElement("div").style,"AnimationEvent"in window||(delete Js.animationend.animation,delete Js.animationiteration.animation,delete Js.animationstart.animation),"TransitionEvent"in window||delete Js.transitionend.transition);function Lu(t){if(Hc[t])return Hc[t];if(!Js[t])return t;var e=Js[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in x_)return Hc[t]=e[n];return t}var w_=Lu("animationend"),E_=Lu("animationiteration"),b_=Lu("animationstart"),S_=Lu("transitionend"),T_=new Map,og="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(t,e){T_.set(t,e),Rs(e,[t])}for(var Wc=0;Wc<og.length;Wc++){var qc=og[Wc],TS=qc.toLowerCase(),IS=qc[0].toUpperCase()+qc.slice(1);es(TS,"on"+IS)}es(w_,"onAnimationEnd");es(E_,"onAnimationIteration");es(b_,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(S_,"onTransitionEnd");vi("onMouseEnter",["mouseout","mouseover"]);vi("onMouseLeave",["mouseout","mouseover"]);vi("onPointerEnter",["pointerout","pointerover"]);vi("onPointerLeave",["pointerout","pointerover"]);Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Eo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Eo));function ag(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Tb(r,e,void 0,t),t.currentTarget=null}function I_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;ag(s,l,c),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,c=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;ag(s,l,c),i=u}}}if(Kl)throw t=zd,Kl=!1,zd=null,t}function Ae(t,e){var n=e[Xd];n===void 0&&(n=e[Xd]=new Set);var r=t+"__bubble";n.has(r)||(C_(e,t,2,!1),n.add(r))}function Gc(t,e,n){var r=0;e&&(r|=4),C_(n,t,r,e)}var il="_reactListening"+Math.random().toString(36).slice(2);function Qo(t){if(!t[il]){t[il]=!0,jv.forEach(function(n){n!=="selectionchange"&&(CS.has(n)||Gc(n,!1,t),Gc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[il]||(e[il]=!0,Gc("selectionchange",!1,e))}}function C_(t,e,n,r){switch(c_(e)){case 1:var s=zb;break;case 4:s=Bb;break;default:s=sf}n=s.bind(null,e,n,t),s=void 0,!Ud||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Kc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=cs(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Yv(function(){var c=i,f=ef(n),p=[];e:{var y=T_.get(t);if(y!==void 0){var I=af,D=t;switch(t){case"keypress":if(Cl(n)===0)break e;case"keydown":case"keyup":I=rS;break;case"focusin":D="focus",I=zc;break;case"focusout":D="blur",I=zc;break;case"beforeblur":case"afterblur":I=zc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=Qm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=Wb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=oS;break;case w_:case E_:case b_:I=Kb;break;case S_:I=lS;break;case"scroll":I=$b;break;case"wheel":I=cS;break;case"copy":case"cut":case"paste":I=Yb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Xm}var E=(e&4)!==0,N=!E&&t==="scroll",b=E?y!==null?y+"Capture":null:y;E=[];for(var w=c,v;w!==null;){v=w;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,b!==null&&(S=$o(w,b),S!=null&&E.push(Yo(w,S,v)))),N)break;w=w.return}0<E.length&&(y=new I(y,D,null,n,f),p.push({event:y,listeners:E}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",y&&n!==Ld&&(D=n.relatedTarget||n.fromElement)&&(cs(D)||D[ar]))break e;if((I||y)&&(y=f.window===f?f:(y=f.ownerDocument)?y.defaultView||y.parentWindow:window,I?(D=n.relatedTarget||n.toElement,I=c,D=D?cs(D):null,D!==null&&(N=Ns(D),D!==N||D.tag!==5&&D.tag!==6)&&(D=null)):(I=null,D=c),I!==D)){if(E=Qm,S="onMouseLeave",b="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(E=Xm,S="onPointerLeave",b="onPointerEnter",w="pointer"),N=I==null?y:Zs(I),v=D==null?y:Zs(D),y=new E(S,w+"leave",I,n,f),y.target=N,y.relatedTarget=v,S=null,cs(f)===c&&(E=new E(b,w+"enter",D,n,f),E.target=v,E.relatedTarget=N,S=E),N=S,I&&D)t:{for(E=I,b=D,w=0,v=E;v;v=$s(v))w++;for(v=0,S=b;S;S=$s(S))v++;for(;0<w-v;)E=$s(E),w--;for(;0<v-w;)b=$s(b),v--;for(;w--;){if(E===b||b!==null&&E===b.alternate)break t;E=$s(E),b=$s(b)}E=null}else E=null;I!==null&&lg(p,y,I,E,!1),D!==null&&N!==null&&lg(p,N,D,E,!0)}}e:{if(y=c?Zs(c):window,I=y.nodeName&&y.nodeName.toLowerCase(),I==="select"||I==="input"&&y.type==="file")var P=yS;else if(eg(y))if(g_)P=wS;else{P=_S;var C=vS}else(I=y.nodeName)&&I.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(P=xS);if(P&&(P=P(t,c))){m_(p,P,n,f);break e}C&&C(t,y,c),t==="focusout"&&(C=y._wrapperState)&&C.controlled&&y.type==="number"&&Dd(y,"number",y.value)}switch(C=c?Zs(c):window,t){case"focusin":(eg(C)||C.contentEditable==="true")&&(Xs=C,Wd=c,No=null);break;case"focusout":No=Wd=Xs=null;break;case"mousedown":qd=!0;break;case"contextmenu":case"mouseup":case"dragend":qd=!1,ig(p,n,f);break;case"selectionchange":if(SS)break;case"keydown":case"keyup":ig(p,n,f)}var x;if(uf)e:{switch(t){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else Ys?f_(t,n)&&(g="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(g="onCompositionStart");g&&(h_&&n.locale!=="ko"&&(Ys||g!=="onCompositionStart"?g==="onCompositionEnd"&&Ys&&(x=d_()):(Dr=f,of="value"in Dr?Dr.value:Dr.textContent,Ys=!0)),C=Zl(c,g),0<C.length&&(g=new Ym(g,t,null,n,f),p.push({event:g,listeners:C}),x?g.data=x:(x=p_(n),x!==null&&(g.data=x)))),(x=hS?fS(t,n):pS(t,n))&&(c=Zl(c,"onBeforeInput"),0<c.length&&(f=new Ym("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:c}),f.data=x))}I_(p,e)})}function Yo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=$o(t,n),i!=null&&r.unshift(Yo(t,i,s)),i=$o(t,e),i!=null&&r.push(Yo(t,i,s))),t=t.return}return r}function $s(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function lg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,s?(u=$o(n,i),u!=null&&o.unshift(Yo(n,u,l))):s||(u=$o(n,i),u!=null&&o.push(Yo(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var AS=/\r\n?/g,PS=/\u0000|\uFFFD/g;function ug(t){return(typeof t=="string"?t:""+t).replace(AS,`
`).replace(PS,"")}function ol(t,e,n){if(e=ug(e),ug(t)!==e&&n)throw Error(z(425))}function eu(){}var Gd=null,Kd=null;function Qd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Yd=typeof setTimeout=="function"?setTimeout:void 0,RS=typeof clearTimeout=="function"?clearTimeout:void 0,cg=typeof Promise=="function"?Promise:void 0,NS=typeof queueMicrotask=="function"?queueMicrotask:typeof cg<"u"?function(t){return cg.resolve(null).then(t).catch(kS)}:Yd;function kS(t){setTimeout(function(){throw t})}function Qc(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),qo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);qo(e)}function Fr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function dg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Vi=Math.random().toString(36).slice(2),Vn="__reactFiber$"+Vi,Xo="__reactProps$"+Vi,ar="__reactContainer$"+Vi,Xd="__reactEvents$"+Vi,DS="__reactListeners$"+Vi,jS="__reactHandles$"+Vi;function cs(t){var e=t[Vn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ar]||n[Vn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=dg(t);t!==null;){if(n=t[Vn])return n;t=dg(t)}return e}t=n,n=t.parentNode}return null}function va(t){return t=t[Vn]||t[ar],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function Fu(t){return t[Xo]||null}var Jd=[],ei=-1;function ts(t){return{current:t}}function Re(t){0>ei||(t.current=Jd[ei],Jd[ei]=null,ei--)}function Se(t,e){ei++,Jd[ei]=t.current,t.current=e}var Qr={},St=ts(Qr),Ft=ts(!1),xs=Qr;function _i(t,e){var n=t.type.contextTypes;if(!n)return Qr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ut(t){return t=t.childContextTypes,t!=null}function tu(){Re(Ft),Re(St)}function hg(t,e,n){if(St.current!==Qr)throw Error(z(168));Se(St,e),Se(Ft,n)}function A_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(z(108,vb(t)||"Unknown",s));return Me({},n,r)}function nu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Qr,xs=St.current,Se(St,t),Se(Ft,Ft.current),!0}function fg(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=A_(t,e,xs),r.__reactInternalMemoizedMergedChildContext=t,Re(Ft),Re(St),Se(St,t)):Re(Ft),Se(Ft,n)}var Yn=null,Uu=!1,Yc=!1;function P_(t){Yn===null?Yn=[t]:Yn.push(t)}function OS(t){Uu=!0,P_(t)}function ns(){if(!Yc&&Yn!==null){Yc=!0;var t=0,e=_e;try{var n=Yn;for(_e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Yn=null,Uu=!1}catch(s){throw Yn!==null&&(Yn=Yn.slice(t+1)),e_(tf,ns),s}finally{_e=e,Yc=!1}}return null}var ti=[],ni=0,ru=null,su=0,un=[],cn=0,ws=null,Jn=1,Zn="";function as(t,e){ti[ni++]=su,ti[ni++]=ru,ru=t,su=e}function R_(t,e,n){un[cn++]=Jn,un[cn++]=Zn,un[cn++]=ws,ws=t;var r=Jn;t=Zn;var s=32-Tn(r)-1;r&=~(1<<s),n+=1;var i=32-Tn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Jn=1<<32-Tn(e)+s|n<<s|r,Zn=i+t}else Jn=1<<i|n<<s|r,Zn=t}function df(t){t.return!==null&&(as(t,1),R_(t,1,0))}function hf(t){for(;t===ru;)ru=ti[--ni],ti[ni]=null,su=ti[--ni],ti[ni]=null;for(;t===ws;)ws=un[--cn],un[cn]=null,Zn=un[--cn],un[cn]=null,Jn=un[--cn],un[cn]=null}var Jt=null,Xt=null,je=!1,bn=null;function N_(t,e){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function pg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jt=t,Xt=Fr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jt=t,Xt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ws!==null?{id:Jn,overflow:Zn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Jt=t,Xt=null,!0):!1;default:return!1}}function Zd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function eh(t){if(je){var e=Xt;if(e){var n=e;if(!pg(t,e)){if(Zd(t))throw Error(z(418));e=Fr(n.nextSibling);var r=Jt;e&&pg(t,e)?N_(r,n):(t.flags=t.flags&-4097|2,je=!1,Jt=t)}}else{if(Zd(t))throw Error(z(418));t.flags=t.flags&-4097|2,je=!1,Jt=t}}}function mg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jt=t}function al(t){if(t!==Jt)return!1;if(!je)return mg(t),je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Qd(t.type,t.memoizedProps)),e&&(e=Xt)){if(Zd(t))throw k_(),Error(z(418));for(;e;)N_(t,e),e=Fr(e.nextSibling)}if(mg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Xt=Fr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Xt=null}}else Xt=Jt?Fr(t.stateNode.nextSibling):null;return!0}function k_(){for(var t=Xt;t;)t=Fr(t.nextSibling)}function xi(){Xt=Jt=null,je=!1}function ff(t){bn===null?bn=[t]:bn.push(t)}var VS=pr.ReactCurrentBatchConfig;function uo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function ll(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function gg(t){var e=t._init;return e(t._payload)}function D_(t){function e(b,w){if(t){var v=b.deletions;v===null?(b.deletions=[w],b.flags|=16):v.push(w)}}function n(b,w){if(!t)return null;for(;w!==null;)e(b,w),w=w.sibling;return null}function r(b,w){for(b=new Map;w!==null;)w.key!==null?b.set(w.key,w):b.set(w.index,w),w=w.sibling;return b}function s(b,w){return b=$r(b,w),b.index=0,b.sibling=null,b}function i(b,w,v){return b.index=v,t?(v=b.alternate,v!==null?(v=v.index,v<w?(b.flags|=2,w):v):(b.flags|=2,w)):(b.flags|=1048576,w)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,w,v,S){return w===null||w.tag!==6?(w=rd(v,b.mode,S),w.return=b,w):(w=s(w,v),w.return=b,w)}function u(b,w,v,S){var P=v.type;return P===Qs?f(b,w,v.props.children,S,v.key):w!==null&&(w.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ir&&gg(P)===w.type)?(S=s(w,v.props),S.ref=uo(b,w,v),S.return=b,S):(S=jl(v.type,v.key,v.props,null,b.mode,S),S.ref=uo(b,w,v),S.return=b,S)}function c(b,w,v,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=sd(v,b.mode,S),w.return=b,w):(w=s(w,v.children||[]),w.return=b,w)}function f(b,w,v,S,P){return w===null||w.tag!==7?(w=gs(v,b.mode,S,P),w.return=b,w):(w=s(w,v),w.return=b,w)}function p(b,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=rd(""+w,b.mode,v),w.return=b,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Xa:return v=jl(w.type,w.key,w.props,null,b.mode,v),v.ref=uo(b,null,w),v.return=b,v;case Ks:return w=sd(w,b.mode,v),w.return=b,w;case Ir:var S=w._init;return p(b,S(w._payload),v)}if(xo(w)||so(w))return w=gs(w,b.mode,v,null),w.return=b,w;ll(b,w)}return null}function y(b,w,v,S){var P=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return P!==null?null:l(b,w,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Xa:return v.key===P?u(b,w,v,S):null;case Ks:return v.key===P?c(b,w,v,S):null;case Ir:return P=v._init,y(b,w,P(v._payload),S)}if(xo(v)||so(v))return P!==null?null:f(b,w,v,S,null);ll(b,v)}return null}function I(b,w,v,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(v)||null,l(w,b,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Xa:return b=b.get(S.key===null?v:S.key)||null,u(w,b,S,P);case Ks:return b=b.get(S.key===null?v:S.key)||null,c(w,b,S,P);case Ir:var C=S._init;return I(b,w,v,C(S._payload),P)}if(xo(S)||so(S))return b=b.get(v)||null,f(w,b,S,P,null);ll(w,S)}return null}function D(b,w,v,S){for(var P=null,C=null,x=w,g=w=0,_=null;x!==null&&g<v.length;g++){x.index>g?(_=x,x=null):_=x.sibling;var A=y(b,x,v[g],S);if(A===null){x===null&&(x=_);break}t&&x&&A.alternate===null&&e(b,x),w=i(A,w,g),C===null?P=A:C.sibling=A,C=A,x=_}if(g===v.length)return n(b,x),je&&as(b,g),P;if(x===null){for(;g<v.length;g++)x=p(b,v[g],S),x!==null&&(w=i(x,w,g),C===null?P=x:C.sibling=x,C=x);return je&&as(b,g),P}for(x=r(b,x);g<v.length;g++)_=I(x,b,g,v[g],S),_!==null&&(t&&_.alternate!==null&&x.delete(_.key===null?g:_.key),w=i(_,w,g),C===null?P=_:C.sibling=_,C=_);return t&&x.forEach(function(k){return e(b,k)}),je&&as(b,g),P}function E(b,w,v,S){var P=so(v);if(typeof P!="function")throw Error(z(150));if(v=P.call(v),v==null)throw Error(z(151));for(var C=P=null,x=w,g=w=0,_=null,A=v.next();x!==null&&!A.done;g++,A=v.next()){x.index>g?(_=x,x=null):_=x.sibling;var k=y(b,x,A.value,S);if(k===null){x===null&&(x=_);break}t&&x&&k.alternate===null&&e(b,x),w=i(k,w,g),C===null?P=k:C.sibling=k,C=k,x=_}if(A.done)return n(b,x),je&&as(b,g),P;if(x===null){for(;!A.done;g++,A=v.next())A=p(b,A.value,S),A!==null&&(w=i(A,w,g),C===null?P=A:C.sibling=A,C=A);return je&&as(b,g),P}for(x=r(b,x);!A.done;g++,A=v.next())A=I(x,b,g,A.value,S),A!==null&&(t&&A.alternate!==null&&x.delete(A.key===null?g:A.key),w=i(A,w,g),C===null?P=A:C.sibling=A,C=A);return t&&x.forEach(function(j){return e(b,j)}),je&&as(b,g),P}function N(b,w,v,S){if(typeof v=="object"&&v!==null&&v.type===Qs&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Xa:e:{for(var P=v.key,C=w;C!==null;){if(C.key===P){if(P=v.type,P===Qs){if(C.tag===7){n(b,C.sibling),w=s(C,v.props.children),w.return=b,b=w;break e}}else if(C.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ir&&gg(P)===C.type){n(b,C.sibling),w=s(C,v.props),w.ref=uo(b,C,v),w.return=b,b=w;break e}n(b,C);break}else e(b,C);C=C.sibling}v.type===Qs?(w=gs(v.props.children,b.mode,S,v.key),w.return=b,b=w):(S=jl(v.type,v.key,v.props,null,b.mode,S),S.ref=uo(b,w,v),S.return=b,b=S)}return o(b);case Ks:e:{for(C=v.key;w!==null;){if(w.key===C)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){n(b,w.sibling),w=s(w,v.children||[]),w.return=b,b=w;break e}else{n(b,w);break}else e(b,w);w=w.sibling}w=sd(v,b.mode,S),w.return=b,b=w}return o(b);case Ir:return C=v._init,N(b,w,C(v._payload),S)}if(xo(v))return D(b,w,v,S);if(so(v))return E(b,w,v,S);ll(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(n(b,w.sibling),w=s(w,v),w.return=b,b=w):(n(b,w),w=rd(v,b.mode,S),w.return=b,b=w),o(b)):n(b,w)}return N}var wi=D_(!0),j_=D_(!1),iu=ts(null),ou=null,ri=null,pf=null;function mf(){pf=ri=ou=null}function gf(t){var e=iu.current;Re(iu),t._currentValue=e}function th(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function hi(t,e){ou=t,pf=ri=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Lt=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(pf!==t)if(t={context:t,memoizedValue:e,next:null},ri===null){if(ou===null)throw Error(z(308));ri=t,ou.dependencies={lanes:0,firstContext:t}}else ri=ri.next=t;return e}var ds=null;function yf(t){ds===null?ds=[t]:ds.push(t)}function O_(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,yf(e)):(n.next=s.next,s.next=n),e.interleaved=n,lr(t,r)}function lr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Cr=!1;function vf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function V_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function sr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ur(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,he&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,lr(t,n)}return s=r.interleaved,s===null?(e.next=e,yf(r)):(e.next=s.next,s.next=e),r.interleaved=e,lr(t,n)}function Al(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,nf(t,n)}}function yg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function au(t,e,n,r){var s=t.updateQueue;Cr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=c:l.next=c,f.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;o=0,f=c=u=null,l=i;do{var y=l.lane,I=l.eventTime;if((r&y)===y){f!==null&&(f=f.next={eventTime:I,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var D=t,E=l;switch(y=e,I=n,E.tag){case 1:if(D=E.payload,typeof D=="function"){p=D.call(I,p,y);break e}p=D;break e;case 3:D.flags=D.flags&-65537|128;case 0:if(D=E.payload,y=typeof D=="function"?D.call(I,p,y):D,y==null)break e;p=Me({},p,y);break e;case 2:Cr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else I={eventTime:I,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(c=f=I,u=p):f=f.next=I,o|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(f===null&&(u=p),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);bs|=o,t.lanes=o,t.memoizedState=p}}function vg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(z(191,s));s.call(r)}}}var _a={},Ln=ts(_a),Jo=ts(_a),Zo=ts(_a);function hs(t){if(t===_a)throw Error(z(174));return t}function _f(t,e){switch(Se(Zo,e),Se(Jo,t),Se(Ln,_a),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Od(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Od(e,t)}Re(Ln),Se(Ln,e)}function Ei(){Re(Ln),Re(Jo),Re(Zo)}function M_(t){hs(Zo.current);var e=hs(Ln.current),n=Od(e,t.type);e!==n&&(Se(Jo,t),Se(Ln,n))}function xf(t){Jo.current===t&&(Re(Ln),Re(Jo))}var Oe=ts(0);function lu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Xc=[];function wf(){for(var t=0;t<Xc.length;t++)Xc[t]._workInProgressVersionPrimary=null;Xc.length=0}var Pl=pr.ReactCurrentDispatcher,Jc=pr.ReactCurrentBatchConfig,Es=0,Ve=null,Je=null,st=null,uu=!1,ko=!1,ea=0,MS=0;function yt(){throw Error(z(321))}function Ef(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Pn(t[n],e[n]))return!1;return!0}function bf(t,e,n,r,s,i){if(Es=i,Ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pl.current=t===null||t.memoizedState===null?zS:BS,t=n(r,s),ko){i=0;do{if(ko=!1,ea=0,25<=i)throw Error(z(301));i+=1,st=Je=null,e.updateQueue=null,Pl.current=$S,t=n(r,s)}while(ko)}if(Pl.current=cu,e=Je!==null&&Je.next!==null,Es=0,st=Je=Ve=null,uu=!1,e)throw Error(z(300));return t}function Sf(){var t=ea!==0;return ea=0,t}function jn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Ve.memoizedState=st=t:st=st.next=t,st}function gn(){if(Je===null){var t=Ve.alternate;t=t!==null?t.memoizedState:null}else t=Je.next;var e=st===null?Ve.memoizedState:st.next;if(e!==null)st=e,Je=t;else{if(t===null)throw Error(z(310));Je=t,t={memoizedState:Je.memoizedState,baseState:Je.baseState,baseQueue:Je.baseQueue,queue:Je.queue,next:null},st===null?Ve.memoizedState=st=t:st=st.next=t}return st}function ta(t,e){return typeof e=="function"?e(t):e}function Zc(t){var e=gn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=Je,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,c=i;do{var f=c.lane;if((Es&f)===f)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var p={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=p,o=r):u=u.next=p,Ve.lanes|=f,bs|=f}c=c.next}while(c!==null&&c!==i);u===null?o=r:u.next=l,Pn(r,e.memoizedState)||(Lt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ve.lanes|=i,bs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ed(t){var e=gn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Pn(i,e.memoizedState)||(Lt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function L_(){}function F_(t,e){var n=Ve,r=gn(),s=e(),i=!Pn(r.memoizedState,s);if(i&&(r.memoizedState=s,Lt=!0),r=r.queue,Tf(B_.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||st!==null&&st.memoizedState.tag&1){if(n.flags|=2048,na(9,z_.bind(null,n,r,s,e),void 0,null),it===null)throw Error(z(349));Es&30||U_(n,e,s)}return s}function U_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function z_(t,e,n,r){e.value=n,e.getSnapshot=r,$_(e)&&H_(t)}function B_(t,e,n){return n(function(){$_(e)&&H_(t)})}function $_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Pn(t,n)}catch{return!0}}function H_(t){var e=lr(t,1);e!==null&&In(e,t,1,-1)}function _g(t){var e=jn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ta,lastRenderedState:t},e.queue=t,t=t.dispatch=US.bind(null,Ve,t),[e.memoizedState,t]}function na(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function W_(){return gn().memoizedState}function Rl(t,e,n,r){var s=jn();Ve.flags|=t,s.memoizedState=na(1|e,n,void 0,r===void 0?null:r)}function zu(t,e,n,r){var s=gn();r=r===void 0?null:r;var i=void 0;if(Je!==null){var o=Je.memoizedState;if(i=o.destroy,r!==null&&Ef(r,o.deps)){s.memoizedState=na(e,n,i,r);return}}Ve.flags|=t,s.memoizedState=na(1|e,n,i,r)}function xg(t,e){return Rl(8390656,8,t,e)}function Tf(t,e){return zu(2048,8,t,e)}function q_(t,e){return zu(4,2,t,e)}function G_(t,e){return zu(4,4,t,e)}function K_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Q_(t,e,n){return n=n!=null?n.concat([t]):null,zu(4,4,K_.bind(null,e,t),n)}function If(){}function Y_(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ef(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function X_(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ef(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function J_(t,e,n){return Es&21?(Pn(n,e)||(n=r_(),Ve.lanes|=n,bs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Lt=!0),t.memoizedState=n)}function LS(t,e){var n=_e;_e=n!==0&&4>n?n:4,t(!0);var r=Jc.transition;Jc.transition={};try{t(!1),e()}finally{_e=n,Jc.transition=r}}function Z_(){return gn().memoizedState}function FS(t,e,n){var r=Br(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ex(t))tx(e,n);else if(n=O_(t,e,n,r),n!==null){var s=Pt();In(n,t,r,s),nx(n,e,r)}}function US(t,e,n){var r=Br(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ex(t))tx(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Pn(l,o)){var u=e.interleaved;u===null?(s.next=s,yf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=O_(t,e,s,r),n!==null&&(s=Pt(),In(n,t,r,s),nx(n,e,r))}}function ex(t){var e=t.alternate;return t===Ve||e!==null&&e===Ve}function tx(t,e){ko=uu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function nx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,nf(t,n)}}var cu={readContext:mn,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},zS={readContext:mn,useCallback:function(t,e){return jn().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:xg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Rl(4194308,4,K_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Rl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Rl(4,2,t,e)},useMemo:function(t,e){var n=jn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=FS.bind(null,Ve,t),[r.memoizedState,t]},useRef:function(t){var e=jn();return t={current:t},e.memoizedState=t},useState:_g,useDebugValue:If,useDeferredValue:function(t){return jn().memoizedState=t},useTransition:function(){var t=_g(!1),e=t[0];return t=LS.bind(null,t[1]),jn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ve,s=jn();if(je){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),it===null)throw Error(z(349));Es&30||U_(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,xg(B_.bind(null,r,i,t),[t]),r.flags|=2048,na(9,z_.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=jn(),e=it.identifierPrefix;if(je){var n=Zn,r=Jn;n=(r&~(1<<32-Tn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ea++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=MS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},BS={readContext:mn,useCallback:Y_,useContext:mn,useEffect:Tf,useImperativeHandle:Q_,useInsertionEffect:q_,useLayoutEffect:G_,useMemo:X_,useReducer:Zc,useRef:W_,useState:function(){return Zc(ta)},useDebugValue:If,useDeferredValue:function(t){var e=gn();return J_(e,Je.memoizedState,t)},useTransition:function(){var t=Zc(ta)[0],e=gn().memoizedState;return[t,e]},useMutableSource:L_,useSyncExternalStore:F_,useId:Z_,unstable_isNewReconciler:!1},$S={readContext:mn,useCallback:Y_,useContext:mn,useEffect:Tf,useImperativeHandle:Q_,useInsertionEffect:q_,useLayoutEffect:G_,useMemo:X_,useReducer:ed,useRef:W_,useState:function(){return ed(ta)},useDebugValue:If,useDeferredValue:function(t){var e=gn();return Je===null?e.memoizedState=t:J_(e,Je.memoizedState,t)},useTransition:function(){var t=ed(ta)[0],e=gn().memoizedState;return[t,e]},useMutableSource:L_,useSyncExternalStore:F_,useId:Z_,unstable_isNewReconciler:!1};function wn(t,e){if(t&&t.defaultProps){e=Me({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function nh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Me({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Bu={isMounted:function(t){return(t=t._reactInternals)?Ns(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Pt(),s=Br(t),i=sr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ur(t,i,s),e!==null&&(In(e,t,s,r),Al(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Pt(),s=Br(t),i=sr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ur(t,i,s),e!==null&&(In(e,t,s,r),Al(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Pt(),r=Br(t),s=sr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ur(t,s,r),e!==null&&(In(e,t,r,n),Al(e,t,r))}};function wg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ko(n,r)||!Ko(s,i):!0}function rx(t,e,n){var r=!1,s=Qr,i=e.contextType;return typeof i=="object"&&i!==null?i=mn(i):(s=Ut(e)?xs:St.current,r=e.contextTypes,i=(r=r!=null)?_i(t,s):Qr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Eg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Bu.enqueueReplaceState(e,e.state,null)}function rh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},vf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=mn(i):(i=Ut(e)?xs:St.current,s.context=_i(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(nh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Bu.enqueueReplaceState(s,s.state,null),au(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function bi(t,e){try{var n="",r=e;do n+=yb(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function td(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var HS=typeof WeakMap=="function"?WeakMap:Map;function sx(t,e,n){n=sr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){hu||(hu=!0,ph=r),sh(t,e)},n}function ix(t,e,n){n=sr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){sh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){sh(t,e),typeof r!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function bg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new HS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=sT.bind(null,t,e,n),e.then(t,t))}function Sg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Tg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=sr(-1,1),e.tag=2,Ur(n,e,1))),n.lanes|=1),t)}var WS=pr.ReactCurrentOwner,Lt=!1;function At(t,e,n,r){e.child=t===null?j_(e,null,n,r):wi(e,t.child,n,r)}function Ig(t,e,n,r,s){n=n.render;var i=e.ref;return hi(e,s),r=bf(t,e,n,r,i,s),n=Sf(),t!==null&&!Lt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ur(t,e,s)):(je&&n&&df(e),e.flags|=1,At(t,e,r,s),e.child)}function Cg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!jf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,ox(t,e,i,r,s)):(t=jl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ko,n(o,r)&&t.ref===e.ref)return ur(t,e,s)}return e.flags|=1,t=$r(i,r),t.ref=e.ref,t.return=e,e.child=t}function ox(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ko(i,r)&&t.ref===e.ref)if(Lt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Lt=!0);else return e.lanes=t.lanes,ur(t,e,s)}return ih(t,e,n,r,s)}function ax(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(ii,Yt),Yt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Se(ii,Yt),Yt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Se(ii,Yt),Yt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Se(ii,Yt),Yt|=r;return At(t,e,s,n),e.child}function lx(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ih(t,e,n,r,s){var i=Ut(n)?xs:St.current;return i=_i(e,i),hi(e,s),n=bf(t,e,n,r,i,s),r=Sf(),t!==null&&!Lt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ur(t,e,s)):(je&&r&&df(e),e.flags|=1,At(t,e,n,s),e.child)}function Ag(t,e,n,r,s){if(Ut(n)){var i=!0;nu(e)}else i=!1;if(hi(e,s),e.stateNode===null)Nl(t,e),rx(e,n,r),rh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=mn(c):(c=Ut(n)?xs:St.current,c=_i(e,c));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Eg(e,o,r,c),Cr=!1;var y=e.memoizedState;o.state=y,au(e,r,o,s),u=e.memoizedState,l!==r||y!==u||Ft.current||Cr?(typeof f=="function"&&(nh(e,n,f,r),u=e.memoizedState),(l=Cr||wg(e,n,l,r,y,u,c))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,V_(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:wn(e.type,l),o.props=c,p=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=mn(u):(u=Ut(n)?xs:St.current,u=_i(e,u));var I=n.getDerivedStateFromProps;(f=typeof I=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||y!==u)&&Eg(e,o,r,u),Cr=!1,y=e.memoizedState,o.state=y,au(e,r,o,s);var D=e.memoizedState;l!==p||y!==D||Ft.current||Cr?(typeof I=="function"&&(nh(e,n,I,r),D=e.memoizedState),(c=Cr||wg(e,n,c,r,y,D,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,D,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,D,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=D),o.props=r,o.state=D,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return oh(t,e,n,r,i,s)}function oh(t,e,n,r,s,i){lx(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&fg(e,n,!1),ur(t,e,i);r=e.stateNode,WS.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=wi(e,t.child,null,i),e.child=wi(e,null,l,i)):At(t,e,l,i),e.memoizedState=r.state,s&&fg(e,n,!0),e.child}function ux(t){var e=t.stateNode;e.pendingContext?hg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&hg(t,e.context,!1),_f(t,e.containerInfo)}function Pg(t,e,n,r,s){return xi(),ff(s),e.flags|=256,At(t,e,n,r),e.child}var ah={dehydrated:null,treeContext:null,retryLane:0};function lh(t){return{baseLanes:t,cachePool:null,transitions:null}}function cx(t,e,n){var r=e.pendingProps,s=Oe.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Se(Oe,s&1),t===null)return eh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Wu(o,r,0,null),t=gs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=lh(n),e.memoizedState=ah,t):Cf(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return qS(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=$r(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=$r(l,i):(i=gs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?lh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=ah,r}return i=t.child,t=i.sibling,r=$r(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Cf(t,e){return e=Wu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ul(t,e,n,r){return r!==null&&ff(r),wi(e,t.child,null,n),t=Cf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function qS(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=td(Error(z(422))),ul(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Wu({mode:"visible",children:r.children},s,0,null),i=gs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&wi(e,t.child,null,o),e.child.memoizedState=lh(o),e.memoizedState=ah,i);if(!(e.mode&1))return ul(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(z(419)),r=td(i,r,void 0),ul(t,e,o,r)}if(l=(o&t.childLanes)!==0,Lt||l){if(r=it,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,lr(t,s),In(r,t,s,-1))}return Df(),r=td(Error(z(421))),ul(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=iT.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Xt=Fr(s.nextSibling),Jt=e,je=!0,bn=null,t!==null&&(un[cn++]=Jn,un[cn++]=Zn,un[cn++]=ws,Jn=t.id,Zn=t.overflow,ws=e),e=Cf(e,r.children),e.flags|=4096,e)}function Rg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),th(t.return,e,n)}function nd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function dx(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(At(t,e,r.children,n),r=Oe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Rg(t,n,e);else if(t.tag===19)Rg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Se(Oe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&lu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),nd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&lu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}nd(e,!0,n,null,i);break;case"together":nd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Nl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ur(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),bs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=$r(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=$r(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function GS(t,e,n){switch(e.tag){case 3:ux(e),xi();break;case 5:M_(e);break;case 1:Ut(e.type)&&nu(e);break;case 4:_f(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Se(iu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Se(Oe,Oe.current&1),e.flags|=128,null):n&e.child.childLanes?cx(t,e,n):(Se(Oe,Oe.current&1),t=ur(t,e,n),t!==null?t.sibling:null);Se(Oe,Oe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return dx(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Se(Oe,Oe.current),r)break;return null;case 22:case 23:return e.lanes=0,ax(t,e,n)}return ur(t,e,n)}var hx,uh,fx,px;hx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uh=function(){};fx=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,hs(Ln.current);var i=null;switch(n){case"input":s=Nd(t,s),r=Nd(t,r),i=[];break;case"select":s=Me({},s,{value:void 0}),r=Me({},r,{value:void 0}),i=[];break;case"textarea":s=jd(t,s),r=jd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=eu)}Vd(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(zo.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(l=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(zo.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Ae("scroll",t),i||l===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};px=function(t,e,n,r){n!==r&&(e.flags|=4)};function co(t,e){if(!je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function vt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function KS(t,e,n){var r=e.pendingProps;switch(hf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vt(e),null;case 1:return Ut(e.type)&&tu(),vt(e),null;case 3:return r=e.stateNode,Ei(),Re(Ft),Re(St),wf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(al(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bn!==null&&(yh(bn),bn=null))),uh(t,e),vt(e),null;case 5:xf(e);var s=hs(Zo.current);if(n=e.type,t!==null&&e.stateNode!=null)fx(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return vt(e),null}if(t=hs(Ln.current),al(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Vn]=e,r[Xo]=i,t=(e.mode&1)!==0,n){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(s=0;s<Eo.length;s++)Ae(Eo[s],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":Fm(r,i),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ae("invalid",r);break;case"textarea":zm(r,i),Ae("invalid",r)}Vd(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&ol(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ol(r.textContent,l,t),s=["children",""+l]):zo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ae("scroll",r)}switch(n){case"input":Ja(r),Um(r,i,!0);break;case"textarea":Ja(r),Bm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=eu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Bv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Vn]=e,t[Xo]=r,hx(t,e,!1,!1),e.stateNode=t;e:{switch(o=Md(n,r),n){case"dialog":Ae("cancel",t),Ae("close",t),s=r;break;case"iframe":case"object":case"embed":Ae("load",t),s=r;break;case"video":case"audio":for(s=0;s<Eo.length;s++)Ae(Eo[s],t);s=r;break;case"source":Ae("error",t),s=r;break;case"img":case"image":case"link":Ae("error",t),Ae("load",t),s=r;break;case"details":Ae("toggle",t),s=r;break;case"input":Fm(t,r),s=Nd(t,r),Ae("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Me({},r,{value:void 0}),Ae("invalid",t);break;case"textarea":zm(t,r),s=jd(t,r),Ae("invalid",t);break;default:s=r}Vd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?Wv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&$v(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Bo(t,u):typeof u=="number"&&Bo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(zo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ae("scroll",t):u!=null&&Yh(t,i,u,o))}switch(n){case"input":Ja(t),Um(t,r,!1);break;case"textarea":Ja(t),Bm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Kr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?li(t,!!r.multiple,i,!1):r.defaultValue!=null&&li(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=eu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return vt(e),null;case 6:if(t&&e.stateNode!=null)px(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=hs(Zo.current),hs(Ln.current),al(e)){if(r=e.stateNode,n=e.memoizedProps,r[Vn]=e,(i=r.nodeValue!==n)&&(t=Jt,t!==null))switch(t.tag){case 3:ol(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ol(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vn]=e,e.stateNode=r}return vt(e),null;case 13:if(Re(Oe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(je&&Xt!==null&&e.mode&1&&!(e.flags&128))k_(),xi(),e.flags|=98560,i=!1;else if(i=al(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[Vn]=e}else xi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;vt(e),i=!1}else bn!==null&&(yh(bn),bn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Oe.current&1?Ze===0&&(Ze=3):Df())),e.updateQueue!==null&&(e.flags|=4),vt(e),null);case 4:return Ei(),uh(t,e),t===null&&Qo(e.stateNode.containerInfo),vt(e),null;case 10:return gf(e.type._context),vt(e),null;case 17:return Ut(e.type)&&tu(),vt(e),null;case 19:if(Re(Oe),i=e.memoizedState,i===null)return vt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)co(i,!1);else{if(Ze!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=lu(t),o!==null){for(e.flags|=128,co(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Se(Oe,Oe.current&1|2),e.child}t=t.sibling}i.tail!==null&&He()>Si&&(e.flags|=128,r=!0,co(i,!1),e.lanes=4194304)}else{if(!r)if(t=lu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),co(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!je)return vt(e),null}else 2*He()-i.renderingStartTime>Si&&n!==1073741824&&(e.flags|=128,r=!0,co(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=He(),e.sibling=null,n=Oe.current,Se(Oe,r?n&1|2:n&1),e):(vt(e),null);case 22:case 23:return kf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Yt&1073741824&&(vt(e),e.subtreeFlags&6&&(e.flags|=8192)):vt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function QS(t,e){switch(hf(e),e.tag){case 1:return Ut(e.type)&&tu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ei(),Re(Ft),Re(St),wf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return xf(e),null;case 13:if(Re(Oe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));xi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Re(Oe),null;case 4:return Ei(),null;case 10:return gf(e.type._context),null;case 22:case 23:return kf(),null;case 24:return null;default:return null}}var cl=!1,Et=!1,YS=typeof WeakSet=="function"?WeakSet:Set,q=null;function si(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(t,e,r)}else n.current=null}function ch(t,e,n){try{n()}catch(r){Ue(t,e,r)}}var Ng=!1;function XS(t,e){if(Gd=Xl,t=__(),cf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,c=0,f=0,p=t,y=null;t:for(;;){for(var I;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(I=p.firstChild)!==null;)y=p,p=I;for(;;){if(p===t)break t;if(y===n&&++c===s&&(l=o),y===i&&++f===r&&(u=o),(I=p.nextSibling)!==null)break;p=y,y=p.parentNode}p=I}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Kd={focusedElem:t,selectionRange:n},Xl=!1,q=e;q!==null;)if(e=q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,q=t;else for(;q!==null;){e=q;try{var D=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(D!==null){var E=D.memoizedProps,N=D.memoizedState,b=e.stateNode,w=b.getSnapshotBeforeUpdate(e.elementType===e.type?E:wn(e.type,E),N);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(S){Ue(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,q=t;break}q=e.return}return D=Ng,Ng=!1,D}function Do(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ch(e,n,i)}s=s.next}while(s!==r)}}function $u(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function dh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function mx(t){var e=t.alternate;e!==null&&(t.alternate=null,mx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Vn],delete e[Xo],delete e[Xd],delete e[DS],delete e[jS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function gx(t){return t.tag===5||t.tag===3||t.tag===4}function kg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eu));else if(r!==4&&(t=t.child,t!==null))for(hh(t,e,n),t=t.sibling;t!==null;)hh(t,e,n),t=t.sibling}function fh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(fh(t,e,n),t=t.sibling;t!==null;)fh(t,e,n),t=t.sibling}var lt=null,En=!1;function Er(t,e,n){for(n=n.child;n!==null;)yx(t,e,n),n=n.sibling}function yx(t,e,n){if(Mn&&typeof Mn.onCommitFiberUnmount=="function")try{Mn.onCommitFiberUnmount(Ou,n)}catch{}switch(n.tag){case 5:Et||si(n,e);case 6:var r=lt,s=En;lt=null,Er(t,e,n),lt=r,En=s,lt!==null&&(En?(t=lt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):lt.removeChild(n.stateNode));break;case 18:lt!==null&&(En?(t=lt,n=n.stateNode,t.nodeType===8?Qc(t.parentNode,n):t.nodeType===1&&Qc(t,n),qo(t)):Qc(lt,n.stateNode));break;case 4:r=lt,s=En,lt=n.stateNode.containerInfo,En=!0,Er(t,e,n),lt=r,En=s;break;case 0:case 11:case 14:case 15:if(!Et&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&ch(n,e,o),s=s.next}while(s!==r)}Er(t,e,n);break;case 1:if(!Et&&(si(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ue(n,e,l)}Er(t,e,n);break;case 21:Er(t,e,n);break;case 22:n.mode&1?(Et=(r=Et)||n.memoizedState!==null,Er(t,e,n),Et=r):Er(t,e,n);break;default:Er(t,e,n)}}function Dg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new YS),e.forEach(function(r){var s=oT.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function _n(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:lt=l.stateNode,En=!1;break e;case 3:lt=l.stateNode.containerInfo,En=!0;break e;case 4:lt=l.stateNode.containerInfo,En=!0;break e}l=l.return}if(lt===null)throw Error(z(160));yx(i,o,s),lt=null,En=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Ue(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vx(e,t),e=e.sibling}function vx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_n(e,t),Dn(t),r&4){try{Do(3,t,t.return),$u(3,t)}catch(E){Ue(t,t.return,E)}try{Do(5,t,t.return)}catch(E){Ue(t,t.return,E)}}break;case 1:_n(e,t),Dn(t),r&512&&n!==null&&si(n,n.return);break;case 5:if(_n(e,t),Dn(t),r&512&&n!==null&&si(n,n.return),t.flags&32){var s=t.stateNode;try{Bo(s,"")}catch(E){Ue(t,t.return,E)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Uv(s,i),Md(l,o);var c=Md(l,i);for(o=0;o<u.length;o+=2){var f=u[o],p=u[o+1];f==="style"?Wv(s,p):f==="dangerouslySetInnerHTML"?$v(s,p):f==="children"?Bo(s,p):Yh(s,f,p,c)}switch(l){case"input":kd(s,i);break;case"textarea":zv(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var I=i.value;I!=null?li(s,!!i.multiple,I,!1):y!==!!i.multiple&&(i.defaultValue!=null?li(s,!!i.multiple,i.defaultValue,!0):li(s,!!i.multiple,i.multiple?[]:"",!1))}s[Xo]=i}catch(E){Ue(t,t.return,E)}}break;case 6:if(_n(e,t),Dn(t),r&4){if(t.stateNode===null)throw Error(z(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(E){Ue(t,t.return,E)}}break;case 3:if(_n(e,t),Dn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qo(e.containerInfo)}catch(E){Ue(t,t.return,E)}break;case 4:_n(e,t),Dn(t);break;case 13:_n(e,t),Dn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Rf=He())),r&4&&Dg(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Et=(c=Et)||f,_n(e,t),Et=c):_n(e,t),Dn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(q=t,f=t.child;f!==null;){for(p=q=f;q!==null;){switch(y=q,I=y.child,y.tag){case 0:case 11:case 14:case 15:Do(4,y,y.return);break;case 1:si(y,y.return);var D=y.stateNode;if(typeof D.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,D.props=e.memoizedProps,D.state=e.memoizedState,D.componentWillUnmount()}catch(E){Ue(r,n,E)}}break;case 5:si(y,y.return);break;case 22:if(y.memoizedState!==null){Og(p);continue}}I!==null?(I.return=y,q=I):Og(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Hv("display",o))}catch(E){Ue(t,t.return,E)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=c?"":p.memoizedProps}catch(E){Ue(t,t.return,E)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:_n(e,t),Dn(t),r&4&&Dg(t);break;case 21:break;default:_n(e,t),Dn(t)}}function Dn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(gx(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Bo(s,""),r.flags&=-33);var i=kg(t);fh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=kg(t);hh(t,l,o);break;default:throw Error(z(161))}}catch(u){Ue(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function JS(t,e,n){q=t,_x(t)}function _x(t,e,n){for(var r=(t.mode&1)!==0;q!==null;){var s=q,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||cl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Et;l=cl;var c=Et;if(cl=o,(Et=u)&&!c)for(q=s;q!==null;)o=q,u=o.child,o.tag===22&&o.memoizedState!==null?Vg(s):u!==null?(u.return=o,q=u):Vg(s);for(;i!==null;)q=i,_x(i),i=i.sibling;q=s,cl=l,Et=c}jg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,q=i):jg(t)}}function jg(t){for(;q!==null;){var e=q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Et||$u(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Et)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:wn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&vg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}vg(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&qo(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Et||e.flags&512&&dh(e)}catch(y){Ue(e,e.return,y)}}if(e===t){q=null;break}if(n=e.sibling,n!==null){n.return=e.return,q=n;break}q=e.return}}function Og(t){for(;q!==null;){var e=q;if(e===t){q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,q=n;break}q=e.return}}function Vg(t){for(;q!==null;){var e=q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{$u(4,e)}catch(u){Ue(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ue(e,s,u)}}var i=e.return;try{dh(e)}catch(u){Ue(e,i,u)}break;case 5:var o=e.return;try{dh(e)}catch(u){Ue(e,o,u)}}}catch(u){Ue(e,e.return,u)}if(e===t){q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,q=l;break}q=e.return}}var ZS=Math.ceil,du=pr.ReactCurrentDispatcher,Af=pr.ReactCurrentOwner,fn=pr.ReactCurrentBatchConfig,he=0,it=null,Ge=null,dt=0,Yt=0,ii=ts(0),Ze=0,ra=null,bs=0,Hu=0,Pf=0,jo=null,Mt=null,Rf=0,Si=1/0,Qn=null,hu=!1,ph=null,zr=null,dl=!1,jr=null,fu=0,Oo=0,mh=null,kl=-1,Dl=0;function Pt(){return he&6?He():kl!==-1?kl:kl=He()}function Br(t){return t.mode&1?he&2&&dt!==0?dt&-dt:VS.transition!==null?(Dl===0&&(Dl=r_()),Dl):(t=_e,t!==0||(t=window.event,t=t===void 0?16:c_(t.type)),t):1}function In(t,e,n,r){if(50<Oo)throw Oo=0,mh=null,Error(z(185));ga(t,n,r),(!(he&2)||t!==it)&&(t===it&&(!(he&2)&&(Hu|=n),Ze===4&&Pr(t,dt)),zt(t,r),n===1&&he===0&&!(e.mode&1)&&(Si=He()+500,Uu&&ns()))}function zt(t,e){var n=t.callbackNode;Vb(t,e);var r=Yl(t,t===it?dt:0);if(r===0)n!==null&&Wm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Wm(n),e===1)t.tag===0?OS(Mg.bind(null,t)):P_(Mg.bind(null,t)),NS(function(){!(he&6)&&ns()}),n=null;else{switch(s_(r)){case 1:n=tf;break;case 4:n=t_;break;case 16:n=Ql;break;case 536870912:n=n_;break;default:n=Ql}n=Cx(n,xx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function xx(t,e){if(kl=-1,Dl=0,he&6)throw Error(z(327));var n=t.callbackNode;if(fi()&&t.callbackNode!==n)return null;var r=Yl(t,t===it?dt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=pu(t,r);else{e=r;var s=he;he|=2;var i=Ex();(it!==t||dt!==e)&&(Qn=null,Si=He()+500,ms(t,e));do try{nT();break}catch(l){wx(t,l)}while(!0);mf(),du.current=i,he=s,Ge!==null?e=0:(it=null,dt=0,e=Ze)}if(e!==0){if(e===2&&(s=Bd(t),s!==0&&(r=s,e=gh(t,s))),e===1)throw n=ra,ms(t,0),Pr(t,r),zt(t,He()),n;if(e===6)Pr(t,r);else{if(s=t.current.alternate,!(r&30)&&!eT(s)&&(e=pu(t,r),e===2&&(i=Bd(t),i!==0&&(r=i,e=gh(t,i))),e===1))throw n=ra,ms(t,0),Pr(t,r),zt(t,He()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:ls(t,Mt,Qn);break;case 3:if(Pr(t,r),(r&130023424)===r&&(e=Rf+500-He(),10<e)){if(Yl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Pt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Yd(ls.bind(null,t,Mt,Qn),e);break}ls(t,Mt,Qn);break;case 4:if(Pr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Tn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=He()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ZS(r/1960))-r,10<r){t.timeoutHandle=Yd(ls.bind(null,t,Mt,Qn),r);break}ls(t,Mt,Qn);break;case 5:ls(t,Mt,Qn);break;default:throw Error(z(329))}}}return zt(t,He()),t.callbackNode===n?xx.bind(null,t):null}function gh(t,e){var n=jo;return t.current.memoizedState.isDehydrated&&(ms(t,e).flags|=256),t=pu(t,e),t!==2&&(e=Mt,Mt=n,e!==null&&yh(e)),t}function yh(t){Mt===null?Mt=t:Mt.push.apply(Mt,t)}function eT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Pn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pr(t,e){for(e&=~Pf,e&=~Hu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Tn(e),r=1<<n;t[n]=-1,e&=~r}}function Mg(t){if(he&6)throw Error(z(327));fi();var e=Yl(t,0);if(!(e&1))return zt(t,He()),null;var n=pu(t,e);if(t.tag!==0&&n===2){var r=Bd(t);r!==0&&(e=r,n=gh(t,r))}if(n===1)throw n=ra,ms(t,0),Pr(t,e),zt(t,He()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ls(t,Mt,Qn),zt(t,He()),null}function Nf(t,e){var n=he;he|=1;try{return t(e)}finally{he=n,he===0&&(Si=He()+500,Uu&&ns())}}function Ss(t){jr!==null&&jr.tag===0&&!(he&6)&&fi();var e=he;he|=1;var n=fn.transition,r=_e;try{if(fn.transition=null,_e=1,t)return t()}finally{_e=r,fn.transition=n,he=e,!(he&6)&&ns()}}function kf(){Yt=ii.current,Re(ii)}function ms(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,RS(n)),Ge!==null)for(n=Ge.return;n!==null;){var r=n;switch(hf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tu();break;case 3:Ei(),Re(Ft),Re(St),wf();break;case 5:xf(r);break;case 4:Ei();break;case 13:Re(Oe);break;case 19:Re(Oe);break;case 10:gf(r.type._context);break;case 22:case 23:kf()}n=n.return}if(it=t,Ge=t=$r(t.current,null),dt=Yt=e,Ze=0,ra=null,Pf=Hu=bs=0,Mt=jo=null,ds!==null){for(e=0;e<ds.length;e++)if(n=ds[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ds=null}return t}function wx(t,e){do{var n=Ge;try{if(mf(),Pl.current=cu,uu){for(var r=Ve.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}uu=!1}if(Es=0,st=Je=Ve=null,ko=!1,ea=0,Af.current=null,n===null||n.return===null){Ze=1,ra=e,Ge=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=dt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var y=f.alternate;y?(f.updateQueue=y.updateQueue,f.memoizedState=y.memoizedState,f.lanes=y.lanes):(f.updateQueue=null,f.memoizedState=null)}var I=Sg(o);if(I!==null){I.flags&=-257,Tg(I,o,l,i,e),I.mode&1&&bg(i,c,e),e=I,u=c;var D=e.updateQueue;if(D===null){var E=new Set;E.add(u),e.updateQueue=E}else D.add(u);break e}else{if(!(e&1)){bg(i,c,e),Df();break e}u=Error(z(426))}}else if(je&&l.mode&1){var N=Sg(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Tg(N,o,l,i,e),ff(bi(u,l));break e}}i=u=bi(u,l),Ze!==4&&(Ze=2),jo===null?jo=[i]:jo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=sx(i,u,e);yg(i,b);break e;case 1:l=u;var w=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(zr===null||!zr.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=ix(i,l,e);yg(i,S);break e}}i=i.return}while(i!==null)}Sx(n)}catch(P){e=P,Ge===n&&n!==null&&(Ge=n=n.return);continue}break}while(!0)}function Ex(){var t=du.current;return du.current=cu,t===null?cu:t}function Df(){(Ze===0||Ze===3||Ze===2)&&(Ze=4),it===null||!(bs&268435455)&&!(Hu&268435455)||Pr(it,dt)}function pu(t,e){var n=he;he|=2;var r=Ex();(it!==t||dt!==e)&&(Qn=null,ms(t,e));do try{tT();break}catch(s){wx(t,s)}while(!0);if(mf(),he=n,du.current=r,Ge!==null)throw Error(z(261));return it=null,dt=0,Ze}function tT(){for(;Ge!==null;)bx(Ge)}function nT(){for(;Ge!==null&&!Cb();)bx(Ge)}function bx(t){var e=Ix(t.alternate,t,Yt);t.memoizedProps=t.pendingProps,e===null?Sx(t):Ge=e,Af.current=null}function Sx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=QS(n,e),n!==null){n.flags&=32767,Ge=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ze=6,Ge=null;return}}else if(n=KS(n,e,Yt),n!==null){Ge=n;return}if(e=e.sibling,e!==null){Ge=e;return}Ge=e=t}while(e!==null);Ze===0&&(Ze=5)}function ls(t,e,n){var r=_e,s=fn.transition;try{fn.transition=null,_e=1,rT(t,e,n,r)}finally{fn.transition=s,_e=r}return null}function rT(t,e,n,r){do fi();while(jr!==null);if(he&6)throw Error(z(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Mb(t,i),t===it&&(Ge=it=null,dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||dl||(dl=!0,Cx(Ql,function(){return fi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fn.transition,fn.transition=null;var o=_e;_e=1;var l=he;he|=4,Af.current=null,XS(t,n),vx(n,t),bS(Kd),Xl=!!Gd,Kd=Gd=null,t.current=n,JS(n),Ab(),he=l,_e=o,fn.transition=i}else t.current=n;if(dl&&(dl=!1,jr=t,fu=s),i=t.pendingLanes,i===0&&(zr=null),Nb(n.stateNode),zt(t,He()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(hu)throw hu=!1,t=ph,ph=null,t;return fu&1&&t.tag!==0&&fi(),i=t.pendingLanes,i&1?t===mh?Oo++:(Oo=0,mh=t):Oo=0,ns(),null}function fi(){if(jr!==null){var t=s_(fu),e=fn.transition,n=_e;try{if(fn.transition=null,_e=16>t?16:t,jr===null)var r=!1;else{if(t=jr,jr=null,fu=0,he&6)throw Error(z(331));var s=he;for(he|=4,q=t.current;q!==null;){var i=q,o=i.child;if(q.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(q=c;q!==null;){var f=q;switch(f.tag){case 0:case 11:case 15:Do(8,f,i)}var p=f.child;if(p!==null)p.return=f,q=p;else for(;q!==null;){f=q;var y=f.sibling,I=f.return;if(mx(f),f===c){q=null;break}if(y!==null){y.return=I,q=y;break}q=I}}}var D=i.alternate;if(D!==null){var E=D.child;if(E!==null){D.child=null;do{var N=E.sibling;E.sibling=null,E=N}while(E!==null)}}q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,q=o;else e:for(;q!==null;){if(i=q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Do(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,q=b;break e}q=i.return}}var w=t.current;for(q=w;q!==null;){o=q;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,q=v;else e:for(o=w;q!==null;){if(l=q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:$u(9,l)}}catch(P){Ue(l,l.return,P)}if(l===o){q=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,q=S;break e}q=l.return}}if(he=s,ns(),Mn&&typeof Mn.onPostCommitFiberRoot=="function")try{Mn.onPostCommitFiberRoot(Ou,t)}catch{}r=!0}return r}finally{_e=n,fn.transition=e}}return!1}function Lg(t,e,n){e=bi(n,e),e=sx(t,e,1),t=Ur(t,e,1),e=Pt(),t!==null&&(ga(t,1,e),zt(t,e))}function Ue(t,e,n){if(t.tag===3)Lg(t,t,n);else for(;e!==null;){if(e.tag===3){Lg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(zr===null||!zr.has(r))){t=bi(n,t),t=ix(e,t,1),e=Ur(e,t,1),t=Pt(),e!==null&&(ga(e,1,t),zt(e,t));break}}e=e.return}}function sT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Pt(),t.pingedLanes|=t.suspendedLanes&n,it===t&&(dt&n)===n&&(Ze===4||Ze===3&&(dt&130023424)===dt&&500>He()-Rf?ms(t,0):Pf|=n),zt(t,e)}function Tx(t,e){e===0&&(t.mode&1?(e=tl,tl<<=1,!(tl&130023424)&&(tl=4194304)):e=1);var n=Pt();t=lr(t,e),t!==null&&(ga(t,e,n),zt(t,n))}function iT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Tx(t,n)}function oT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),Tx(t,n)}var Ix;Ix=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ft.current)Lt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Lt=!1,GS(t,e,n);Lt=!!(t.flags&131072)}else Lt=!1,je&&e.flags&1048576&&R_(e,su,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Nl(t,e),t=e.pendingProps;var s=_i(e,St.current);hi(e,n),s=bf(null,e,r,t,s,n);var i=Sf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ut(r)?(i=!0,nu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vf(e),s.updater=Bu,e.stateNode=s,s._reactInternals=e,rh(e,r,t,n),e=oh(null,e,r,!0,i,n)):(e.tag=0,je&&i&&df(e),At(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Nl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=lT(r),t=wn(r,t),s){case 0:e=ih(null,e,r,t,n);break e;case 1:e=Ag(null,e,r,t,n);break e;case 11:e=Ig(null,e,r,t,n);break e;case 14:e=Cg(null,e,r,wn(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wn(r,s),ih(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wn(r,s),Ag(t,e,r,s,n);case 3:e:{if(ux(e),t===null)throw Error(z(387));r=e.pendingProps,i=e.memoizedState,s=i.element,V_(t,e),au(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=bi(Error(z(423)),e),e=Pg(t,e,r,n,s);break e}else if(r!==s){s=bi(Error(z(424)),e),e=Pg(t,e,r,n,s);break e}else for(Xt=Fr(e.stateNode.containerInfo.firstChild),Jt=e,je=!0,bn=null,n=j_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(xi(),r===s){e=ur(t,e,n);break e}At(t,e,r,n)}e=e.child}return e;case 5:return M_(e),t===null&&eh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Qd(r,s)?o=null:i!==null&&Qd(r,i)&&(e.flags|=32),lx(t,e),At(t,e,o,n),e.child;case 6:return t===null&&eh(e),null;case 13:return cx(t,e,n);case 4:return _f(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=wi(e,null,r,n):At(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wn(r,s),Ig(t,e,r,s,n);case 7:return At(t,e,e.pendingProps,n),e.child;case 8:return At(t,e,e.pendingProps.children,n),e.child;case 12:return At(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Se(iu,r._currentValue),r._currentValue=o,i!==null)if(Pn(i.value,o)){if(i.children===s.children&&!Ft.current){e=ur(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=sr(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?u.next=u:(u.next=f.next,f.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),th(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(z(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),th(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}At(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,hi(e,n),s=mn(s),r=r(s),e.flags|=1,At(t,e,r,n),e.child;case 14:return r=e.type,s=wn(r,e.pendingProps),s=wn(r.type,s),Cg(t,e,r,s,n);case 15:return ox(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wn(r,s),Nl(t,e),e.tag=1,Ut(r)?(t=!0,nu(e)):t=!1,hi(e,n),rx(e,r,s),rh(e,r,s,n),oh(null,e,r,!0,t,n);case 19:return dx(t,e,n);case 22:return ax(t,e,n)}throw Error(z(156,e.tag))};function Cx(t,e){return e_(t,e)}function aT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(t,e,n,r){return new aT(t,e,n,r)}function jf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lT(t){if(typeof t=="function")return jf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Jh)return 11;if(t===Zh)return 14}return 2}function $r(t,e){var n=t.alternate;return n===null?(n=hn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function jl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")jf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qs:return gs(n.children,s,i,e);case Xh:o=8,s|=8;break;case Cd:return t=hn(12,n,e,s|2),t.elementType=Cd,t.lanes=i,t;case Ad:return t=hn(13,n,e,s),t.elementType=Ad,t.lanes=i,t;case Pd:return t=hn(19,n,e,s),t.elementType=Pd,t.lanes=i,t;case Mv:return Wu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ov:o=10;break e;case Vv:o=9;break e;case Jh:o=11;break e;case Zh:o=14;break e;case Ir:o=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=hn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function gs(t,e,n,r){return t=hn(7,t,r,e),t.lanes=n,t}function Wu(t,e,n,r){return t=hn(22,t,r,e),t.elementType=Mv,t.lanes=n,t.stateNode={isHidden:!1},t}function rd(t,e,n){return t=hn(6,t,null,e),t.lanes=n,t}function sd(t,e,n){return e=hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function uT(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lc(0),this.expirationTimes=Lc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Of(t,e,n,r,s,i,o,l,u){return t=new uT(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=hn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vf(i),t}function cT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ks,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Ax(t){if(!t)return Qr;t=t._reactInternals;e:{if(Ns(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ut(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(Ut(n))return A_(t,n,e)}return e}function Px(t,e,n,r,s,i,o,l,u){return t=Of(n,r,!0,t,s,i,o,l,u),t.context=Ax(null),n=t.current,r=Pt(),s=Br(n),i=sr(r,s),i.callback=e??null,Ur(n,i,s),t.current.lanes=s,ga(t,s,r),zt(t,r),t}function qu(t,e,n,r){var s=e.current,i=Pt(),o=Br(s);return n=Ax(n),e.context===null?e.context=n:e.pendingContext=n,e=sr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ur(s,e,o),t!==null&&(In(t,s,o,i),Al(t,s,o)),o}function mu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Fg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Vf(t,e){Fg(t,e),(t=t.alternate)&&Fg(t,e)}function dT(){return null}var Rx=typeof reportError=="function"?reportError:function(t){console.error(t)};function Mf(t){this._internalRoot=t}Gu.prototype.render=Mf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));qu(t,e,null,null)};Gu.prototype.unmount=Mf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ss(function(){qu(null,t,null,null)}),e[ar]=null}};function Gu(t){this._internalRoot=t}Gu.prototype.unstable_scheduleHydration=function(t){if(t){var e=a_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ar.length&&e!==0&&e<Ar[n].priority;n++);Ar.splice(n,0,t),n===0&&u_(t)}};function Lf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ku(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ug(){}function hT(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=mu(o);i.call(c)}}var o=Px(e,r,t,0,null,!1,!1,"",Ug);return t._reactRootContainer=o,t[ar]=o.current,Qo(t.nodeType===8?t.parentNode:t),Ss(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var c=mu(u);l.call(c)}}var u=Of(t,0,!1,null,null,!1,!1,"",Ug);return t._reactRootContainer=u,t[ar]=u.current,Qo(t.nodeType===8?t.parentNode:t),Ss(function(){qu(e,u,n,r)}),u}function Qu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=mu(o);l.call(u)}}qu(e,o,t,s)}else o=hT(n,e,t,s,r);return mu(o)}i_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wo(e.pendingLanes);n!==0&&(nf(e,n|1),zt(e,He()),!(he&6)&&(Si=He()+500,ns()))}break;case 13:Ss(function(){var r=lr(t,1);if(r!==null){var s=Pt();In(r,t,1,s)}}),Vf(t,1)}};rf=function(t){if(t.tag===13){var e=lr(t,134217728);if(e!==null){var n=Pt();In(e,t,134217728,n)}Vf(t,134217728)}};o_=function(t){if(t.tag===13){var e=Br(t),n=lr(t,e);if(n!==null){var r=Pt();In(n,t,e,r)}Vf(t,e)}};a_=function(){return _e};l_=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}};Fd=function(t,e,n){switch(e){case"input":if(kd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Fu(r);if(!s)throw Error(z(90));Fv(r),kd(r,s)}}}break;case"textarea":zv(t,n);break;case"select":e=n.value,e!=null&&li(t,!!n.multiple,e,!1)}};Kv=Nf;Qv=Ss;var fT={usingClientEntryPoint:!1,Events:[va,Zs,Fu,qv,Gv,Nf]},ho={findFiberByHostInstance:cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pT={bundleType:ho.bundleType,version:ho.version,rendererPackageName:ho.rendererPackageName,rendererConfig:ho.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Jv(t),t===null?null:t.stateNode},findFiberByHostInstance:ho.findFiberByHostInstance||dT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hl.isDisabled&&hl.supportsFiber)try{Ou=hl.inject(pT),Mn=hl}catch{}}nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fT;nn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lf(e))throw Error(z(200));return cT(t,e,null,n)};nn.createRoot=function(t,e){if(!Lf(t))throw Error(z(299));var n=!1,r="",s=Rx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Of(t,1,!1,null,null,n,!1,r,s),t[ar]=e.current,Qo(t.nodeType===8?t.parentNode:t),new Mf(e)};nn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=Jv(e),t=t===null?null:t.stateNode,t};nn.flushSync=function(t){return Ss(t)};nn.hydrate=function(t,e,n){if(!Ku(e))throw Error(z(200));return Qu(null,t,e,!0,n)};nn.hydrateRoot=function(t,e,n){if(!Lf(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Rx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Px(e,null,t,1,n??null,s,!1,i,o),t[ar]=e.current,Qo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Gu(e)};nn.render=function(t,e,n){if(!Ku(e))throw Error(z(200));return Qu(null,t,e,!1,n)};nn.unmountComponentAtNode=function(t){if(!Ku(t))throw Error(z(40));return t._reactRootContainer?(Ss(function(){Qu(null,null,t,!1,function(){t._reactRootContainer=null,t[ar]=null})}),!0):!1};nn.unstable_batchedUpdates=Nf;nn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ku(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return Qu(t,e,n,!1,r)};nn.version="18.3.1-next-f1338f8080-20240426";function Nx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Nx)}catch(t){console.error(t)}}Nx(),Nv.exports=nn;var xa=Nv.exports,zg=xa;Td.createRoot=zg.createRoot,Td.hydrateRoot=zg.hydrateRoot;var Bg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},mT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Dx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,c=u?t[s+2]:0,f=i>>2,p=(i&3)<<4|l>>4;let y=(l&15)<<2|c>>6,I=c&63;u||(I=64,o||(y=64)),r.push(n[f],n[p],n[y],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(kx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):mT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||c==null||p==null)throw new gT;const y=i<<2|l>>4;if(r.push(y),c!==64){const I=l<<4&240|c>>2;if(r.push(I),p!==64){const D=c<<6&192|p;r.push(D)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class gT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yT=function(t){const e=kx(t);return Dx.encodeByteArray(e,!0)},gu=function(t){return yT(t).replace(/\./g,"")},jx=function(t){try{return Dx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T=()=>vT().__FIREBASE_DEFAULTS__,xT=()=>{if(typeof process>"u"||typeof Bg>"u")return;const t=Bg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},wT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&jx(t[1]);return e&&JSON.parse(e)},Yu=()=>{try{return _T()||xT()||wT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ox=t=>{var e,n;return(n=(e=Yu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},ET=t=>{const e=Ox(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Vx=()=>{var t;return(t=Yu())===null||t===void 0?void 0:t.config},Mx=t=>{var e;return(e=Yu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ST(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[gu(JSON.stringify(n)),gu(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function TT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tt())}function IT(){var t;const e=(t=Yu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function CT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function AT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function PT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RT(){const t=Tt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function NT(){return!IT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kT(){try{return typeof indexedDB=="object"}catch{return!1}}function DT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="FirebaseError";class mr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=jT,Object.setPrototypeOf(this,mr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wa.prototype.create)}}class wa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?OT(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new mr(s,l,r)}}function OT(t,e){return t.replace(VT,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const VT=/\{\$([^}]+)}/g;function MT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function yu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if($g(i)&&$g(o)){if(!yu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function $g(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ea(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function LT(t,e){const n=new FT(t,e);return n.subscribe.bind(n)}class FT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");UT(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=id),s.error===void 0&&(s.error=id),s.complete===void 0&&(s.complete=id);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function id(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(t){return t&&t._delegate?t._delegate:t}class Ts{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new bT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($T(e))try{this.getOrInitializeService({instanceIdentifier:us})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=us){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=us){return this.instances.has(e)}getOptions(e=us){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:BT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=us){return this.component?this.component.multipleInstances?e:us:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function BT(t){return t===us?void 0:t}function $T(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new zT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ce;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ce||(ce={}));const WT={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},qT=ce.INFO,GT={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},KT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=GT[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ff{constructor(e){this.name=e,this._logLevel=qT,this._logHandler=KT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...e),this._logHandler(this,ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...e),this._logHandler(this,ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...e),this._logHandler(this,ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...e),this._logHandler(this,ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...e),this._logHandler(this,ce.ERROR,...e)}}const QT=(t,e)=>e.some(n=>t instanceof n);let Hg,Wg;function YT(){return Hg||(Hg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function XT(){return Wg||(Wg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lx=new WeakMap,vh=new WeakMap,Fx=new WeakMap,od=new WeakMap,Uf=new WeakMap;function JT(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Hr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Lx.set(n,t)}).catch(()=>{}),Uf.set(e,t),e}function ZT(t){if(vh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});vh.set(t,e)}let _h={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return vh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Fx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Hr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function eI(t){_h=t(_h)}function tI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ad(this),e,...n);return Fx.set(r,e.sort?e.sort():[e]),Hr(r)}:XT().includes(t)?function(...e){return t.apply(ad(this),e),Hr(Lx.get(this))}:function(...e){return Hr(t.apply(ad(this),e))}}function nI(t){return typeof t=="function"?tI(t):(t instanceof IDBTransaction&&ZT(t),QT(t,YT())?new Proxy(t,_h):t)}function Hr(t){if(t instanceof IDBRequest)return JT(t);if(od.has(t))return od.get(t);const e=nI(t);return e!==t&&(od.set(t,e),Uf.set(e,t)),e}const ad=t=>Uf.get(t);function rI(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Hr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Hr(o.result),u.oldVersion,u.newVersion,Hr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const sI=["get","getKey","getAll","getAllKeys","count"],iI=["put","add","delete","clear"],ld=new Map;function qg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ld.get(e))return ld.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=iI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||sI.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),s&&u.done]))[0]};return ld.set(e,i),i}eI(t=>({...t,get:(e,n,r)=>qg(e,n)||t.get(e,n,r),has:(e,n)=>!!qg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(aI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function aI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const xh="@firebase/app",Gg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cr=new Ff("@firebase/app"),lI="@firebase/app-compat",uI="@firebase/analytics-compat",cI="@firebase/analytics",dI="@firebase/app-check-compat",hI="@firebase/app-check",fI="@firebase/auth",pI="@firebase/auth-compat",mI="@firebase/database",gI="@firebase/data-connect",yI="@firebase/database-compat",vI="@firebase/functions",_I="@firebase/functions-compat",xI="@firebase/installations",wI="@firebase/installations-compat",EI="@firebase/messaging",bI="@firebase/messaging-compat",SI="@firebase/performance",TI="@firebase/performance-compat",II="@firebase/remote-config",CI="@firebase/remote-config-compat",AI="@firebase/storage",PI="@firebase/storage-compat",RI="@firebase/firestore",NI="@firebase/vertexai-preview",kI="@firebase/firestore-compat",DI="firebase",jI="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh="[DEFAULT]",OI={[xh]:"fire-core",[lI]:"fire-core-compat",[cI]:"fire-analytics",[uI]:"fire-analytics-compat",[hI]:"fire-app-check",[dI]:"fire-app-check-compat",[fI]:"fire-auth",[pI]:"fire-auth-compat",[mI]:"fire-rtdb",[gI]:"fire-data-connect",[yI]:"fire-rtdb-compat",[vI]:"fire-fn",[_I]:"fire-fn-compat",[xI]:"fire-iid",[wI]:"fire-iid-compat",[EI]:"fire-fcm",[bI]:"fire-fcm-compat",[SI]:"fire-perf",[TI]:"fire-perf-compat",[II]:"fire-rc",[CI]:"fire-rc-compat",[AI]:"fire-gcs",[PI]:"fire-gcs-compat",[RI]:"fire-fst",[kI]:"fire-fst-compat",[NI]:"fire-vertex","fire-js":"fire-js",[DI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vu=new Map,VI=new Map,Eh=new Map;function Kg(t,e){try{t.container.addComponent(e)}catch(n){cr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ti(t){const e=t.name;if(Eh.has(e))return cr.debug(`There were multiple attempts to register component ${e}.`),!1;Eh.set(e,t);for(const n of vu.values())Kg(n,t);for(const n of VI.values())Kg(n,t);return!0}function zf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function er(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wr=new wa("app","Firebase",MI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ts("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi=jI;function Ux(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:wh,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Wr.create("bad-app-name",{appName:String(s)});if(n||(n=Vx()),!n)throw Wr.create("no-options");const i=vu.get(s);if(i){if(yu(n,i.options)&&yu(r,i.config))return i;throw Wr.create("duplicate-app",{appName:s})}const o=new HT(s);for(const u of Eh.values())o.addComponent(u);const l=new LI(n,r,o);return vu.set(s,l),l}function zx(t=wh){const e=vu.get(t);if(!e&&t===wh&&Vx())return Ux();if(!e)throw Wr.create("no-app",{appName:t});return e}function qr(t,e,n){var r;let s=(r=OI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),cr.warn(l.join(" "));return}Ti(new Ts(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="firebase-heartbeat-database",UI=1,sa="firebase-heartbeat-store";let ud=null;function Bx(){return ud||(ud=rI(FI,UI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(sa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Wr.create("idb-open",{originalErrorMessage:t.message})})),ud}async function zI(t){try{const n=(await Bx()).transaction(sa),r=await n.objectStore(sa).get($x(t));return await n.done,r}catch(e){if(e instanceof mr)cr.warn(e.message);else{const n=Wr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});cr.warn(n.message)}}}async function Qg(t,e){try{const r=(await Bx()).transaction(sa,"readwrite");await r.objectStore(sa).put(e,$x(t)),await r.done}catch(n){if(n instanceof mr)cr.warn(n.message);else{const r=Wr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});cr.warn(r.message)}}}function $x(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=1024,$I=30*24*60*60*1e3;class HI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new qI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Yg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=$I}),this._storage.overwrite(this._heartbeatsCache))}catch(r){cr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Yg(),{heartbeatsToSend:r,unsentEntries:s}=WI(this._heartbeatsCache.heartbeats),i=gu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return cr.warn(n),""}}}function Yg(){return new Date().toISOString().substring(0,10)}function WI(t,e=BI){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Xg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Xg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class qI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kT()?DT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await zI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Qg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Qg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Xg(t){return gu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(t){Ti(new Ts("platform-logger",e=>new oI(e),"PRIVATE")),Ti(new Ts("heartbeat",e=>new HI(e),"PRIVATE")),qr(xh,Gg,t),qr(xh,Gg,"esm2017"),qr("fire-js","")}GI("");function Bf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Hx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const KI=Hx,Wx=new wa("auth","Firebase",Hx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _u=new Ff("@firebase/auth");function QI(t,...e){_u.logLevel<=ce.WARN&&_u.warn(`Auth (${Mi}): ${t}`,...e)}function Ol(t,...e){_u.logLevel<=ce.ERROR&&_u.error(`Auth (${Mi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t,...e){throw Hf(t,...e)}function Cn(t,...e){return Hf(t,...e)}function $f(t,e,n){const r=Object.assign(Object.assign({},KI()),{[e]:n});return new wa("auth","Firebase",r).create(e,{appName:t.name})}function ys(t){return $f(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function YI(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Bn(t,"argument-error"),$f(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Hf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Wx.create(t,...e)}function ee(t,e,...n){if(!t)throw Hf(e,...n)}function tr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ol(e),new Error(e)}function dr(t,e){t||tr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function XI(){return Jg()==="http:"||Jg()==="https:"}function Jg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XI()||AT()||"connection"in navigator)?navigator.onLine:!0}function ZI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e,n){this.shortDelay=e,this.longDelay=n,dr(n>e,"Short delay should be less than long delay!"),this.isMobile=TT()||PT()}get(){return JI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wf(t,e){dr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;tr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;tr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;tr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=new ba(3e4,6e4);function qf(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Li(t,e,n,r,s={}){return Gx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Ea(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:u},i);return CT()||(c.referrerPolicy="no-referrer"),qx.fetch()(Kx(t,t.config.apiHost,n,l),c)})}async function Gx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},eC),e);try{const s=new rC(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw fl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,c]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw fl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw fl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw fl(t,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw $f(t,f,c);Bn(t,f)}}catch(s){if(s instanceof mr)throw s;Bn(t,"network-request-failed",{message:String(s)})}}async function nC(t,e,n,r,s={}){const i=await Li(t,e,n,r,s);return"mfaPendingCredential"in i&&Bn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Kx(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Wf(t.config,s):`${t.config.apiScheme}://${s}`}class rC{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Cn(this.auth,"network-request-failed")),tC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function fl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Cn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sC(t,e){return Li(t,"POST","/v1/accounts:delete",e)}async function Qx(t,e){return Li(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function iC(t,e=!1){const n=Nt(t),r=await n.getIdToken(e),s=Gf(r);ee(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Vo(cd(s.auth_time)),issuedAtTime:Vo(cd(s.iat)),expirationTime:Vo(cd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function cd(t){return Number(t)*1e3}function Gf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ol("JWT malformed, contained fewer than 3 sections"),null;try{const s=jx(n);return s?JSON.parse(s):(Ol("Failed to decode base64 JWT payload"),null)}catch(s){return Ol("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Zg(t){const e=Gf(t);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ia(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof mr&&oC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function oC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vo(this.lastLoginAt),this.creationTime=Vo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await ia(t,Qx(n,{idToken:r}));ee(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Yx(i.providerUserInfo):[],l=uC(t.providerData,o),u=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),f=u?c:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Sh(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function lC(t){const e=Nt(t);await xu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uC(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Yx(t){return t.map(e=>{var{providerId:n}=e,r=Bf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cC(t,e){const n=await Gx(t,{},async()=>{const r=Ea({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=Kx(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",qx.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function dC(t,e){return Li(t,"POST","/v2/accounts:revokeToken",qf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Zg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const n=Zg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await cC(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new pi;return r&&(ee(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ee(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ee(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new pi,this.toJSON())}_performRefresh(){return tr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(t,e){ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class nr{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Bf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new aC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Sh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ia(this,this.stsTokenManager.getToken(this.auth,e));return ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return iC(this,e)}reload(){return lC(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new nr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await xu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(er(this.auth.app))return Promise.reject(ys(this.auth));const e=await this.getIdToken();return await ia(this,sC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,u,c,f;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(s=n.email)!==null&&s!==void 0?s:void 0,I=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,D=(o=n.photoURL)!==null&&o!==void 0?o:void 0,E=(l=n.tenantId)!==null&&l!==void 0?l:void 0,N=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,b=(c=n.createdAt)!==null&&c!==void 0?c:void 0,w=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:v,emailVerified:S,isAnonymous:P,providerData:C,stsTokenManager:x}=n;ee(v&&x,e,"internal-error");const g=pi.fromJSON(this.name,x);ee(typeof v=="string",e,"internal-error"),br(p,e.name),br(y,e.name),ee(typeof S=="boolean",e,"internal-error"),ee(typeof P=="boolean",e,"internal-error"),br(I,e.name),br(D,e.name),br(E,e.name),br(N,e.name),br(b,e.name),br(w,e.name);const _=new nr({uid:v,auth:e,email:y,emailVerified:S,displayName:p,isAnonymous:P,photoURL:D,phoneNumber:I,tenantId:E,stsTokenManager:g,createdAt:b,lastLoginAt:w});return C&&Array.isArray(C)&&(_.providerData=C.map(A=>Object.assign({},A))),N&&(_._redirectEventId=N),_}static async _fromIdTokenResponse(e,n,r=!1){const s=new pi;s.updateFromServerResponse(n);const i=new nr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await xu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ee(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Yx(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new pi;l.updateFromIdToken(r);const u=new nr({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Sh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey=new Map;function rr(t){dr(t instanceof Function,"Expected a class definition");let e=ey.get(t);return e?(dr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ey.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Xx.type="NONE";const ty=Xx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vl(t,e,n){return`firebase:${t}:${e}:${n}`}class mi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Vl(this.userKey,s.apiKey,i),this.fullPersistenceKey=Vl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?nr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new mi(rr(ty),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||rr(ty);const o=Vl(r,e.config.apiKey,e.name);let l=null;for(const c of n)try{const f=await c._get(o);if(f){const p=nr._fromJSON(e,f);c!==i&&(l=p),i=c;break}}catch{}const u=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new mi(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new mi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(t0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Jx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(r0(e))return"Blackberry";if(s0(e))return"Webos";if(Zx(e))return"Safari";if((e.includes("chrome/")||e0(e))&&!e.includes("edge/"))return"Chrome";if(n0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Jx(t=Tt()){return/firefox\//i.test(t)}function Zx(t=Tt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function e0(t=Tt()){return/crios\//i.test(t)}function t0(t=Tt()){return/iemobile/i.test(t)}function n0(t=Tt()){return/android/i.test(t)}function r0(t=Tt()){return/blackberry/i.test(t)}function s0(t=Tt()){return/webos/i.test(t)}function Kf(t=Tt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function hC(t=Tt()){var e;return Kf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function fC(){return RT()&&document.documentMode===10}function i0(t=Tt()){return Kf(t)||n0(t)||s0(t)||r0(t)||/windows phone/i.test(t)||t0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(t,e=[]){let n;switch(t){case"Browser":n=ny(Tt());break;case"Worker":n=`${ny(Tt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Mi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(t,e={}){return Li(t,"GET","/v2/passwordPolicy",qf(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=6;class yC{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:gC,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ry(this),this.idTokenSubscription=new ry(this),this.beforeStateQueue=new pC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=rr(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await mi.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Qx(this,{idToken:e}),r=await nr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(er(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await xu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ZI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(er(this.app))return Promise.reject(ys(this));const n=e?Nt(e):null;return n&&ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return er(this.app)?Promise.reject(ys(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return er(this.app)?Promise.reject(ys(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(rr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await mC(this),n=new yC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new wa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await dC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&rr(e)||this._popupRedirectResolver;ee(n,this,"argument-error"),this.redirectPersistenceManager=await mi.create(this,[rr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=o0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&QI(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Xu(t){return Nt(t)}class ry{constructor(e){this.auth=e,this.observer=null,this.addObserver=LT(n=>this.observer=n)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _C(t){Qf=t}function xC(t){return Qf.loadJS(t)}function wC(){return Qf.gapiScript}function EC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(t,e){const n=zf(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(yu(i,e??{}))return s;Bn(s,"already-initialized")}return n.initialize({options:e})}function SC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(rr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function TC(t,e,n){const r=Xu(t);ee(r._canInitEmulator,r,"emulator-config-failed"),ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=a0(e),{host:o,port:l}=IC(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),CC()}function a0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function IC(t){const e=a0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:sy(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:sy(o)}}}function sy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function CC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return tr("not implemented")}_getIdTokenResponse(e){return tr("not implemented")}_linkToIdToken(e,n){return tr("not implemented")}_getReauthenticationResolver(e){return tr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gi(t,e){return nC(t,"POST","/v1/accounts:signInWithIdp",qf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="http://localhost";class Is extends l0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Is(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Bn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Bf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Is(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return gi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,gi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,gi(e,n)}buildRequest(){const e={requestUri:AC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ea(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends Yf{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr extends Sa{constructor(){super("facebook.com")}static credential(e){return Is._fromParams({providerId:Rr.PROVIDER_ID,signInMethod:Rr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rr.credentialFromTaggedObject(e)}static credentialFromError(e){return Rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rr.credential(e.oauthAccessToken)}catch{return null}}}Rr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Rr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn extends Sa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Is._fromParams({providerId:Xn.PROVIDER_ID,signInMethod:Xn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Xn.credentialFromTaggedObject(e)}static credentialFromError(e){return Xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Xn.credential(n,r)}catch{return null}}}Xn.GOOGLE_SIGN_IN_METHOD="google.com";Xn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr extends Sa{constructor(){super("github.com")}static credential(e){return Is._fromParams({providerId:Nr.PROVIDER_ID,signInMethod:Nr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nr.credentialFromTaggedObject(e)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Nr.credential(e.oauthAccessToken)}catch{return null}}}Nr.GITHUB_SIGN_IN_METHOD="github.com";Nr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr extends Sa{constructor(){super("twitter.com")}static credential(e,n){return Is._fromParams({providerId:kr.PROVIDER_ID,signInMethod:kr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return kr.credentialFromTaggedObject(e)}static credentialFromError(e){return kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return kr.credential(n,r)}catch{return null}}}kr.TWITTER_SIGN_IN_METHOD="twitter.com";kr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await nr._fromIdTokenResponse(e,r,s),o=iy(r);return new Ii({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=iy(r);return new Ii({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function iy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends mr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,wu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new wu(e,n,r,s)}}function u0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?wu._fromErrorAndOperation(t,i,e,r):i})}async function PC(t,e,n=!1){const r=await ia(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ii._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RC(t,e,n=!1){const{auth:r}=t;if(er(r.app))return Promise.reject(ys(r));const s="reauthenticate";try{const i=await ia(t,u0(r,s,e,t),n);ee(i.idToken,r,"internal-error");const o=Gf(i.idToken);ee(o,r,"internal-error");const{sub:l}=o;return ee(t.uid===l,r,"user-mismatch"),Ii._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Bn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NC(t,e,n=!1){if(er(t.app))return Promise.reject(ys(t));const r="signIn",s=await u0(t,r,e),i=await Ii._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function kC(t,e,n,r){return Nt(t).onIdTokenChanged(e,n,r)}function DC(t,e,n){return Nt(t).beforeAuthStateChanged(e,n)}function jC(t,e,n,r){return Nt(t).onAuthStateChanged(e,n,r)}function OC(t){return Nt(t).signOut()}const Eu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Eu,"1"),this.storage.removeItem(Eu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC=1e3,MC=10;class d0 extends c0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=i0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);fC()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,MC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},VC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}d0.type="LOCAL";const LC=d0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0 extends c0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}h0.type="SESSION";const f0=h0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Ju(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async c=>c(n.origin,i)),u=await FC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ju.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const c=Xf("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const y=p;if(y.data.eventId===c)switch(y.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(y.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(){return window}function zC(t){Fn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(){return typeof Fn().WorkerGlobalScope<"u"&&typeof Fn().importScripts=="function"}async function BC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $C(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function HC(){return p0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0="firebaseLocalStorageDb",WC=1,bu="firebaseLocalStorage",g0="fbase_key";class Ta{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Zu(t,e){return t.transaction([bu],e?"readwrite":"readonly").objectStore(bu)}function qC(){const t=indexedDB.deleteDatabase(m0);return new Ta(t).toPromise()}function Th(){const t=indexedDB.open(m0,WC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(bu,{keyPath:g0})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(bu)?e(r):(r.close(),await qC(),e(await Th()))})})}async function oy(t,e,n){const r=Zu(t,!0).put({[g0]:e,value:n});return new Ta(r).toPromise()}async function GC(t,e){const n=Zu(t,!1).get(e),r=await new Ta(n).toPromise();return r===void 0?null:r.value}function ay(t,e){const n=Zu(t,!0).delete(e);return new Ta(n).toPromise()}const KC=800,QC=3;class y0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Th(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>QC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return p0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ju._getInstance(HC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await BC(),!this.activeServiceWorker)return;this.sender=new UC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$C()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Th();return await oy(e,Eu,"1"),await ay(e,Eu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>oy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>GC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ay(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Zu(s,!1).getAll();return new Ta(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),KC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}y0.type="LOCAL";const YC=y0;new ba(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t,e){return e?rr(e):(ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf extends l0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return gi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return gi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return gi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function XC(t){return NC(t.auth,new Jf(t),t.bypassAuthState)}function JC(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),RC(n,new Jf(t),t.bypassAuthState)}async function ZC(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),PC(n,new Jf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XC;case"linkViaPopup":case"linkViaRedirect":return ZC;case"reauthViaPopup":case"reauthViaRedirect":return JC;default:Bn(this.auth,"internal-error")}}resolve(e){dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA=new ba(2e3,1e4);async function tA(t,e,n){if(er(t.app))return Promise.reject(Cn(t,"operation-not-supported-in-this-environment"));const r=Xu(t);YI(t,e,Yf);const s=v0(r,n);return new fs(r,"signInViaPopup",e,s).executeNotNull()}class fs extends _0{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,fs.currentPopupAction&&fs.currentPopupAction.cancel(),fs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){dr(this.filter.length===1,"Popup operations only handle one event");const e=Xf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Cn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Cn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,eA.get())};e()}}fs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="pendingRedirect",Ml=new Map;class rA extends _0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ml.get(this.auth._key());if(!e){try{const r=await sA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ml.set(this.auth._key(),e)}return this.bypassAuthState||Ml.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sA(t,e){const n=aA(e),r=oA(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function iA(t,e){Ml.set(t._key(),e)}function oA(t){return rr(t._redirectPersistence)}function aA(t){return Vl(nA,t.config.apiKey,t.name)}async function lA(t,e,n=!1){if(er(t.app))return Promise.reject(ys(t));const r=Xu(t),s=v0(r,e),o=await new rA(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=10*60*1e3;class cA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!dA(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!x0(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Cn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=uA&&this.cachedEventUids.clear(),this.cachedEventUids.has(ly(e))}saveEventToCache(e){this.cachedEventUids.add(ly(e)),this.lastProcessedEventTime=Date.now()}}function ly(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function x0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function dA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return x0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hA(t,e={}){return Li(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pA=/^https?/;async function mA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await hA(t);for(const n of e)try{if(gA(n))return}catch{}Bn(t,"unauthorized-domain")}function gA(t){const e=bh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!pA.test(n))return!1;if(fA.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA=new ba(3e4,6e4);function uy(){const t=Fn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function vA(t){return new Promise((e,n)=>{var r,s,i;function o(){uy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{uy(),n(Cn(t,"network-request-failed"))},timeout:yA.get()})}if(!((s=(r=Fn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Fn().gapi)===null||i===void 0)&&i.load)o();else{const l=EC("iframefcb");return Fn()[l]=()=>{gapi.load?o():n(Cn(t,"network-request-failed"))},xC(`${wC()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw Ll=null,e})}let Ll=null;function _A(t){return Ll=Ll||vA(t),Ll}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=new ba(5e3,15e3),wA="__/auth/iframe",EA="emulator/auth/iframe",bA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function TA(t){const e=t.config;ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Wf(e,EA):`https://${t.config.authDomain}/${wA}`,r={apiKey:e.apiKey,appName:t.name,v:Mi},s=SA.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Ea(r).slice(1)}`}async function IA(t){const e=await _A(t),n=Fn().gapi;return ee(n,t,"internal-error"),e.open({where:document.body,url:TA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bA,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Cn(t,"network-request-failed"),l=Fn().setTimeout(()=>{i(o)},xA.get());function u(){Fn().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},AA=500,PA=600,RA="_blank",NA="http://localhost";class cy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function kA(t,e,n,r=AA,s=PA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},CA),{width:r.toString(),height:s.toString(),top:i,left:o}),c=Tt().toLowerCase();n&&(l=e0(c)?RA:n),Jx(c)&&(e=e||NA,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[I,D])=>`${y}${I}=${D},`,"");if(hC(c)&&l!=="_self")return DA(e||"",l),new cy(null);const p=window.open(e||"",l,f);ee(p,t,"popup-blocked");try{p.focus()}catch{}return new cy(p)}function DA(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA="__/auth/handler",OA="emulator/auth/handler",VA=encodeURIComponent("fac");async function dy(t,e,n,r,s,i){ee(t.config.authDomain,t,"auth-domain-config-required"),ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Mi,eventId:s};if(e instanceof Yf){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",MT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof Sa){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await t._getAppCheckToken(),c=u?`#${VA}=${encodeURIComponent(u)}`:"";return`${MA(t)}?${Ea(l).slice(1)}${c}`}function MA({config:t}){return t.emulator?Wf(t,OA):`https://${t.authDomain}/${jA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd="webStorageSupport";class LA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=f0,this._completeRedirectFn=lA,this._overrideRedirectResult=iA}async _openPopup(e,n,r,s){var i;dr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await dy(e,n,r,bh(),s);return kA(e,o,Xf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await dy(e,n,r,bh(),s);return zC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(dr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await IA(e),r=new cA(e);return n.register("authEvent",s=>(ee(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(dd,{type:dd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[dd];o!==void 0&&n(!!o),Bn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=mA(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return i0()||Zx()||Kf()}}const FA=LA;var hy="@firebase/auth",fy="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function BA(t){Ti(new Ts("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ee(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:o0(t)},c=new vC(r,s,i,u);return SC(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ti(new Ts("auth-internal",e=>{const n=Xu(e.getProvider("auth").getImmediate());return(r=>new UA(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),qr(hy,fy,zA(t)),qr(hy,fy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=5*60,HA=Mx("authIdTokenMaxAge")||$A;let py=null;const WA=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>HA)return;const s=n==null?void 0:n.token;py!==s&&(py=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function qA(t=zx()){const e=zf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=bC(t,{popupRedirectResolver:FA,persistence:[YC,LC,f0]}),r=Mx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=WA(i.toString());DC(n,o,()=>o(n.currentUser)),kC(n,l=>o(l))}}const s=Ox("auth");return s&&TC(n,`http://${s}`),n}function GA(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}_C({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Cn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",GA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});BA("Browser");var KA="firebase",QA="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qr(KA,QA,"app");var my=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vs,w0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,g){function _(){}_.prototype=g.prototype,x.D=g.prototype,x.prototype=new _,x.prototype.constructor=x,x.C=function(A,k,j){for(var R=Array(arguments.length-2),H=2;H<arguments.length;H++)R[H-2]=arguments[H];return g.prototype[k].apply(A,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,g,_){_||(_=0);var A=Array(16);if(typeof g=="string")for(var k=0;16>k;++k)A[k]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(k=0;16>k;++k)A[k]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=x.g[0],_=x.g[1],k=x.g[2];var j=x.g[3],R=g+(j^_&(k^j))+A[0]+3614090360&4294967295;g=_+(R<<7&4294967295|R>>>25),R=j+(k^g&(_^k))+A[1]+3905402710&4294967295,j=g+(R<<12&4294967295|R>>>20),R=k+(_^j&(g^_))+A[2]+606105819&4294967295,k=j+(R<<17&4294967295|R>>>15),R=_+(g^k&(j^g))+A[3]+3250441966&4294967295,_=k+(R<<22&4294967295|R>>>10),R=g+(j^_&(k^j))+A[4]+4118548399&4294967295,g=_+(R<<7&4294967295|R>>>25),R=j+(k^g&(_^k))+A[5]+1200080426&4294967295,j=g+(R<<12&4294967295|R>>>20),R=k+(_^j&(g^_))+A[6]+2821735955&4294967295,k=j+(R<<17&4294967295|R>>>15),R=_+(g^k&(j^g))+A[7]+4249261313&4294967295,_=k+(R<<22&4294967295|R>>>10),R=g+(j^_&(k^j))+A[8]+1770035416&4294967295,g=_+(R<<7&4294967295|R>>>25),R=j+(k^g&(_^k))+A[9]+2336552879&4294967295,j=g+(R<<12&4294967295|R>>>20),R=k+(_^j&(g^_))+A[10]+4294925233&4294967295,k=j+(R<<17&4294967295|R>>>15),R=_+(g^k&(j^g))+A[11]+2304563134&4294967295,_=k+(R<<22&4294967295|R>>>10),R=g+(j^_&(k^j))+A[12]+1804603682&4294967295,g=_+(R<<7&4294967295|R>>>25),R=j+(k^g&(_^k))+A[13]+4254626195&4294967295,j=g+(R<<12&4294967295|R>>>20),R=k+(_^j&(g^_))+A[14]+2792965006&4294967295,k=j+(R<<17&4294967295|R>>>15),R=_+(g^k&(j^g))+A[15]+1236535329&4294967295,_=k+(R<<22&4294967295|R>>>10),R=g+(k^j&(_^k))+A[1]+4129170786&4294967295,g=_+(R<<5&4294967295|R>>>27),R=j+(_^k&(g^_))+A[6]+3225465664&4294967295,j=g+(R<<9&4294967295|R>>>23),R=k+(g^_&(j^g))+A[11]+643717713&4294967295,k=j+(R<<14&4294967295|R>>>18),R=_+(j^g&(k^j))+A[0]+3921069994&4294967295,_=k+(R<<20&4294967295|R>>>12),R=g+(k^j&(_^k))+A[5]+3593408605&4294967295,g=_+(R<<5&4294967295|R>>>27),R=j+(_^k&(g^_))+A[10]+38016083&4294967295,j=g+(R<<9&4294967295|R>>>23),R=k+(g^_&(j^g))+A[15]+3634488961&4294967295,k=j+(R<<14&4294967295|R>>>18),R=_+(j^g&(k^j))+A[4]+3889429448&4294967295,_=k+(R<<20&4294967295|R>>>12),R=g+(k^j&(_^k))+A[9]+568446438&4294967295,g=_+(R<<5&4294967295|R>>>27),R=j+(_^k&(g^_))+A[14]+3275163606&4294967295,j=g+(R<<9&4294967295|R>>>23),R=k+(g^_&(j^g))+A[3]+4107603335&4294967295,k=j+(R<<14&4294967295|R>>>18),R=_+(j^g&(k^j))+A[8]+1163531501&4294967295,_=k+(R<<20&4294967295|R>>>12),R=g+(k^j&(_^k))+A[13]+2850285829&4294967295,g=_+(R<<5&4294967295|R>>>27),R=j+(_^k&(g^_))+A[2]+4243563512&4294967295,j=g+(R<<9&4294967295|R>>>23),R=k+(g^_&(j^g))+A[7]+1735328473&4294967295,k=j+(R<<14&4294967295|R>>>18),R=_+(j^g&(k^j))+A[12]+2368359562&4294967295,_=k+(R<<20&4294967295|R>>>12),R=g+(_^k^j)+A[5]+4294588738&4294967295,g=_+(R<<4&4294967295|R>>>28),R=j+(g^_^k)+A[8]+2272392833&4294967295,j=g+(R<<11&4294967295|R>>>21),R=k+(j^g^_)+A[11]+1839030562&4294967295,k=j+(R<<16&4294967295|R>>>16),R=_+(k^j^g)+A[14]+4259657740&4294967295,_=k+(R<<23&4294967295|R>>>9),R=g+(_^k^j)+A[1]+2763975236&4294967295,g=_+(R<<4&4294967295|R>>>28),R=j+(g^_^k)+A[4]+1272893353&4294967295,j=g+(R<<11&4294967295|R>>>21),R=k+(j^g^_)+A[7]+4139469664&4294967295,k=j+(R<<16&4294967295|R>>>16),R=_+(k^j^g)+A[10]+3200236656&4294967295,_=k+(R<<23&4294967295|R>>>9),R=g+(_^k^j)+A[13]+681279174&4294967295,g=_+(R<<4&4294967295|R>>>28),R=j+(g^_^k)+A[0]+3936430074&4294967295,j=g+(R<<11&4294967295|R>>>21),R=k+(j^g^_)+A[3]+3572445317&4294967295,k=j+(R<<16&4294967295|R>>>16),R=_+(k^j^g)+A[6]+76029189&4294967295,_=k+(R<<23&4294967295|R>>>9),R=g+(_^k^j)+A[9]+3654602809&4294967295,g=_+(R<<4&4294967295|R>>>28),R=j+(g^_^k)+A[12]+3873151461&4294967295,j=g+(R<<11&4294967295|R>>>21),R=k+(j^g^_)+A[15]+530742520&4294967295,k=j+(R<<16&4294967295|R>>>16),R=_+(k^j^g)+A[2]+3299628645&4294967295,_=k+(R<<23&4294967295|R>>>9),R=g+(k^(_|~j))+A[0]+4096336452&4294967295,g=_+(R<<6&4294967295|R>>>26),R=j+(_^(g|~k))+A[7]+1126891415&4294967295,j=g+(R<<10&4294967295|R>>>22),R=k+(g^(j|~_))+A[14]+2878612391&4294967295,k=j+(R<<15&4294967295|R>>>17),R=_+(j^(k|~g))+A[5]+4237533241&4294967295,_=k+(R<<21&4294967295|R>>>11),R=g+(k^(_|~j))+A[12]+1700485571&4294967295,g=_+(R<<6&4294967295|R>>>26),R=j+(_^(g|~k))+A[3]+2399980690&4294967295,j=g+(R<<10&4294967295|R>>>22),R=k+(g^(j|~_))+A[10]+4293915773&4294967295,k=j+(R<<15&4294967295|R>>>17),R=_+(j^(k|~g))+A[1]+2240044497&4294967295,_=k+(R<<21&4294967295|R>>>11),R=g+(k^(_|~j))+A[8]+1873313359&4294967295,g=_+(R<<6&4294967295|R>>>26),R=j+(_^(g|~k))+A[15]+4264355552&4294967295,j=g+(R<<10&4294967295|R>>>22),R=k+(g^(j|~_))+A[6]+2734768916&4294967295,k=j+(R<<15&4294967295|R>>>17),R=_+(j^(k|~g))+A[13]+1309151649&4294967295,_=k+(R<<21&4294967295|R>>>11),R=g+(k^(_|~j))+A[4]+4149444226&4294967295,g=_+(R<<6&4294967295|R>>>26),R=j+(_^(g|~k))+A[11]+3174756917&4294967295,j=g+(R<<10&4294967295|R>>>22),R=k+(g^(j|~_))+A[2]+718787259&4294967295,k=j+(R<<15&4294967295|R>>>17),R=_+(j^(k|~g))+A[9]+3951481745&4294967295,x.g[0]=x.g[0]+g&4294967295,x.g[1]=x.g[1]+(k+(R<<21&4294967295|R>>>11))&4294967295,x.g[2]=x.g[2]+k&4294967295,x.g[3]=x.g[3]+j&4294967295}r.prototype.u=function(x,g){g===void 0&&(g=x.length);for(var _=g-this.blockSize,A=this.B,k=this.h,j=0;j<g;){if(k==0)for(;j<=_;)s(this,x,j),j+=this.blockSize;if(typeof x=="string"){for(;j<g;)if(A[k++]=x.charCodeAt(j++),k==this.blockSize){s(this,A),k=0;break}}else for(;j<g;)if(A[k++]=x[j++],k==this.blockSize){s(this,A),k=0;break}}this.h=k,this.o+=g},r.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var g=1;g<x.length-8;++g)x[g]=0;var _=8*this.o;for(g=x.length-8;g<x.length;++g)x[g]=_&255,_/=256;for(this.u(x),x=Array(16),g=_=0;4>g;++g)for(var A=0;32>A;A+=8)x[_++]=this.g[g]>>>A&255;return x};function i(x,g){var _=l;return Object.prototype.hasOwnProperty.call(_,x)?_[x]:_[x]=g(x)}function o(x,g){this.h=g;for(var _=[],A=!0,k=x.length-1;0<=k;k--){var j=x[k]|0;A&&j==g||(_[k]=j,A=!1)}this.g=_}var l={};function u(x){return-128<=x&&128>x?i(x,function(g){return new o([g|0],0>g?-1:0)}):new o([x|0],0>x?-1:0)}function c(x){if(isNaN(x)||!isFinite(x))return p;if(0>x)return N(c(-x));for(var g=[],_=1,A=0;x>=_;A++)g[A]=x/_|0,_*=4294967296;return new o(g,0)}function f(x,g){if(x.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(x.charAt(0)=="-")return N(f(x.substring(1),g));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=c(Math.pow(g,8)),A=p,k=0;k<x.length;k+=8){var j=Math.min(8,x.length-k),R=parseInt(x.substring(k,k+j),g);8>j?(j=c(Math.pow(g,j)),A=A.j(j).add(c(R))):(A=A.j(_),A=A.add(c(R)))}return A}var p=u(0),y=u(1),I=u(16777216);t=o.prototype,t.m=function(){if(E(this))return-N(this).m();for(var x=0,g=1,_=0;_<this.g.length;_++){var A=this.i(_);x+=(0<=A?A:4294967296+A)*g,g*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(D(this))return"0";if(E(this))return"-"+N(this).toString(x);for(var g=c(Math.pow(x,6)),_=this,A="";;){var k=S(_,g).g;_=b(_,k.j(g));var j=((0<_.g.length?_.g[0]:_.h)>>>0).toString(x);if(_=k,D(_))return j+A;for(;6>j.length;)j="0"+j;A=j+A}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function D(x){if(x.h!=0)return!1;for(var g=0;g<x.g.length;g++)if(x.g[g]!=0)return!1;return!0}function E(x){return x.h==-1}t.l=function(x){return x=b(this,x),E(x)?-1:D(x)?0:1};function N(x){for(var g=x.g.length,_=[],A=0;A<g;A++)_[A]=~x.g[A];return new o(_,~x.h).add(y)}t.abs=function(){return E(this)?N(this):this},t.add=function(x){for(var g=Math.max(this.g.length,x.g.length),_=[],A=0,k=0;k<=g;k++){var j=A+(this.i(k)&65535)+(x.i(k)&65535),R=(j>>>16)+(this.i(k)>>>16)+(x.i(k)>>>16);A=R>>>16,j&=65535,R&=65535,_[k]=R<<16|j}return new o(_,_[_.length-1]&-2147483648?-1:0)};function b(x,g){return x.add(N(g))}t.j=function(x){if(D(this)||D(x))return p;if(E(this))return E(x)?N(this).j(N(x)):N(N(this).j(x));if(E(x))return N(this.j(N(x)));if(0>this.l(I)&&0>x.l(I))return c(this.m()*x.m());for(var g=this.g.length+x.g.length,_=[],A=0;A<2*g;A++)_[A]=0;for(A=0;A<this.g.length;A++)for(var k=0;k<x.g.length;k++){var j=this.i(A)>>>16,R=this.i(A)&65535,H=x.i(k)>>>16,ne=x.i(k)&65535;_[2*A+2*k]+=R*ne,w(_,2*A+2*k),_[2*A+2*k+1]+=j*ne,w(_,2*A+2*k+1),_[2*A+2*k+1]+=R*H,w(_,2*A+2*k+1),_[2*A+2*k+2]+=j*H,w(_,2*A+2*k+2)}for(A=0;A<g;A++)_[A]=_[2*A+1]<<16|_[2*A];for(A=g;A<2*g;A++)_[A]=0;return new o(_,0)};function w(x,g){for(;(x[g]&65535)!=x[g];)x[g+1]+=x[g]>>>16,x[g]&=65535,g++}function v(x,g){this.g=x,this.h=g}function S(x,g){if(D(g))throw Error("division by zero");if(D(x))return new v(p,p);if(E(x))return g=S(N(x),g),new v(N(g.g),N(g.h));if(E(g))return g=S(x,N(g)),new v(N(g.g),g.h);if(30<x.g.length){if(E(x)||E(g))throw Error("slowDivide_ only works with positive integers.");for(var _=y,A=g;0>=A.l(x);)_=P(_),A=P(A);var k=C(_,1),j=C(A,1);for(A=C(A,2),_=C(_,2);!D(A);){var R=j.add(A);0>=R.l(x)&&(k=k.add(_),j=R),A=C(A,1),_=C(_,1)}return g=b(x,k.j(g)),new v(k,g)}for(k=p;0<=x.l(g);){for(_=Math.max(1,Math.floor(x.m()/g.m())),A=Math.ceil(Math.log(_)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),j=c(_),R=j.j(g);E(R)||0<R.l(x);)_-=A,j=c(_),R=j.j(g);D(j)&&(j=y),k=k.add(j),x=b(x,R)}return new v(k,x)}t.A=function(x){return S(this,x).h},t.and=function(x){for(var g=Math.max(this.g.length,x.g.length),_=[],A=0;A<g;A++)_[A]=this.i(A)&x.i(A);return new o(_,this.h&x.h)},t.or=function(x){for(var g=Math.max(this.g.length,x.g.length),_=[],A=0;A<g;A++)_[A]=this.i(A)|x.i(A);return new o(_,this.h|x.h)},t.xor=function(x){for(var g=Math.max(this.g.length,x.g.length),_=[],A=0;A<g;A++)_[A]=this.i(A)^x.i(A);return new o(_,this.h^x.h)};function P(x){for(var g=x.g.length+1,_=[],A=0;A<g;A++)_[A]=x.i(A)<<1|x.i(A-1)>>>31;return new o(_,x.h)}function C(x,g){var _=g>>5;g%=32;for(var A=x.g.length-_,k=[],j=0;j<A;j++)k[j]=0<g?x.i(j+_)>>>g|x.i(j+_+1)<<32-g:x.i(j+_);return new o(k,x.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,w0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=f,vs=o}).apply(typeof my<"u"?my:typeof self<"u"?self:typeof window<"u"?window:{});var pl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var E0,bo,b0,Fl,Ih,S0,T0,I0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,m){return a==Array.prototype||a==Object.prototype||(a[h]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof pl=="object"&&pl];for(var h=0;h<a.length;++h){var m=a[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var m=r;a=a.split(".");for(var T=0;T<a.length-1;T++){var O=a[T];if(!(O in m))break e;m=m[O]}a=a[a.length-1],T=m[a],h=h(T),h!=T&&h!=null&&e(m,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var m=0,T=!1,O={next:function(){if(!T&&m<a.length){var M=m++;return{value:h(M,a[M]),done:!1}}return T=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function c(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,m){return a.call.apply(a.bind,arguments)}function p(a,h,m){if(!a)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,T),a.apply(h,O)}}return function(){return a.apply(h,arguments)}}function y(a,h,m){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,y.apply(null,arguments)}function I(a,h){var m=Array.prototype.slice.call(arguments,1);return function(){var T=m.slice();return T.push.apply(T,arguments),a.apply(this,T)}}function D(a,h){function m(){}m.prototype=h.prototype,a.aa=h.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(T,O,M){for(var B=Array(arguments.length-2),be=2;be<arguments.length;be++)B[be-2]=arguments[be];return h.prototype[O].apply(T,B)}}function E(a){const h=a.length;if(0<h){const m=Array(h);for(let T=0;T<h;T++)m[T]=a[T];return m}return[]}function N(a,h){for(let m=1;m<arguments.length;m++){const T=arguments[m];if(u(T)){const O=a.length||0,M=T.length||0;a.length=O+M;for(let B=0;B<M;B++)a[O+B]=T[B]}else a.push(T)}}class b{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function w(a){return/^[\s\xa0]*$/.test(a)}function v(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function S(a){return S[" "](a),a}S[" "]=function(){};var P=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function C(a,h,m){for(const T in a)h.call(m,a[T],T,a)}function x(a,h){for(const m in a)h.call(void 0,a[m],m,a)}function g(a){const h={};for(const m in a)h[m]=a[m];return h}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(a,h){let m,T;for(let O=1;O<arguments.length;O++){T=arguments[O];for(m in T)a[m]=T[m];for(let M=0;M<_.length;M++)m=_[M],Object.prototype.hasOwnProperty.call(T,m)&&(a[m]=T[m])}}function k(a){var h=1;a=a.split(":");const m=[];for(;0<h&&a.length;)m.push(a.shift()),h--;return a.length&&m.push(a.join(":")),m}function j(a){l.setTimeout(()=>{throw a},0)}function R(){var a=K;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class H{constructor(){this.h=this.g=null}add(h,m){const T=ne.get();T.set(h,m),this.h?this.h.next=T:this.g=T,this.h=T}}var ne=new b(()=>new re,a=>a.reset());class re{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,F=!1,K=new H,Q=()=>{const a=l.Promise.resolve(void 0);oe=()=>{a.then(we)}};var we=()=>{for(var a;a=R();){try{a.h.call(a.g)}catch(m){j(m)}var h=ne;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}F=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ke(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}ke.prototype.h=function(){this.defaultPrevented=!0};var sn=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};l.addEventListener("test",m,h),l.removeEventListener("test",m,h)}catch{}return a}();function on(a,h){if(ke.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,T=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(P){e:{try{S(h.nodeName);var O=!0;break e}catch{}O=!1}O||(h=null)}}else m=="mouseover"?h=a.fromElement:m=="mouseout"&&(h=a.toElement);this.relatedTarget=h,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:an[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&on.aa.h.call(this)}}D(on,ke);var an={2:"touch",3:"pen",4:"mouse"};on.prototype.h=function(){on.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var $="closure_listenable_"+(1e6*Math.random()|0),le=0;function ve(a,h,m,T,O){this.listener=a,this.proxy=null,this.src=h,this.type=m,this.capture=!!T,this.ha=O,this.key=++le,this.da=this.fa=!1}function Te(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Z(a){this.src=a,this.g={},this.h=0}Z.prototype.add=function(a,h,m,T,O){var M=a.toString();a=this.g[M],a||(a=this.g[M]=[],this.h++);var B=De(a,h,T,O);return-1<B?(h=a[B],m||(h.fa=!1)):(h=new ve(h,this.src,M,!!T,O),h.fa=m,a.push(h)),h};function Ee(a,h){var m=h.type;if(m in a.g){var T=a.g[m],O=Array.prototype.indexOf.call(T,h,void 0),M;(M=0<=O)&&Array.prototype.splice.call(T,O,1),M&&(Te(h),a.g[m].length==0&&(delete a.g[m],a.h--))}}function De(a,h,m,T){for(var O=0;O<a.length;++O){var M=a[O];if(!M.da&&M.listener==h&&M.capture==!!m&&M.ha==T)return O}return-1}var ge="closure_lm_"+(1e6*Math.random()|0),jt={};function Ht(a,h,m,T,O){if(Array.isArray(h)){for(var M=0;M<h.length;M++)Ht(a,h[M],m,T,O);return null}return m=Hi(m),a&&a[$]?a.K(h,m,c(T)?!!T.capture:!1,O):Wt(a,h,m,!1,T,O)}function Wt(a,h,m,T,O,M){if(!h)throw Error("Invalid event type");var B=c(O)?!!O.capture:!!O,be=Vs(a);if(be||(a[ge]=be=new Z(a)),m=be.add(h,m,T,B,M),m.proxy)return m;if(T=yn(),m.proxy=T,T.src=a,T.listener=m,a.addEventListener)sn||(O=B),O===void 0&&(O=!1),a.addEventListener(h.toString(),T,O);else if(a.attachEvent)a.attachEvent(qn(h.toString()),T);else if(a.addListener&&a.removeListener)a.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return m}function yn(){function a(m){return h.call(a.src,a.listener,m)}const h=ka;return a}function qt(a,h,m,T,O){if(Array.isArray(h))for(var M=0;M<h.length;M++)qt(a,h[M],m,T,O);else T=c(T)?!!T.capture:!!T,m=Hi(m),a&&a[$]?(a=a.i,h=String(h).toString(),h in a.g&&(M=a.g[h],m=De(M,m,T,O),-1<m&&(Te(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete a.g[h],a.h--)))):a&&(a=Vs(a))&&(h=a.g[h.toString()],a=-1,h&&(a=De(h,m,T,O)),(m=-1<a?h[a]:null)&&yr(m))}function yr(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[$])Ee(h.i,a);else{var m=a.type,T=a.proxy;h.removeEventListener?h.removeEventListener(m,T,a.capture):h.detachEvent?h.detachEvent(qn(m),T):h.addListener&&h.removeListener&&h.removeListener(T),(m=Vs(h))?(Ee(m,a),m.h==0&&(m.src=null,h[ge]=null)):Te(a)}}}function qn(a){return a in jt?jt[a]:jt[a]="on"+a}function ka(a,h){if(a.da)a=!0;else{h=new on(h,this);var m=a.listener,T=a.ha||a.src;a.fa&&yr(a),a=m.call(T,h)}return a}function Vs(a){return a=a[ge],a instanceof Z?a:null}var Nn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hi(a){return typeof a=="function"?a:(a[Nn]||(a[Nn]=function(h){return a.handleEvent(h)}),a[Nn])}function tt(){ye.call(this),this.i=new Z(this),this.M=this,this.F=null}D(tt,ye),tt.prototype[$]=!0,tt.prototype.removeEventListener=function(a,h,m,T){qt(this,a,h,m,T)};function Qe(a,h){var m,T=a.F;if(T)for(m=[];T;T=T.F)m.push(T);if(a=a.M,T=h.type||h,typeof h=="string")h=new ke(h,a);else if(h instanceof ke)h.target=h.target||a;else{var O=h;h=new ke(T,a),A(h,O)}if(O=!0,m)for(var M=m.length-1;0<=M;M--){var B=h.g=m[M];O=vr(B,T,!0,h)&&O}if(B=h.g=a,O=vr(B,T,!0,h)&&O,O=vr(B,T,!1,h)&&O,m)for(M=0;M<m.length;M++)B=h.g=m[M],O=vr(B,T,!1,h)&&O}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var m=a.g[h],T=0;T<m.length;T++)Te(m[T]);delete a.g[h],a.h--}}this.F=null},tt.prototype.K=function(a,h,m,T){return this.i.add(String(a),h,!1,m,T)},tt.prototype.L=function(a,h,m,T){return this.i.add(String(a),h,!0,m,T)};function vr(a,h,m,T){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var O=!0,M=0;M<h.length;++M){var B=h[M];if(B&&!B.da&&B.capture==m){var be=B.listener,at=B.ha||B.src;B.fa&&Ee(a.i,B),O=be.call(at,T)!==!1&&O}}return O&&!T.defaultPrevented}function Da(a,h,m){if(typeof a=="function")m&&(a=y(a,m));else if(a&&typeof a.handleEvent=="function")a=y(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function Wi(a){a.g=Da(()=>{a.g=null,a.i&&(a.i=!1,Wi(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class Y extends ye{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Wi(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function J(a){ye.call(this),this.h=a,this.g={}}D(J,ye);var fe=[];function Ie(a){C(a.g,function(h,m){this.g.hasOwnProperty(m)&&yr(h)},a),a.g={}}J.prototype.N=function(){J.aa.N.call(this),Ie(this)},J.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Gt=l.JSON.stringify,ot=l.JSON.parse,nt=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Ye(){}Ye.prototype.h=null;function Ot(a){return a.h||(a.h=a.i())}function Ms(){}var ln={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qi(){ke.call(this,"d")}D(qi,ke);function Ls(){ke.call(this,"c")}D(Ls,ke);var kn={},Hp=null;function ja(){return Hp=Hp||new tt}kn.La="serverreachability";function Wp(a){ke.call(this,kn.La,a)}D(Wp,ke);function Gi(a){const h=ja();Qe(h,new Wp(h))}kn.STAT_EVENT="statevent";function qp(a,h){ke.call(this,kn.STAT_EVENT,a),this.stat=h}D(qp,ke);function It(a){const h=ja();Qe(h,new qp(h,a))}kn.Ma="timingevent";function Gp(a,h){ke.call(this,kn.Ma,a),this.size=h}D(Gp,ke);function Ki(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function Qi(){this.g=!0}Qi.prototype.xa=function(){this.g=!1};function xE(a,h,m,T,O,M){a.info(function(){if(a.g)if(M)for(var B="",be=M.split("&"),at=0;at<be.length;at++){var pe=be[at].split("=");if(1<pe.length){var mt=pe[0];pe=pe[1];var gt=mt.split("_");B=2<=gt.length&&gt[1]=="type"?B+(mt+"="+pe+"&"):B+(mt+"=redacted&")}}else B=null;else B=M;return"XMLHTTP REQ ("+T+") [attempt "+O+"]: "+h+`
`+m+`
`+B})}function wE(a,h,m,T,O,M,B){a.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+O+"]: "+h+`
`+m+`
`+M+" "+B})}function Fs(a,h,m,T){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+bE(a,m)+(T?" "+T:"")})}function EE(a,h){a.info(function(){return"TIMEOUT: "+h})}Qi.prototype.info=function(){};function bE(a,h){if(!a.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var T=m[a];if(!(2>T.length)){var O=T[1];if(Array.isArray(O)&&!(1>O.length)){var M=O[0];if(M!="noop"&&M!="stop"&&M!="close")for(var B=1;B<O.length;B++)O[B]=""}}}}return Gt(m)}catch{return h}}var Oa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Kp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},wc;function Va(){}D(Va,Ye),Va.prototype.g=function(){return new XMLHttpRequest},Va.prototype.i=function(){return{}},wc=new Va;function _r(a,h,m,T){this.j=a,this.i=h,this.l=m,this.R=T||1,this.U=new J(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qp}function Qp(){this.i=null,this.g="",this.h=!1}var Yp={},Ec={};function bc(a,h,m){a.L=1,a.v=Ua(Gn(h)),a.m=m,a.P=!0,Xp(a,null)}function Xp(a,h){a.F=Date.now(),Ma(a),a.A=Gn(a.v);var m=a.A,T=a.R;Array.isArray(T)||(T=[String(T)]),dm(m.i,"t",T),a.C=0,m=a.j.J,a.h=new Qp,a.g=Pm(a.j,m?h:null,!a.m),0<a.O&&(a.M=new Y(y(a.Y,a,a.g),a.O)),h=a.U,m=a.g,T=a.ca;var O="readystatechange";Array.isArray(O)||(O&&(fe[0]=O.toString()),O=fe);for(var M=0;M<O.length;M++){var B=Ht(m,O[M],T||h.handleEvent,!1,h.h||h);if(!B)break;h.g[B.key]=B}h=a.H?g(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Gi(),xE(a.i,a.u,a.A,a.l,a.R,a.m)}_r.prototype.ca=function(a){a=a.target;const h=this.M;h&&Kn(a)==3?h.j():this.Y(a)},_r.prototype.Y=function(a){try{if(a==this.g)e:{const gt=Kn(this.g);var h=this.g.Ba();const Bs=this.g.Z();if(!(3>gt)&&(gt!=3||this.g&&(this.h.h||this.g.oa()||vm(this.g)))){this.J||gt!=4||h==7||(h==8||0>=Bs?Gi(3):Gi(2)),Sc(this);var m=this.g.Z();this.X=m;t:if(Jp(this)){var T=vm(this.g);a="";var O=T.length,M=Kn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ss(this),Yi(this);var B="";break t}this.h.i=new l.TextDecoder}for(h=0;h<O;h++)this.h.h=!0,a+=this.h.i.decode(T[h],{stream:!(M&&h==O-1)});T.length=0,this.h.g+=a,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=m==200,wE(this.i,this.u,this.A,this.l,this.R,gt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var be,at=this.g;if((be=at.g?at.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(be)){var pe=be;break t}}pe=null}if(m=pe)Fs(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Tc(this,m);else{this.o=!1,this.s=3,It(12),ss(this),Yi(this);break e}}if(this.P){m=!0;let vn;for(;!this.J&&this.C<B.length;)if(vn=SE(this,B),vn==Ec){gt==4&&(this.s=4,It(14),m=!1),Fs(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==Yp){this.s=4,It(15),Fs(this.i,this.l,B,"[Invalid Chunk]"),m=!1;break}else Fs(this.i,this.l,vn,null),Tc(this,vn);if(Jp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gt!=4||B.length!=0||this.h.h||(this.s=1,It(16),m=!1),this.o=this.o&&m,!m)Fs(this.i,this.l,B,"[Invalid Chunked Response]"),ss(this),Yi(this);else if(0<B.length&&!this.W){this.W=!0;var mt=this.j;mt.g==this&&mt.ba&&!mt.M&&(mt.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),Nc(mt),mt.M=!0,It(11))}}else Fs(this.i,this.l,B,null),Tc(this,B);gt==4&&ss(this),this.o&&!this.J&&(gt==4?Tm(this.j,this):(this.o=!1,Ma(this)))}else zE(this.g),m==400&&0<B.indexOf("Unknown SID")?(this.s=3,It(12)):(this.s=0,It(13)),ss(this),Yi(this)}}}catch{}finally{}};function Jp(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function SE(a,h){var m=a.C,T=h.indexOf(`
`,m);return T==-1?Ec:(m=Number(h.substring(m,T)),isNaN(m)?Yp:(T+=1,T+m>h.length?Ec:(h=h.slice(T,T+m),a.C=T+m,h)))}_r.prototype.cancel=function(){this.J=!0,ss(this)};function Ma(a){a.S=Date.now()+a.I,Zp(a,a.I)}function Zp(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Ki(y(a.ba,a),h)}function Sc(a){a.B&&(l.clearTimeout(a.B),a.B=null)}_r.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(EE(this.i,this.A),this.L!=2&&(Gi(),It(17)),ss(this),this.s=2,Yi(this)):Zp(this,this.S-a)};function Yi(a){a.j.G==0||a.J||Tm(a.j,a)}function ss(a){Sc(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,Ie(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Tc(a,h){try{var m=a.j;if(m.G!=0&&(m.g==a||Ic(m.h,a))){if(!a.K&&Ic(m.h,a)&&m.G==3){try{var T=m.Da.g.parse(h)}catch{T=null}if(Array.isArray(T)&&T.length==3){var O=T;if(O[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)qa(m),Ha(m);else break e;Rc(m),It(18)}}else m.za=O[1],0<m.za-m.T&&37500>O[2]&&m.F&&m.v==0&&!m.C&&(m.C=Ki(y(m.Za,m),6e3));if(1>=nm(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else os(m,11)}else if((a.K||m.g==a)&&qa(m),!w(h))for(O=m.Da.g.parse(h),h=0;h<O.length;h++){let pe=O[h];if(m.T=pe[0],pe=pe[1],m.G==2)if(pe[0]=="c"){m.K=pe[1],m.ia=pe[2];const mt=pe[3];mt!=null&&(m.la=mt,m.j.info("VER="+m.la));const gt=pe[4];gt!=null&&(m.Aa=gt,m.j.info("SVER="+m.Aa));const Bs=pe[5];Bs!=null&&typeof Bs=="number"&&0<Bs&&(T=1.5*Bs,m.L=T,m.j.info("backChannelRequestTimeoutMs_="+T)),T=m;const vn=a.g;if(vn){const Ka=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ka){var M=T.h;M.g||Ka.indexOf("spdy")==-1&&Ka.indexOf("quic")==-1&&Ka.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Cc(M,M.h),M.h=null))}if(T.D){const kc=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;kc&&(T.ya=kc,Ce(T.I,T.D,kc))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),T=m;var B=a;if(T.qa=Am(T,T.J?T.ia:null,T.W),B.K){rm(T.h,B);var be=B,at=T.L;at&&(be.I=at),be.B&&(Sc(be),Ma(be)),T.g=B}else bm(T);0<m.i.length&&Wa(m)}else pe[0]!="stop"&&pe[0]!="close"||os(m,7);else m.G==3&&(pe[0]=="stop"||pe[0]=="close"?pe[0]=="stop"?os(m,7):Pc(m):pe[0]!="noop"&&m.l&&m.l.ta(pe),m.v=0)}}Gi(4)}catch{}}var TE=class{constructor(a,h){this.g=a,this.map=h}};function em(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tm(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function nm(a){return a.h?1:a.g?a.g.size:0}function Ic(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Cc(a,h){a.g?a.g.add(h):a.h=h}function rm(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}em.prototype.cancel=function(){if(this.i=sm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function sm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const m of a.g.values())h=h.concat(m.D);return h}return E(a.i)}function IE(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var h=[],m=a.length,T=0;T<m;T++)h.push(a[T]);return h}h=[],m=0;for(T in a)h[m++]=a[T];return h}function CE(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var h=[];a=a.length;for(var m=0;m<a;m++)h.push(m);return h}h=[],m=0;for(const T in a)h[m++]=T;return h}}}function im(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var m=CE(a),T=IE(a),O=T.length,M=0;M<O;M++)h.call(void 0,T[M],m&&m[M],a)}var om=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function AE(a,h){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var T=a[m].indexOf("="),O=null;if(0<=T){var M=a[m].substring(0,T);O=a[m].substring(T+1)}else M=a[m];h(M,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function is(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof is){this.h=a.h,La(this,a.j),this.o=a.o,this.g=a.g,Fa(this,a.s),this.l=a.l;var h=a.i,m=new Zi;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),am(this,m),this.m=a.m}else a&&(h=String(a).match(om))?(this.h=!1,La(this,h[1]||"",!0),this.o=Xi(h[2]||""),this.g=Xi(h[3]||"",!0),Fa(this,h[4]),this.l=Xi(h[5]||"",!0),am(this,h[6]||"",!0),this.m=Xi(h[7]||"")):(this.h=!1,this.i=new Zi(null,this.h))}is.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Ji(h,lm,!0),":");var m=this.g;return(m||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Ji(h,lm,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(Ji(m,m.charAt(0)=="/"?NE:RE,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",Ji(m,DE)),a.join("")};function Gn(a){return new is(a)}function La(a,h,m){a.j=m?Xi(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Fa(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function am(a,h,m){h instanceof Zi?(a.i=h,jE(a.i,a.h)):(m||(h=Ji(h,kE)),a.i=new Zi(h,a.h))}function Ce(a,h,m){a.i.set(h,m)}function Ua(a){return Ce(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Xi(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Ji(a,h,m){return typeof a=="string"?(a=encodeURI(a).replace(h,PE),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function PE(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var lm=/[#\/\?@]/g,RE=/[#\?:]/g,NE=/[#\?]/g,kE=/[#\?@]/g,DE=/#/g;function Zi(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function xr(a){a.g||(a.g=new Map,a.h=0,a.i&&AE(a.i,function(h,m){a.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=Zi.prototype,t.add=function(a,h){xr(this),this.i=null,a=Us(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(h),this.h+=1,this};function um(a,h){xr(a),h=Us(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function cm(a,h){return xr(a),h=Us(a,h),a.g.has(h)}t.forEach=function(a,h){xr(this),this.g.forEach(function(m,T){m.forEach(function(O){a.call(h,O,T,this)},this)},this)},t.na=function(){xr(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let T=0;T<h.length;T++){const O=a[T];for(let M=0;M<O.length;M++)m.push(h[T])}return m},t.V=function(a){xr(this);let h=[];if(typeof a=="string")cm(this,a)&&(h=h.concat(this.g.get(Us(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)h=h.concat(a[m])}return h},t.set=function(a,h){return xr(this),this.i=null,a=Us(this,a),cm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function dm(a,h,m){um(a,h),0<m.length&&(a.i=null,a.g.set(Us(a,h),E(m)),a.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var T=h[m];const M=encodeURIComponent(String(T)),B=this.V(T);for(T=0;T<B.length;T++){var O=M;B[T]!==""&&(O+="="+encodeURIComponent(String(B[T]))),a.push(O)}}return this.i=a.join("&")};function Us(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function jE(a,h){h&&!a.j&&(xr(a),a.i=null,a.g.forEach(function(m,T){var O=T.toLowerCase();T!=O&&(um(this,T),dm(this,O,m))},a)),a.j=h}function OE(a,h){const m=new Qi;if(l.Image){const T=new Image;T.onload=I(wr,m,"TestLoadImage: loaded",!0,h,T),T.onerror=I(wr,m,"TestLoadImage: error",!1,h,T),T.onabort=I(wr,m,"TestLoadImage: abort",!1,h,T),T.ontimeout=I(wr,m,"TestLoadImage: timeout",!1,h,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=a}else h(!1)}function VE(a,h){const m=new Qi,T=new AbortController,O=setTimeout(()=>{T.abort(),wr(m,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:T.signal}).then(M=>{clearTimeout(O),M.ok?wr(m,"TestPingServer: ok",!0,h):wr(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(O),wr(m,"TestPingServer: error",!1,h)})}function wr(a,h,m,T,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),T(m)}catch{}}function ME(){this.g=new nt}function LE(a,h,m){const T=m||"";try{im(a,function(O,M){let B=O;c(O)&&(B=Gt(O)),h.push(T+M+"="+encodeURIComponent(B))})}catch(O){throw h.push(T+"type="+encodeURIComponent("_badmap")),O}}function za(a){this.l=a.Ub||null,this.j=a.eb||!1}D(za,Ye),za.prototype.g=function(){return new Ba(this.l,this.j)},za.prototype.i=function(a){return function(){return a}}({});function Ba(a,h){tt.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(Ba,tt),t=Ba.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,to(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,eo(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,to(this)),this.g&&(this.readyState=3,to(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;hm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function hm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?eo(this):to(this),this.readyState==3&&hm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,eo(this))},t.Qa=function(a){this.g&&(this.response=a,eo(this))},t.ga=function(){this.g&&eo(this)};function eo(a){a.readyState=4,a.l=null,a.j=null,a.v=null,to(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=h.next();return a.join(`\r
`)};function to(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ba.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function fm(a){let h="";return C(a,function(m,T){h+=T,h+=":",h+=m,h+=`\r
`}),h}function Ac(a,h,m){e:{for(T in m){var T=!1;break e}T=!0}T||(m=fm(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):Ce(a,h,m))}function Fe(a){tt.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(Fe,tt);var FE=/^https?$/i,UE=["POST","PUT"];t=Fe.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,m,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():wc.g(),this.v=this.o?Ot(this.o):Ot(wc),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(M){pm(this,M);return}if(a=m||"",m=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var O in T)m.set(O,T[O]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const M of T.keys())m.set(M,T.get(M));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),O=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(UE,h,void 0))||T||O||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,B]of m)this.g.setRequestHeader(M,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ym(this),this.u=!0,this.g.send(a),this.u=!1}catch(M){pm(this,M)}};function pm(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,mm(a),$a(a)}function mm(a){a.A||(a.A=!0,Qe(a,"complete"),Qe(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Qe(this,"complete"),Qe(this,"abort"),$a(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$a(this,!0)),Fe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?gm(this):this.bb())},t.bb=function(){gm(this)};function gm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Kn(a)!=4||a.Z()!=2)){if(a.u&&Kn(a)==4)Da(a.Ea,0,a);else if(Qe(a,"readystatechange"),Kn(a)==4){a.h=!1;try{const B=a.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var T;if(T=B===0){var O=String(a.D).match(om)[1]||null;!O&&l.self&&l.self.location&&(O=l.self.location.protocol.slice(0,-1)),T=!FE.test(O?O.toLowerCase():"")}m=T}if(m)Qe(a,"complete"),Qe(a,"success");else{a.m=6;try{var M=2<Kn(a)?a.g.statusText:""}catch{M=""}a.l=M+" ["+a.Z()+"]",mm(a)}}finally{$a(a)}}}}function $a(a,h){if(a.g){ym(a);const m=a.g,T=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||Qe(a,"ready");try{m.onreadystatechange=T}catch{}}}function ym(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Kn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Kn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),ot(h)}};function vm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function zE(a){const h={};a=(a.g&&2<=Kn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<a.length;T++){if(w(a[T]))continue;var m=k(a[T]);const O=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const M=h[O]||[];h[O]=M,M.push(m)}x(h,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function no(a,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||h}function _m(a){this.Aa=0,this.i=[],this.j=new Qi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=no("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=no("baseRetryDelayMs",5e3,a),this.cb=no("retryDelaySeedMs",1e4,a),this.Wa=no("forwardChannelMaxRetries",2,a),this.wa=no("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new em(a&&a.concurrentRequestLimit),this.Da=new ME,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=_m.prototype,t.la=8,t.G=1,t.connect=function(a,h,m,T){It(0),this.W=a,this.H=h||{},m&&T!==void 0&&(this.H.OSID=m,this.H.OAID=T),this.F=this.X,this.I=Am(this,null,this.W),Wa(this)};function Pc(a){if(xm(a),a.G==3){var h=a.U++,m=Gn(a.I);if(Ce(m,"SID",a.K),Ce(m,"RID",h),Ce(m,"TYPE","terminate"),ro(a,m),h=new _r(a,a.j,h),h.L=2,h.v=Ua(Gn(m)),m=!1,l.navigator&&l.navigator.sendBeacon)try{m=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&l.Image&&(new Image().src=h.v,m=!0),m||(h.g=Pm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Ma(h)}Cm(a)}function Ha(a){a.g&&(Nc(a),a.g.cancel(),a.g=null)}function xm(a){Ha(a),a.u&&(l.clearTimeout(a.u),a.u=null),qa(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Wa(a){if(!tm(a.h)&&!a.s){a.s=!0;var h=a.Ga;oe||Q(),F||(oe(),F=!0),K.add(h,a),a.B=0}}function BE(a,h){return nm(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Ki(y(a.Ga,a,h),Im(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const O=new _r(this,this.j,a);let M=this.o;if(this.S&&(M?(M=g(M),A(M,this.S)):M=this.S),this.m!==null||this.O||(O.H=M,M=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var T=this.i[m];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(h+=T,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Em(this,O,h),m=Gn(this.I),Ce(m,"RID",a),Ce(m,"CVER",22),this.D&&Ce(m,"X-HTTP-Session-Id",this.D),ro(this,m),M&&(this.O?h="headers="+encodeURIComponent(String(fm(M)))+"&"+h:this.m&&Ac(m,this.m,M)),Cc(this.h,O),this.Ua&&Ce(m,"TYPE","init"),this.P?(Ce(m,"$req",h),Ce(m,"SID","null"),O.T=!0,bc(O,m,null)):bc(O,m,h),this.G=2}}else this.G==3&&(a?wm(this,a):this.i.length==0||tm(this.h)||wm(this))};function wm(a,h){var m;h?m=h.l:m=a.U++;const T=Gn(a.I);Ce(T,"SID",a.K),Ce(T,"RID",m),Ce(T,"AID",a.T),ro(a,T),a.m&&a.o&&Ac(T,a.m,a.o),m=new _r(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Em(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Cc(a.h,m),bc(m,T,h)}function ro(a,h){a.H&&C(a.H,function(m,T){Ce(h,T,m)}),a.l&&im({},function(m,T){Ce(h,T,m)})}function Em(a,h,m){m=Math.min(a.i.length,m);var T=a.l?y(a.l.Na,a.l,a):null;e:{var O=a.i;let M=-1;for(;;){const B=["count="+m];M==-1?0<m?(M=O[0].g,B.push("ofs="+M)):M=0:B.push("ofs="+M);let be=!0;for(let at=0;at<m;at++){let pe=O[at].g;const mt=O[at].map;if(pe-=M,0>pe)M=Math.max(0,O[at].g-100),be=!1;else try{LE(mt,B,"req"+pe+"_")}catch{T&&T(mt)}}if(be){T=B.join("&");break e}}}return a=a.i.splice(0,m),h.D=a,T}function bm(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;oe||Q(),F||(oe(),F=!0),K.add(h,a),a.v=0}}function Rc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Ki(y(a.Fa,a),Im(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Sm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Ki(y(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,It(10),Ha(this),Sm(this))};function Nc(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Sm(a){a.g=new _r(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=Gn(a.qa);Ce(h,"RID","rpc"),Ce(h,"SID",a.K),Ce(h,"AID",a.T),Ce(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&Ce(h,"TO",a.ja),Ce(h,"TYPE","xmlhttp"),ro(a,h),a.m&&a.o&&Ac(h,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=Ua(Gn(h)),m.m=null,m.P=!0,Xp(m,a)}t.Za=function(){this.C!=null&&(this.C=null,Ha(this),Rc(this),It(19))};function qa(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Tm(a,h){var m=null;if(a.g==h){qa(a),Nc(a),a.g=null;var T=2}else if(Ic(a.h,h))m=h.D,rm(a.h,h),T=1;else return;if(a.G!=0){if(h.o)if(T==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var O=a.B;T=ja(),Qe(T,new Gp(T,m)),Wa(a)}else bm(a);else if(O=h.s,O==3||O==0&&0<h.X||!(T==1&&BE(a,h)||T==2&&Rc(a)))switch(m&&0<m.length&&(h=a.h,h.i=h.i.concat(m)),O){case 1:os(a,5);break;case 4:os(a,10);break;case 3:os(a,6);break;default:os(a,2)}}}function Im(a,h){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*h}function os(a,h){if(a.j.info("Error code "+h),h==2){var m=y(a.fb,a),T=a.Xa;const O=!T;T=new is(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||La(T,"https"),Ua(T),O?OE(T.toString(),m):VE(T.toString(),m)}else It(2);a.G=0,a.l&&a.l.sa(h),Cm(a),xm(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function Cm(a){if(a.G=0,a.ka=[],a.l){const h=sm(a.h);(h.length!=0||a.i.length!=0)&&(N(a.ka,h),N(a.ka,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.ra()}}function Am(a,h,m){var T=m instanceof is?Gn(m):new is(m);if(T.g!="")h&&(T.g=h+"."+T.g),Fa(T,T.s);else{var O=l.location;T=O.protocol,h=h?h+"."+O.hostname:O.hostname,O=+O.port;var M=new is(null);T&&La(M,T),h&&(M.g=h),O&&Fa(M,O),m&&(M.l=m),T=M}return m=a.D,h=a.ya,m&&h&&Ce(T,m,h),Ce(T,"VER",a.la),ro(a,T),T}function Pm(a,h,m){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Fe(new za({eb:m})):new Fe(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rm(){}t=Rm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ga(){}Ga.prototype.g=function(a,h){return new Kt(a,h)};function Kt(a,h){tt.call(this),this.g=new _m(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!w(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!w(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new zs(this)}D(Kt,tt),Kt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Kt.prototype.close=function(){Pc(this.g)},Kt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=Gt(a),a=m);h.i.push(new TE(h.Ya++,a)),h.G==3&&Wa(h)},Kt.prototype.N=function(){this.g.l=null,delete this.j,Pc(this.g),delete this.g,Kt.aa.N.call(this)};function Nm(a){qi.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const m in h){a=m;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}D(Nm,qi);function km(){Ls.call(this),this.status=1}D(km,Ls);function zs(a){this.g=a}D(zs,Rm),zs.prototype.ua=function(){Qe(this.g,"a")},zs.prototype.ta=function(a){Qe(this.g,new Nm(a))},zs.prototype.sa=function(a){Qe(this.g,new km)},zs.prototype.ra=function(){Qe(this.g,"b")},Ga.prototype.createWebChannel=Ga.prototype.g,Kt.prototype.send=Kt.prototype.o,Kt.prototype.open=Kt.prototype.m,Kt.prototype.close=Kt.prototype.close,I0=function(){return new Ga},T0=function(){return ja()},S0=kn,Ih={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Oa.NO_ERROR=0,Oa.TIMEOUT=8,Oa.HTTP_ERROR=6,Fl=Oa,Kp.COMPLETE="complete",b0=Kp,Ms.EventType=ln,ln.OPEN="a",ln.CLOSE="b",ln.ERROR="c",ln.MESSAGE="d",tt.prototype.listen=tt.prototype.K,bo=Ms,Fe.prototype.listenOnce=Fe.prototype.L,Fe.prototype.getLastError=Fe.prototype.Ka,Fe.prototype.getLastErrorCode=Fe.prototype.Ba,Fe.prototype.getStatus=Fe.prototype.Z,Fe.prototype.getResponseJson=Fe.prototype.Oa,Fe.prototype.getResponseText=Fe.prototype.oa,Fe.prototype.send=Fe.prototype.ea,Fe.prototype.setWithCredentials=Fe.prototype.Ha,E0=Fe}).apply(typeof pl<"u"?pl:typeof self<"u"?self:typeof window<"u"?window:{});const gy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wt.UNAUTHENTICATED=new wt(null),wt.GOOGLE_CREDENTIALS=new wt("google-credentials-uid"),wt.FIRST_PARTY=new wt("first-party-uid"),wt.MOCK_USER=new wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new Ff("@firebase/firestore");function fo(){return Cs.logLevel}function G(t,...e){if(Cs.logLevel<=ce.DEBUG){const n=e.map(Zf);Cs.debug(`Firestore (${Fi}): ${t}`,...n)}}function hr(t,...e){if(Cs.logLevel<=ce.ERROR){const n=e.map(Zf);Cs.error(`Firestore (${Fi}): ${t}`,...n)}}function Ci(t,...e){if(Cs.logLevel<=ce.WARN){const n=e.map(Zf);Cs.warn(`Firestore (${Fi}): ${t}`,...n)}}function Zf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(t="Unexpected state"){const e=`FIRESTORE (${Fi}) INTERNAL ASSERTION FAILED: `+t;throw hr(e),new Error(e)}function xe(t,e){t||te()}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends mr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(wt.UNAUTHENTICATED))}shutdown(){}}class XA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class JA{constructor(e){this.t=e,this.currentUser=wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){xe(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new ir;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ir,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{G("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(G("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ir)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(G("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(xe(typeof r.accessToken=="string"),new C0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return xe(e===null||typeof e=="string"),new wt(e)}}class ZA{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=wt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class eP{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new ZA(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){xe(this.o===void 0);const r=i=>{i.error!=null&&G("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,G("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{G("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):G("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(xe(typeof n.token=="string"),this.R=n.token,new tP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=rP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function me(t,e){return t<e?-1:t>e?1:0}function Ai(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new W(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return et.fromMillis(Date.now())}static fromDate(e){return et.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new et(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?me(this.nanoseconds,e.nanoseconds):me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.timestamp=e}static fromTimestamp(e){return new se(e)}static min(){return new se(new et(0,0))}static max(){return new se(new et(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,n,r){n===void 0?n=0:n>e.length&&te(),r===void 0?r=e.length-n:r>e.length-n&&te(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return oa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof oa?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Pe extends oa{construct(e,n,r){return new Pe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Pe(n)}static emptyPath(){return new Pe([])}}const sP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends oa{construct(e,n,r){return new ct(e,n,r)}static isValidIdentifier(e){return sP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ct(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new W(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new W(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new W(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(Pe.fromString(e))}static fromName(e){return new X(Pe.fromString(e).popFirst(5))}static empty(){return new X(Pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Pe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new Pe(e.slice()))}}function iP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=se.fromTimestamp(r===1e9?new et(n+1,0):new et(n,r));return new Yr(s,X.empty(),e)}function oP(t){return new Yr(t.readTime,t.key,-1)}class Yr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Yr(se.min(),X.empty(),-1)}static max(){return new Yr(se.max(),X.empty(),-1)}}function aP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:me(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ia(t){if(t.code!==L.FAILED_PRECONDITION||t.message!==lP)throw t;G("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&te(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const c=u;n(e[c]).next(f=>{o[c]=f,++l,l===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function cP(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ca(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ep.oe=-1;function ec(t){return t==null}function Su(t){return t===0&&1/t==-1/0}function dP(t){return typeof t=="number"&&Number.isInteger(t)&&!Su(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ui(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function P0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e,n){this.comparator=e,this.root=n||ut.EMPTY}insert(e,n){return new Le(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ut.BLACK,null,null))}remove(e){return new Le(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ut.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ml(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ml(this.root,e,this.comparator,!1)}getReverseIterator(){return new ml(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ml(this.root,e,this.comparator,!0)}}class ml{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ut{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ut.RED,this.left=s??ut.EMPTY,this.right=i??ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ut(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ut.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw te();const e=this.left.check();if(e!==this.right.check())throw te();return e+(this.isRed()?0:1)}}ut.EMPTY=null,ut.RED=!0,ut.BLACK=!1;ut.EMPTY=new class{constructor(){this.size=0}get key(){throw te()}get value(){throw te()}get color(){throw te()}get left(){throw te()}get right(){throw te()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ut(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new vy(this.data.getIterator())}getIteratorFrom(e){return new vy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ht)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ht(this.comparator);return n.data=e,n}}class vy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new Sn([])}unionWith(e){let n=new ht(ct.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Sn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ai(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new R0("Invalid base64 string: "+i):i}}(e);return new pt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new pt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pt.EMPTY_BYTE_STRING=new pt("");const hP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xr(t){if(xe(!!t),typeof t=="string"){let e=0;const n=hP.exec(t);if(xe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$e(t.seconds),nanos:$e(t.nanos)}}function $e(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function As(t){return typeof t=="string"?pt.fromBase64String(t):pt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function np(t){const e=t.mapValue.fields.__previous_value__;return tp(e)?np(e):e}function aa(t){const e=Xr(t.mapValue.fields.__local_write_time__.timestampValue);return new et(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e,n,r,s,i,o,l,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=c}}class la{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new la("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof la&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gl={mapValue:{}};function Ps(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?tp(t)?4:mP(t)?9007199254740991:pP(t)?10:11:te()}function $n(t,e){if(t===e)return!0;const n=Ps(t);if(n!==Ps(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return aa(t).isEqual(aa(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Xr(s.timestampValue),l=Xr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return As(s.bytesValue).isEqual(As(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return $e(s.geoPointValue.latitude)===$e(i.geoPointValue.latitude)&&$e(s.geoPointValue.longitude)===$e(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return $e(s.integerValue)===$e(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=$e(s.doubleValue),l=$e(i.doubleValue);return o===l?Su(o)===Su(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Ai(t.arrayValue.values||[],e.arrayValue.values||[],$n);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(yy(o)!==yy(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!$n(o[u],l[u])))return!1;return!0}(t,e);default:return te()}}function ua(t,e){return(t.values||[]).find(n=>$n(n,e))!==void 0}function Pi(t,e){if(t===e)return 0;const n=Ps(t),r=Ps(e);if(n!==r)return me(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return me(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=$e(i.integerValue||i.doubleValue),u=$e(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return _y(t.timestampValue,e.timestampValue);case 4:return _y(aa(t),aa(e));case 5:return me(t.stringValue,e.stringValue);case 6:return function(i,o){const l=As(i),u=As(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let c=0;c<l.length&&c<u.length;c++){const f=me(l[c],u[c]);if(f!==0)return f}return me(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=me($e(i.latitude),$e(o.latitude));return l!==0?l:me($e(i.longitude),$e(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return xy(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,c,f;const p=i.fields||{},y=o.fields||{},I=(l=p.value)===null||l===void 0?void 0:l.arrayValue,D=(u=y.value)===null||u===void 0?void 0:u.arrayValue,E=me(((c=I==null?void 0:I.values)===null||c===void 0?void 0:c.length)||0,((f=D==null?void 0:D.values)===null||f===void 0?void 0:f.length)||0);return E!==0?E:xy(I,D)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===gl.mapValue&&o===gl.mapValue)return 0;if(i===gl.mapValue)return 1;if(o===gl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),c=o.fields||{},f=Object.keys(c);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const y=me(u[p],f[p]);if(y!==0)return y;const I=Pi(l[u[p]],c[f[p]]);if(I!==0)return I}return me(u.length,f.length)}(t.mapValue,e.mapValue);default:throw te()}}function _y(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return me(t,e);const n=Xr(t),r=Xr(e),s=me(n.seconds,r.seconds);return s!==0?s:me(n.nanos,r.nanos)}function xy(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Pi(n[s],r[s]);if(i)return i}return me(n.length,r.length)}function Ri(t){return Ch(t)}function Ch(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Xr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return As(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ch(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Ch(n.fields[o])}`;return s+"}"}(t.mapValue):te()}function wy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ah(t){return!!t&&"integerValue"in t}function rp(t){return!!t&&"arrayValue"in t}function Ey(t){return!!t&&"nullValue"in t}function by(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ul(t){return!!t&&"mapValue"in t}function pP(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Mo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ui(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Mo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Mo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function mP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.value=e}static empty(){return new dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ul(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mo(n)}setAll(e){let n=ct.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Mo(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Ul(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return $n(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ul(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ui(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new dn(Mo(this.value))}}function N0(t){const e=[];return Ui(t.fields,(n,r)=>{const s=new ct([n]);if(Ul(r)){const i=N0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Sn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new bt(e,0,se.min(),se.min(),se.min(),dn.empty(),0)}static newFoundDocument(e,n,r,s){return new bt(e,1,n,se.min(),r,s,0)}static newNoDocument(e,n){return new bt(e,2,n,se.min(),se.min(),dn.empty(),0)}static newUnknownDocument(e,n){return new bt(e,3,n,se.min(),se.min(),dn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,n){this.position=e,this.inclusive=n}}function Sy(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=X.comparator(X.fromName(o.referenceValue),n.key):r=Pi(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ty(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!$n(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,n="asc"){this.field=e,this.dir=n}}function gP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{}class Ke extends k0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new vP(e,n,r):n==="array-contains"?new wP(e,r):n==="in"?new EP(e,r):n==="not-in"?new bP(e,r):n==="array-contains-any"?new SP(e,r):new Ke(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new _P(e,r):new xP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Pi(n,this.value)):n!==null&&Ps(this.value)===Ps(n)&&this.matchesComparison(Pi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return te()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Rn extends k0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Rn(e,n)}matches(e){return D0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function D0(t){return t.op==="and"}function j0(t){return yP(t)&&D0(t)}function yP(t){for(const e of t.filters)if(e instanceof Rn)return!1;return!0}function Ph(t){if(t instanceof Ke)return t.field.canonicalString()+t.op.toString()+Ri(t.value);if(j0(t))return t.filters.map(e=>Ph(e)).join(",");{const e=t.filters.map(n=>Ph(n)).join(",");return`${t.op}(${e})`}}function O0(t,e){return t instanceof Ke?function(r,s){return s instanceof Ke&&r.op===s.op&&r.field.isEqual(s.field)&&$n(r.value,s.value)}(t,e):t instanceof Rn?function(r,s){return s instanceof Rn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&O0(o,s.filters[l]),!0):!1}(t,e):void te()}function V0(t){return t instanceof Ke?function(n){return`${n.field.canonicalString()} ${n.op} ${Ri(n.value)}`}(t):t instanceof Rn?function(n){return n.op.toString()+" {"+n.getFilters().map(V0).join(" ,")+"}"}(t):"Filter"}class vP extends Ke{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){const n=X.comparator(e.key,this.key);return this.matchesComparison(n)}}class _P extends Ke{constructor(e,n){super(e,"in",n),this.keys=M0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class xP extends Ke{constructor(e,n){super(e,"not-in",n),this.keys=M0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function M0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class wP extends Ke{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return rp(n)&&ua(n.arrayValue,this.value)}}class EP extends Ke{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ua(this.value.arrayValue,n)}}class bP extends Ke{constructor(e,n){super(e,"not-in",n)}matches(e){if(ua(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ua(this.value.arrayValue,n)}}class SP extends Ke{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!rp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ua(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function Iy(t,e=null,n=[],r=[],s=null,i=null,o=null){return new TP(t,e,n,r,s,i,o)}function sp(t){const e=ie(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ph(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ec(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ri(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ri(r)).join(",")),e.ue=n}return e.ue}function ip(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!gP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!O0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ty(t.startAt,e.startAt)&&Ty(t.endAt,e.endAt)}function Rh(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function IP(t,e,n,r,s,i,o,l){return new zi(t,e,n,r,s,i,o,l)}function tc(t){return new zi(t)}function Cy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function L0(t){return t.collectionGroup!==null}function Lo(t){const e=ie(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new ht(ct.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(l=l.add(c.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ca(i,r))}),n.has(ct.keyField().canonicalString())||e.ce.push(new ca(ct.keyField(),r))}return e.ce}function Un(t){const e=ie(t);return e.le||(e.le=CP(e,Lo(t))),e.le}function CP(t,e){if(t.limitType==="F")return Iy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ca(s.field,i)});const n=t.endAt?new Tu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Tu(t.startAt.position,t.startAt.inclusive):null;return Iy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Nh(t,e){const n=t.filters.concat([e]);return new zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function kh(t,e,n){return new zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function nc(t,e){return ip(Un(t),Un(e))&&t.limitType===e.limitType}function F0(t){return`${sp(Un(t))}|lt:${t.limitType}`}function Ws(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>V0(s)).join(", ")}]`),ec(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ri(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ri(s)).join(",")),`Target(${r})`}(Un(t))}; limitType=${t.limitType})`}function rc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):X.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Lo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const c=Sy(o,l,u);return o.inclusive?c<=0:c<0}(r.startAt,Lo(r),s)||r.endAt&&!function(o,l,u){const c=Sy(o,l,u);return o.inclusive?c>=0:c>0}(r.endAt,Lo(r),s))}(t,e)}function AP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function U0(t){return(e,n)=>{let r=!1;for(const s of Lo(t)){const i=PP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function PP(t,e,n){const r=t.field.isKeyField()?X.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),c=l.data.field(i);return u!==null&&c!==null?Pi(u,c):te()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return te()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ui(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return P0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP=new Le(X.comparator);function fr(){return RP}const z0=new Le(X.comparator);function So(...t){let e=z0;for(const n of t)e=e.insert(n.key,n);return e}function B0(t){let e=z0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ps(){return Fo()}function $0(){return Fo()}function Fo(){return new Bi(t=>t.toString(),(t,e)=>t.isEqual(e))}const NP=new Le(X.comparator),kP=new ht(X.comparator);function ue(...t){let e=kP;for(const n of t)e=e.add(n);return e}const DP=new ht(me);function jP(){return DP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Su(e)?"-0":e}}function H0(t){return{integerValue:""+t}}function OP(t,e){return dP(e)?H0(e):op(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(){this._=void 0}}function VP(t,e,n){return t instanceof da?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&tp(i)&&(i=np(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof ha?q0(t,e):t instanceof fa?G0(t,e):function(s,i){const o=W0(s,i),l=Ay(o)+Ay(s.Pe);return Ah(o)&&Ah(s.Pe)?H0(l):op(s.serializer,l)}(t,e)}function MP(t,e,n){return t instanceof ha?q0(t,e):t instanceof fa?G0(t,e):n}function W0(t,e){return t instanceof Iu?function(r){return Ah(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class da extends sc{}class ha extends sc{constructor(e){super(),this.elements=e}}function q0(t,e){const n=K0(e);for(const r of t.elements)n.some(s=>$n(s,r))||n.push(r);return{arrayValue:{values:n}}}class fa extends sc{constructor(e){super(),this.elements=e}}function G0(t,e){let n=K0(e);for(const r of t.elements)n=n.filter(s=>!$n(s,r));return{arrayValue:{values:n}}}class Iu extends sc{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Ay(t){return $e(t.integerValue||t.doubleValue)}function K0(t){return rp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e,n){this.field=e,this.transform=n}}function FP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ha&&s instanceof ha||r instanceof fa&&s instanceof fa?Ai(r.elements,s.elements,$n):r instanceof Iu&&s instanceof Iu?$n(r.Pe,s.Pe):r instanceof da&&s instanceof da}(t.transform,e.transform)}class UP{constructor(e,n){this.version=e,this.transformResults=n}}class An{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new An}static exists(e){return new An(void 0,e)}static updateTime(e){return new An(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ic{}function Q0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ap(t.key,An.none()):new Aa(t.key,t.data,An.none());{const n=t.data,r=dn.empty();let s=new ht(ct.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ks(t.key,r,new Sn(s.toArray()),An.none())}}function zP(t,e,n){t instanceof Aa?function(s,i,o){const l=s.value.clone(),u=Ry(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ks?function(s,i,o){if(!zl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Ry(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Y0(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Uo(t,e,n,r){return t instanceof Aa?function(i,o,l,u){if(!zl(i.precondition,o))return l;const c=i.value.clone(),f=Ny(i.fieldTransforms,u,o);return c.setAll(f),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ks?function(i,o,l,u){if(!zl(i.precondition,o))return l;const c=Ny(i.fieldTransforms,u,o),f=o.data;return f.setAll(Y0(i)),f.setAll(c),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,l){return zl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function BP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=W0(r.transform,s||null);i!=null&&(n===null&&(n=dn.empty()),n.set(r.field,i))}return n||null}function Py(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ai(r,s,(i,o)=>FP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Aa extends ic{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ks extends ic{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Y0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Ry(t,e,n){const r=new Map;xe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,MP(o,l,n[s]))}return r}function Ny(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,VP(i,o,e))}return r}class ap extends ic{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $P extends ic{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&zP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Uo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Uo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=$0();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=Q0(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ue())}isEqual(e){return this.batchId===e.batchId&&Ai(this.mutations,e.mutations,(n,r)=>Py(n,r))&&Ai(this.baseMutations,e.baseMutations,(n,r)=>Py(n,r))}}class lp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){xe(e.mutations.length===r.length);let s=function(){return NP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new lp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var We,de;function GP(t){switch(t){default:return te();case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0}}function X0(t){if(t===void 0)return hr("GRPC error has no .code"),L.UNKNOWN;switch(t){case We.OK:return L.OK;case We.CANCELLED:return L.CANCELLED;case We.UNKNOWN:return L.UNKNOWN;case We.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case We.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case We.INTERNAL:return L.INTERNAL;case We.UNAVAILABLE:return L.UNAVAILABLE;case We.UNAUTHENTICATED:return L.UNAUTHENTICATED;case We.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case We.NOT_FOUND:return L.NOT_FOUND;case We.ALREADY_EXISTS:return L.ALREADY_EXISTS;case We.PERMISSION_DENIED:return L.PERMISSION_DENIED;case We.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case We.ABORTED:return L.ABORTED;case We.OUT_OF_RANGE:return L.OUT_OF_RANGE;case We.UNIMPLEMENTED:return L.UNIMPLEMENTED;case We.DATA_LOSS:return L.DATA_LOSS;default:return te()}}(de=We||(We={}))[de.OK=0]="OK",de[de.CANCELLED=1]="CANCELLED",de[de.UNKNOWN=2]="UNKNOWN",de[de.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",de[de.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",de[de.NOT_FOUND=5]="NOT_FOUND",de[de.ALREADY_EXISTS=6]="ALREADY_EXISTS",de[de.PERMISSION_DENIED=7]="PERMISSION_DENIED",de[de.UNAUTHENTICATED=16]="UNAUTHENTICATED",de[de.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",de[de.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",de[de.ABORTED=10]="ABORTED",de[de.OUT_OF_RANGE=11]="OUT_OF_RANGE",de[de.UNIMPLEMENTED=12]="UNIMPLEMENTED",de[de.INTERNAL=13]="INTERNAL",de[de.UNAVAILABLE=14]="UNAVAILABLE",de[de.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QP=new vs([4294967295,4294967295],0);function ky(t){const e=KP().encode(t),n=new w0;return n.update(e),new Uint8Array(n.digest())}function Dy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new vs([n,r],0),new vs([s,i],0)]}class up{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new To(`Invalid padding: ${n}`);if(r<0)throw new To(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new To(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new To(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=vs.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(vs.fromNumber(r)));return s.compare(QP)===1&&(s=new vs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=ky(e),[r,s]=Dy(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new up(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=ky(e),[r,s]=Dy(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class To extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Pa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new oc(se.min(),s,new Le(me),fr(),ue())}}class Pa{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Pa(r,n,ue(),ue(),ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class J0{constructor(e,n){this.targetId=e,this.me=n}}class Z0{constructor(e,n,r=pt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class jy{constructor(){this.fe=0,this.ge=Vy(),this.pe=pt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ue(),n=ue(),r=ue();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:te()}}),new Pa(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Vy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,xe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class YP{constructor(e){this.Le=e,this.Be=new Map,this.ke=fr(),this.qe=Oy(),this.Qe=new Le(me)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:te()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Rh(i))if(r===0){const o=new X(i.path);this.Ue(n,o,bt.newNoDocument(o,se.min()))}else xe(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=As(r).toUint8Array()}catch(u){if(u instanceof R0)return Ci("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new up(o,s,i)}catch(u){return Ci(u instanceof To?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&Rh(l.target)){const u=new X(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,bt.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=ue();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new oc(e,n,this.Qe,this.ke,r);return this.ke=fr(),this.qe=Oy(),this.Qe=new Le(me),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new jy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ht(me),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||G("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Oy(){return new Le(X.comparator)}function Vy(){return new Le(X.comparator)}const XP={asc:"ASCENDING",desc:"DESCENDING"},JP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZP={and:"AND",or:"OR"};class eR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Dh(t,e){return t.useProto3Json||ec(e)?e:{value:e}}function Cu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ew(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function tR(t,e){return Cu(t,e.toTimestamp())}function zn(t){return xe(!!t),se.fromTimestamp(function(n){const r=Xr(n);return new et(r.seconds,r.nanos)}(t))}function cp(t,e){return jh(t,e).canonicalString()}function jh(t,e){const n=function(s){return new Pe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function tw(t){const e=Pe.fromString(t);return xe(ow(e)),e}function Oh(t,e){return cp(t.databaseId,e.path)}function hd(t,e){const n=tw(e);if(n.get(1)!==t.databaseId.projectId)throw new W(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new X(rw(n))}function nw(t,e){return cp(t.databaseId,e)}function nR(t){const e=tw(t);return e.length===4?Pe.emptyPath():rw(e)}function Vh(t){return new Pe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function rw(t){return xe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function My(t,e,n){return{name:Oh(t,e),fields:n.value.mapValue.fields}}function rR(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:te()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,f){return c.useProto3Json?(xe(f===void 0||typeof f=="string"),pt.fromBase64String(f||"")):(xe(f===void 0||f instanceof Buffer||f instanceof Uint8Array),pt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(c){const f=c.code===void 0?L.UNKNOWN:X0(c.code);return new W(f,c.message||"")}(o);n=new Z0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=hd(t,r.document.name),i=zn(r.document.updateTime),o=r.document.createTime?zn(r.document.createTime):se.min(),l=new dn({mapValue:{fields:r.document.fields}}),u=bt.newFoundDocument(s,i,o,l),c=r.targetIds||[],f=r.removedTargetIds||[];n=new Bl(c,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=hd(t,r.document),i=r.readTime?zn(r.readTime):se.min(),o=bt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Bl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=hd(t,r.document),i=r.removedTargetIds||[];n=new Bl([],i,s,null)}else{if(!("filter"in e))return te();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new qP(s,i),l=r.targetId;n=new J0(l,o)}}return n}function sR(t,e){let n;if(e instanceof Aa)n={update:My(t,e.key,e.value)};else if(e instanceof ap)n={delete:Oh(t,e.key)};else if(e instanceof ks)n={update:My(t,e.key,e.data),updateMask:fR(e.fieldMask)};else{if(!(e instanceof $P))return te();n={verify:Oh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof da)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ha)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof fa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Iu)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw te()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:tR(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:te()}(t,e.precondition)),n}function iR(t,e){return t&&t.length>0?(xe(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?zn(s.updateTime):zn(i);return o.isEqual(se.min())&&(o=zn(i)),new UP(o,s.transformResults||[])}(n,e))):[]}function oR(t,e){return{documents:[nw(t,e.path)]}}function aR(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=nw(t,s);const i=function(c){if(c.length!==0)return iw(Rn.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(f=>function(y){return{field:qs(y.field),direction:cR(y.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Dh(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:s}}function lR(t){let e=nR(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){xe(r===1);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(p){const y=sw(p);return y instanceof Rn&&j0(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(y=>function(D){return new ca(Gs(D.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(p){let y;return y=typeof p=="object"?p.value:p,ec(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(p){const y=!!p.before,I=p.values||[];return new Tu(I,y)}(n.startAt));let c=null;return n.endAt&&(c=function(p){const y=!p.before,I=p.values||[];return new Tu(I,y)}(n.endAt)),IP(e,s,o,i,l,"F",u,c)}function uR(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return te()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function sw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Gs(n.unaryFilter.field);return Ke.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Gs(n.unaryFilter.field);return Ke.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Gs(n.unaryFilter.field);return Ke.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Gs(n.unaryFilter.field);return Ke.create(o,"!=",{nullValue:"NULL_VALUE"});default:return te()}}(t):t.fieldFilter!==void 0?function(n){return Ke.create(Gs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return te()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Rn.create(n.compositeFilter.filters.map(r=>sw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return te()}}(n.compositeFilter.op))}(t):te()}function cR(t){return XP[t]}function dR(t){return JP[t]}function hR(t){return ZP[t]}function qs(t){return{fieldPath:t.canonicalString()}}function Gs(t){return ct.fromServerFormat(t.fieldPath)}function iw(t){return t instanceof Ke?function(n){if(n.op==="=="){if(by(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NAN"}};if(Ey(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(by(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NAN"}};if(Ey(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qs(n.field),op:dR(n.op),value:n.value}}}(t):t instanceof Rn?function(n){const r=n.getFilters().map(s=>iw(s));return r.length===1?r[0]:{compositeFilter:{op:hR(n.op),filters:r}}}(t):te()}function fR(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ow(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,n,r,s,i=se.min(),o=se.min(),l=pt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Or(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Or(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e){this.ct=e}}function mR(t){const e=lR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?kh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(){this.un=new yR}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Yr.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Yr.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class yR{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ht(Pe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ht(Pe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ni(0)}static kn(){return new Ni(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(){this.changes=new Bi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,bt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Uo(r.mutation,s,Sn.empty(),et.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ue()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ue()){const s=ps();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=So();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ps();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ue()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=fr();const o=Fo(),l=function(){return Fo()}();return n.forEach((u,c)=>{const f=r.get(c.key);s.has(c.key)&&(f===void 0||f.mutation instanceof ks)?i=i.insert(c.key,c):f!==void 0?(o.set(c.key,f.mutation.getFieldMask()),Uo(f.mutation,c,f.mutation.getFieldMask(),et.now())):o.set(c.key,Sn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,f)=>o.set(c,f)),n.forEach((c,f)=>{var p;return l.set(c,new _R(f,(p=o.get(c))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Fo();let s=new Le((o,l)=>o-l),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let f=r.get(u)||Sn.empty();f=l.applyToLocalView(c,f),r.set(u,f);const p=(s.get(l.batchId)||ue()).add(u);s=s.insert(l.batchId,p)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),c=u.key,f=u.value,p=$0();f.forEach(y=>{if(!i.has(y)){const I=Q0(n.get(y),r.get(y));I!==null&&p.set(y,I),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,p))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return X.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):L0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(ps());let l=-1,u=i;return o.next(c=>U.forEach(c,(f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),i.get(f)?U.resolve():this.remoteDocumentCache.getEntry(e,f).next(y=>{u=u.insert(f,y)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,ue())).next(f=>({batchId:l,changes:B0(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let s=So();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=So();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,u=>{const c=function(p,y){return new zi(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(f=>{f.forEach((p,y)=>{o=o.insert(p,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,c)=>{const f=c.getKey();o.get(f)===null&&(o=o.insert(f,bt.newInvalidDocument(f)))});let l=So();return o.forEach((u,c)=>{const f=i.get(u);f!==void 0&&Uo(f.mutation,c,Sn.empty(),et.now()),rc(n,c)&&(l=l.insert(u,c))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:zn(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:mR(s.bundledQuery),readTime:zn(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(){this.overlays=new Le(X.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ps();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=ps(),i=n.length+1,o=new X(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Le((c,f)=>c-f);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let f=i.get(c.largestBatchId);f===null&&(f=ps(),i=i.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const l=ps(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,f)=>l.set(c,f)),!(l.size()>=s)););return U.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new WP(n,r));let i=this.Ir.get(n);i===void 0&&(i=ue(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(){this.sessionToken=pt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(){this.Tr=new ht(rt.Er),this.dr=new ht(rt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new rt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new rt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new X(new Pe([])),r=new rt(n,e),s=new rt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new X(new Pe([])),r=new rt(n,e),s=new rt(n,e+1);let i=ue();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new rt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class rt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return X.comparator(e.key,n.key)||me(e.wr,n.wr)}static Ar(e,n){return me(e.wr,n.wr)||X.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ht(rt.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new HP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new rt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new rt(n,0),s=new rt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ht(me);return n.forEach(s=>{const i=new rt(s,0),o=new rt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;X.isDocumentKey(i)||(i=i.child(""));const o=new rt(new X(i),0);let l=new ht(me);return this.br.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(l=l.add(u.wr)),!0)},o),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){xe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,s=>{const i=new rt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new rt(n,0),s=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e){this.Mr=e,this.docs=function(){return new Le(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():bt.newInvalidDocument(n))}getEntries(e,n){let r=fr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():bt.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=fr();const o=n.path,l=new X(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:c,value:{document:f}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||aP(oP(f),r)<=0||(s.has(f.key)||rc(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){te()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new IR(this)}getSize(e){return U.resolve(this.size)}}class IR extends vR{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e){this.persistence=e,this.Nr=new Bi(n=>sp(n),ip),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Lr=0,this.Br=new dp,this.targetCount=0,this.kr=Ni.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Ni(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e,n){this.qr={},this.overlays={},this.Qr=new ep(0),this.Kr=!1,this.Kr=!0,this.$r=new bR,this.referenceDelegate=e(this),this.Ur=new CR(this),this.indexManager=new gR,this.remoteDocumentCache=function(s){return new TR(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new pR(n),this.Gr=new wR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ER,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new SR(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){G("MemoryPersistence","Starting transaction:",e);const s=new PR(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class PR extends uP{constructor(e){super(),this.currentSequenceNumber=e}}class hp{constructor(e){this.persistence=e,this.Jr=new dp,this.Yr=null}static Zr(e){return new hp(e)}get Xr(){if(this.Yr)return this.Yr;throw te()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const s=X.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,se.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ue(),s=ue();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new fp(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return NT()?8:cP(Tt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new RR;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(fo()<=ce.DEBUG&&G("QueryEngine","SDK will not create cache indexes for query:",Ws(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(fo()<=ce.DEBUG&&G("QueryEngine","Query:",Ws(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(fo()<=ce.DEBUG&&G("QueryEngine","The SDK decides to create cache indexes for query:",Ws(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Un(n))):U.resolve())}Yi(e,n){if(Cy(n))return U.resolve(null);let r=Un(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=kh(n,null,"F"),r=Un(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ue(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ts(n,l);return this.ns(n,c,o,u.readTime)?this.Yi(e,kh(n,null,"F")):this.rs(e,c,n,u)}))})))}Zi(e,n,r,s){return Cy(n)||s.isEqual(se.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?U.resolve(null):(fo()<=ce.DEBUG&&G("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ws(n)),this.rs(e,o,n,iP(s,-1)).next(l=>l))})}ts(e,n){let r=new ht(U0(e));return n.forEach((s,i)=>{rc(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return fo()<=ce.DEBUG&&G("QueryEngine","Using full collection scan to execute query:",Ws(n)),this.Ji.getDocumentsMatchingQuery(e,n,Yr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Le(me),this._s=new Bi(i=>sp(i),ip),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xR(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function DR(t,e,n,r){return new kR(t,e,n,r)}async function aw(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=ue();for(const c of s){o.push(c.batchId);for(const f of c.mutations)u=u.add(f.key)}for(const c of i){l.push(c.batchId);for(const f of c.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:l}))})})}function jR(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,c,f){const p=c.batch,y=p.keys();let I=U.resolve();return y.forEach(D=>{I=I.next(()=>f.getEntry(u,D)).next(E=>{const N=c.docVersions.get(D);xe(N!==null),E.version.compareTo(N)<0&&(p.applyToRemoteDocument(E,c),E.isValidDocument()&&(E.setReadTime(c.commitVersion),f.addEntry(E)))})}),I.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ue();for(let c=0;c<l.mutationResults.length;++c)l.mutationResults[c].transformResults.length>0&&(u=u.add(l.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function lw(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function OR(t,e){const n=ie(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((f,p)=>{const y=s.get(p);if(!y)return;l.push(n.Ur.removeMatchingKeys(i,f.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(i,f.addedDocuments,p)));let I=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?I=I.withResumeToken(pt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):f.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(f.resumeToken,r)),s=s.insert(p,I),function(E,N,b){return E.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(y,I,f)&&l.push(n.Ur.updateTargetData(i,I))});let u=fr(),c=ue();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(VR(i,o,e.documentUpdates).next(f=>{u=f.Ps,c=f.Is})),!r.isEqual(se.min())){const f=n.Ur.getLastRemoteSnapshotVersion(i).next(p=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return U.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(n.os=s,i))}function VR(t,e,n){let r=ue(),s=ue();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=fr();return n.forEach((l,u)=>{const c=i.get(l);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(se.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):G("LocalStore","Ignoring outdated watch update for ",l,". Current version:",c.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function MR(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function LR(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Or(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Mh(t,e,n){const r=ie(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ca(o))throw o;G("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Ly(t,e,n){const r=ie(t);let s=se.min(),i=ue();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,f){const p=ie(u),y=p._s.get(f);return y!==void 0?U.resolve(p.os.get(y)):p.Ur.getTargetData(c,f)}(r,o,Un(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:se.min(),n?i:ue())).next(l=>(FR(r,AP(e),l),{documents:l,Ts:i})))}function FR(t,e,n){let r=t.us.get(e)||se.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Fy{constructor(){this.activeTargetIds=jP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class UR{constructor(){this.so=new Fy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Fy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){G("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){G("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yl=null;function fd(){return yl===null?yl=function(){return 268435456+Math.round(2147483648*Math.random())}():yl++,"0x"+yl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _t="WebChannelConnection";class HR extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=fd(),u=this.xo(n,r.toUriEncodedString());G("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(n,u,c,s).then(f=>(G("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw Ci("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Fi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=BR[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=fd();return new Promise((o,l)=>{const u=new E0;u.setWithCredentials(!0),u.listenOnce(b0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Fl.NO_ERROR:const f=u.getResponseJson();G(_t,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),o(f);break;case Fl.TIMEOUT:G(_t,`RPC '${e}' ${i} timed out`),l(new W(L.DEADLINE_EXCEEDED,"Request time out"));break;case Fl.HTTP_ERROR:const p=u.getStatus();if(G(_t,`RPC '${e}' ${i} failed with status:`,p,"response text:",u.getResponseText()),p>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const I=y==null?void 0:y.error;if(I&&I.status&&I.message){const D=function(N){const b=N.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(b)>=0?b:L.UNKNOWN}(I.status);l(new W(D,I.message))}else l(new W(L.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new W(L.UNAVAILABLE,"Connection failed."));break;default:te()}}finally{G(_t,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);G(_t,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",c,r,15)})}Bo(e,n,r){const s=fd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=I0(),l=T0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");G(_t,`Creating RPC '${e}' stream ${s}: ${f}`,u);const p=o.createWebChannel(f,u);let y=!1,I=!1;const D=new $R({Io:N=>{I?G(_t,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(y||(G(_t,`Opening RPC '${e}' stream ${s} transport.`),p.open(),y=!0),G(_t,`RPC '${e}' stream ${s} sending:`,N),p.send(N))},To:()=>p.close()}),E=(N,b,w)=>{N.listen(b,v=>{try{w(v)}catch(S){setTimeout(()=>{throw S},0)}})};return E(p,bo.EventType.OPEN,()=>{I||(G(_t,`RPC '${e}' stream ${s} transport opened.`),D.yo())}),E(p,bo.EventType.CLOSE,()=>{I||(I=!0,G(_t,`RPC '${e}' stream ${s} transport closed`),D.So())}),E(p,bo.EventType.ERROR,N=>{I||(I=!0,Ci(_t,`RPC '${e}' stream ${s} transport errored:`,N),D.So(new W(L.UNAVAILABLE,"The operation could not be completed")))}),E(p,bo.EventType.MESSAGE,N=>{var b;if(!I){const w=N.data[0];xe(!!w);const v=w,S=v.error||((b=v[0])===null||b===void 0?void 0:b.error);if(S){G(_t,`RPC '${e}' stream ${s} received error:`,S);const P=S.status;let C=function(_){const A=We[_];if(A!==void 0)return X0(A)}(P),x=S.message;C===void 0&&(C=L.INTERNAL,x="Unknown error status: "+P+" with message "+S.message),I=!0,D.So(new W(C,x)),p.close()}else G(_t,`RPC '${e}' stream ${s} received:`,w),D.bo(w)}}),E(l,S0.STAT_EVENT,N=>{N.stat===Ih.PROXY?G(_t,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===Ih.NOPROXY&&G(_t,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{D.wo()},0),D}}function pd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ac(t){return new eR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&G("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,n,r,s,i,o,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new uw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===L.RESOURCE_EXHAUSTED?(hr(n.toString()),hr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===L.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new W(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return G("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(G("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class WR extends cw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=rR(this.serializer,e),r=function(i){if(!("targetChange"in i))return se.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?se.min():o.readTime?zn(o.readTime):se.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Vh(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=Rh(u)?{documents:oR(i,u)}:{query:aR(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=ew(i,o.resumeToken);const c=Dh(i,o.expectedCount);c!==null&&(l.expectedCount=c)}else if(o.snapshotVersion.compareTo(se.min())>0){l.readTime=Cu(i,o.snapshotVersion.toTimestamp());const c=Dh(i,o.expectedCount);c!==null&&(l.expectedCount=c)}return l}(this.serializer,e);const r=uR(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Vh(this.serializer),n.removeTarget=e,this.a_(n)}}class qR extends cw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return xe(!!e.streamToken),this.lastStreamToken=e.streamToken,xe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){xe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=iR(e.writeResults,e.commitTime),r=zn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Vh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>sR(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new W(L.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,jh(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(L.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,jh(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(L.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class KR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(hr(n),this.D_=!1):G("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Ds(this)&&(G("RemoteStore","Restarting streams for network reachability change."),await async function(u){const c=ie(u);c.L_.add(4),await Ra(c),c.q_.set("Unknown"),c.L_.delete(4),await lc(c)}(this))})}),this.q_=new KR(r,s)}}async function lc(t){if(Ds(t))for(const e of t.B_)await e(!0)}async function Ra(t){for(const e of t.B_)await e(!1)}function dw(t,e){const n=ie(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),yp(n)?gp(n):$i(n).r_()&&mp(n,e))}function pp(t,e){const n=ie(t),r=$i(n);n.N_.delete(e),r.r_()&&hw(n,e),n.N_.size===0&&(r.r_()?r.o_():Ds(n)&&n.q_.set("Unknown"))}function mp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(se.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}$i(t).A_(e)}function hw(t,e){t.Q_.xe(e),$i(t).R_(e)}function gp(t){t.Q_=new YP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),$i(t).start(),t.q_.v_()}function yp(t){return Ds(t)&&!$i(t).n_()&&t.N_.size>0}function Ds(t){return ie(t).L_.size===0}function fw(t){t.Q_=void 0}async function YR(t){t.q_.set("Online")}async function XR(t){t.N_.forEach((e,n)=>{mp(t,e)})}async function JR(t,e){fw(t),yp(t)?(t.q_.M_(e),gp(t)):t.q_.set("Unknown")}async function ZR(t,e,n){if(t.q_.set("Online"),e instanceof Z0&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){G("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Au(t,r)}else if(e instanceof Bl?t.Q_.Ke(e):e instanceof J0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(se.min()))try{const r=await lw(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.N_.get(c);f&&i.N_.set(c,f.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,c)=>{const f=i.N_.get(u);if(!f)return;i.N_.set(u,f.withResumeToken(pt.EMPTY_BYTE_STRING,f.snapshotVersion)),hw(i,u);const p=new Or(f.target,u,c,f.sequenceNumber);mp(i,p)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){G("RemoteStore","Failed to raise snapshot:",r),await Au(t,r)}}async function Au(t,e,n){if(!Ca(e))throw e;t.L_.add(1),await Ra(t),t.q_.set("Offline"),n||(n=()=>lw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{G("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await lc(t)})}function pw(t,e){return e().catch(n=>Au(t,n,e))}async function uc(t){const e=ie(t),n=Jr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;eN(e);)try{const s=await MR(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,tN(e,s)}catch(s){await Au(e,s)}mw(e)&&gw(e)}function eN(t){return Ds(t)&&t.O_.length<10}function tN(t,e){t.O_.push(e);const n=Jr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function mw(t){return Ds(t)&&!Jr(t).n_()&&t.O_.length>0}function gw(t){Jr(t).start()}async function nN(t){Jr(t).p_()}async function rN(t){const e=Jr(t);for(const n of t.O_)e.m_(n.mutations)}async function sN(t,e,n){const r=t.O_.shift(),s=lp.from(r,e,n);await pw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await uc(t)}async function iN(t,e){e&&Jr(t).V_&&await async function(r,s){if(function(o){return GP(o)&&o!==L.ABORTED}(s.code)){const i=r.O_.shift();Jr(r).s_(),await pw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await uc(r)}}(t,e),mw(t)&&gw(t)}async function zy(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),G("RemoteStore","RemoteStore received new credentials");const r=Ds(n);n.L_.add(3),await Ra(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await lc(n)}async function oN(t,e){const n=ie(t);e?(n.L_.delete(2),await lc(n)):e||(n.L_.add(2),await Ra(n),n.q_.set("Unknown"))}function $i(t){return t.K_||(t.K_=function(n,r,s){const i=ie(n);return i.w_(),new WR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:YR.bind(null,t),Ro:XR.bind(null,t),mo:JR.bind(null,t),d_:ZR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),yp(t)?gp(t):t.q_.set("Unknown")):(await t.K_.stop(),fw(t))})),t.K_}function Jr(t){return t.U_||(t.U_=function(n,r,s){const i=ie(n);return i.w_(),new qR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:nN.bind(null,t),mo:iN.bind(null,t),f_:rN.bind(null,t),g_:sN.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await uc(t)):(await t.U_.stop(),t.O_.length>0&&(G("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ir,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new vp(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _p(t,e){if(hr("AsyncQueue",`${e}: ${t}`),Ca(t))return new W(L.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=So(),this.sortedSet=new Le(this.comparator)}static emptySet(e){return new yi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof yi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new yi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(){this.W_=new Le(X.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):te():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ki{constructor(e,n,r,s,i,o,l,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new ki(e,n,yi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class lN{constructor(){this.queries=$y(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ie(n),i=s.queries;s.queries=$y(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new W(L.ABORTED,"Firestore shutting down"))}}function $y(){return new Bi(t=>F0(t),nc)}async function xp(t,e){const n=ie(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new aN,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=_p(o,`Initialization of query '${Ws(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Ep(n)}async function wp(t,e){const n=ie(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function uN(t,e){const n=ie(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Ep(n)}function cN(t,e,n){const r=ie(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Ep(t){t.Y_.forEach(e=>{e.next()})}var Lh,Hy;(Hy=Lh||(Lh={})).ea="default",Hy.Cache="cache";class bp{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ki(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Lh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e){this.key=e}}class vw{constructor(e){this.key=e}}class dN{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ue(),this.mutatedKeys=ue(),this.Aa=U0(e),this.Ra=new yi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new By,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,p)=>{const y=s.get(f),I=rc(this.query,p)?p:null,D=!!y&&this.mutatedKeys.has(y.key),E=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let N=!1;y&&I?y.data.isEqual(I.data)?D!==E&&(r.track({type:3,doc:I}),N=!0):this.ga(y,I)||(r.track({type:2,doc:I}),N=!0,(u&&this.Aa(I,u)>0||c&&this.Aa(I,c)<0)&&(l=!0)):!y&&I?(r.track({type:0,doc:I}),N=!0):y&&!I&&(r.track({type:1,doc:y}),N=!0,(u||c)&&(l=!0)),N&&(I?(o=o.add(I),i=E?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,p)=>function(I,D){const E=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return te()}};return E(I)-E(D)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,c=u!==this.Ea;return this.Ea=u,o.length!==0||c?{snapshot:new ki(this.query,e.Ra,i,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new By,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ue(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new vw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new yw(r))}),n}ba(e){this.Ta=e.Ts,this.da=ue();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ki.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class hN{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class fN{constructor(e){this.key=e,this.va=!1}}class pN{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Bi(l=>F0(l),nc),this.Ma=new Map,this.xa=new Set,this.Oa=new Le(X.comparator),this.Na=new Map,this.La=new dp,this.Ba={},this.ka=new Map,this.qa=Ni.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function mN(t,e,n=!0){const r=Sw(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await _w(r,e,n,!0),s}async function gN(t,e){const n=Sw(t);await _w(n,e,!0,!1)}async function _w(t,e,n,r){const s=await LR(t.localStore,Un(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await yN(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&dw(t.remoteStore,s),l}async function yN(t,e,n,r,s){t.Ka=(p,y,I)=>async function(E,N,b,w){let v=N.view.ma(b);v.ns&&(v=await Ly(E.localStore,N.query,!1).then(({documents:x})=>N.view.ma(x,v)));const S=w&&w.targetChanges.get(N.targetId),P=w&&w.targetMismatches.get(N.targetId)!=null,C=N.view.applyChanges(v,E.isPrimaryClient,S,P);return qy(E,N.targetId,C.wa),C.snapshot}(t,p,y,I);const i=await Ly(t.localStore,e,!0),o=new dN(e,i.Ts),l=o.ma(i.documents),u=Pa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(l,t.isPrimaryClient,u);qy(t,n,c.wa);const f=new hN(e,n,o);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function vN(t,e,n){const r=ie(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!nc(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Mh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&pp(r.remoteStore,s.targetId),Fh(r,s.targetId)}).catch(Ia)):(Fh(r,s.targetId),await Mh(r.localStore,s.targetId,!0))}async function _N(t,e){const n=ie(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),pp(n.remoteStore,r.targetId))}async function xN(t,e,n){const r=CN(t);try{const s=await function(o,l){const u=ie(o),c=et.now(),f=l.reduce((I,D)=>I.add(D.key),ue());let p,y;return u.persistence.runTransaction("Locally write mutations","readwrite",I=>{let D=fr(),E=ue();return u.cs.getEntries(I,f).next(N=>{D=N,D.forEach((b,w)=>{w.isValidDocument()||(E=E.add(b))})}).next(()=>u.localDocuments.getOverlayedDocuments(I,D)).next(N=>{p=N;const b=[];for(const w of l){const v=BP(w,p.get(w.key).overlayedDocument);v!=null&&b.push(new ks(w.key,v,N0(v.value.mapValue),An.exists(!0)))}return u.mutationQueue.addMutationBatch(I,c,b,l)}).next(N=>{y=N;const b=N.applyToLocalDocumentSet(p,E);return u.documentOverlayCache.saveOverlays(I,N.batchId,b)})}).then(()=>({batchId:y.batchId,changes:B0(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let c=o.Ba[o.currentUser.toKey()];c||(c=new Le(me)),c=c.insert(l,u),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,n),await Na(r,s.changes),await uc(r.remoteStore)}catch(s){const i=_p(s,"Failed to persist write");n.reject(i)}}async function xw(t,e){const n=ie(t);try{const r=await OR(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(xe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?xe(o.va):s.removedDocuments.size>0&&(xe(o.va),o.va=!1))}),await Na(n,r,e)}catch(r){await Ia(r)}}function Wy(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=ie(o);u.onlineState=l;let c=!1;u.queries.forEach((f,p)=>{for(const y of p.j_)y.Z_(l)&&(c=!0)}),c&&Ep(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wN(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new Le(X.comparator);o=o.insert(i,bt.newNoDocument(i,se.min()));const l=ue().add(i),u=new oc(se.min(),new Map,new Le(me),o,l);await xw(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Sp(r)}else await Mh(r.localStore,e,!1).then(()=>Fh(r,e,n)).catch(Ia)}async function EN(t,e){const n=ie(t),r=e.batch.batchId;try{const s=await jR(n.localStore,e);Ew(n,r,null),ww(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Na(n,s)}catch(s){await Ia(s)}}async function bN(t,e,n){const r=ie(t);try{const s=await function(o,l){const u=ie(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return u.mutationQueue.lookupMutationBatch(c,l).next(p=>(xe(p!==null),f=p.keys(),u.mutationQueue.removeMutationBatch(c,p))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,f,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>u.localDocuments.getDocuments(c,f))})}(r.localStore,e);Ew(r,e,n),ww(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Na(r,s)}catch(s){await Ia(s)}}function ww(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Ew(t,e,n){const r=ie(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Fh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||bw(t,r)})}function bw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(pp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Sp(t))}function qy(t,e,n){for(const r of n)r instanceof yw?(t.La.addReference(r.key,e),SN(t,r)):r instanceof vw?(G("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||bw(t,r.key)):te()}function SN(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(G("SyncEngine","New document in limbo: "+n),t.xa.add(r),Sp(t))}function Sp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new X(Pe.fromString(e)),r=t.qa.next();t.Na.set(r,new fN(n)),t.Oa=t.Oa.insert(n,r),dw(t.remoteStore,new Or(Un(tc(n.path)),r,"TargetPurposeLimboResolution",ep.oe))}}async function Na(t,e,n){const r=ie(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(c=>{var f;if((c||n)&&r.isPrimaryClient){const p=c?!c.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(c){s.push(c);const p=fp.Wi(u.targetId,c);i.push(p)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,c){const f=ie(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>U.forEach(c,y=>U.forEach(y.$i,I=>f.persistence.referenceDelegate.addReference(p,y.targetId,I)).next(()=>U.forEach(y.Ui,I=>f.persistence.referenceDelegate.removeReference(p,y.targetId,I)))))}catch(p){if(!Ca(p))throw p;G("LocalStore","Failed to update sequence numbers: "+p)}for(const p of c){const y=p.targetId;if(!p.fromCache){const I=f.os.get(y),D=I.snapshotVersion,E=I.withLastLimboFreeSnapshotVersion(D);f.os=f.os.insert(y,E)}}}(r.localStore,i))}async function TN(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){G("SyncEngine","User change. New user:",e.toKey());const r=await aw(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new W(L.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Na(n,r.hs)}}function IN(t,e){const n=ie(t),r=n.Na.get(e);if(r&&r.va)return ue().add(r.key);{let s=ue();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function Sw(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=xw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wN.bind(null,e),e.Ca.d_=uN.bind(null,e.eventManager),e.Ca.$a=cN.bind(null,e.eventManager),e}function CN(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=EN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bN.bind(null,e),e}class Pu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ac(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return DR(this.persistence,new NR,e.initialUser,this.serializer)}Ga(e){return new AR(hp.Zr,this.serializer)}Wa(e){return new UR}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Pu.provider={build:()=>new Pu};class Uh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Wy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=TN.bind(null,this.syncEngine),await oN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new lN}()}createDatastore(e){const n=ac(e.databaseInfo.databaseId),r=function(i){return new HR(i)}(e.databaseInfo);return function(i,o,l,u){return new GR(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new QR(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Wy(this.syncEngine,n,0),function(){return Uy.D()?new Uy:new zR}())}createSyncEngine(e,n){return function(s,i,o,l,u,c,f){const p=new pN(s,i,o,l,u,c);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ie(s);G("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Ra(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Uh.provider={build:()=>new Uh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):hr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=wt.UNAUTHENTICATED,this.clientId=A0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{G("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(G("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ir;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=_p(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function md(t,e){t.asyncQueue.verifyOperationInProgress(),G("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await aw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Gy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await PN(t);G("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>zy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>zy(e.remoteStore,s)),t._onlineComponents=e}async function PN(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){G("FirestoreClient","Using user provided OfflineComponentProvider");try{await md(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===L.FAILED_PRECONDITION||s.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ci("Error using user provided cache. Falling back to memory cache: "+n),await md(t,new Pu)}}else G("FirestoreClient","Using default OfflineComponentProvider"),await md(t,new Pu);return t._offlineComponents}async function Tw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(G("FirestoreClient","Using user provided OnlineComponentProvider"),await Gy(t,t._uninitializedComponentsProvider._online)):(G("FirestoreClient","Using default OnlineComponentProvider"),await Gy(t,new Uh))),t._onlineComponents}function RN(t){return Tw(t).then(e=>e.syncEngine)}async function Ru(t){const e=await Tw(t),n=e.eventManager;return n.onListen=mN.bind(null,e.syncEngine),n.onUnlisten=vN.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=gN.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=_N.bind(null,e.syncEngine),n}function NN(t,e,n={}){const r=new ir;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,c){const f=new Tp({next:y=>{f.Za(),o.enqueueAndForget(()=>wp(i,p));const I=y.docs.has(l);!I&&y.fromCache?c.reject(new W(L.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&y.fromCache&&u&&u.source==="server"?c.reject(new W(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(y)},error:y=>c.reject(y)}),p=new bp(tc(l.path),f,{includeMetadataChanges:!0,_a:!0});return xp(i,p)}(await Ru(t),t.asyncQueue,e,n,r)),r.promise}function kN(t,e,n={}){const r=new ir;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,c){const f=new Tp({next:y=>{f.Za(),o.enqueueAndForget(()=>wp(i,p)),y.fromCache&&u.source==="server"?c.reject(new W(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(y)},error:y=>c.reject(y)}),p=new bp(l,f,{includeMetadataChanges:!0,_a:!0});return xp(i,p)}(await Ru(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(t,e,n){if(!n)throw new W(L.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function DN(t,e,n,r){if(e===!0&&r===!0)throw new W(L.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Qy(t){if(!X.isDocumentKey(t))throw new W(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Yy(t){if(X.isDocumentKey(t))throw new W(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function cc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":te()}function pn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=cc(t);throw new W(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new W(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new W(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}DN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Iw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new W(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new W(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new W(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xy(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new YA;switch(r.type){case"firstParty":return new eP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Ky.get(n);r&&(G("ComponentProvider","Removing Datastore"),Ky.delete(n),r.terminate())}(this),Promise.resolve()}}function jN(t,e,n,r={}){var s;const i=(t=pn(t,dc))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Ci("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=wt.MOCK_USER;else{l=ST(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new W(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new wt(c)}t._authCredentials=new XA(new C0(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new rs(this.firestore,e,this._query)}}class Rt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rt(this.firestore,e,this._key)}}class Gr extends rs{constructor(e,n,r){super(e,n,tc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rt(this.firestore,null,new X(e))}withConverter(e){return new Gr(this.firestore,e,this._path)}}function Zt(t,e,...n){if(t=Nt(t),Cw("collection","path",e),t instanceof dc){const r=Pe.fromString(e,...n);return Yy(r),new Gr(t,null,r)}{if(!(t instanceof Rt||t instanceof Gr))throw new W(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Pe.fromString(e,...n));return Yy(r),new Gr(t.firestore,null,r)}}function Bt(t,e,...n){if(t=Nt(t),arguments.length===1&&(e=A0.newId()),Cw("doc","path",e),t instanceof dc){const r=Pe.fromString(e,...n);return Qy(r),new Rt(t,null,new X(r))}{if(!(t instanceof Rt||t instanceof Gr))throw new W(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Pe.fromString(e,...n));return Qy(r),new Rt(t.firestore,t instanceof Gr?t.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new uw(this,"async_queue_retry"),this.Vu=()=>{const r=pd();r&&G("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=pd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=pd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new ir;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ca(e))throw e;G("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw hr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=vp.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&te()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Zy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Zr extends dc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Jy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Jy(e),this._firestoreClient=void 0,await e}}}function ON(t,e){const n=typeof t=="object"?t:zx(),r=typeof t=="string"?t:"(default)",s=zf(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=ET("firestore");i&&jN(s,...i)}return s}function hc(t){if(t._terminated)throw new W(L.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||VN(t),t._firestoreClient}function VN(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,c,f){return new fP(l,u,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Iw(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new AN(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Di(pt.fromBase64String(e))}catch(n){throw new W(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Di(pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return me(this._lat,e._lat)||me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN=/^__.*__$/;class LN{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ks(e,this.data,this.fieldMask,n,this.fieldTransforms):new Aa(e,this.data,n,this.fieldTransforms)}}function Aw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw te()}}class Rp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Rp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Nu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Aw(this.Cu)&&MN.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class FN{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ac(e)}Qu(e,n,r,s=!1){return new Rp({Cu:e,methodName:n,qu:r,path:ct.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Np(t){const e=t._freezeSettings(),n=ac(t._databaseId);return new FN(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Pw(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);kw("Data must be an object, but it was:",o,r);const l=Rw(r,o);let u,c;if(i.merge)u=new Sn(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const y=zN(e,p,n);if(!o.contains(y))throw new W(L.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);$N(f,y)||f.push(y)}u=new Sn(f),c=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,c=o.fieldTransforms;return new LN(new dn(l),u,c)}class kp extends Cp{_toFieldTransform(e){return new LP(e.path,new da)}isEqual(e){return e instanceof kp}}function UN(t,e,n,r=!1){return Dp(n,t.Qu(r?4:3,e))}function Dp(t,e){if(Nw(t=Nt(t)))return kw("Unsupported field value:",e,t),Rw(t,e);if(t instanceof Cp)return function(r,s){if(!Aw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=Dp(l,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Nt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=et.fromDate(r);return{timestampValue:Cu(s.serializer,i)}}if(r instanceof et){const i=new et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Cu(s.serializer,i)}}if(r instanceof Ap)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Di)return{bytesValue:ew(s.serializer,r._byteString)};if(r instanceof Rt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:cp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Pp)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return op(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${cc(r)}`)}(t,e)}function Rw(t,e){const n={};return P0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ui(t,(r,s)=>{const i=Dp(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Nw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof et||t instanceof Ap||t instanceof Di||t instanceof Rt||t instanceof Cp||t instanceof Pp)}function kw(t,e,n){if(!Nw(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=cc(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function zN(t,e,n){if((e=Nt(e))instanceof Ip)return e._internalPath;if(typeof e=="string")return Dw(t,e);throw Nu("Field path arguments must be of type string or ",t,!1,void 0,n)}const BN=new RegExp("[~\\*/\\[\\]]");function Dw(t,e,n){if(e.search(BN)>=0)throw Nu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ip(...e.split("."))._internalPath}catch{throw Nu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Nu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new W(L.INVALID_ARGUMENT,l+t+u)}function $N(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Rt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new HN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(fc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class HN extends jw{data(){return super.data()}}function fc(t,e){return typeof e=="string"?Dw(t,e):e instanceof Ip?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class jp{}class Vw extends jp{}function ku(t,e,...n){let r=[];e instanceof jp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Op).length,l=i.filter(u=>u instanceof pc).length;if(o>1||o>0&&l>0)throw new W(L.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class pc extends Vw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new pc(e,n,r)}_apply(e){const n=this._parse(e);return Mw(e._query,n),new rs(e.firestore,e.converter,Nh(e._query,n))}_parse(e){const n=Np(e.firestore);return function(i,o,l,u,c,f,p){let y;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new W(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){tv(p,f);const I=[];for(const D of p)I.push(ev(u,i,D));y={arrayValue:{values:I}}}else y=ev(u,i,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||tv(p,f),y=UN(l,o,p,f==="in"||f==="not-in");return Ke.create(c,f,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function WN(t,e,n){const r=e,s=fc("where",t);return pc._create(s,r,n)}class Op extends jp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Op(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Rn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)Mw(o,u),o=Nh(o,u)}(e._query,n),new rs(e.firestore,e.converter,Nh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Vp extends Vw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Vp(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new W(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ca(i,o)}(e._query,this._field,this._direction);return new rs(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new zi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function qN(t,e="asc"){const n=e,r=fc("orderBy",t);return Vp._create(r,n)}function ev(t,e,n){if(typeof(n=Nt(n))=="string"){if(n==="")throw new W(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!L0(e)&&n.indexOf("/")!==-1)throw new W(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Pe.fromString(n));if(!X.isDocumentKey(r))throw new W(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return wy(t,new X(r))}if(n instanceof Rt)return wy(t,n._key);throw new W(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cc(n)}.`)}function tv(t,e){if(!Array.isArray(t)||t.length===0)throw new W(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Mw(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(L.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(L.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class GN{convertValue(e,n="none"){switch(Ps(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(As(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw te()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ui(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>$e(o.doubleValue));return new Pp(i)}convertGeoPoint(e){return new Ap($e(e.latitude),$e(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=np(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(aa(e));default:return null}}convertTimestamp(e){const n=Xr(e);return new et(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Pe.fromString(e);xe(ow(r));const s=new la(r.get(1),r.get(3)),i=new X(r.popFirst(5));return s.isEqual(n)||hr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fw extends jw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new $l(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(fc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class $l extends Fw{data(e={}){return super.data(e)}}class Uw{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Io(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new $l(this._firestore,this._userDataWriter,r.key,r,new Io(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new $l(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Io(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new $l(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Io(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,f=-1;return l.type!==0&&(c=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:KN(l.type),doc:u,oldIndex:c,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function KN(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return te()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(t){t=pn(t,Rt);const e=pn(t.firestore,Zr);return NN(hc(e),t._key).then(n=>$w(e,t,n))}class Mp extends GN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Di(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Rt(this.firestore,null,n)}}function Hl(t){t=pn(t,rs);const e=pn(t.firestore,Zr),n=hc(e),r=new Mp(e);return Ow(t._query),kN(n,t._query).then(s=>new Uw(e,r,t,s))}function js(t,e,n){t=pn(t,Rt);const r=pn(t.firestore,Zr),s=Lw(t.converter,e,n);return Fp(r,[Pw(Np(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,An.none())])}function Bw(t){return Fp(pn(t.firestore,Zr),[new ap(t._key,An.none())])}function Lp(t,e){const n=pn(t.firestore,Zr),r=Bt(t),s=Lw(t.converter,e);return Fp(n,[Pw(Np(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,An.exists(!1))]).then(()=>r)}function _s(t,...e){var n,r,s;t=Nt(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Zy(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Zy(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(s=p.complete)===null||s===void 0?void 0:s.bind(p)}let u,c,f;if(t instanceof Rt)c=pn(t.firestore,Zr),f=tc(t._key.path),u={next:p=>{e[o]&&e[o]($w(c,t,p))},error:e[o+1],complete:e[o+2]};else{const p=pn(t,rs);c=pn(p.firestore,Zr),f=p._query;const y=new Mp(c);u={next:I=>{e[o]&&e[o](new Uw(c,y,p,I))},error:e[o+1],complete:e[o+2]},Ow(t._query)}return function(y,I,D,E){const N=new Tp(E),b=new bp(I,N,D);return y.asyncQueue.enqueueAndForget(async()=>xp(await Ru(y),b)),()=>{N.Za(),y.asyncQueue.enqueueAndForget(async()=>wp(await Ru(y),b))}}(hc(c),f,l,u)}function Fp(t,e){return function(r,s){const i=new ir;return r.asyncQueue.enqueueAndForget(async()=>xN(await RN(r),s,i)),i.promise}(hc(t),e)}function $w(t,e,n){const r=n.docs.get(e._key),s=new Mp(t);return new Fw(t,s,e._key,r,new Io(n.hasPendingWrites,n.fromCache),e.converter)}function Hw(){return new kp("serverTimestamp")}(function(e,n=!0){(function(s){Fi=s})(Mi),Ti(new Ts("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Zr(new JA(r.getProvider("auth-internal")),new nP(r.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new W(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new la(c.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),qr(gy,"4.7.3",e),qr(gy,"4.7.3","esm2017")})();const QN={apiKey:"AIzaSyDfsK4K4vhOmSSGeVHOlLnJuNlHGNha4LU",authDomain:"storycraft-a5f7e.firebaseapp.com",projectId:"storycraft-a5f7e",storageBucket:"storycraft-a5f7e.firebasestorage.app",messagingSenderId:"727724875985",appId:"1:727724875985:web:97411448885c68c289e5f0",measurementId:"G-JH03Y2NZDK"},Ww=Ux(QN),gd=qA(Ww),Ne=ON(Ww),qw=V.createContext(),YN=({children:t})=>{const[e,n]=V.useState(null),[r,s]=V.useState(!1),[i,o]=V.useState(!0),{GLOBAL_APP_IDENTIFIER:l}=gr();V.useEffect(()=>{const p=jC(gd,y=>{n(y),y||(o(!1),s(!1))});return()=>p()},[]),V.useEffect(()=>{if(e&&l){const p=Bt(Ne,`artifacts2/${l}/users/${e.uid}`),y=_s(p,async I=>{if(I.exists()){const D=I.data().isMaster===!0;s(D),console.log("%c[DIAGNSTICO AUTH]","color: #00A8E8; font-weight: bold;",{isMaster:D,userData:I.data()})}else try{await js(p,{displayName:e.displayName,email:e.email,isMaster:!1}),s(!1)}catch(D){console.error("Erro ao criar o documento do utilizador:",D)}o(!1)},I=>{console.error("Erro ao escutar documento do utilizador:",I),o(!1)});return()=>y()}s(!1)},[e,l]);const f={user:e,loading:i,isMaster:r,googleSignIn:()=>{const p=new Xn;return tA(gd,p)},googleSignOut:()=>OC(gd)};return d.jsx(qw.Provider,{value:f,children:!i&&t})},ze=()=>{const t=V.useContext(qw);if(!t)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return t},nv="1:727724875985:web:97411448885c68c289e5f0",XN=(t,e)=>{const[n,r]=V.useState(null),[s,i]=V.useState(!0);V.useEffect(()=>{if(!t||!e){i(!1);return}const u=Bt(Ne,`artifacts2/${nv}/users/${e}/characterSheets/${t}`),c=_s(u,f=>{if(f.exists()){const y={...f.data()};Object.keys(y).forEach(I=>{if(typeof y[I]=="string")try{y[I]=JSON.parse(y[I])}catch{}}),r({id:f.id,...y})}else console.error("Personagem no encontrado!"),r(null);i(!1)},f=>{console.error("Erro ao carregar o personagem:",f),i(!1)});return()=>c()},[t,e]);const o=V.useCallback(async(u,c)=>{if(!t||!e)return;const f=Bt(Ne,`artifacts2/${nv}/users/${e}/characterSheets/${t}`),p=typeof c=="object"&&c!==null?JSON.stringify(c):c;try{await js(f,{[u]:p},{merge:!0})}catch(y){console.error(`Erro ao atualizar o campo ${u}:`,y)}},[t,e]),l=V.useCallback(u=>{var c;if(n){const f=((c=n.collapsedStates)==null?void 0:c[u])??!1,p={...n.collapsedStates,[u]:!f};o("collapsedStates",p)}},[n,o]);return{character:n,loading:s,updateCharacterField:o,toggleSection:l}},Gw=V.createContext(),gr=()=>V.useContext(Gw),yd="1:727724875985:web:97411448885c68c289e5f0",rv="storycraft-v2/default-session",JN=({children:t})=>{const[e,n]=V.useState(null),[r,s]=V.useState(null),i=V.useMemo(()=>{switch(e){case"v1":return`artifacts2/${yd}`;case"v2":return`artifacts2/${yd}`;default:return null}},[e]),l={currentSystem:e,setCurrentSystem:n,characterDataCollectionRoot:i,sessionDataCollectionRoot:rv,GLOBAL_APP_IDENTIFIER:yd,GLOBAL_SESSION_PATH:rv,activeCharacter:r,setActiveCharacter:s};return d.jsx(Gw.Provider,{value:l,children:t})},$t=({title:t,isCollapsed:e,toggleSection:n,actions:r,children:s,isComplexTitle:i})=>d.jsxs("section",{className:"mb-8 p-6 bg-bgSurface backdrop-blur-sm rounded-xl shadow-inner border border-bgElement",children:[d.jsxs("div",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2 cursor-pointer flex justify-between items-center",onClick:n,children:[d.jsx("h2",{className:`flex-grow ${i?"":"truncate"}`.trim(),children:t}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{onClick:o=>o.stopPropagation(),children:r}),d.jsx("span",{children:e?"":""})]})]}),!e&&d.jsx("div",{className:"mt-4",children:s})]}),oi=[{name:"Acrobacia",attr:"DES"},{name:"Adestramento*",attr:"CAR"},{name:"Armadilhas*",attr:"INT"},{name:"Atletismo",attr:"FOR"},{name:"Atuao*",attr:"CAR"},{name:"Cavalgar",attr:"DES"},{name:"Cirurgia*",attr:"INT"},{name:"Conhecimento*",attr:"INT"},{name:"Cura",attr:"SAB"},{name:"Diplomacia",attr:"CAR"},{name:"Disfarce*",attr:"CAR"},{name:"Enganao",attr:"CAR"},{name:"Furtividade",attr:"DES"},{name:"Guerra*",attr:"INT"},{name:"Intimidao",attr:"CAR"},{name:"Intuio",attr:"SAB"},{name:"Investigao",attr:"INT"},{name:"Jogatina*",attr:"CAR"},{name:"Ladinagem*",attr:"DES"},{name:"Luta",attr:"FOR"},{name:"Misticismo*",attr:"INT"},{name:"Nobreza*",attr:"INT"},{name:"Ofcio",attr:"INT"},{name:"Percepo",attr:"SAB"},{name:"Pilotagem*",attr:"DES"},{name:"Pontaria",attr:"DES"},{name:"Prestidigitao",attr:"DES"},{name:"Religio*",attr:"SAB"},{name:"Seduo",attr:"CAR"},{name:"Sobrevivncia",attr:"SAB"}],Wl={FOR:"forca",DES:"destreza",CON:"constituicao",INT:"inteligencia",SAB:"sabedoria",CAR:"carisma"},ZN=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,onUpdate:s,onExecuteFormula:i,isEditMode:o,totalAttributesMap:l})=>{const{user:u}=ze(),c=u.uid===t.ownerUid||e,[f,p]=V.useState(t.skillSystem||{});V.useEffect(()=>{if((!t.skillSystem||oi.some(S=>!t.skillSystem[S.name]||!t.skillSystem[S.name].hasOwnProperty("selectedAttr")))&&c){console.log("Inicializando ou atualizando sistema de percias...");const S={...t.skillSystem};oi.forEach(P=>{const C=S[P.name]||{};C.hasOwnProperty("selectedAttr")||(S[P.name]={trained:C.trained||!1,otherBonus:C.otherBonus||0,selectedAttr:P.attr})}),s("skillSystem",S)}p(t.skillSystem||{})},[t.skillSystem,s,c]),V.useMemo(()=>t.mainAttributes||{},[t.mainAttributes]);const y=V.useMemo(()=>t.level||0,[t.level]),I=V.useCallback((v,S)=>{if(!S)return 0;const P=S.selectedAttr||v.attr,C=l[P]||0;let x=0;S.trained&&(x=2+Math.floor(y/10));const g=parseInt(S.otherBonus,10)||0;return C+x+g},[l,y]),D=v=>{if(!c||!o)return;const S=t.skillSystem||{},P=S[v]||{trained:!1,otherBonus:0},C={...S,[v]:{...P,trained:!P.trained}};s("skillSystem",C)},E=(v,S)=>{if(!c||!o)return;const P=t.skillSystem||{},C=P[v]||{trained:!1,otherBonus:0,selectedAttr:""},x={...P,[v]:{...C,selectedAttr:S}};s("skillSystem",x)},N=(v,S)=>{p(P=>{const C=P[v]||{trained:!1,otherBonus:0};return{...P,[v]:{...C,otherBonus:S}}})},b=v=>{var g,_,A;if(!c||!o)return;const S=(g=f[v])==null?void 0:g.otherBonus,P=(A=(_=t.skillSystem)==null?void 0:_[v])==null?void 0:A.otherBonus,C=parseInt(S,10)||0,x=parseInt(P,10)||0;if(C!==x){const k={...t.skillSystem,...f};k[v].otherBonus=C,s("skillSystem",k)}String(S)!==String(C)&&p(t.skillSystem||{})},w=(v,S)=>{const P={name:`Teste de ${v.name}`,components:[{type:"skillRoll",skill:v.name}]};i(P)};return!f||Object.keys(f).length<oi.length?d.jsx($t,{title:"Percias",isCollapsed:n,toggleSection:r,children:d.jsx("p",{className:"text-textSecondary text-center",children:"Carregando percias..."})}):d.jsx($t,{title:"Percias",isCollapsed:n,toggleSection:r,children:d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:oi.map(v=>{const S=f[v.name];if(!S)return null;const P=I(v,S),C=`${P>=0?"+":""}${P}`,x=S.selectedAttr||v.attr;return d.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex flex-col gap-2",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"flex items-center gap-2 flex-grow overflow-hidden",children:[d.jsx("input",{type:"checkbox",id:`trained-${v.name}`,checked:S.trained,onChange:()=>D(v.name),className:"form-checkbox text-btnHighlightBg rounded-sm focus:ring-btnHighlightBg disabled:opacity-50",disabled:!c||!o}),d.jsx("label",{className:"font-semibold text-lg text-textPrimary truncate",title:`${v.name}`,children:v.name})]}),o?d.jsx("select",{value:x,onChange:g=>E(v.name,g.target.value),className:"bg-bgInput text-textPrimary text-sm font-bold rounded-md p-1 border-none focus:ring-2 focus:ring-btnHighlightBg",disabled:!c,children:Object.keys(Wl).map(g=>d.jsx("option",{value:g,children:g},g))}):d.jsxs("span",{className:"font-semibold text-textSecondary text-sm ml-1",children:["(",x,")"]}),d.jsx("span",{className:"font-bold text-lg text-btnHighlightBg whitespace-nowrap ml-2",children:C})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("label",{htmlFor:`other-${v.name}`,className:"text-sm text-textSecondary whitespace-nowrap",children:"Outros:"}),d.jsx("input",{type:"number",id:`other-${v.name}`,value:S.otherBonus===0?"":S.otherBonus,onChange:g=>N(v.name,g.target.value),onBlur:()=>b(v.name),className:"w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center disabled:bg-bgPage",placeholder:"0",disabled:!c||!o}),d.jsx("button",{onClick:()=>w(v),className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg text-lg",title:`Rolar ${v.name} (1d20${C})`,children:""})]})]},v.name)})})})},e1=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i})=>{const o=V.useRef(null);return Gh.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),d.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i})},t1=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,onOpenActionModal:s,allAttributes:i,onUpdate:o,onExecuteFormula:l,isEditMode:u})=>{const{user:c}=ze();if(!t||!c)return null;const f=c.uid===t.ownerUid||e,[p,y]=V.useState(t.formulaActions||[]);V.useEffect(()=>{y(t.formulaActions||[])},[t.formulaActions]);const I=()=>{const C={id:crypto.randomUUID(),name:"Nova Ao",components:[{id:crypto.randomUUID(),type:"dice",value:"1d6"}],multiplier:1,discordText:"",isCollapsed:!1,costValue:0,costType:"",recoverHP:!1,recoverMP:!1};o("formulaActions",[...t.formulaActions||[],C])},D=C=>{o("formulaActions",(t.formulaActions||[]).filter(x=>x.id!==C))},E=(C,x,g)=>{y(_=>_.map(A=>A.id===C?{...A,[x]:g}:A))},N=V.useCallback((C,x,g)=>{const _=p.find(k=>k.id===C),A=(t.formulaActions||[]).find(k=>k.id===C);if(_&&A){const k=g!==void 0?g:_[x];k!==A[x]&&o("formulaActions",(t.formulaActions||[]).map(j=>j.id===C?{...j,[x]:k}:j))}},[p,t.formulaActions,o]),b=(C,x)=>{let g;x==="dice"?g={id:crypto.randomUUID(),type:x,value:"1d6"}:x==="attribute"?g={id:crypto.randomUUID(),type:x,value:""}:x==="critDice"?g={id:crypto.randomUUID(),type:x,value:"1d6",critValue:6,critBonusAttribute:"",critBonusMultiplier:1}:x==="skillRoll"&&(g={id:crypto.randomUUID(),type:x,skill:"",critMin:19,critFormula:""}),o("formulaActions",(t.formulaActions||[]).map(_=>_.id===C?{..._,components:[..._.components||[],g]}:_))},w=(C,x)=>{o("formulaActions",(t.formulaActions||[]).map(g=>g.id===C?{...g,components:(g.components||[]).filter(_=>_&&_.id!==x)}:g))},v=(C,x,g,_)=>{y(A=>A.map(k=>k.id===C?{...k,components:k.components.map(j=>j.id===x?{...j,[g]:_}:j)}:k))},S=V.useCallback((C,x,g,_)=>{const A=p.find(H=>H.id===C),k=A==null?void 0:A.components.find(H=>H.id===x),j=(t.formulaActions||[]).find(H=>H.id===C),R=j==null?void 0:j.components.find(H=>H.id===x);if(k&&R){const H=_!==void 0?_:k[g];H!==R[g]&&o("formulaActions",(t.formulaActions||[]).map(ne=>ne.id===C?{...ne,components:ne.components.map(re=>re.id===x?{...re,[g]:H}:re)}:ne))}},[p,t.formulaActions,o]),P=C=>{o("formulaActions",(t.formulaActions||[]).map(x=>x.id===C?{...x,isCollapsed:!x.isCollapsed}:x))};return d.jsx($t,{title:"Aes",isCollapsed:n,toggleSection:r,children:d.jsx(d.Fragment,{children:d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3",children:"Construtor de Aes Rpidas"}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(p||[]).map(C=>C.isCollapsed!==!1?d.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[d.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>P(C.id),children:C.name||"Ao Sem Nome"}),d.jsx("button",{onClick:()=>l(C),className:"px-4 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-2 text-sm",children:"Usar"})]},C.id):d.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[d.jsxs("div",{className:"flex justify-between items-center gap-2 mb-3",children:[d.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>P(C.id),children:C.name||"Ao Sem Nome"}),d.jsx("button",{onClick:()=>l(C),className:"px-5 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap",children:"Usar"}),f&&u&&d.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>P(C.id),children:"Recolher "})]}),f&&u&&d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 border-t border-bgInput pt-3 mt-3 flex-grow",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome da Ao:"}),d.jsx("input",{type:"text",placeholder:"Nome da Ao",value:C.name,onChange:g=>E(C.id,"name",g.target.value),onBlur:()=>N(C.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-3",disabled:!f||!u}),d.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Componentes da Frmula:"}),d.jsx("div",{className:"space-y-2 mb-3",children:(C.components||[]).filter(Boolean).map(g=>d.jsx("div",{className:"flex flex-col gap-2 p-2 rounded-md border border-dashed border-textSecondary/30",children:g.type==="dice"?d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"text",placeholder:"1d6 ou 10",value:g.value,onChange:_=>v(C.id,g.id,"value",_.target.value),onBlur:()=>S(C.id,g.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u}),d.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Dado/N"}),f&&u&&d.jsx("button",{onClick:()=>w(C.id,g.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}):g.type==="attribute"?d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("select",{value:g.value,onChange:_=>v(C.id,g.id,"value",_.target.value),onBlur:()=>S(C.id,g.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u,children:[d.jsx("option",{value:"",children:"Selecione Atributo"}),i.map(_=>d.jsx("option",{value:_,children:_},_))]}),d.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Atributo"}),f&&u&&d.jsx("button",{onClick:()=>w(C.id,g.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}):g.type==="critDice"?d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"text",placeholder:"1d6",value:g.value,onChange:_=>v(C.id,g.id,"value",_.target.value),onBlur:()=>S(C.id,g.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u}),d.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Dado Crtico"}),f&&u&&d.jsx("button",{onClick:()=>w(C.id,g.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-textSecondary",children:[d.jsx("span",{className:"flex-shrink-0",children:"Crit. "}),d.jsx("input",{type:"number",placeholder:"6",value:g.critValue||"",onChange:_=>v(C.id,g.id,"critValue",_.target.value),onBlur:()=>S(C.id,g.id,"critValue"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u}),d.jsx("span",{className:"flex-shrink-0",children:"Bnus:"}),d.jsxs("select",{value:g.critBonusAttribute||"",onChange:_=>v(C.id,g.id,"critBonusAttribute",_.target.value),onBlur:()=>S(C.id,g.id,"critBonusAttribute"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u,children:[d.jsx("option",{value:"",children:"Nenhum"}),i.map(_=>d.jsx("option",{value:_,children:_},_))]}),d.jsx("span",{className:"flex-shrink-0",children:"x"}),d.jsx("input",{type:"number",placeholder:"1",value:g.critBonusMultiplier||"",onChange:_=>v(C.id,g.id,"critBonusMultiplier",_.target.value),onBlur:()=>S(C.id,g.id,"critBonusMultiplier"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u})]})]}):g.type==="skillRoll"?d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("select",{value:g.skill,onChange:_=>v(C.id,g.id,"skill",_.target.value),onBlur:()=>S(C.id,g.id,"skill"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u,children:[d.jsx("option",{value:"",children:"Selecione Percia"}),oi.map(_=>d.jsx("option",{value:_.name,children:_.name},_.name))]}),d.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Percia"}),f&&u&&d.jsx("button",{onClick:()=>w(C.id,g.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-textSecondary",children:[d.jsx("span",{className:"flex-shrink-0",children:"Crit. "}),d.jsx("input",{type:"number",placeholder:"19",value:g.critMin||"",onChange:_=>v(C.id,g.id,"critMin",_.target.value),onBlur:()=>S(C.id,g.id,"critMin"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u}),d.jsx("span",{className:"flex-shrink-0",children:"Frmula Crtico:"}),d.jsx("input",{type:"text",placeholder:"Ex: 1d6",value:g.critFormula||"",onChange:_=>v(C.id,g.id,"critFormula",_.target.value),onBlur:()=>S(C.id,g.id,"critFormula"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u})]})]}):null},g.id))}),f&&u&&d.jsxs("div",{className:"flex gap-2 flex-wrap",children:[d.jsx("button",{onClick:()=>b(C.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Dado/N"}),d.jsx("button",{onClick:()=>b(C.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Atributo"}),d.jsx("button",{onClick:()=>b(C.id,"critDice"),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md",children:"+ Dado Crtico"}),d.jsx("button",{onClick:()=>b(C.id,"skillRoll"),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md",children:"+ Rolagem de Percia"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Multiplicador:"}),d.jsx("input",{type:"number",value:C.multiplier||"",onChange:g=>E(C.id,"multiplier",g.target.value),onBlur:()=>N(C.id,"multiplier"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-3",placeholder:"1",disabled:!f||!u}),d.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Descrio da Ao:"}),d.jsx(e1,{placeholder:"Descrio...",value:C.discordText,onChange:g=>E(C.id,"discordText",g.target.value),onBlur:()=>N(C.id,"discordText"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-sm",disabled:!f||!u}),d.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2 mt-3",children:"Custo da Ao:"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"number",placeholder:"Custo",value:C.costValue||"",onChange:g=>E(C.id,"costValue",g.target.value),onBlur:()=>N(C.id,"costValue"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u}),d.jsxs("select",{value:C.costType,onChange:g=>E(C.id,"costType",g.target.value),onBlur:()=>N(C.id,"costType"),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!f||!u,children:[d.jsx("option",{value:"",children:"N/A"}),d.jsx("option",{value:"HP",children:"HP"}),d.jsx("option",{value:"MP",children:"MP"})]})]}),f&&d.jsxs("div",{className:"flex gap-4 mt-4",style:{display:u?"flex":"none"},children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:`recover-hp-${C.id}`,checked:C.recoverHP||!1,onChange:g=>N(C.id,"recoverHP",g.target.checked),className:"form-checkbox text-green-500 rounded-sm",disabled:!f}),d.jsx("label",{htmlFor:`recover-hp-${C.id}`,className:"ml-2 text-sm text-textSecondary",children:"Recuperar HP"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:`recover-mp-${C.id}`,checked:C.recoverMP||!1,onChange:g=>N(C.id,"recoverMP",g.target.checked),className:"form-checkbox text-blue-500 rounded-sm",disabled:!f}),d.jsx("label",{htmlFor:`recover-mp-${C.id}`,className:"ml-2 text-sm text-textSecondary",children:"Recuperar MP"})]})]})]})]}),f&&u&&d.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-bgInput/50",children:d.jsx("button",{onClick:()=>D(C.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Ao",children:d.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},C.id))}),f&&u&&d.jsx("div",{className:"flex justify-center mt-4",children:d.jsx("button",{onClick:I,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"+ Adicionar Ao Rpida"})})]})})})},n1=({character:t,isMaster:e,onUpdate:n,allAttributes:r,isCollapsed:s,toggleSection:i,isEditMode:o})=>{const{user:l}=ze();if(!t||!l)return d.jsx("div",{className:"p-6 text-center text-textSecondary",children:"A carregar buffs..."});const u=l.uid===t.ownerUid||e,[c,f]=V.useState(t.buffs||[]);V.useEffect(()=>{f(t.buffs||[])},[t.buffs]);const p=()=>{const P={id:crypto.randomUUID(),name:"Novo Buff",effects:[],isActive:!1,isCollapsed:!1,costValue:0,costType:""};n("buffs",[...c,P])},y=P=>n("buffs",(t.buffs||[]).filter(C=>C.id!==P)),I=P=>n("buffs",(t.buffs||[]).map(C=>C.id===P?{...C,isActive:!C.isActive}:C)),D=P=>n("buffs",(t.buffs||[]).map(C=>C.id===P?{...C,isCollapsed:!C.isCollapsed}:C)),E=(P,C,x)=>{f(g=>g.map(_=>_.id===P?{..._,[C]:x}:_))},N=V.useCallback((P,C)=>{const x=c.find(_=>_.id===P),g=(t.buffs||[]).find(_=>_.id===P);if(x&&g&&x[C]!==g[C]){const _=C==="costValue"?parseInt(x[C],10)||0:x[C];n("buffs",(t.buffs||[]).map(A=>A.id===P?{...A,[C]:_}:A))}},[c,t.buffs,n]),b=(P,C)=>{const x={id:crypto.randomUUID(),type:C,target:"",value:C==="attribute"?0:"1d6"};n("buffs",(t.buffs||[]).map(g=>g.id===P?{...g,effects:[...g.effects||[],x]}:g))},w=(P,C)=>{n("buffs",(t.buffs||[]).map(x=>x.id===P?{...x,effects:(x.effects||[]).filter(g=>g.id!==C)}:x))},v=(P,C,x,g)=>{f(_=>_.map(A=>A.id===P?{...A,effects:A.effects.map(k=>{if(k.id===C){const j={...k,[x]:g};return x==="type"&&(j.target="",j.value=g==="attribute"?0:"1d6"),j}return k})}:A))},S=V.useCallback((P,C,x)=>{const g=c.find(j=>j.id===P),_=g==null?void 0:g.effects.find(j=>j.id===C),A=(t.buffs||[]).find(j=>j.id===P),k=A==null?void 0:A.effects.find(j=>j.id===C);_&&k&&_[x]!==k[x]&&n("buffs",(t.buffs||[]).map(j=>j.id===P?{...j,effects:j.effects.map(R=>R.id===C?{...R,[x]:_[x]}:R)}:j))},[c,t.buffs,n]);return d.jsx($t,{title:"Buffs",isCollapsed:s,toggleSection:i,children:d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(c||[]).map(P=>P.isCollapsed!==!1?d.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[d.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>D(P.id),children:P.name||"Buff Sem Nome"}),d.jsx("label",{className:"flex items-center cursor-pointer ml-2",children:d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"checkbox",checked:P.isActive,onChange:()=>I(P.id),className:"sr-only",disabled:!u}),d.jsx("div",{className:`block w-12 h-6 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),d.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})]})})]},P.id):d.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[d.jsxs("div",{className:"flex justify-between items-center mb-3",children:[d.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>D(P.id),children:P.name||"Buff Sem Nome"}),d.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[d.jsx("label",{className:"flex items-center cursor-pointer",children:d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"checkbox",checked:P.isActive,onChange:()=>I(P.id),className:"sr-only",disabled:!u}),d.jsx("div",{className:`block w-14 h-8 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),d.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})]})}),d.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>D(P.id),children:"Recolher "})]})]}),d.jsxs("div",{className:"mt-3 pt-3 border-t border-bgInput/50 space-y-3",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome do Buff:"}),d.jsx("input",{type:"text",placeholder:"Nome do Buff",value:P.name,onChange:x=>E(P.id,"name",x.target.value),onBlur:()=>N(P.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-4",disabled:!u}),d.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Custo de Manuteno:"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"number",placeholder:"0",value:P.costValue||"",onChange:x=>E(P.id,"costValue",x.target.value),onBlur:()=>N(P.id,"costValue"),className:"w-20 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),d.jsxs("select",{value:P.costType,onChange:x=>E(P.id,"costType",x.target.value),onBlur:()=>N(P.id,"costType"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u,children:[d.jsx("option",{value:"",children:"N/A"}),d.jsx("option",{value:"HP",children:"HP"}),d.jsx("option",{value:"MP",children:"MP"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Efeitos do Buff:"}),d.jsx("div",{className:"space-y-2",children:(P.effects||[]).map(x=>d.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[d.jsxs("select",{value:x.type,onChange:g=>v(P.id,x.id,"type",g.target.value),onBlur:()=>S(P.id,x.id,"type"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!u,children:[d.jsx("option",{value:"attribute",children:"Modificar Atributo"}),d.jsx("option",{value:"dice",children:"Adicionar Dado/N"})]}),x.type==="attribute"?d.jsxs("select",{value:x.target,onChange:g=>v(P.id,x.id,"target",g.target.value),onBlur:()=>S(P.id,x.id,"target"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!u,children:[d.jsx("option",{value:"",children:"Selecione Atributo"}),r.map(g=>d.jsx("option",{value:g,children:g},g))]}):d.jsx("div",{className:"p-2 bg-bgPage border-bgElement rounded-md text-textSecondary text-center italic col-span-3 sm:col-span-1",children:"No aplicvel"}),d.jsxs("div",{className:"flex items-center gap-2 col-span-3 sm:col-span-1",children:[d.jsx("input",{type:"text",placeholder:x.type==="attribute"?"Valor (+/-)":"1d6 ou 6",value:x.value||"",onChange:g=>v(P.id,x.id,"value",g.target.value),onBlur:()=>S(P.id,x.id,"value"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center",disabled:!u}),u&&d.jsx("button",{onClick:()=>w(P.id,x.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Efeito",children:d.jsx("span",{role:"img","aria-label":"Remover",children:""})})]})]},x.id))}),u&&o&&d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("button",{onClick:()=>b(P.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Atributo"}),d.jsx("button",{onClick:()=>b(P.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Dado/N"})]})]})]}),u&&o&&d.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-bgInput/50",children:d.jsx("button",{onClick:()=>y(P.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Buff",children:d.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]})]},P.id))}),(c||[]).length===0&&d.jsx("p",{className:"text-textSecondary italic",children:"Nenhum buff criado."}),u&&o&&d.jsx("div",{className:"flex justify-center mt-4",children:d.jsx("button",{onClick:p,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})})},Kw=({user:t,onSelectCharacter:e,handleCreateClick:n,handleImportClick:r,handleDeleteClick:s,characters:i,isMaster:o,viewingAll:l,onToggleView:u})=>d.jsxs("div",{className:"bg-bgSurface/80 backdrop-blur-sm p-6 rounded-lg shadow-lg border border-bgElement w-full",children:[d.jsx("h2",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2",children:l?"Todas as Fichas":"Meus Personagens"}),d.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[d.jsx("button",{onClick:n,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Criar Novo Personagem"}),d.jsx("button",{onClick:r,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md",children:"Importar Ficha (JSON)"}),o&&d.jsx("button",{onClick:()=>u(!l),className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md",children:l?"Ver Apenas Minhas Fichas":"Ver Todas as Fichas"})]}),i.length>0?d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(c=>d.jsxs("div",{className:"bg-bgElement p-4 rounded-lg shadow-md flex flex-col justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-1",children:c.name}),d.jsxs("p",{className:"text-sm text-textSecondary",children:["Nvel: ",c.level||"1"]}),o&&l&&d.jsxs("p",{className:"text-xs text-textSecondary mt-2 break-all",children:["Dono: ",c.ownerUid]})]}),d.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[d.jsx("button",{onClick:()=>e(c),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-lg",children:"Ver/Editar"}),t&&(t.uid===c.ownerUid||o)&&d.jsx("button",{onClick:()=>s(c),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-lg",children:"Excluir"})]})]},c.id))}):d.jsx("p",{className:"text-textSecondary italic",children:"Nenhum personagem encontrado."})]}),sv=async(t,e)=>{try{console.log("[DIAGNSTICO FIRESTORE] Adicionando item  coleo:",t,e);const n=Zt(Ne,t,"feed");await Lp(n,{...e,timestamp:Hw()})}catch(n){console.error("Error adding document to feed: ",n)}},r1=(t,e)=>{console.log("[DIAGNSTICO FIRESTORE] Assinando coleo:",t);const n=Zt(Ne,t,"feed"),r=ku(n,qN("timestamp","desc"));return _s(r,s=>{const i=[];s.forEach(o=>{i.push({id:o.id,...o.data()})}),e(i)},s=>{console.error("Error subscribing to feed:",s)})},Qw=V.createContext(),mc=()=>V.useContext(Qw),s1=({children:t})=>{const{user:e}=ze(),{GLOBAL_SESSION_PATH:n}=gr(),[r,s]=V.useState([]),[i,o]=V.useState(!0);V.useEffect(()=>{if(!e){s([]),o(!1);return}o(!0),console.log("[DIAGNSTICO ROLLFEED] Assinando feed global:",n);const f=r1(n,p=>{s(p),o(!1),console.log("[DIAGNSTICO ROLLFEED] Feed atualizado. Total de itens:",p.length)});return()=>f()},[e,n]);const l=V.useCallback(f=>{if(!e){console.warn("[DIAGNSTICO ROLLFEED] Tentativa de adicionar rolagem sem usurio logado.");return}console.log("[DIAGNSTICO ROLLFEED] Adicionando rolagem ao feed global:",n,f),sv(n,{...f,type:"roll"})},[e,n]),u=V.useCallback(f=>{if(!e){console.warn("[DIAGNSTICO ROLLFEED] Tentativa de adicionar mensagem sem usurio logado.");return}console.log("[DIAGNSTICO ROLLFEED] Adicionando mensagem ao feed global:",n,f),sv(n,{...f,type:"message"})},[e,n]),c={feedItems:r,isLoading:i,addRollToFeed:l,addMessageToFeed:u};return d.jsx(Qw.Provider,{value:c,children:t})},Yw=async(t,e,n=!1)=>{if(!e||!t)return[];try{let r=[];if(n){const s=Zt(Ne,`${t}/users`),i=await Hl(s);for(const o of i.docs){const l=Zt(Ne,`${t}/users/${o.id}/characterSheets`),u=ku(l);(await Hl(u)).forEach(f=>{r.push({id:f.id,ownerUid:o.id,...f.data()})})}}else{const s=Zt(Ne,`${t}/users/${e}/characterSheets`),i=ku(s);(await Hl(i)).forEach(l=>{r.push({id:l.id,ownerUid:e,...l.data()})})}return r}catch(r){return console.error("Erro ao buscar personagens:",r),[]}},Xw=async(t,e)=>{if(!e||!t)return null;const n=prompt("Qual o nome do novo personagem?");if(!n)return null;try{const r=Zt(Ne,`${t}/users/${e}/characterSheets`),s={name:n,ownerUid:e,createdAt:Hw(),level:1,mainAttributes:{hp:{current:100,max:100,temp:0},mp:{current:50,max:50}}};return{id:(await Lp(r,s)).id,...s}}catch(r){return console.error("Erro ao criar novo personagem:",r),null}},Jw=async(t,e,n)=>{if(!e||!n||!t)return!1;try{const r=Bt(Ne,`${t}/users/${e}/characterSheets/${n}`);return await Bw(r),console.log("Ficha deletada com sucesso!"),!0}catch(r){return console.error("Erro ao deletar personagem:",r),!1}},Up="1:727724875985:web:97411448885c68c289e5f0",vd=async t=>{if(!t)return[];try{const e=Zt(Ne,"themes"),n=ku(e,WN("ownerUid","==",t)),r=await Hl(n),s=[];return r.forEach(i=>{s.push({id:i.id,...i.data()})}),s}catch(e){return console.error("Erro ao buscar temas:",e),[]}},i1=async t=>{if(!t)return null;try{const e=Bt(Ne,"themes",t),n=await zw(e);return n.exists()?{id:n.id,...n.data()}:null}catch(e){return console.error("Erro ao buscar tema por ID:",e),null}},iv=async t=>{try{if(t.id){const e=Bt(Ne,"themes",t.id);return await js(e,t,{merge:!0}),t.id}else{const e=Zt(Ne,"themes");return(await Lp(e,t)).id}}catch(e){return console.error("Erro ao salvar tema:",e),null}},o1=async t=>{if(!t)return!1;try{const e=Bt(Ne,"themes",t);return await Bw(e),!0}catch(e){return console.error("Erro ao deletar tema:",e),!1}},a1=async t=>{if(!t)return null;try{const e=Bt(Ne,"storycraft-v2",Up,"userSettings",t),n=await zw(e);return n.exists()?{id:n.id,...n.data()}:null}catch(e){return console.error("Erro ao buscar configuraes de usurio:",e),null}},l1=async(t,e)=>{if(!t||!e)return!1;try{const n=Bt(Ne,"storycraft-v2",Up,"userSettings",t);return await js(n,e,{merge:!0}),!0}catch(n){return console.error("Erro ao salvar configuraes de usurio:",n),!1}},u1=async(t,e,n,r)=>{if(!(!t||!e))try{const s=Bt(Ne,`${r}/${Up}/users/${t}/characterSheets/${e}`);await js(s,{activeThemeId:n},{merge:!0})}catch(s){console.error("Erro ao aplicar tema ao personagem:",s)}};function c1(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Zw=c1,d1=typeof Qa=="object"&&Qa&&Qa.Object===Object&&Qa,h1=d1,f1=h1,p1=typeof self=="object"&&self&&self.Object===Object&&self,m1=f1||p1||Function("return this")(),eE=m1,g1=eE,y1=function(){return g1.Date.now()},v1=y1,_1=/\s/;function x1(t){for(var e=t.length;e--&&_1.test(t.charAt(e)););return e}var w1=x1,E1=w1,b1=/^\s+/;function S1(t){return t&&t.slice(0,E1(t)+1).replace(b1,"")}var T1=S1,I1=eE,C1=I1.Symbol,tE=C1,ov=tE,nE=Object.prototype,A1=nE.hasOwnProperty,P1=nE.toString,po=ov?ov.toStringTag:void 0;function R1(t){var e=A1.call(t,po),n=t[po];try{t[po]=void 0;var r=!0}catch{}var s=P1.call(t);return r&&(e?t[po]=n:delete t[po]),s}var N1=R1,k1=Object.prototype,D1=k1.toString;function j1(t){return D1.call(t)}var O1=j1,av=tE,V1=N1,M1=O1,L1="[object Null]",F1="[object Undefined]",lv=av?av.toStringTag:void 0;function U1(t){return t==null?t===void 0?F1:L1:lv&&lv in Object(t)?V1(t):M1(t)}var z1=U1;function B1(t){return t!=null&&typeof t=="object"}var $1=B1,H1=z1,W1=$1,q1="[object Symbol]";function G1(t){return typeof t=="symbol"||W1(t)&&H1(t)==q1}var K1=G1,Q1=T1,uv=Zw,Y1=K1,cv=NaN,X1=/^[-+]0x[0-9a-f]+$/i,J1=/^0b[01]+$/i,Z1=/^0o[0-7]+$/i,ek=parseInt;function tk(t){if(typeof t=="number")return t;if(Y1(t))return cv;if(uv(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=uv(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Q1(t);var n=J1.test(t);return n||Z1.test(t)?ek(t.slice(2),n?2:8):X1.test(t)?cv:+t}var nk=tk,rk=Zw,_d=v1,dv=nk,sk="Expected a function",ik=Math.max,ok=Math.min;function ak(t,e,n){var r,s,i,o,l,u,c=0,f=!1,p=!1,y=!0;if(typeof t!="function")throw new TypeError(sk);e=dv(e)||0,rk(n)&&(f=!!n.leading,p="maxWait"in n,i=p?ik(dv(n.maxWait)||0,e):i,y="trailing"in n?!!n.trailing:y);function I(C){var x=r,g=s;return r=s=void 0,c=C,o=t.apply(g,x),o}function D(C){return c=C,l=setTimeout(b,e),f?I(C):o}function E(C){var x=C-u,g=C-c,_=e-x;return p?ok(_,i-g):_}function N(C){var x=C-u,g=C-c;return u===void 0||x>=e||x<0||p&&g>=i}function b(){var C=_d();if(N(C))return w(C);l=setTimeout(b,E(C))}function w(C){return l=void 0,y&&r?I(C):(r=s=void 0,o)}function v(){l!==void 0&&clearTimeout(l),c=0,r=u=s=l=void 0}function S(){return l===void 0?o:w(_d())}function P(){var C=_d(),x=N(C);if(r=arguments,s=this,u=C,x){if(l===void 0)return D(u);if(p)return clearTimeout(l),l=setTimeout(b,e),I(u)}return l===void 0&&(l=setTimeout(b,e)),o}return P.cancel=v,P.flush=S,P}var lk=ak;const uk=Bh(lk),rE=V.createContext(),ck=()=>V.useContext(rE),dk=({children:t})=>{const{user:e,isMaster:n}=ze(),{characterDataCollectionRoot:r,GLOBAL_SESSION_PATH:s}=gr(),[i,o]=V.useState([]),[l,u]=V.useState(()=>{try{const E=localStorage.getItem("selectedCharIds");return E?JSON.parse(E):[]}catch{return[]}}),[c,f]=V.useState(!0);V.useEffect(()=>{if(!e)return;(async()=>{const N=await a1(e.uid);N&&N.selectedCharIds&&u(N.selectedCharIds)})()},[e]),V.useEffect(()=>{if(!e||!r){o([]),f(!1);return}o([]),f(!0);const E=new Map,N=(b,w)=>{let v=!1;if(b.docChanges().forEach(S=>{const P=S.doc.data();let C=P.mainAttributes;if(typeof C=="string")try{C=JSON.parse(C)}catch(g){console.error(`Erro ao parsear mainAttributes para o personagem ${S.doc.id}:`,g)}const x={id:S.doc.id,ownerUid:w,...P,mainAttributes:C};S.type==="added"||S.type==="modified"?(E.set(x.id,x),v=!0):S.type==="removed"&&(E.delete(x.id),v=!0)}),v){const S=Array.from(E.values());o(S)}f(!1)};if(n){let b=[];const w=Zt(Ne,`${r}/users`),v=_s(w,S=>{if(b.forEach(P=>P()),b=[],S.empty){E.clear(),o([]),f(!1);return}S.docs.forEach(P=>{const C=P.id,x=Zt(Ne,`${r}/users/${C}/characterSheets`),g=_s(x,_=>N(_,C),_=>{console.error(`Erro ao ouvir fichas do usurio ${C}:`,_),f(!1)});b.push(g)})},S=>{console.error("Erro ao ouvir coleo de usurios:",S),f(!1)});return()=>{v(),b.forEach(S=>S())}}else{const b=Zt(Ne,`${r}/users/${e.uid}/characterSheets`),w=_s(b,v=>N(v,e.uid),v=>{console.error("Erro ao ouvir as prprias fichas:",v),f(!1)});return()=>w()}},[e,n,r]);const p=V.useRef(uk((E,N,b)=>{localStorage.setItem("selectedCharIds",JSON.stringify(b)),N&&l1(N,{selectedCharIds:b})},1e3)).current;V.useEffect(()=>{e&&p(s,e.uid,l)},[l,e,p]);const y=V.useMemo(()=>i.filter(E=>l.includes(E.id)),[i,l]),I=V.useCallback(E=>{u(N=>N.includes(E)?N.filter(b=>b!==E):[...N,E])},[]),D={allCharacters:i,selectedCharIds:l,partyHealthData:y,isLoading:c,toggleCharacterSelection:I};return d.jsx(rE.Provider,{value:D,children:t})},hk=()=>{const{feedItems:t,isLoading:e}=mc(),[n,r]=V.useState(!0),s=c=>!c||typeof c.toDate!="function"?"":c.toDate().toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),i=c=>d.jsxs("div",{className:"p-3 bg-bgElement rounded-md border border-bgInput mb-2",children:[d.jsxs("div",{className:"flex justify-between items-center text-xs text-textSecondary mb-1",children:[d.jsx("span",{className:"font-bold text-base text-textPrimary",children:c.characterName}),d.jsx("span",{children:s(c.timestamp)})]}),c.title&&d.jsx("h4",{className:"font-semibold text-textAccent text-lg mb-1",children:c.title}),d.jsx("p",{className:"text-sm text-textPrimary break-words whitespace-pre-wrap",children:c.description||c.text})]},c.id),o=c=>{const f=c.totalResult,p=c.acertoResult&&c.acertoResult.isCrit||c.criticals&&c.criticals.length>0,y=c.results.map((I,D)=>d.jsxs(Gh.Fragment,{children:[D>0&&" + ",I.value===1&&I.dice==="d20"?d.jsx("span",{className:"text-red-500 font-bold",children:I.displayValue}):I.displayValue]},D));return d.jsxs("div",{className:"p-3 bg-bgElement rounded-md border border-bgInput mb-2",children:[d.jsxs("div",{className:"flex justify-between items-center text-xs text-textSecondary mb-1",children:[d.jsx("span",{className:"font-bold text-base text-textPrimary",children:c.characterName}),d.jsx("span",{children:s(c.timestamp)})]}),d.jsx("p",{className:"font-semibold text-lg text-textPrimary",children:c.rollName}),c.acertoResult&&d.jsxs("div",{className:"mt-2 pt-2 border-t border-bgInput/50",children:[d.jsxs("p",{className:`font-semibold ${p?"text-green-400":"text-textPrimary/90"}`,children:["Acerto:",d.jsx("span",{className:`font-bold text-lg ml-2 ${p?"text-green-400":"text-textAccent"}`,children:c.acertoResult.total}),d.jsxs("span",{className:"text-sm text-textSecondary ml-2",children:["(",c.acertoResult.skillName,")"]})]}),d.jsxs("p",{className:"text-sm text-textSecondary mt-1",children:["1d20(",d.jsx("span",{className:c.acertoResult.isCrit?"text-green-400 font-bold":c.acertoResult.roll===1?"text-red-500 font-bold":"",children:c.acertoResult.roll}),") + ",c.acertoResult.bonus,c.acertoResult.isCrit&&d.jsx("span",{className:"text-green-400 font-bold ml-2",children:" CRTICO!"}),c.acertoResult.roll===1&&d.jsx("span",{className:"text-red-500 font-bold ml-2",children:" FALHA CRTICA!"})]})]}),(y||!c.acertoResult||c.criticals&&c.criticals.length>0)&&d.jsxs("div",{className:"mt-2 pt-2 border-t border-bgInput/50",children:[d.jsxs("p",{className:`font-semibold ${p?"text-green-400":"text-textPrimary/90"}`,children:[c.acertoResult?"Dano/Resultado:":"Resultado:",d.jsx("span",{className:`font-bold text-3xl ml-2 ${p?"text-green-400":"text-textAccent"}`,children:f})]}),y&&d.jsx("p",{className:"text-sm text-textSecondary break-words mt-2",children:y}),c.criticals&&c.criticals.length>0&&d.jsx("p",{className:"text-sm text-green-400 font-semibold whitespace-pre-wrap mt-1",children:c.criticals.filter(I=>!I.startsWith("Acerto Crtico")).join(`
`)})]}),c.discordText&&d.jsxs("p",{className:"text-xs italic text-textSecondary mt-2",children:['"',c.discordText,'"']})]},c.id)},l=c=>{switch(c.type){case"roll":return o(c);case"message":return i(c);default:return null}},u=V.useRef(null);return V.useEffect(()=>{u.current&&(u.current.scrollTop=u.current.scrollHeight)},[t]),n?d.jsx("div",{className:"fixed bottom-4 left-4 bg-btnHighlightBg text-btnHighlightText p-3 rounded-full shadow-lg cursor-pointer hover:opacity-90 z-50",onClick:()=>r(!1),children:d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}):d.jsxs("div",{className:"fixed bottom-4 left-4 w-full max-w-sm h-[60vh] bg-bgSurface/90 backdrop-blur-md rounded-lg shadow-2xl border border-bgElement flex flex-col z-50",children:[d.jsxs("div",{className:"flex justify-between items-center p-3 bg-bgElement cursor-pointer",onClick:()=>r(!0),children:[d.jsx("h3",{className:"font-bold text-textAccent",children:"Feed de Rolagens"}),d.jsx("button",{className:"text-textSecondary hover:text-textPrimary",children:""})]}),d.jsxs("div",{ref:u,className:"flex-grow p-3 overflow-y-auto flex flex-col-reverse",children:[e&&d.jsx("p",{className:"text-textSecondary italic",children:"Carregando feed..."}),!e&&t.length===0&&d.jsx("p",{className:"text-textSecondary italic",children:"Nenhuma rolagem ou mensagem ainda..."}),t.map(l)]}),d.jsx(_k,{})]})},fk=({message:t,onConfirm:e,onCancel:n,type:r,showCopyButton:s,copyText:i})=>{const[o,l]=V.useState(""),u=()=>{navigator.clipboard.writeText(i).then(()=>{l("Copiado!"),setTimeout(()=>l(""),2e3)},()=>{l("Falhou em copiar.")})},c=r==="confirm"?"Confirmar":"OK",f=r==="confirm"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700";return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"text-lg text-textPrimary mb-4 text-center whitespace-pre-wrap",children:t}),s&&d.jsxs("div",{className:"my-4 p-2 bg-bgElement rounded-md text-center",children:[d.jsx("p",{className:"text-textSecondary text-sm mb-1",children:"Comando para Discord/Roll20:"}),d.jsx("code",{className:"text-textAccent break-words",children:i}),d.jsx("button",{onClick:u,className:"ml-4 px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-xs font-bold rounded-md",children:o||"Copiar"})]}),d.jsxs("div",{className:"flex justify-around gap-4 mt-4",children:[d.jsx("button",{onClick:e,className:`px-5 py-2 rounded-lg font-bold shadow-md text-white ${f}`,children:c}),r!=="info"&&d.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},pk=({title:t,onConfirm:e,onClose:n,type:r})=>{const[s,i]=V.useState(""),[o,l]=V.useState("HP"),u=()=>{const f=parseInt(s,10);!isNaN(f)&&f>0?e(f,o):console.error("Valor invlido.")},c=f=>{f.key==="Enter"&&u()};return d.jsxs(d.Fragment,{children:[d.jsx("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center",children:t}),d.jsx("input",{type:"number",value:s,onChange:f=>i(f.target.value),onKeyDown:c,className:"w-full p-2 mb-4 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg focus:ring-btnHighlightBg focus:border-btnHighlightBg",placeholder:"Valor",autoFocus:!0}),d.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[d.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[d.jsx("input",{type:"radio",name:"target",value:"HP",checked:o==="HP",onChange:()=>l("HP"),className:"form-radio text-btnHighlightBg"})," HP"]}),r==="heal"&&d.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[d.jsx("input",{type:"radio",name:"target",value:"HP Bonus",checked:o==="HP Bonus",onChange:()=>l("HP Bonus"),className:"form-radio text-btnHighlightBg"})," HP Bonus"]}),d.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[d.jsx("input",{type:"radio",name:"target",value:"MP",checked:o==="MP",onChange:()=>l("MP"),className:"form-radio text-btnHighlightBg"})," MP"]})]}),d.jsxs("div",{className:"flex justify-around gap-4",children:[d.jsx("button",{onClick:u,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Confirmar"}),d.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},mk=({attributeName:t,onConfirm:e,onClose:n})=>{const[r,s]=V.useState("1d20"),[i,o]=V.useState(""),l=()=>e(r,parseInt(i,10)||0),u=c=>{c.key==="Enter"&&l()};return d.jsxs(d.Fragment,{children:[d.jsxs("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center",children:["Rolar ",t]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{htmlFor:"dice-input",className:"block text-sm font-medium text-textSecondary mb-1",children:"Dado:"}),d.jsx("input",{id:"dice-input",type:"text",value:r,onChange:c=>s(c.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"Ex: 1d20, 2d6",autoFocus:!0})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("label",{htmlFor:"bonus-input",className:"block text-sm font-medium text-textSecondary mb-1",children:"Bnus Adicional:"}),d.jsx("input",{id:"bonus-input",type:"number",value:i,onChange:c=>o(c.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"0"})]}),d.jsxs("div",{className:"flex justify-around gap-4",children:[d.jsx("button",{onClick:l,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Confirmar"}),d.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},gk=({attributeName:t,onConfirm:e,onClose:n})=>{const[r,s]=V.useState(""),[i,o]=V.useState("damage"),[l,u]=V.useState(!1),c=()=>{const y=parseInt(r,10);!isNaN(y)&&y>0&&(e(y,t,i,l),n())},f=y=>{y.key==="Enter"&&c()},p=i==="heal"?`Curar ${t}`:`Causar Dano em ${t}`;return d.jsxs(d.Fragment,{children:[d.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-4 text-center",children:p}),d.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[d.jsx("button",{onClick:()=>o("damage"),className:`px-4 py-2 rounded-lg font-semibold ${i==="damage"?"bg-red-600 text-white":"bg-bgElement text-textSecondary"}`,children:" Dano"}),d.jsx("button",{onClick:()=>o("heal"),className:`px-4 py-2 rounded-lg font-semibold ${i==="heal"?"bg-green-600 text-white":"bg-bgElement text-textSecondary"}`,children:" Cura"})]}),d.jsx("input",{type:"number",value:r,onChange:y=>s(y.target.value),onKeyDown:f,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-2xl mb-4",placeholder:"Valor",autoFocus:!0}),i==="damage"&&t==="HP"&&d.jsxs("div",{className:"flex items-center justify-center mb-4",children:[d.jsx("input",{type:"checkbox",id:"directDamage",checked:l,onChange:y=>u(y.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),d.jsx("label",{htmlFor:"directDamage",className:"ml-2 block text-sm text-textSecondary",children:"Dano Direto (ignora HP Bnus)"})]}),d.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[d.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg",children:"Cancelar"}),d.jsx("button",{onClick:c,className:"px-4 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",disabled:!r,children:"Confirmar"})]})]})},gc=({modalState:t,closeModal:e})=>{if(!t.type)return null;const n=()=>{const{type:r,props:s}=t;switch(r){case"info":case"confirm":return d.jsx(fk,{...s});case"action":return d.jsx(pk,{...s});case"rollAttribute":return d.jsx(mk,{...s});case"damageHeal":return d.jsx(gk,{...s});default:return null}};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",onClick:e,children:d.jsx("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-sm border border-bgElement",onClick:r=>r.stopPropagation(),children:n()})})},xd={name:"Novo Tema",ownerUid:"",isPublic:!1,styles:{backgroundImage:"url('')",fontFamily:"'Roboto', sans-serif",surfaceOpacity:80,colors:{bgPage:"#111827",bgSurface:"#1f2937",bgElement:"#374151",bgInput:"#4b5563",textPrimary:"#f9fafb",textSecondary:"#9ca3af",borderAccent:"#f59e0b",textAccent:"#fcd34d",btnHighlightBg:"#8b5cf6",btnHighlightText:"#ffffff"}}},yk=["'Roboto', sans-serif","'Merriweather', serif","'Lato', sans-serif","'Noto Sans', sans-serif","'Slabo 27px', serif"],vk=({character:t,setPreviewTheme:e,onClose:n})=>{const{user:r}=ze(),{characterDataCollectionRoot:s}=gr(),[i,o]=V.useState([]),[l,u]=V.useState(xd),[c,f]=V.useState({type:null,props:{}}),p=()=>f({type:null,props:{}});V.useEffect(()=>{r&&(vd(r.uid).then(o),u(v=>({...xd,ownerUid:r.uid})))},[r]),V.useEffect(()=>{e(l)},[l,e]);const y=v=>{if(v==="new")u({...xd,ownerUid:r.uid});else{const S=i.find(P=>P.id===v);S&&u(S)}},I=(v,S)=>u(P=>({...P,styles:{...P.styles,[v]:S}})),D=(v,S)=>u(P=>({...P,styles:{...P.styles,colors:{...P.styles.colors,[v]:S}}})),E=v=>u(S=>({...S,name:v.target.value})),N=async()=>{const v={...l,ownerUid:r.uid};try{const S=await iv(v);if(S){f({type:"info",props:{message:"Tema salvo com sucesso!",onConfirm:p}});const P=await vd(r.uid);o(P);const C=P.find(x=>x.id===(v.id||S));C&&u(C)}else throw new Error("Ocorreu um erro desconhecido ao salvar.")}catch(S){console.error("Falha ao salvar o tema:",S),f({type:"info",props:{message:"Falha ao salvar o tema.",onConfirm:p}})}},b=()=>{if(!l.id){f({type:"info",props:{message:"No pode apagar um tema que ainda no foi salvo.",onConfirm:p}});return}f({type:"confirm",props:{message:`Tem a certeza que quer apagar o tema "${l.name}"?`,onConfirm:async()=>{await o1(l.id),p(),vd(r.uid).then(o),y("new")},onCancel:p}})},w=async()=>{if(!t||!l.id){f({type:"info",props:{message:"Precisa ter uma ficha selecionada e um tema salvo para aplicar.",onConfirm:p}});return}await iv(l),await u1(t.ownerUid,t.id,l.id,s),f({type:"info",props:{message:`Tema "${l.name}" aplicado!`,onConfirm:()=>{p(),n()}}})};return d.jsxs(d.Fragment,{children:[d.jsx(gc,{modalState:c,closeModal:p}),d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-3xl border border-bgElement max-h-[90vh] flex flex-col",children:[d.jsx("h2",{className:"text-2xl font-bold text-textAccent mb-4",children:"Editor de Temas"}),d.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Tema a Editar"}),d.jsxs("select",{onChange:v=>y(v.target.value),value:l.id||"new",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",children:[d.jsx("option",{value:"new",children:"-- Criar Novo Tema --"}),i.map(v=>d.jsx("option",{value:v.id,children:v.name},v.id))]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Nome do Tema"}),d.jsx("input",{type:"text",value:l.name,onChange:E,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"URL da Imagem de Fundo"}),d.jsx("input",{type:"text",value:l.styles.backgroundImage.replace(/url\(['"]?(.*?)['"]?\)/,"$1"),onChange:v=>I("backgroundImage",`url('${v.target.value}')`),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Fonte Principal"}),d.jsx("select",{value:l.styles.fontFamily,onChange:v=>I("fontFamily",v.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",children:yk.map(v=>d.jsx("option",{value:v,children:v.split(",")[0].replace(/'/g,"")},v))})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:["Transparncia dos Mdulos (",l.styles.surfaceOpacity||80,"%)"]}),d.jsx("input",{type:"range",min:"10",max:"100",step:"5",value:l.styles.surfaceOpacity||80,onChange:v=>I("surfaceOpacity",parseInt(v.target.value)),className:"w-full h-2 bg-bgElement rounded-lg appearance-none cursor-pointer mt-2"})]})]}),d.jsx("h3",{className:"text-lg font-semibold text-textAccent mt-6 mb-2",children:"Cores"}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Object.entries(l.styles.colors).map(([v,S])=>d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-textSecondary capitalize",children:v.replace(/([A-Z])/g," $1")}),d.jsxs("div",{className:"flex items-center gap-2 p-1 bg-bgInput border border-bgElement rounded-md",children:[d.jsx("input",{type:"color",value:S,onChange:P=>D(v,P.target.value),className:"w-8 h-8 rounded border-none bg-transparent cursor-pointer"}),d.jsx("input",{type:"text",value:S,onChange:P=>D(v,P.target.value),className:"w-full bg-transparent text-textPrimary text-sm"})]})]},v))})]}),d.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-6 pt-4 border-t border-bgElement",children:[d.jsxs("div",{children:[d.jsx("button",{onClick:N,className:"px-4 py-2 bg-green-600 text-white font-bold rounded-lg mr-2",children:"Salvar"}),d.jsx("button",{onClick:b,className:"px-4 py-2 bg-red-600 text-white font-bold rounded-lg",children:"Apagar"})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{onClick:w,disabled:!t||!l.id,className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg disabled:opacity-50",children:"Aplicar"}),d.jsx("button",{onClick:n,className:"px-4 py-2 bg-textSecondary/50 text-textPrimary font-bold rounded-lg",children:"Fechar"})]})]})]})})]})},_k=()=>{const[t,e]=V.useState(""),{addMessageToFeed:n}=mc(),{user:r}=ze(),{activeCharacter:s}=gr(),i=o=>{o.preventDefault(),t.trim()!==""&&(n({characterName:(s==null?void 0:s.name)||r.displayName||"Usurio",text:t,ownerUid:r.uid}),e(""))};return d.jsx("form",{onSubmit:i,className:"p-3 border-t border-bgElement",children:d.jsxs("div",{className:"flex items-center bg-bgInput rounded-md",children:[d.jsx("input",{type:"text",value:t,onChange:o=>e(o.target.value),placeholder:"Digite uma mensagem...",className:"w-full bg-transparent p-2 text-textPrimary placeholder-textSecondary focus:outline-none"}),d.jsx("button",{type:"submit",className:"p-2 text-textAccent hover:opacity-80 disabled:opacity-50",disabled:!t.trim(),children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",clipRule:"evenodd"})})})]})})},sE=({onCharacterClick:t})=>{const{isMaster:e}=ze(),{allCharacters:n,selectedCharIds:r,partyHealthData:s,toggleCharacterSelection:i}=ck(),[o,l]=V.useState(!1),[u,c]=V.useState(!1),f=y=>{t&&t(y)},p=y=>{var E,N;const I=((E=y.mainAttributes)==null?void 0:E.hp)||{current:"?",max:"?",temp:0},D=((N=y.mainAttributes)==null?void 0:N.mp)||{current:"?",max:"?"};return d.jsxs("div",{className:"p-2 bg-bgElement rounded-md border border-bgInput cursor-pointer hover:border-btnHighlightBg",onClick:()=>f(y),title:`Clique para ir para a ficha de ${y.name}`,children:[d.jsx("p",{className:"font-bold text-textPrimary truncate",children:y.name}),d.jsxs("div",{className:"text-sm flex justify-between",children:[d.jsxs("span",{className:"text-red-400",children:["HP: ",I.current,"/",I.max," ",I.temp>0?`(+${I.temp})`:""]}),d.jsxs("span",{className:"text-blue-400",children:["MP: ",D.current,"/",D.max]})]})]},y.id)};return o?d.jsx("div",{className:"fixed top-4 left-4 bg-btnHighlightBg text-btnHighlightText p-3 rounded-full shadow-lg cursor-pointer hover:opacity-90 z-50",onClick:()=>l(!1),title:"Expandir Monitor de Grupo",children:d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-5M3 4h5V9"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 16l-4-4M3 8l4 4"})]})}):d.jsxs("div",{className:"fixed top-4 left-4 w-full max-w-xs bg-bgSurface/90 backdrop-blur-md rounded-lg shadow-2xl border border-bgElement flex flex-col z-50",children:[d.jsxs("div",{className:"flex justify-between items-center p-3 bg-bgElement cursor-pointer",onClick:()=>l(!0),children:[d.jsx("h3",{className:"font-bold text-textAccent",children:"Monitor de Grupo"}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{className:"text-textSecondary hover:text-textPrimary mr-2",onClick:y=>{y.stopPropagation(),c(!u)},title:"Selecionar Personagens",children:""}),d.jsx("button",{className:"text-textSecondary hover:text-textPrimary",title:"Recolher",children:""})]})]}),u&&d.jsxs("div",{className:"p-3 border-b border-bgElement max-h-48 overflow-y-auto",children:[d.jsx("h4",{className:"text-sm font-semibold text-textSecondary mb-2",children:"Selecionar Personagens"}),n.length>0?n.map(y=>d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:`char-select-${y.id}`,checked:r.includes(y.id),onChange:()=>i(y.id),className:"form-checkbox h-4 w-4 text-btnHighlightBg bg-bgInput border-bgElement rounded"}),d.jsx("label",{htmlFor:`char-select-${y.id}`,className:"ml-2 text-textPrimary text-sm truncate",children:y.name})]},y.id)):d.jsx("p",{className:"text-xs text-textSecondary italic",children:"Nenhuma ficha encontrada."})]}),d.jsx("div",{className:"flex-grow p-3 overflow-y-auto space-y-2 max-h-[60vh]",children:s.length>0?s.map(p):d.jsx("p",{className:"text-textSecondary italic text-sm text-center py-4",children:"Nenhum personagem selecionado. Clique na engrenagem  para selecionar."})})]})},xk=[2,3,4,6,8,10,12,20,50,100],wk=({character:t})=>{const[e,n]=V.useState(!1),{addRollToFeed:r}=mc(),s=V.useCallback(async(o,l)=>{const u=`${o}
${l}`;if(t&&t.discordWebhookUrl){try{await fetch(t.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[{title:o,description:l.replace(/\*/g,""),color:7506394}]})})}catch(c){return console.error("Failed to send to Discord:",c),null}return u}else return alert(`Webhook do Discord no configurado. Copie o comando:

${u}`),null},[t,r]),i=async o=>{const l=Math.floor(Math.random()*o)+1;n(!1);const u=await s(`Rolagem de d${o}`,`**Resultado: ${l}**`);r({characterName:(t==null?void 0:t.name)||"Narrador",rollName:`Rolagem Rpida de d${o}`,results:[{value:l,displayValue:`d${o} (${l})`}],discordText:u})};return d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:()=>n(!e),title:"Rolagem Rpida",className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600",children:""}),e&&d.jsx("div",{className:"absolute bottom-12 right-0 bg-gray-900 bg-opacity-90 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700 w-40",children:d.jsx("div",{className:"grid grid-cols-2 gap-2",children:xk.map(o=>d.jsxs("button",{onClick:()=>i(o),className:"bg-gray-700 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:["d",o]},o))})})]})},Ek=({href:t,title:e,children:n})=>d.jsx("a",{href:t,title:e,className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600",children:n}),bk=({character:t})=>{const e=[{href:"#info",title:"Informaes",icon:""},{href:"#main-attributes",title:"Atributos Principais",icon:""},{href:"#actions",title:"Aes",icon:""},{href:"#buffs",title:"Buffs",icon:""},{href:"#wallet",title:"Carteira",icon:""},{href:"#inventory",title:"Inventrio",icon:""},{href:"#equipped",title:"Equipados",icon:""},{href:"#perks",title:"Vantagens",icon:""},{href:"#skills",title:"Habilidades",icon:""},{href:"#specializations",title:"Especializaes",icon:""},{href:"#story",title:"Histria",icon:""},{href:"#notes",title:"Anotaes",icon:""},{href:"#discord",title:"Discord",icon:""}];return d.jsx("div",{className:"fixed bottom-4 right-4 z-40 bg-gray-900 bg-opacity-80 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700",children:d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.map(n=>d.jsx(Ek,{href:n.href,title:n.title,children:n.icon},n.href)),d.jsx(wk,{character:t})]})})},Sk=({initialValue:t,onConfirm:e,onCancel:n})=>{const[r,s]=V.useState(t),i=()=>{e(r)};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50",children:d.jsxs("div",{className:"bg-bgSurface p-6 rounded-lg shadow-xl w-full max-w-md",children:[d.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-4",children:"URL da Imagem do Personagem"}),d.jsx("p",{className:"text-textSecondary mb-4",children:"Cole a nova URL da imagem abaixo:"}),d.jsx("input",{type:"text",value:r,onChange:o=>s(o.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary focus:ring-btnHighlightBg focus:border-btnHighlightBg",placeholder:"https://exemplo.com/imagem.png",autoFocus:!0}),d.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[d.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg",children:"Cancelar"}),d.jsx("button",{onClick:i,className:"px-4 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Confirmar"})]})]})})},Tk=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=ze(),l=o&&(o.uid===t.ownerUid||n),[u,c]=V.useState(!1),[f,p]=V.useState({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""});V.useEffect(()=>{p({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""})},[t]);const y=S=>(S=parseInt(S,10),isNaN(S)||S<1?{scale:"N/A",category:"Desconhecida"}:S>=1&&S<=10?{scale:0,category:"Comum"}:S>=11&&S<=20?{scale:1,category:"Lendrio I"}:S>=21&&S<=30?{scale:2,category:"Lendrio II"}:S>=31&&S<=40?{scale:3,category:"Lendrio III"}:S>=41&&S<=45?{scale:4,category:"Colossal I"}:S>=46&&S<=50?{scale:5,category:"Colossal II"}:S>=51&&S<=55?{scale:6,category:"Colossal III"}:S>=56&&S<=59?{scale:7,category:"Titnico"}:S===60?{scale:8,category:"Divino"}:{scale:"N/A",category:"Alm do Divino"}),{scale:I,category:D}=V.useMemo(()=>y(t.level),[t.level]),E=S=>{const{name:P,value:C}=S.target;p(x=>({...x,[P]:C}))},N=V.useCallback(S=>{const P=f[S],C=t[S],g=["age","level","xp"].includes(S)?parseInt(P,10)||0:P;g!==C&&e(S,g)},[f,t,e]),b=()=>{l&&i&&c(!0)},w=S=>{S!==null&&S!==t.photoUrl&&e("photoUrl",S),c(!1)},v=["name","age","height","gender","race","class","alignment","level","xp"];return d.jsxs($t,{title:"Informaes do Personagem",isCollapsed:r,toggleSection:s,children:[u&&d.jsx(Sk,{initialValue:t.photoUrl||"",onConfirm:w,onCancel:()=>c(!1)}),d.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[d.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center",children:[d.jsx("div",{className:`rounded-full border-2 border-btnHighlightBg ${l&&i?"cursor-pointer":""}`,onClick:b,children:t.photoUrl?d.jsx("img",{src:t.photoUrl,alt:"Foto",className:"w-48 h-48 object-cover rounded-full",onError:S=>{S.target.onerror=null,S.target.src="https://placehold.co/192x192/1f2937/FFFFFF?text=Erro"}}):d.jsx("div",{className:"w-48 h-48 bg-bgElement rounded-full flex items-center justify-center text-6xl text-textSecondary",children:"+"})}),d.jsxs("div",{className:"text-center mt-2",children:[d.jsx("p",{className:"text-sm font-medium text-textSecondary",children:"Escala de Poder:"}),d.jsx("p",{className:"text-lg font-bold text-textPrimary",children:D})]})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 flex-grow w-full",children:v.map(S=>d.jsxs("div",{children:[d.jsxs("label",{htmlFor:S,className:"block text-sm font-medium text-textSecondary mb-1 capitalize",children:[S,":"]}),d.jsx("input",{type:["age","level","xp"].includes(S)?"number":"text",id:S,name:S,value:f[S],onChange:E,onBlur:()=>N(S),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary focus:ring-btnHighlightBg focus:border-btnHighlightBg",disabled:!l||!i&&["race","class","alignment"].includes(S)})]},S))})]})]})},Ik=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,buffModifiers:i,isEditMode:o,onAttributeRoll:l,onMapUpdate:u})=>{var S,P,C,x,g;const{user:c}=ze();c&&(c.uid,t.ownerUid);const f=c&&(c.uid===t.ownerUid||n),[p,y]=V.useState(t.mainAttributes||{hp:{},mp:{}});V.useEffect(()=>{y(t.mainAttributes||{hp:{},mp:{}})},[t.mainAttributes]);const I=(_,A)=>(parseInt(_,10)||0)+(i&&i[A]||0),D=V.useMemo(()=>I(p==null?void 0:p.destreza,"Destreza"),[p==null?void 0:p.destreza,i]),E=V.useMemo(()=>I(p==null?void 0:p.constituicao,"Constituio"),[p==null?void 0:p.constituicao,i]),N=V.useMemo(()=>I(p==null?void 0:p.sabedoria,"Sabedoria"),[p==null?void 0:p.sabedoria,i]),b=V.useMemo(()=>({FOR:I(p==null?void 0:p.forca,"Fora"),DES:D,CON:E,INT:I(p==null?void 0:p.inteligencia,"Inteligencia"),SAB:N,CAR:I(p==null?void 0:p.carisma,"Carisma")}),[p,D,E,N,i]);V.useEffect(()=>{u&&u(b)},[b,u]),parseInt(p==null?void 0:p.fd,10);const w=(_,A)=>{const{name:k,value:j}=_.target,R=j===""?"":parseInt(j,10);y(H=>A==="fd"?{...H,fd:R}:A?{...H,[A]:{...H[A]||{},[k]:R}}:{...H,[k]:R})},v=V.useCallback((_,A)=>{var j;if(!t)return;const k=t.mainAttributes||{};if(A){const R=(j=p==null?void 0:p[A])==null?void 0:j[_],H=k[A]||{},ne=H[_],re=R===""?0:parseInt(R,10)||0;if(re!==(ne||0)){const oe={...H,[_]:re},F={...k,[A]:oe};e("mainAttributes",F)}}else{const R=p==null?void 0:p[_],H=k[_],ne=parseInt(R,10)||0;if(ne!==(H||0)){const re={...k,[_]:ne};e("mainAttributes",re)}}},[p,t,e]);return d.jsx($t,{title:"Atributos",isCollapsed:r,toggleSection:s,children:d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[d.jsx("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase",children:"HP"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("input",{type:"number",readOnly:!0,name:"current",value:((S=p.hp)==null?void 0:S.current)??"",className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var _;return l("HP",(_=p.hp)==null?void 0:_.current)},title:"Aplicar Dano/Cura no HP"}),d.jsx("span",{className:"text-textSecondary",children:"/"}),d.jsx("input",{type:"number",name:"max",value:((P=p.hp)==null?void 0:P.max)??"",onChange:_=>w(_,"hp"),onBlur:()=>v("max","hp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),d.jsx("span",{className:"text-blue-400 font-bold text-xl ml-1",children:"+"}),d.jsx("input",{type:"number",readOnly:!0,title:"HP Temporrio",name:"temp",value:((C=p.hp)==null?void 0:C.temp)??"",className:"w-16 p-2 text-center bg-bgInput border border-blue-400 rounded-md text-blue-300 text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var _;return l("HP Bonus",(_=p.hp)==null?void 0:_.temp)}})]})]}),d.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[d.jsx("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase",children:"MP"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"number",readOnly:!0,name:"current",value:((x=p.mp)==null?void 0:x.current)??"",className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var _;return l("MP",(_=p.mp)==null?void 0:_.current)},title:"Aplicar Dano/Cura no MP"}),d.jsx("span",{className:"text-textSecondary",children:"/"}),d.jsx("input",{type:"number",name:"max",value:((g=p.mp)==null?void 0:g.max)??"",onChange:_=>w(_,"mp"),onBlur:()=>v("max","mp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n})]})]})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:["Fora","Destreza","Constituio","Inteligencia","Sabedoria","Carisma"].map(_=>{const A=_.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),k=(p==null?void 0:p[A])??"",j=I(k,_);return d.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[d.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(_,j),title:`Clique para rolar ${_} (Valor: ${j})`,children:j}),d.jsx("input",{type:"number",id:_,name:A,value:k,onChange:w,onBlur:()=>v(A),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!f,"aria-label":`${_} Base`}),d.jsx("label",{htmlFor:_,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:_})]},_)})}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 auto-rows-fr",children:[["Iniciativa","FA","FM","MD","Acerto","ME"].map(_=>{const A=_.toLowerCase();let k,j;return _==="Iniciativa"?(k=(p==null?void 0:p[A])??"",j=(parseInt(k,10)||0)+D+(i.Iniciativa||0)):_==="MD"?(k=(p==null?void 0:p.fd)??"",j=(parseInt(k,10)||0)+E+(i.MD||0)):(k=(p==null?void 0:p[A])??"",j=I((p==null?void 0:p[A])||0,_.toUpperCase())),d.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[d.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(_,j),title:`Clique para rolar ${_} (Valor: ${j})`,children:j}),d.jsx("input",{type:"number",id:_,name:A,value:k,onChange:R=>w(R,_==="MD"?"fd":void 0),onBlur:()=>v(_==="MD"?"fd":A),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!f,"aria-label":`${_} Base`}),d.jsx("label",{htmlFor:_,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:_})]},_)}),[{key:"Fortitude",defaultAttr:"CON"},{key:"Reflexo",defaultAttr:"DES"},{key:"Vontade",defaultAttr:"SAB"}].map(({key:_,defaultAttr:A})=>{const k=_.toLowerCase(),j=`${k}Attr`,R=t[j]||A,H=b[R]||0,ne=(p==null?void 0:p[k])??"",re=(parseInt(ne,10)||0)+H+(i[_]||0),oe=F=>{e(j,F)};return d.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md col-span-2 justify-between",children:[d.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(_,re),title:`Clique para rolar ${_} (Valor: ${re})`,children:re}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"number",id:_,name:k,value:ne,onChange:w,onBlur:()=>v(k),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!f||!o,"aria-label":`${_} Base`}),o?d.jsx("select",{value:R,onChange:F=>oe(F.target.value),className:"bg-bgInput text-textPrimary text-sm font-bold rounded-md p-1 border-none focus:ring-2 focus:ring-btnHighlightBg",disabled:!f,children:Object.keys(b).map(F=>d.jsx("option",{value:F,children:F},F))}):d.jsxs("span",{className:"font-semibold text-textSecondary text-sm ml-1",children:["(",R,")"]})]}),d.jsx("label",{htmlFor:_,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:_})]},_)})]})]})})},Ck=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{var w,v;const{user:o}=ze(),[l,u]=V.useState(0),c=((w=t.wallet)==null?void 0:w.zeni)||0,f=((v=t.wallet)==null?void 0:v.inspiration)||0,p=o&&(o.uid===t.ownerUid||e),y=(S,P)=>{const C={...t.wallet,[S]:Math.max(0,P)};n("wallet",C)},I=()=>{y("zeni",c+l),u(0)},D=()=>{y("zeni",c-l),u(0)},E=()=>y("inspiration",f+1),N=()=>y("inspiration",f-1),b=d.jsxs("div",{className:"flex justify-between items-center w-full",children:[d.jsxs("span",{children:["Zeni: ",c]}),d.jsxs("span",{className:"text-textPrimary text-base",children:["Inspirao: ",f]})]});return d.jsx($t,{title:b,isCollapsed:r,toggleSection:s,isComplexTitle:!0,children:d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"hidden sm:inline font-semibold text-textSecondary",children:"Zeni:"}),d.jsx("input",{type:"number",value:l===0?"":l,onChange:S=>u(parseInt(S.target.value,10)||0),className:"w-24 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-lg",placeholder:"Valor",disabled:!p}),d.jsx("button",{onClick:I,className:"px-3 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg text-sm",disabled:!p,children:"+"}),d.jsx("button",{onClick:D,className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm",disabled:!p,children:"-"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"hidden sm:inline font-semibold text-textSecondary",children:"Inspirao:"}),d.jsx("button",{onClick:E,className:"px-3 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg text-sm",disabled:!p,children:"+1"}),d.jsx("button",{onClick:N,className:"px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-lg text-sm",disabled:!p,children:"-1"})]})]})})},Ak=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=ze(),l=o&&(o.uid===t.ownerUid||n),[u,c]=V.useState(t.discordWebhookUrl||"");V.useEffect(()=>{c(t.discordWebhookUrl||"")},[t.discordWebhookUrl]);const f=y=>{c(y.target.value)},p=V.useCallback(()=>{u!==t.discordWebhookUrl&&e("discordWebhookUrl",u)},[u,t.discordWebhookUrl,e]);return d.jsx($t,{title:"Integrao com Discord",isCollapsed:r,toggleSection:s,children:d.jsxs("div",{children:[d.jsx("label",{htmlFor:"discordWebhookUrl",className:"block text-sm font-medium text-textSecondary mb-1",children:"URL do Webhook do Canal:"}),d.jsx("input",{type:"text",id:"discordWebhookUrl",name:"discordWebhookUrl",value:u,onChange:f,onBlur:p,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md focus:ring-btnHighlightBg focus:border-btnHighlightBg text-textPrimary",placeholder:"Cole a URL do Webhook do seu canal do Discord aqui",disabled:!l||!i}),d.jsx("p",{className:"text-xs text-textSecondary mt-2",children:"Com a URL do Webhook configurada, os comandos de rolagem sero enviados diretamente para o seu canal do Discord."})]})})},pa=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i,name:o})=>{const l=V.useRef(null);return V.useEffect(()=>{l.current&&(l.current.style.height="auto",l.current.style.height=`${l.current.scrollHeight}px`)},[t]),d.jsx("textarea",{ref:l,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i,name:o})},Pk=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,onShowDiscord:i})=>{const{user:o}=ze(),l=o.uid===t.ownerUid||n,[u,c]=V.useState(t.inventory||[]);V.useEffect(()=>{c(t.inventory||[])},[t.inventory]);const f=()=>e("inventory",[...t.inventory||[],{id:crypto.randomUUID(),name:"",description:"",isCollapsed:!1}]),p=E=>e("inventory",(t.inventory||[]).filter(N=>N.id!==E)),y=(E,N,b)=>{c(w=>w.map(v=>v.id===E?{...v,[N]:b}:v))},I=V.useCallback((E,N)=>{const b=u.find(v=>v.id===E),w=(t.inventory||[]).find(v=>v.id===E);b&&w&&b[N]!==w[N]&&e("inventory",(t.inventory||[]).map(v=>v.id===E?{...v,[N]:b[N]}:v))},[u,t.inventory,e]),D=E=>{u.find(b=>b.id===E)&&e("inventory",(t.inventory||[]).map(b=>b.id===E?{...b,isCollapsed:!b.isCollapsed}:b))};return d.jsxs($t,{title:"Inventrio",isCollapsed:r,toggleSection:s,children:[d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(E=>E.isCollapsed!==!1?d.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[d.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>D(E.id),children:E.name||"Item Sem Nome"}),d.jsx("button",{onClick:()=>i(E.name,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},E.id):d.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>D(E.id),children:E.name||"Item Sem Nome"}),d.jsx("button",{onClick:()=>i(E.name,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-4",children:"Mostrar no Feed"})]}),d.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer self-end",onClick:()=>D(E.id),children:"Recolher "}),d.jsx("input",{type:"text",value:E.name,onChange:b=>y(E.id,"name",b.target.value),onBlur:()=>I(E.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome do Item",disabled:!l}),d.jsx(pa,{name:"description",value:E.description,onChange:b=>y(E.id,"description",b.target.value),onBlur:()=>I(E.id,"description"),placeholder:"Descrio do item",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l}),l&&d.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:d.jsx("button",{onClick:()=>p(E.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Item",children:d.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},E.id))}),(u||[]).length===0&&d.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhum item no inventrio."}),l&&d.jsx("div",{className:"flex justify-center mt-4",children:d.jsx("button",{onClick:f,className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})},Rk=({character:t,isMaster:e,onUpdate:n,onShowDiscord:r,isCollapsed:s,toggleSection:i})=>{const{user:o}=ze(),l=o.uid===t.ownerUid||e,[u,c]=V.useState(t.equippedItems||[]);V.useEffect(()=>{c(t.equippedItems||[])},[t.equippedItems]);const f=()=>n("equippedItems",[...t.equippedItems||[],{id:crypto.randomUUID(),name:"",description:"",attributes:"",isCollapsed:!1}]),p=E=>n("equippedItems",(t.equippedItems||[]).filter(N=>N.id!==E)),y=(E,N,b)=>{c(w=>w.map(v=>v.id===E?{...v,[N]:b}:v))},I=V.useCallback((E,N)=>{const b=u.find(v=>v.id===E),w=(t.equippedItems||[]).find(v=>v.id===E);b&&w&&b[N]!==w[N]&&n("equippedItems",(t.equippedItems||[]).map(v=>v.id===E?{...v,[N]:b[N]}:v))},[u,t.equippedItems,n]),D=E=>n("equippedItems",(t.equippedItems||[]).map(N=>N.id===E?{...N,isCollapsed:!N.isCollapsed}:N));return d.jsxs($t,{title:"Itens Equipados",isCollapsed:s,toggleSection:i,children:[d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(E=>E.isCollapsed!==!1?d.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[d.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>D(E.id),children:E.name||"Item Sem Nome"}),d.jsx("button",{onClick:()=>r(E.name,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},E.id):d.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>D(E.id),children:E.name||"Item Sem Nome"}),d.jsx("button",{onClick:()=>r(E.name,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-4",children:"Mostrar no Feed"})]}),d.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer self-end",onClick:()=>D(E.id),children:"Recolher "}),d.jsx("input",{type:"text",value:E.name,onChange:b=>y(E.id,"name",b.target.value),onBlur:()=>I(E.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome",disabled:!l}),d.jsx(pa,{value:E.description,onChange:b=>y(E.id,"description",b.target.value),onBlur:()=>I(E.id,"description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md mb-2",disabled:!l}),d.jsx(pa,{value:E.attributes,onChange:b=>y(E.id,"attributes",b.target.value),onBlur:()=>I(E.id,"attributes"),placeholder:"Atributos/Efeitos",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-sm text-textPrimary",disabled:!l}),l&&d.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:d.jsx("button",{onClick:()=>p(E.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Item",children:d.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},E.id))}),(u||[]).length===0&&d.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhum item equipado."}),l&&d.jsx("div",{className:"flex justify-center mt-4",children:d.jsx("button",{onClick:f,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})},Nk=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,onShowDiscord:i})=>{const{user:o}=ze(),l=o.uid===t.ownerUid||e,[u,c]=V.useState(t.abilities||[]);V.useEffect(()=>{c(t.abilities||[])},[t.abilities]);const f=()=>n("abilities",[...t.abilities||[],{id:crypto.randomUUID(),title:"",description:"",isCollapsed:!1}]),p=E=>n("abilities",(t.abilities||[]).filter(N=>N.id!==E)),y=(E,N,b)=>{c(w=>w.map(v=>v.id===E?{...v,[N]:b}:v))},I=V.useCallback((E,N)=>{const b=u.find(v=>v.id===E),w=(t.abilities||[]).find(v=>v.id===E);b&&w&&b[N]!==w[N]&&n("abilities",(t.abilities||[]).map(v=>v.id===E?{...v,[N]:b[N]}:v))},[u,t.abilities,n]),D=E=>n("abilities",(t.abilities||[]).map(N=>N.id===E?{...N,isCollapsed:!N.isCollapsed}:N));return d.jsxs($t,{title:"Habilidades",isCollapsed:r,toggleSection:s,children:[d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(E=>E.isCollapsed!==!1?d.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[d.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>D(E.id),children:E.title||"Habilidade Sem Ttulo"}),d.jsx("button",{onClick:()=>i(E.title,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},E.id):d.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>D(E.id),children:E.title||"Habilidade Sem Ttulo"}),d.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[d.jsx("button",{onClick:()=>i(E.title,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap",children:"Mostrar no Feed"}),d.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>D(E.id),children:"Recolher "})]})]}),d.jsx("input",{type:"text",value:E.title,onChange:b=>y(E.id,"title",b.target.value),onBlur:()=>I(E.id,"title"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Ttulo",disabled:!l}),d.jsx(pa,{value:E.description,onChange:b=>y(E.id,"description",b.target.value),onBlur:()=>I(E.id,"description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l}),l&&d.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:d.jsx("button",{onClick:()=>p(E.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Habilidade",children:d.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},E.id))}),(u||[]).length===0&&d.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhuma habilidade adicionada."}),l&&d.jsx("div",{className:"flex justify-center mt-4",children:d.jsx("button",{onClick:f,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})},kk=({character:t,onUpdate:e,isCollapsed:n,toggleSection:r,onShowDiscord:s})=>{const o=p=>e(p,[...t[p]||[],{id:crypto.randomUUID(),name:"",description:"",origin:{class:!1,race:!1,manual:!0},value:0,isCollapsed:!1}]),l=(p,y)=>e(p,(t[p]||[]).filter(I=>I.id!==y)),u=(p,y,I)=>e(p,(t[p]||[]).map(D=>D.id===y?{...D,origin:{...D.origin,[I]:!D.origin[I]}}:D)),c=(p,y,I,D)=>e(p,(t[p]||[]).map(E=>E.id===y?{...E,[I]:D}:E)),f=(p,y)=>e(p,(t[p]||[]).map(I=>I.id===y?{...I,isCollapsed:!I.isCollapsed}:I));return d.jsx($t,{title:"Vantagens e Desvantagens",isCollapsed:n,toggleSection:r,children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1",children:"Vantagens"}),d.jsxs("div",{className:"space-y-2",children:[(t.advantages||[]).map(p=>d.jsx(hv,{perk:p,type:"advantages",canEdit:!0,onRemove:l,onChange:c,onOriginChange:u,onToggleCollapse:f,onShowDiscord:s},p.id)),d.jsx("div",{className:"flex justify-end mt-4",children:d.jsx("button",{onClick:()=>o("advantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1",children:"Desvantagens"}),d.jsxs("div",{className:"space-y-2",children:[(t.disadvantages||[]).map(p=>d.jsx(hv,{perk:p,type:"disadvantages",canEdit:!0,onRemove:l,onChange:c,onOriginChange:u,onToggleCollapse:f,onShowDiscord:s},p.id)),d.jsx("div",{className:"flex justify-end mt-4",children:d.jsx("button",{onClick:()=>o("disadvantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})]})]})})},hv=({perk:t,type:e,canEdit:n,onRemove:r,onChange:s,onOriginChange:i,onToggleCollapse:o,onShowDiscord:l})=>{const[u,c]=V.useState(t);V.useEffect(()=>{c(t)},[t.id]);const f=y=>{const{name:I,value:D,type:E}=y.target,N=E==="number"?parseInt(D,10)||0:D;c(b=>({...b,[I]:N}))},p=V.useCallback(y=>{u[y]!==t[y]&&s(e,u.id,y,u[y])},[u,t,e,s]);return d.jsxs("div",{className:"flex flex-col p-3 bg-bgElement rounded-md shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsxs("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>o(e,t.id),children:[u.name||"Sem Nome"," ",t.isCollapsed?"...":""]}),d.jsx("button",{onClick:()=>l(u.name,u.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]}),!t.isCollapsed&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("input",{type:"text",name:"name",value:u.name,onChange:f,onBlur:()=>p("name"),className:"font-semibold text-lg flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",placeholder:"Nome",disabled:!n}),d.jsx("input",{type:"number",name:"value",value:u.value===0?"":u.value,onChange:f,onBlur:()=>p("value"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary",placeholder:"Valor",disabled:!n})]}),d.jsx(pa,{name:"description",value:u.description,onChange:f,onBlur:()=>p("description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!n}),d.jsx("div",{className:"flex gap-3 text-sm text-textSecondary mt-2",children:["class","race","manual"].map(y=>{var I;return d.jsxs("label",{className:"flex items-center gap-1",children:[d.jsx("input",{type:"checkbox",checked:((I=t.origin)==null?void 0:I[y])||!1,onChange:()=>i(e,t.id,y),className:"form-checkbox text-btnHighlightBg rounded",disabled:!n}),y.charAt(0).toUpperCase()+y.slice(1)]},y)})}),n&&d.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:d.jsx("button",{onClick:()=>r(e,t.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:`Remover ${e==="advantages"?"Vantagem":"Desvantagem"}`,children:d.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]})]})},Dk=({value:t,onChange:e,placeholder:n,className:r,disabled:s,onBlur:i})=>{const o=V.useRef(null);return V.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),d.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:i,placeholder:n,className:`${r} resize-none overflow-hidden`,rows:"1",disabled:s})},jk=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=ze(),l=o.uid===t.ownerUid||e,u=p=>{const y=p==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(p==="image"){const I=prompt("Cole a URL da imagem:");I&&n("history",[...t.history||[],{...y,value:I}])}else n("history",[...t.history||[],y])},c=(p,y,I)=>n("history",(t.history||[]).map(D=>D.id===p?{...D,[y]:I}:D)),f=p=>n("history",(t.history||[]).filter(y=>y.id!==p));return d.jsxs($t,{title:"Histria do Personagem",isCollapsed:r,toggleSection:s,children:[d.jsx("div",{className:"space-y-4 mb-4",children:(t.history||[]).length===0?d.jsx("p",{className:"text-textSecondary italic",children:"Nenhum bloco de histria adicionado."}):t.history.map(p=>iE(p,l,c,f))}),l&&i&&d.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 justify-center",children:[d.jsx("button",{onClick:()=>u("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Texto"}),d.jsx("button",{onClick:()=>u("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Imagem"})]})]})},Ok=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=ze(),l=o.uid===t.ownerUid||e,u=p=>{const y=p==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(p==="image"){const I=prompt("Cole a URL da imagem para a anotao:");I&&n("notes",[...t.notes||[],{...y,value:I}])}else n("notes",[...t.notes||[],y])},c=(p,y,I)=>n("notes",(t.notes||[]).map(D=>D.id===p?{...D,[y]:I}:D)),f=p=>n("notes",(t.notes||[]).filter(y=>y.id!==p));return d.jsxs($t,{title:"Anotaes",isCollapsed:r,toggleSection:s,children:[d.jsx("div",{className:"space-y-4 mb-4",children:(t.notes||[]).length===0?d.jsx("p",{className:"text-textSecondary italic",children:"Nenhum bloco de anotao adicionado."}):t.notes.map(p=>iE(p,l,c,f))}),l&&i&&d.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 justify-center",children:[d.jsx("button",{onClick:()=>u("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Texto"}),d.jsx("button",{onClick:()=>u("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Imagem"})]})]})},iE=(t,e,n,r)=>d.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput relative",children:[e&&d.jsx("button",{onClick:()=>r(t.id),className:"absolute top-2 right-2 p-1 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white z-10",title:"Remover Bloco",children:d.jsx("span",{role:"img","aria-label":"Remover",className:"text-lg",children:""})}),t.type==="text"?d.jsx(Vk,{block:t,canEdit:e,updateBlock:n}):d.jsx(Mk,{block:t,canEdit:e,updateBlock:n})]},t.id),Vk=({block:t,canEdit:e,updateBlock:n})=>{const[r,s]=V.useState(t.value||"");V.useEffect(()=>{s(t.value||"")},[t.value]);const i=V.useCallback(()=>{r!==t.value&&n(t.id,"value",r)},[r,t.value,t.id,n]);return t.isCollapsed?d.jsxs("div",{className:"cursor-pointer",onClick:()=>n(t.id,"isCollapsed",!1),children:[d.jsx("p",{className:"text-lg font-semibold mb-1 text-textPrimary",children:"Bloco de Texto"}),d.jsx("p",{className:"text-sm italic text-textSecondary truncate",children:t.value||"Vazio..."})]}):d.jsxs(d.Fragment,{children:[d.jsx(Dk,{value:r,onChange:o=>s(o.target.value),onBlur:i,placeholder:"Digite aqui...",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!e}),d.jsx("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary",children:"Ocultar "})]})},Mk=({block:t,canEdit:e,updateBlock:n})=>{const[r,s]=V.useState(t.width===0?"":t.width),[i,o]=V.useState(t.height===0?"":t.height),[l,u]=V.useState(t.fitWidth);V.useEffect(()=>{s(t.width===0?"":t.width),o(t.height===0?"":t.height),u(t.fitWidth)},[t.width,t.height,t.fitWidth]);const c=V.useCallback(()=>n(t.id,"width",parseInt(r)||0),[t.id,n,r]),f=V.useCallback(()=>n(t.id,"height",parseInt(i)||0),[t.id,n,i]),p=V.useCallback(y=>n(t.id,"fitWidth",y.target.checked),[t.id,n]);return t.isCollapsed?d.jsx("div",{className:"cursor-pointer text-center py-2",onClick:()=>n(t.id,"isCollapsed",!1),children:d.jsx("p",{className:"text-lg font-semibold text-textPrimary",children:"Mostrar Imagem"})}):d.jsxs("div",{className:"flex flex-col items-center",children:[d.jsx("img",{src:t.value,alt:"Imagem",className:"max-w-full h-auto rounded-md shadow-md",style:{width:l?"100%":r?`${r}px`:"auto",height:l?"auto":i?`${i}px`:"auto",objectFit:"contain"},onError:y=>{y.target.onerror=null,y.target.src="https://placehold.co/300x200/1f2937/FFFFFF?text=Erro"}}),e&&d.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 mt-2 text-sm text-textSecondary",children:[d.jsxs("label",{children:["Ajustar  Largura: ",d.jsx("input",{type:"checkbox",checked:l,onChange:y=>{u(y.target.checked),p(y)},className:"form-checkbox text-btnHighlightBg rounded"})]}),!l&&d.jsxs(d.Fragment,{children:[d.jsxs("label",{children:["Largura (px): ",d.jsx("input",{type:"number",value:r,onChange:y=>s(y.target.value),onBlur:c,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})]}),d.jsxs("label",{children:["Altura (px): ",d.jsx("input",{type:"number",value:i,onChange:y=>o(y.target.value),onBlur:f,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})]})]})]}),d.jsx("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 w-full text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary",children:"Ocultar "})]})},Lk=({character:t,onBack:e,isMaster:n})=>{var H,ne,re,oe,F,K,Q,we,ye,ke,sn,on,an;const{character:r,loading:s,updateCharacterField:i,toggleSection:o}=XN(t.id,t.ownerUid),{addRollToFeed:l,addMessageToFeed:u}=mc(),{user:c}=ze(),{setActiveCharacter:f}=gr();V.useEffect(()=>(f(r),()=>f(null)),[r,f]);const[p,y]=V.useState(!1),[I,D]=V.useState({}),E=n||c&&c.uid===(r==null?void 0:r.ownerUid),[N,b]=V.useState({type:null,props:{}}),w=()=>b({type:null,props:{}}),v=V.useMemo(()=>r?["Iniciativa","FA","FM","FD","Acerto","MD","ME","Fora","Destreza","Constituio","Inteligencia","Sabedoria","Carisma","Fortitude","Reflexo","Vontade"]:[],[r]),S=V.useMemo(()=>{const $={attributes:{},dice:[]};return r!=null&&r.buffs&&r.buffs.forEach(le=>{le.isActive&&le.effects&&le.effects.forEach(ve=>{if(ve.type==="attribute"&&ve.target){const Te=parseInt(ve.value,10)||0;$.attributes[ve.target]=($.attributes[ve.target]||0)+Te}else ve.type==="dice"&&ve.value&&$.dice.push({name:le.name,value:ve.value})})}),$},[r==null?void 0:r.buffs]),P=async($,le,ve=[],Te="",Z="",Ee=!1)=>{if(!r)return;Ee||u({characterName:r.name||"Narrador",title:$,description:le||"Nenhuma descrio."});const De={author:{name:r.name||"Personagem",icon_url:r.photoUrl||""},title:$||"Sem Ttulo",description:le||"Sem Descrio.",fields:ve,color:8141549,footer:Te?{text:Te}:void 0};if(r.discordWebhookUrl)try{await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[De]})}),Z&&await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:Z})})}catch(ge){b({type:"info",props:{message:`Falha ao enviar para o Discord: ${ge.message}`,onConfirm:w}})}else{const ge=`**${$||"Sem Ttulo"}**
${le||"Sem Descrio."}`;b({type:"info",props:{message:"Webhook do Discord no configurado. Copie e cole no Discord:",copyText:ge,showCopyButton:!0,onConfirm:w}})}},C=($,le,ve,Te=!1)=>{if(!(r!=null&&r.mainAttributes))return;let Z="";const Ee=r.name||"Personagem",De=JSON.parse(JSON.stringify(r.mainAttributes)),ge=De.hp,jt=De.mp;if(ve==="heal")switch(le){case"HP":ge.current=Math.min(ge.max,ge.current+$),Z=`${Ee} recuperou ${$} de HP.`;break;case"HP Bonus":ge.temp=(ge.temp||0)+$,Z=`${Ee} recebeu ${$} de HP Bnus.`;break;case"MP":jt.current=Math.min(jt.max,jt.current+$),Z=`${Ee} recuperou ${$} de MP.`;break}else switch(le){case"HP":let Ht=$;if(Te)ge.current-=Ht,Z=`${Ee} sofreu ${$} de dano direto no HP.`;else{const Wt=Math.min(Ht,ge.temp||0);ge.temp-=Wt,Ht-=Wt,Ht>0&&(ge.current-=Ht),Z=`${Ee} sofreu ${$} de dano.`}break;case"HP Bonus":ge.temp=Math.max(0,(ge.temp||0)-$),Z=`${Ee} perdeu ${$} de HP Bnus.`;break;case"MP":jt.current=Math.max(0,jt.current-$),Z=`${Ee} perdeu ${$} de MP.`;break}ge.current=Math.max(0,ge.current),i("mainAttributes",De),P(ve==="heal"?" Cura / Restaurao":" Dano Sofrido",Z),w()},x=$=>{b({type:"damageHeal",props:{attributeName:$,onConfirm:C,onClose:w}})},g=($,le)=>{if(!r)return;const ve=Math.floor(Math.random()*20)+1,Te=ve===20,Z=ve===1,Ee={name:`Rolagem de ${$}`,components:[{type:"number",value:le,label:"Bnus"}],acertoResult:{roll:ve,bonus:le,total:ve+le,isCrit:Te,isCritFail:Z,skillName:$},discordText:`Rolagem de ${$} (1d20${le>=0?"+":""}${le})`};k(Ee)},_=($,le)=>{["HP","HP Bonus","MP"].includes($)?x($):g($,le)},A=V.useCallback(($,le)=>{var Wt,yn;const ve=oi.find(qt=>qt.name===$),Te=(Wt=le.skillSystem)==null?void 0:Wt[$];if(!ve||!Te)return 0;const Z=Te.selectedAttr||ve.attr,Ee=Wl[Z].toLowerCase();Object.keys(Wl).find(qt=>Wl[qt]===Ee);const De=((yn=le.mainAttributes)==null?void 0:yn[Ee])||0,ge=le.level||0;let jt=0;Te.trained&&(jt=2+Math.floor(ge/10));const Ht=parseInt(Te.otherBonus,10)||0;return De+jt+Ht},[]),k=async $=>{var Wi;if(!$)return;const le={HP:0,MP:0},ve=parseInt($.costValue,10)||0;$.costType&&ve>0&&(le[$.costType]+=ve);const Te=(r.buffs||[]).filter(Y=>Y.isActive);if(Te.forEach(Y=>{if(Y.costType&&Y.costValue){const J=parseInt(Y.costValue,10)||0;J>0&&(le[Y.costType]+=J)}}),r.mainAttributes.hp.current<le.HP||r.mainAttributes.mp.current<le.MP){b({type:"info",props:{message:`Recursos insuficientes! Custo: ${le.HP} HP, ${le.MP} MP.`,onConfirm:w}});return}let Z=0,Ee=$.acertoResult||null,De=[],ge=[];const jt=$.multiplier||1,Ht=Y=>{let J=0;if(!Y)return 0;const fe=(Y||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.mainAttributes&&r.mainAttributes.hasOwnProperty(fe)?J=r.mainAttributes[fe]||0:r.mainAttributes&&r.mainAttributes.hasOwnProperty(fe.toLowerCase())&&(J=r.mainAttributes[fe.toLowerCase()]||0),J+=S.attributes[Y]||0,J},Wt=(Wi=$.components)==null?void 0:Wi.find(Y=>Y.type==="skillRoll");if(Wt&&Wt.skill){const Y=Math.floor(Math.random()*20)+1,J=A(Wt.skill,r),fe=Y+J,Ie=Y===20;if(Ee={roll:Y,bonus:J,total:fe,isCrit:Ie,isCritFail:Y===1,skillName:Wt.skill},Ie){ge.push(`Acerto Crtico no d20 (${Y})!`);const ot=Wt.critFormula||"",nt=ot.match(/(\d+)d(\d+)/i);if(nt){const Ye=parseInt(nt[1],10),Ot=parseInt(nt[2],10);let Ms=[],ln=0;for(let Ls=0;Ls<Ye;Ls++){const kn=Math.floor(Math.random()*Ot)+1;Ms.push(kn),ln+=kn}Z+=ln;const qi=`Crtico(${ot}: ${Ms.join("+")}) = ${ln}`;ge.push(qi)}if(!isNaN(parseInt(ot,10))&&ot.trim()!==""){const Ye=parseInt(ot,10);Z+=Ye;const Ot=`Crtico(Bnus: ${Ye})`;De.push({type:"number",value:Ye,displayValue:Ot}),ge.push(Ot)}}}else if(!Ee&&!($.components||[]).some(J=>J.type==="dice"||J.type==="critDice")){const J=Math.floor(Math.random()*20)+1;Z+=J,De.push({type:"dice",value:J,displayValue:`1d20(${J})`})}for(let Y=0;Y<jt;Y++)for(const J of $.components||[])if(J.type==="attribute"){const fe=J.value,Ie=Ht(fe);Z+=Ie,De.push({type:"attribute",value:Ie,displayValue:`${fe}(${Ie})`})}else if(J.type==="critDice"){const fe=String(J.value||"").match(/(\d+)d(\d+)/i);if(fe){const Ie=parseInt(fe[1],10),Gt=parseInt(fe[2],10);let ot=[],nt=0;for(let Ye=0;Ye<Ie;Ye++){const Ot=Math.floor(Math.random()*Gt)+1;if(ot.push(Ot),nt+=Ot,Ot>=(J.critValue||Gt)){const ln=Ht(J.critBonusAttribute)*(J.critBonusMultiplier||1);nt+=ln,ge.push(`Crtico no ${Ot}! Adiciona ${J.critBonusAttribute} (${ln})`)}}Z+=nt,De.push({type:"dice",value:nt,displayValue:`${J.value}(${ot.join("+")})`})}else{const Ie=parseInt(J.value,10)||0;Z+=Ie,De.push({type:"number",value:Ie,displayValue:`${Ie}`})}}else if(J.type==="dice"){const fe=String(J.value||"").match(/(\d+)d(\d+)/i);if(fe){const Ie=parseInt(fe[1],10),Gt=parseInt(fe[2],10);let ot=[];for(let Ye=0;Ye<Ie;Ye++)ot.push(Math.floor(Math.random()*Gt)+1);const nt=ot.reduce((Ye,Ot)=>Ye+Ot,0);Z+=nt,De.push({type:"dice",value:nt,displayValue:`${J.value}(${ot.join("+")})`})}else if(!isNaN(parseInt(J.value,10))){const Ie=parseInt(J.value,10)||0;Z+=Ie,De.push({type:"number",value:Ie,displayValue:`${Ie}`})}}else if(J.type==="number"){const fe=parseInt(J.value,10)||0;Z+=fe;const Ie=J.label?`${J.label}(${fe>=0?"+":""}${fe})`:`${fe}`;De.push({type:"number",value:fe,displayValue:Ie})}else J.type;S.dice.forEach(Y=>{const J=(Y.value||"").match(/(\d+)d(\d+)/i);if(J){const fe=parseInt(J[1],10),Ie=parseInt(J[2],10);let Gt=[];for(let nt=0;nt<fe;nt++)Gt.push(Math.floor(Math.random()*Ie)+1);const ot=Gt.reduce((nt,Ye)=>nt+Ye,0);Z+=ot,De.push({type:"dice",value:ot,displayValue:`${Y.name}(${Gt.join("+")})`})}else{const fe=parseInt(Y.value,10)||0;Z+=fe,De.push({type:"number",value:fe,displayValue:`${Y.name}(${fe})`})}});const yn={HP:0,MP:0};let qt=[];const yr=$.costType&&$.costIsRollResult?-Z:parseInt($.costValue,10)||0;$.costType&&yr!==0&&(yn[$.costType]+=yr,qt.push(`Ao: ${yr>=0?"+":""}${yr} ${$.costType}`));const qn={HP:0,MP:0};$.recoverHP&&(qn.HP=Z,qt.push(`Recupera: ${Z} HP`)),$.recoverMP&&(qn.MP=Z,qt.push(`Recupera: ${Z} MP`)),Te.forEach(Y=>{if(Y.costType&&Y.costValue!==void 0){const J=parseInt(Y.costValue,10)||0;J!==0&&(yn[Y.costType]+=J,qt.push(`${Y.name}: ${J>=0?"+":""}${J} ${Y.costType}`))}});const ka=/(https?:\/\/[^\s]+)/i;let Vs="",Nn=$.discordText||"";const Hi=Nn.match(ka);if(Hi&&(Vs=Hi[0],Nn=Nn.replace(ka,"").trim()),yn.HP!==0||yn.MP!==0||qn.HP>0||qn.MP>0){const Y={...r.mainAttributes};Y.hp.current=Y.hp.current-yn.HP+qn.HP,Y.mp.current=Y.mp.current-yn.MP+qn.MP,Y.hp.current=Math.min(Y.hp.current,Y.hp.max),Y.hp.current=Math.max(Y.hp.current,0),Y.mp.current=Math.min(Y.mp.current,Y.mp.max),Y.mp.current=Math.max(Y.mp.current,0),await i("mainAttributes",Y)}let tt=De.map(Y=>Y.displayValue).join(" + "),Qe;if(Ee){const Y=`**Teste de ${Ee.skillName}:** ${Ee.total} (d20:${Ee.roll} + Bnus:${Ee.bonus||0})`;Qe=`${Nn}
${Y}

**Dano/Resultado: ${Z}**`}else Qe=`${Nn}

**Resultado Final: ${Z}**`;const vr=[{name:"Detalhes da Rolagem",value:tt||"N/A",inline:!1}];ge.length>0&&vr.push({name:"Crticos",value:ge.join(`
`),inline:!1}),Te.length>0&&vr.push({name:"Buffs Ativos",value:Te.map(Y=>Y.name).join(", "),inline:!1});const Da=qt.length>0?`Custo Total: ${qt.join(" | ")}`:"";P($.name,Qe,vr,Da,Vs,!0),l({characterId:r.id,characterName:r.name,ownerUid:c.uid,rollName:$.name,results:De,totalResult:Z,acertoResult:Ee,criticals:ge,discordText:Nn})},j=()=>{b({type:"confirm",props:{message:`Tem a certeza que deseja resetar PERMANENTEMENTE a ficha de "${r.name}"?`,onConfirm:async()=>{const $={photoUrl:"",age:"",height:"",gender:"",race:"",class:"",alignment:"",level:1,xp:0,mainAttributes:{hp:{current:10,max:10,temp:0},mp:{current:10,max:10},fa:0,fm:0,fd:0,acerto:0,me:0,forca:0,destreza:0,constituicao:0,inteligencia:0,sabedoria:0,carisma:0,fortitude:0,reflexo:0,vontade:0},attributes:[],inventory:[],wallet:{zeni:0,inspiration:0},fortitude:0,reflexo:0,vontade:0,advantages:[],disadvantages:[],abilities:[],equippedItems:[],history:[],notes:[],buffs:[],formulaActions:[],discordWebhookUrl:"",fortitudeAttr:"CON",reflexoAttr:"DES",vontadeAttr:"SAB",skillSystem:{}};for(const[le,ve]of Object.entries($))await i(le,ve);w()},onCancel:w}})},R=()=>{const{collapsedStates:$,...le}=r,ve=JSON.stringify(le,null,2),Te=new Blob([ve],{type:"application/json"}),Z=document.createElement("a");Z.href=URL.createObjectURL(Te),Z.download=`${r.name||"ficha"}.json`,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),URL.revokeObjectURL(Z.href)};return s?d.jsx("div",{className:"text-center p-8",children:d.jsx("p",{className:"text-xl text-textSecondary",children:"A carregar ficha..."})}):r?d.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4",children:[d.jsx(gc,{modalState:N,closeModal:w}),d.jsx(bk,{character:r}),d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("button",{onClick:e,className:"px-4 py-2 bg-bgSurface hover:opacity-80 text-textPrimary font-bold rounded-lg",children:" Voltar para a Lista"}),E&&d.jsx("button",{onClick:()=>y(!p),className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg shadow-lg",children:p?" Sair do Modo Edio":" Entrar no Modo Edio"})]}),d.jsx("div",{id:"info",children:d.jsx(Tk,{character:r,onUpdate:i,isMaster:n,isEditMode:p,isCollapsed:(H=r.collapsedStates)==null?void 0:H.info,toggleSection:()=>o("info")})}),d.jsx("div",{id:"main-attributes",children:d.jsx(Ik,{character:r,onUpdate:i,isMaster:n,isEditMode:p,buffModifiers:S.attributes,isCollapsed:(ne=r.collapsedStates)==null?void 0:ne.main,toggleSection:()=>o("main"),onAttributeRoll:_,onMapUpdate:D})}),d.jsx("div",{id:"actions",children:d.jsx(t1,{character:r,isMaster:n,isCollapsed:(re=r.collapsedStates)==null?void 0:re.actions,toggleSection:()=>o("actions"),allAttributes:v,onUpdate:i,onExecuteFormula:k,isEditMode:p})}),d.jsx("div",{id:"buffs",children:d.jsx(n1,{character:r,isMaster:n,onUpdate:i,allAttributes:v,isCollapsed:(oe=r.collapsedStates)==null?void 0:oe.buffs,toggleSection:()=>o("buffs"),isEditMode:p})}),d.jsx("div",{id:"wallet",children:d.jsx(Ck,{character:r,isMaster:n,onUpdate:i,isCollapsed:(F=r.collapsedStates)==null?void 0:F.wallet,toggleSection:()=>o("wallet"),isEditMode:p})}),d.jsx("div",{id:"inventory",children:d.jsx(Pk,{character:r,onUpdate:i,isMaster:n,onShowDiscord:P,isCollapsed:(K=r.collapsedStates)==null?void 0:K.inventory,toggleSection:()=>o("inventory"),isEditMode:p})}),d.jsx("div",{id:"equipped",children:d.jsx(Rk,{character:r,onUpdate:i,isMaster:n,onShowDiscord:P,isCollapsed:(Q=r.collapsedStates)==null?void 0:Q.equipped,toggleSection:()=>o("equipped"),isEditMode:p})}),d.jsx("div",{id:"perks",children:d.jsx(kk,{character:r,onUpdate:i,onShowDiscord:P,isCollapsed:(we=r.collapsedStates)==null?void 0:we.perks,toggleSection:()=>o("perks"),isEditMode:p})}),d.jsx("div",{id:"skills",children:d.jsx(Nk,{character:r,onUpdate:i,isMaster:n,onShowDiscord:P,isCollapsed:(ye=r.collapsedStates)==null?void 0:ye.skills,toggleSection:()=>o("skills"),isEditMode:p})}),d.jsx("div",{id:"specializations",children:d.jsx(ZN,{character:r,onUpdate:i,isMaster:n,isCollapsed:(ke=r.collapsedStates)==null?void 0:ke.specializations,toggleSection:()=>o("specializations"),onExecuteFormula:k,isEditMode:p,totalAttributesMap:I})}),d.jsx("div",{id:"story",children:d.jsx(jk,{character:r,onUpdate:i,isMaster:n,isCollapsed:(sn=r.collapsedStates)==null?void 0:sn.story,toggleSection:()=>o("story"),isEditMode:p})}),d.jsx("div",{id:"notes",children:d.jsx(Ok,{character:r,onUpdate:i,isMaster:n,isCollapsed:(on=r.collapsedStates)==null?void 0:on.notes,toggleSection:()=>o("notes"),isEditMode:p})}),d.jsx("div",{id:"discord",children:d.jsx(Ak,{character:r,onUpdate:i,isMaster:n,isCollapsed:(an=r.collapsedStates)==null?void 0:an.discord,toggleSection:()=>o("discord"),isEditMode:p})}),d.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mt-8 p-4 bg-bgSurface/80 backdrop-blur-sm rounded-xl border border-bgElement",children:[d.jsx("button",{onClick:R,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!r,children:"Exportar Ficha (JSON)"}),d.jsx("button",{onClick:j,className:"px-8 py-3 bg-red-700 hover:bg-red-800 text-white font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!r,children:"Resetar Ficha"})]})]}):d.jsx("div",{className:"text-center p-8",children:d.jsx("p",{className:"text-xl text-red-400",children:"Erro: Personagem no encontrado."})})},Fk=({activeTheme:t,setActiveTheme:e,setPreviewTheme:n})=>{const{user:r,googleSignOut:s,isMaster:i}=ze(),[o,l]=V.useState(null),[u,c]=V.useState([]),f=V.useRef(null),[p,y]=V.useState(!1),[I,D]=V.useState(!1),{currentSystem:E,setCurrentSystem:N,characterDataCollectionRoot:b,GLOBAL_APP_IDENTIFIER:w}=gr(),[v,S]=V.useState({type:null,props:{}}),P=()=>S({type:null,props:{}});V.useEffect(()=>{if(o!=null&&o.id&&(o!=null&&o.ownerUid)){const H=_s(Bt(Ne,`${b}/users/${o.ownerUid}/characterSheets/${o.id}`),async ne=>{if(ne.exists()){const re=ne.data();if(re.activeThemeId){const oe=await i1(re.activeThemeId);e(oe)}else e(null)}});return()=>H()}else e(null)},[o,e,b,Ne]);const C=()=>{D(!1),n(null)},x=H=>{l(H)},g=async()=>{if(r){console.log("%c[DIAGNSTICO DASHBOARD]","color: #00A8E8; font-weight: bold;",`Buscando fichas. isMaster: ${i}, viewingAll: ${p}`);const H=await Yw(b,r.uid,i&&p);c(H)}};V.useEffect(()=>{g()},[r,p,i,b]);const _=async()=>{await Xw(b,r.uid)&&g()},A=()=>{f.current.click()},k=H=>{const ne=H.target.files[0];if(!ne)return;const re=new FileReader;re.onload=oe=>{try{const F=JSON.parse(oe.target.result);if(!F.name)throw new Error("Ficheiro JSON invlido ou incompatvel.");S({type:"confirm",props:{message:`Deseja criar um novo personagem para o sistema ${E.toUpperCase()} com os dados de "${F.name}"?`,onConfirm:async()=>{const K=Bt(Zt(Ne,`${b}/users/${r.uid}/characterSheets`)),Q={...F,ownerUid:r.uid,system:E};delete Q.id,await js(K,Q),g(),P()},onCancel:P}})}catch(F){S({type:"info",props:{message:`Erro ao ler arquivo: ${F.message}`,onConfirm:P}})}},re.readAsText(ne),H.target.value=null},j=H=>{const ne=H.ownerUid||r.uid;S({type:"confirm",props:{message:`Tem a certeza que deseja excluir permanentemente a ficha de "${H.name}" do sistema ${E.toUpperCase()}?`,onConfirm:async()=>{await Jw(b,ne,H.id)?c(oe=>oe.filter(F=>F.id!==H.id)):alert("No foi possvel excluir a ficha."),P()},onCancel:P}})},R=d.jsx(sE,{onCharacterClick:x});return d.jsxs(d.Fragment,{children:[R,d.jsx("button",{onClick:()=>D(!0),className:"fixed top-4 right-4 z-[60] px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg shadow-lg",children:"Editor de Temas"}),I&&d.jsx(vk,{character:o,originalTheme:t,setPreviewTheme:n,onClose:C}),o?d.jsx(Lk,{character:o,onBack:()=>l(null),isMaster:i}):d.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 md:p-8",children:[d.jsx(gc,{modalState:v,closeModal:P}),d.jsx("input",{type:"file",ref:f,onChange:k,accept:".json",className:"hidden"}),d.jsxs("header",{className:"flex justify-between items-center mb-8",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-textPrimary",children:"Painel StoryCraft V1"}),d.jsxs("p",{className:"text-textSecondary",children:["Bem-vindo, ",r.displayName,"!"]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{onClick:()=>N(null),className:"px-4 py-2 bg-bgElement hover:bg-opacity-80 text-textPrimary font-semibold rounded-lg shadow-lg",children:"Trocar Sistema"}),d.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg",children:"Sair"})]})]}),d.jsx("main",{children:d.jsx(Kw,{user:r,onSelectCharacter:l,handleImportClick:A,handleDeleteClick:j,handleCreateClick:_,characters:u,isMaster:i,viewingAll:p,onToggleView:y})})]})]})};var yc={exports:{}},oE={},aE={exports:{}},Uk="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",zk=Uk,Bk=zk;function lE(){}function uE(){}uE.resetWarningCache=lE;var $k=function(){function t(r,s,i,o,l,u){if(u!==Bk){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:uE,resetWarningCache:lE};return n.PropTypes=n,n};aE.exports=$k();var cE=aE.exports;function dE(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=dE(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function fv(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=dE(t))&&(r&&(r+=" "),r+=e);return r}const Hk=Object.freeze(Object.defineProperty({__proto__:null,clsx:fv,default:fv},Symbol.toStringTag,{value:"Module"})),Wk=$E(Hk);var Be={},Hn={};Object.defineProperty(Hn,"__esModule",{value:!0});Hn.dontSetMe=Yk;Hn.findInArray=qk;Hn.int=Qk;Hn.isFunction=Gk;Hn.isNum=Kk;function qk(t,e){for(let n=0,r=t.length;n<r;n++)if(e.apply(e,[t[n],n,t]))return t[n]}function Gk(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Kk(t){return typeof t=="number"&&!isNaN(t)}function Qk(t){return parseInt(t,10)}function Yk(t,e,n){if(t[e])return new Error("Invalid prop ".concat(e," passed to ").concat(n," - do not set this, set it on the child."))}var Os={};Object.defineProperty(Os,"__esModule",{value:!0});Os.browserPrefixToKey=fE;Os.browserPrefixToStyle=Xk;Os.default=void 0;Os.getPrefix=hE;const wd=["Moz","Webkit","O","ms"];function hE(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const n=(t=window.document)===null||t===void 0||(t=t.documentElement)===null||t===void 0?void 0:t.style;if(!n||e in n)return"";for(let r=0;r<wd.length;r++)if(fE(e,wd[r])in n)return wd[r];return""}function fE(t,e){return e?"".concat(e).concat(Jk(t)):t}function Xk(t,e){return e?"-".concat(e.toLowerCase(),"-").concat(t):t}function Jk(t){let e="",n=!0;for(let r=0;r<t.length;r++)n?(e+=t[r].toUpperCase(),n=!1):t[r]==="-"?n=!0:e+=t[r];return e}Os.default=hE();Object.defineProperty(Be,"__esModule",{value:!0});Be.addClassName=gE;Be.addEvent=tD;Be.addUserSelectStyles=hD;Be.createCSSTransform=lD;Be.createSVGTransform=uD;Be.getTouch=cD;Be.getTouchIdentifier=dD;Be.getTranslation=zp;Be.innerHeight=iD;Be.innerWidth=oD;Be.matchesSelector=mE;Be.matchesSelectorAndParentsTo=eD;Be.offsetXYFromParent=aD;Be.outerHeight=rD;Be.outerWidth=sD;Be.removeClassName=yE;Be.removeEvent=nD;Be.removeUserSelectStyles=fD;var en=Hn,pv=Zk(Os);function pE(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(pE=function(r){return r?n:e})(t)}function Zk(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=pE(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}let vl="";function mE(t,e){return vl||(vl=(0,en.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,en.isFunction)(t[n])})),(0,en.isFunction)(t[vl])?t[vl](e):!1}function eD(t,e,n){let r=t;do{if(mE(r,e))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function tD(t,e,n,r){if(!t)return;const s={capture:!0,...r};t.addEventListener?t.addEventListener(e,n,s):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}function nD(t,e,n,r){if(!t)return;const s={capture:!0,...r};t.removeEventListener?t.removeEventListener(e,n,s):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}function rD(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,en.int)(n.borderTopWidth),e+=(0,en.int)(n.borderBottomWidth),e}function sD(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,en.int)(n.borderLeftWidth),e+=(0,en.int)(n.borderRightWidth),e}function iD(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,en.int)(n.paddingTop),e-=(0,en.int)(n.paddingBottom),e}function oD(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,en.int)(n.paddingLeft),e-=(0,en.int)(n.paddingRight),e}function aD(t,e,n){const s=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),i=(t.clientX+e.scrollLeft-s.left)/n,o=(t.clientY+e.scrollTop-s.top)/n;return{x:i,y:o}}function lD(t,e){const n=zp(t,e,"px");return{[(0,pv.browserPrefixToKey)("transform",pv.default)]:n}}function uD(t,e){return zp(t,e,"")}function zp(t,e,n){let{x:r,y:s}=t,i="translate(".concat(r).concat(n,",").concat(s).concat(n,")");if(e){const o="".concat(typeof e.x=="string"?e.x:e.x+n),l="".concat(typeof e.y=="string"?e.y:e.y+n);i="translate(".concat(o,", ").concat(l,")")+i}return i}function cD(t,e){return t.targetTouches&&(0,en.findInArray)(t.targetTouches,n=>e===n.identifier)||t.changedTouches&&(0,en.findInArray)(t.changedTouches,n=>e===n.identifier)}function dD(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function hD(t){if(!t)return;let e=t.getElementById("react-draggable-style-el");e||(e=t.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(e)),t.body&&gE(t.body,"react-draggable-transparent-selection")}function fD(t){if(t)try{if(t.body&&yE(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{const e=(t.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function gE(t,e){t.classList?t.classList.add(e):t.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(t.className+=" ".concat(e))}function yE(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var Wn={};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.canDragX=gD;Wn.canDragY=yD;Wn.createCoreData=_D;Wn.createDraggableData=xD;Wn.getBoundPosition=pD;Wn.getControlPosition=vD;Wn.snapToGrid=mD;var Qt=Hn,ai=Be;function pD(t,e,n){if(!t.props.bounds)return[e,n];let{bounds:r}=t.props;r=typeof r=="string"?r:wD(r);const s=Bp(t);if(typeof r=="string"){const{ownerDocument:i}=s,o=i.defaultView;let l;if(r==="parent"?l=s.parentNode:l=i.querySelector(r),!(l instanceof o.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const u=l,c=o.getComputedStyle(s),f=o.getComputedStyle(u);r={left:-s.offsetLeft+(0,Qt.int)(f.paddingLeft)+(0,Qt.int)(c.marginLeft),top:-s.offsetTop+(0,Qt.int)(f.paddingTop)+(0,Qt.int)(c.marginTop),right:(0,ai.innerWidth)(u)-(0,ai.outerWidth)(s)-s.offsetLeft+(0,Qt.int)(f.paddingRight)-(0,Qt.int)(c.marginRight),bottom:(0,ai.innerHeight)(u)-(0,ai.outerHeight)(s)-s.offsetTop+(0,Qt.int)(f.paddingBottom)-(0,Qt.int)(c.marginBottom)}}return(0,Qt.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,Qt.isNum)(r.bottom)&&(n=Math.min(n,r.bottom)),(0,Qt.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,Qt.isNum)(r.top)&&(n=Math.max(n,r.top)),[e,n]}function mD(t,e,n){const r=Math.round(e/t[0])*t[0],s=Math.round(n/t[1])*t[1];return[r,s]}function gD(t){return t.props.axis==="both"||t.props.axis==="x"}function yD(t){return t.props.axis==="both"||t.props.axis==="y"}function vD(t,e,n){const r=typeof e=="number"?(0,ai.getTouch)(t,e):null;if(typeof e=="number"&&!r)return null;const s=Bp(n),i=n.props.offsetParent||s.offsetParent||s.ownerDocument.body;return(0,ai.offsetXYFromParent)(r||t,i,n.props.scale)}function _D(t,e,n){const r=!(0,Qt.isNum)(t.lastX),s=Bp(t);return r?{node:s,deltaX:0,deltaY:0,lastX:e,lastY:n,x:e,y:n}:{node:s,deltaX:e-t.lastX,deltaY:n-t.lastY,lastX:t.lastX,lastY:t.lastY,x:e,y:n}}function xD(t,e){const n=t.props.scale;return{node:e.node,x:t.state.x+e.deltaX/n,y:t.state.y+e.deltaY/n,deltaX:e.deltaX/n,deltaY:e.deltaY/n,lastX:t.state.x,lastY:t.state.y}}function wD(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function Bp(t){const e=t.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var vc={},_c={};Object.defineProperty(_c,"__esModule",{value:!0});_c.default=ED;function ED(){}Object.defineProperty(vc,"__esModule",{value:!0});vc.default=void 0;var Ed=SD(V),Vt=$p(cE),bD=$p(xa),xt=Be,Sr=Wn,bd=Hn,mo=$p(_c);function $p(t){return t&&t.__esModule?t:{default:t}}function vE(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(vE=function(r){return r?n:e})(t)}function SD(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=vE(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}function Ct(t,e,n){return e=TD(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TD(t){var e=ID(t,"string");return typeof e=="symbol"?e:String(e)}function ID(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xn={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let Tr=xn.mouse,xc=class extends Ed.Component{constructor(){super(...arguments),Ct(this,"dragging",!1),Ct(this,"lastX",NaN),Ct(this,"lastY",NaN),Ct(this,"touchIdentifier",null),Ct(this,"mounted",!1),Ct(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=n;if(this.props.disabled||!(e.target instanceof r.defaultView.Node)||this.props.handle&&!(0,xt.matchesSelectorAndParentsTo)(e.target,this.props.handle,n)||this.props.cancel&&(0,xt.matchesSelectorAndParentsTo)(e.target,this.props.cancel,n))return;e.type==="touchstart"&&e.preventDefault();const s=(0,xt.getTouchIdentifier)(e);this.touchIdentifier=s;const i=(0,Sr.getControlPosition)(e,s,this);if(i==null)return;const{x:o,y:l}=i,u=(0,Sr.createCoreData)(this,o,l);(0,mo.default)("DraggableCore: handleDragStart: %j",u),(0,mo.default)("calling",this.props.onStart),!(this.props.onStart(e,u)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,xt.addUserSelectStyles)(r),this.dragging=!0,this.lastX=o,this.lastY=l,(0,xt.addEvent)(r,Tr.move,this.handleDrag),(0,xt.addEvent)(r,Tr.stop,this.handleDragStop))}),Ct(this,"handleDrag",e=>{const n=(0,Sr.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:s}=n;if(Array.isArray(this.props.grid)){let l=r-this.lastX,u=s-this.lastY;if([l,u]=(0,Sr.snapToGrid)(this.props.grid,l,u),!l&&!u)return;r=this.lastX+l,s=this.lastY+u}const i=(0,Sr.createCoreData)(this,r,s);if((0,mo.default)("DraggableCore: handleDrag: %j",i),this.props.onDrag(e,i)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const u=document.createEvent("MouseEvents");u.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(u)}return}this.lastX=r,this.lastY=s}),Ct(this,"handleDragStop",e=>{if(!this.dragging)return;const n=(0,Sr.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:s}=n;if(Array.isArray(this.props.grid)){let u=r-this.lastX||0,c=s-this.lastY||0;[u,c]=(0,Sr.snapToGrid)(this.props.grid,u,c),r=this.lastX+u,s=this.lastY+c}const i=(0,Sr.createCoreData)(this,r,s);if(this.props.onStop(e,i)===!1||this.mounted===!1)return!1;const l=this.findDOMNode();l&&this.props.enableUserSelectHack&&(0,xt.removeUserSelectStyles)(l.ownerDocument),(0,mo.default)("DraggableCore: handleDragStop: %j",i),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,l&&((0,mo.default)("DraggableCore: Removing handlers"),(0,xt.removeEvent)(l.ownerDocument,Tr.move,this.handleDrag),(0,xt.removeEvent)(l.ownerDocument,Tr.stop,this.handleDragStop))}),Ct(this,"onMouseDown",e=>(Tr=xn.mouse,this.handleDragStart(e))),Ct(this,"onMouseUp",e=>(Tr=xn.mouse,this.handleDragStop(e))),Ct(this,"onTouchStart",e=>(Tr=xn.touch,this.handleDragStart(e))),Ct(this,"onTouchEnd",e=>(Tr=xn.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,xt.addEvent)(e,xn.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:n}=e;(0,xt.removeEvent)(n,xn.mouse.move,this.handleDrag),(0,xt.removeEvent)(n,xn.touch.move,this.handleDrag),(0,xt.removeEvent)(n,xn.mouse.stop,this.handleDragStop),(0,xt.removeEvent)(n,xn.touch.stop,this.handleDragStop),(0,xt.removeEvent)(e,xn.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,xt.removeUserSelectStyles)(n)}}findDOMNode(){var e,n;return(e=this.props)!==null&&e!==void 0&&e.nodeRef?(n=this.props)===null||n===void 0||(n=n.nodeRef)===null||n===void 0?void 0:n.current:bD.default.findDOMNode(this)}render(){return Ed.cloneElement(Ed.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};vc.default=xc;Ct(xc,"displayName","DraggableCore");Ct(xc,"propTypes",{allowAnyClick:Vt.default.bool,children:Vt.default.node.isRequired,disabled:Vt.default.bool,enableUserSelectHack:Vt.default.bool,offsetParent:function(t,e){if(t[e]&&t[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Vt.default.arrayOf(Vt.default.number),handle:Vt.default.string,cancel:Vt.default.string,nodeRef:Vt.default.object,onStart:Vt.default.func,onDrag:Vt.default.func,onStop:Vt.default.func,onMouseDown:Vt.default.func,scale:Vt.default.number,className:bd.dontSetMe,style:bd.dontSetMe,transform:bd.dontSetMe});Ct(xc,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var e=y(V),n=f(cE),r=f(xa),s=f(Wk),i=Be,o=Wn,l=Hn,u=f(vc),c=f(_c);function f(w){return w&&w.__esModule?w:{default:w}}function p(w){if(typeof WeakMap!="function")return null;var v=new WeakMap,S=new WeakMap;return(p=function(P){return P?S:v})(w)}function y(w,v){if(w&&w.__esModule)return w;if(w===null||typeof w!="object"&&typeof w!="function")return{default:w};var S=p(v);if(S&&S.has(w))return S.get(w);var P={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in w)if(x!=="default"&&Object.prototype.hasOwnProperty.call(w,x)){var g=C?Object.getOwnPropertyDescriptor(w,x):null;g&&(g.get||g.set)?Object.defineProperty(P,x,g):P[x]=w[x]}return P.default=w,S&&S.set(w,P),P}function I(){return I=Object.assign?Object.assign.bind():function(w){for(var v=1;v<arguments.length;v++){var S=arguments[v];for(var P in S)Object.prototype.hasOwnProperty.call(S,P)&&(w[P]=S[P])}return w},I.apply(this,arguments)}function D(w,v,S){return v=E(v),v in w?Object.defineProperty(w,v,{value:S,enumerable:!0,configurable:!0,writable:!0}):w[v]=S,w}function E(w){var v=N(w,"string");return typeof v=="symbol"?v:String(v)}function N(w,v){if(typeof w!="object"||w===null)return w;var S=w[Symbol.toPrimitive];if(S!==void 0){var P=S.call(w,v);if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(v==="string"?String:Number)(w)}class b extends e.Component{static getDerivedStateFromProps(v,S){let{position:P}=v,{prevPropsPosition:C}=S;return P&&(!C||P.x!==C.x||P.y!==C.y)?((0,c.default)("Draggable: getDerivedStateFromProps %j",{position:P,prevPropsPosition:C}),{x:P.x,y:P.y,prevPropsPosition:{...P}}):null}constructor(v){super(v),D(this,"onDragStart",(S,P)=>{if((0,c.default)("Draggable: onDragStart: %j",P),this.props.onStart(S,(0,o.createDraggableData)(this,P))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),D(this,"onDrag",(S,P)=>{if(!this.state.dragging)return!1;(0,c.default)("Draggable: onDrag: %j",P);const C=(0,o.createDraggableData)(this,P),x={x:C.x,y:C.y,slackX:0,slackY:0};if(this.props.bounds){const{x:_,y:A}=x;x.x+=this.state.slackX,x.y+=this.state.slackY;const[k,j]=(0,o.getBoundPosition)(this,x.x,x.y);x.x=k,x.y=j,x.slackX=this.state.slackX+(_-x.x),x.slackY=this.state.slackY+(A-x.y),C.x=x.x,C.y=x.y,C.deltaX=x.x-this.state.x,C.deltaY=x.y-this.state.y}if(this.props.onDrag(S,C)===!1)return!1;this.setState(x)}),D(this,"onDragStop",(S,P)=>{if(!this.state.dragging||this.props.onStop(S,(0,o.createDraggableData)(this,P))===!1)return!1;(0,c.default)("Draggable: onDragStop: %j",P);const x={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:_,y:A}=this.props.position;x.x=_,x.y=A}this.setState(x)}),this.state={dragging:!1,dragged:!1,x:v.position?v.position.x:v.defaultPosition.x,y:v.position?v.position.y:v.defaultPosition.y,prevPropsPosition:{...v.position},slackX:0,slackY:0,isElementSVG:!1},v.position&&!(v.onDrag||v.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var v,S;return(v=(S=this.props)===null||S===void 0||(S=S.nodeRef)===null||S===void 0?void 0:S.current)!==null&&v!==void 0?v:r.default.findDOMNode(this)}render(){const{axis:v,bounds:S,children:P,defaultPosition:C,defaultClassName:x,defaultClassNameDragging:g,defaultClassNameDragged:_,position:A,positionOffset:k,scale:j,...R}=this.props;let H={},ne=null;const oe=!!!A||this.state.dragging,F=A||C,K={x:(0,o.canDragX)(this)&&oe?this.state.x:F.x,y:(0,o.canDragY)(this)&&oe?this.state.y:F.y};this.state.isElementSVG?ne=(0,i.createSVGTransform)(K,k):H=(0,i.createCSSTransform)(K,k);const Q=(0,s.default)(P.props.className||"",x,{[g]:this.state.dragging,[_]:this.state.dragged});return e.createElement(u.default,I({},R,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(P),{className:Q,style:{...P.props.style,...H},transform:ne}))}}t.default=b,D(b,"displayName","Draggable"),D(b,"propTypes",{...u.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),D(b,"defaultProps",{...u.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(oE);const{default:_E,DraggableCore:CD}=oE;yc.exports=_E;yc.exports.default=_E;yc.exports.DraggableCore=CD;var AD=yc.exports;const PD=Bh(AD);var qe=function(){return qe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},qe.apply(this,arguments)},mv={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},gv={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},_l={width:"20px",height:"20px",position:"absolute",zIndex:1},RD={top:qe(qe({},mv),{top:"-5px"}),right:qe(qe({},gv),{left:void 0,right:"-5px"}),bottom:qe(qe({},mv),{top:void 0,bottom:"-5px"}),left:qe(qe({},gv),{left:"-5px"}),topRight:qe(qe({},_l),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:qe(qe({},_l),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:qe(qe({},_l),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:qe(qe({},_l),{left:"-10px",top:"-10px",cursor:"nw-resize"})},ND=V.memo(function(t){var e=t.onResizeStart,n=t.direction,r=t.children,s=t.replaceStyles,i=t.className,o=V.useCallback(function(c){e(c,n)},[e,n]),l=V.useCallback(function(c){e(c,n)},[e,n]),u=V.useMemo(function(){return qe(qe({position:"absolute",userSelect:"none"},RD[n]),s??{})},[s,n]);return d.jsx("div",{className:i||void 0,style:u,onMouseDown:o,onTouchStart:l,children:r})}),kD=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),On=function(){return On=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},On.apply(this,arguments)},DD={width:"auto",height:"auto"},xl=function(t,e,n){return Math.max(Math.min(t,n),e)},yv=function(t,e,n){var r=Math.round(t/e);return r*e+n*(r-1)},Hs=function(t,e){return new RegExp(t,"i").test(e)},wl=function(t){return!!(t.touches&&t.touches.length)},jD=function(t){return!!((t.clientX||t.clientX===0)&&(t.clientY||t.clientY===0))},vv=function(t,e,n){n===void 0&&(n=0);var r=e.reduce(function(i,o,l){return Math.abs(o-t)<Math.abs(e[i]-t)?l:i},0),s=Math.abs(e[r]-t);return n===0||s<n?e[r]:t},Sd=function(t){return t=t.toString(),t==="auto"||t.endsWith("px")||t.endsWith("%")||t.endsWith("vh")||t.endsWith("vw")||t.endsWith("vmax")||t.endsWith("vmin")?t:"".concat(t,"px")},El=function(t,e,n,r){if(t&&typeof t=="string"){if(t.endsWith("px"))return Number(t.replace("px",""));if(t.endsWith("%")){var s=Number(t.replace("%",""))/100;return e*s}if(t.endsWith("vw")){var s=Number(t.replace("vw",""))/100;return n*s}if(t.endsWith("vh")){var s=Number(t.replace("vh",""))/100;return r*s}}return t},OD=function(t,e,n,r,s,i,o){return r=El(r,t.width,e,n),s=El(s,t.height,e,n),i=El(i,t.width,e,n),o=El(o,t.height,e,n),{maxWidth:typeof r>"u"?void 0:Number(r),maxHeight:typeof s>"u"?void 0:Number(s),minWidth:typeof i>"u"?void 0:Number(i),minHeight:typeof o>"u"?void 0:Number(o)}},VD=function(t){return Array.isArray(t)?t:[t,t]},MD=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],_v="__resizable_base__",LD=function(t){kD(e,t);function e(n){var r,s,i,o,l=t.call(this,n)||this;return l.ratio=1,l.resizable=null,l.parentLeft=0,l.parentTop=0,l.resizableLeft=0,l.resizableRight=0,l.resizableTop=0,l.resizableBottom=0,l.targetLeft=0,l.targetTop=0,l.delta={width:0,height:0},l.appendBase=function(){if(!l.resizable||!l.window)return null;var u=l.parentNode;if(!u)return null;var c=l.window.document.createElement("div");return c.style.width="100%",c.style.height="100%",c.style.position="absolute",c.style.transform="scale(0, 0)",c.style.left="0",c.style.flex="0 0 100%",c.classList?c.classList.add(_v):c.className+=_v,u.appendChild(c),c},l.removeBase=function(u){var c=l.parentNode;c&&c.removeChild(u)},l.state={isResizing:!1,width:(s=(r=l.propsSize)===null||r===void 0?void 0:r.width)!==null&&s!==void 0?s:"auto",height:(o=(i=l.propsSize)===null||i===void 0?void 0:i.height)!==null&&o!==void 0?o:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},l.onResizeStart=l.onResizeStart.bind(l),l.onMouseMove=l.onMouseMove.bind(l),l.onMouseUp=l.onMouseUp.bind(l),l}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||DD},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var n=0,r=0;if(this.resizable&&this.window){var s=this.resizable.offsetWidth,i=this.resizable.offsetHeight,o=this.resizable.style.position;o!=="relative"&&(this.resizable.style.position="relative"),n=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:s,r=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:i,this.resizable.style.position=o}return{width:n,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sizeStyle",{get:function(){var n=this,r=this.props.size,s=function(l){var u;if(typeof n.state[l]>"u"||n.state[l]==="auto")return"auto";if(n.propsSize&&n.propsSize[l]&&(!((u=n.propsSize[l])===null||u===void 0)&&u.toString().endsWith("%"))){if(n.state[l].toString().endsWith("%"))return n.state[l].toString();var c=n.getParentSize(),f=Number(n.state[l].toString().replace("px","")),p=f/c[l]*100;return"".concat(p,"%")}return Sd(n.state[l])},i=r&&typeof r.width<"u"&&!this.state.isResizing?Sd(r.width):s("width"),o=r&&typeof r.height<"u"&&!this.state.isResizing?Sd(r.height):s("height");return{width:i,height:o}},enumerable:!1,configurable:!0}),e.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var n=this.appendBase();if(!n)return{width:0,height:0};var r=!1,s=this.parentNode.style.flexWrap;s!=="wrap"&&(r=!0,this.parentNode.style.flexWrap="wrap"),n.style.position="relative",n.style.minWidth="100%",n.style.minHeight="100%";var i={width:n.offsetWidth,height:n.offsetHeight};return r&&(this.parentNode.style.flexWrap=s),this.removeBase(n),i},e.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},e.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},e.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var n=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:n.flexBasis!=="auto"?n.flexBasis:void 0})}},e.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},e.prototype.createSizeForCssProperty=function(n,r){var s=this.propsSize&&this.propsSize[r];return this.state[r]==="auto"&&this.state.original[r]===n&&(typeof s>"u"||s==="auto")?"auto":n},e.prototype.calculateNewMaxFromBoundary=function(n,r){var s=this.props.boundsByDirection,i=this.state.direction,o=s&&Hs("left",i),l=s&&Hs("top",i),u,c;if(this.props.bounds==="parent"){var f=this.parentNode;f&&(u=o?this.resizableRight-this.parentLeft:f.offsetWidth+(this.parentLeft-this.resizableLeft),c=l?this.resizableBottom-this.parentTop:f.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(u=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,c=l?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(u=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),c=l?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return u&&Number.isFinite(u)&&(n=n&&n<u?n:u),c&&Number.isFinite(c)&&(r=r&&r<c?r:c),{maxWidth:n,maxHeight:r}},e.prototype.calculateNewSizeFromDirection=function(n,r){var s=this.props.scale||1,i=VD(this.props.resizeRatio||1),o=i[0],l=i[1],u=this.state,c=u.direction,f=u.original,p=this.props,y=p.lockAspectRatio,I=p.lockAspectRatioExtraHeight,D=p.lockAspectRatioExtraWidth,E=f.width,N=f.height,b=I||0,w=D||0;return Hs("right",c)&&(E=f.width+(n-f.x)*o/s,y&&(N=(E-w)/this.ratio+b)),Hs("left",c)&&(E=f.width-(n-f.x)*o/s,y&&(N=(E-w)/this.ratio+b)),Hs("bottom",c)&&(N=f.height+(r-f.y)*l/s,y&&(E=(N-b)*this.ratio+w)),Hs("top",c)&&(N=f.height-(r-f.y)*l/s,y&&(E=(N-b)*this.ratio+w)),{newWidth:E,newHeight:N}},e.prototype.calculateNewSizeFromAspectRatio=function(n,r,s,i){var o=this.props,l=o.lockAspectRatio,u=o.lockAspectRatioExtraHeight,c=o.lockAspectRatioExtraWidth,f=typeof i.width>"u"?10:i.width,p=typeof s.width>"u"||s.width<0?n:s.width,y=typeof i.height>"u"?10:i.height,I=typeof s.height>"u"||s.height<0?r:s.height,D=u||0,E=c||0;if(l){var N=(y-D)*this.ratio+E,b=(I-D)*this.ratio+E,w=(f-E)/this.ratio+D,v=(p-E)/this.ratio+D,S=Math.max(f,N),P=Math.min(p,b),C=Math.max(y,w),x=Math.min(I,v);n=xl(n,S,P),r=xl(r,C,x)}else n=xl(n,f,p),r=xl(r,y,I);return{newWidth:n,newHeight:r}},e.prototype.setBoundingClientRect=function(){var n=1/(this.props.scale||1);if(this.props.bounds==="parent"){var r=this.parentNode;if(r){var s=r.getBoundingClientRect();this.parentLeft=s.left*n,this.parentTop=s.top*n}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left*n,this.targetTop=i.top*n}if(this.resizable){var o=this.resizable.getBoundingClientRect(),l=o.left,u=o.top,c=o.right,f=o.bottom;this.resizableLeft=l*n,this.resizableRight=c*n,this.resizableTop=u*n,this.resizableBottom=f*n}},e.prototype.onResizeStart=function(n,r){if(!(!this.resizable||!this.window)){var s=0,i=0;if(n.nativeEvent&&jD(n.nativeEvent)?(s=n.nativeEvent.clientX,i=n.nativeEvent.clientY):n.nativeEvent&&wl(n.nativeEvent)&&(s=n.nativeEvent.touches[0].clientX,i=n.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var o=this.props.onResizeStart(n,r,this.resizable);if(o===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var l,u=this.window.getComputedStyle(this.resizable);if(u.flexBasis!=="auto"){var c=this.parentNode;if(c){var f=this.window.getComputedStyle(c).flexDirection;this.flexDir=f.startsWith("row")?"row":"column",l=u.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var p={original:{x:s,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:On(On({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(n.target).cursor||"auto"}),direction:r,flexBasis:l};this.setState(p)}},e.prototype.onMouseMove=function(n){var r=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&wl(n))try{n.preventDefault(),n.stopPropagation()}catch{}var s=this.props,i=s.maxWidth,o=s.maxHeight,l=s.minWidth,u=s.minHeight,c=wl(n)?n.touches[0].clientX:n.clientX,f=wl(n)?n.touches[0].clientY:n.clientY,p=this.state,y=p.direction,I=p.original,D=p.width,E=p.height,N=this.getParentSize(),b=OD(N,this.window.innerWidth,this.window.innerHeight,i,o,l,u);i=b.maxWidth,o=b.maxHeight,l=b.minWidth,u=b.minHeight;var w=this.calculateNewSizeFromDirection(c,f),v=w.newHeight,S=w.newWidth,P=this.calculateNewMaxFromBoundary(i,o);this.props.snap&&this.props.snap.x&&(S=vv(S,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(v=vv(v,this.props.snap.y,this.props.snapGap));var C=this.calculateNewSizeFromAspectRatio(S,v,{width:P.maxWidth,height:P.maxHeight},{width:l,height:u});if(S=C.newWidth,v=C.newHeight,this.props.grid){var x=yv(S,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),g=yv(v,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),_=this.props.snapGap||0,A=_===0||Math.abs(x-S)<=_?x:S,k=_===0||Math.abs(g-v)<=_?g:v;S=A,v=k}var j={width:S-I.width,height:v-I.height};if(this.delta=j,D&&typeof D=="string"){if(D.endsWith("%")){var R=S/N.width*100;S="".concat(R,"%")}else if(D.endsWith("vw")){var H=S/this.window.innerWidth*100;S="".concat(H,"vw")}else if(D.endsWith("vh")){var ne=S/this.window.innerHeight*100;S="".concat(ne,"vh")}}if(E&&typeof E=="string"){if(E.endsWith("%")){var R=v/N.height*100;v="".concat(R,"%")}else if(E.endsWith("vw")){var H=v/this.window.innerWidth*100;v="".concat(H,"vw")}else if(E.endsWith("vh")){var ne=v/this.window.innerHeight*100;v="".concat(ne,"vh")}}var re={width:this.createSizeForCssProperty(S,"width"),height:this.createSizeForCssProperty(v,"height")};this.flexDir==="row"?re.flexBasis=re.width:this.flexDir==="column"&&(re.flexBasis=re.height);var oe=this.state.width!==re.width,F=this.state.height!==re.height,K=this.state.flexBasis!==re.flexBasis,Q=oe||F||K;Q&&xa.flushSync(function(){r.setState(re)}),this.props.onResize&&Q&&this.props.onResize(n,y,this.resizable,j)}},e.prototype.onMouseUp=function(n){var r,s,i=this.state,o=i.isResizing,l=i.direction;i.original,!(!o||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(n,l,this.resizable,this.delta),this.props.size&&this.setState({width:(r=this.props.size.width)!==null&&r!==void 0?r:"auto",height:(s=this.props.size.height)!==null&&s!==void 0?s:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:On(On({},this.state.backgroundStyle),{cursor:"auto"})}))},e.prototype.updateSize=function(n){var r,s;this.setState({width:(r=n.width)!==null&&r!==void 0?r:"auto",height:(s=n.height)!==null&&s!==void 0?s:"auto"})},e.prototype.renderResizer=function(){var n=this,r=this.props,s=r.enable,i=r.handleStyles,o=r.handleClasses,l=r.handleWrapperStyle,u=r.handleWrapperClass,c=r.handleComponent;if(!s)return null;var f=Object.keys(s).map(function(p){return s[p]!==!1?d.jsx(ND,{direction:p,onResizeStart:n.onResizeStart,replaceStyles:i&&i[p],className:o&&o[p],children:c&&c[p]?c[p]:null},p):null});return d.jsx("div",{className:u,style:l,children:f})},e.prototype.render=function(){var n=this,r=Object.keys(this.props).reduce(function(o,l){return MD.indexOf(l)!==-1||(o[l]=n.props[l]),o},{}),s=On(On(On({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(s.flexBasis=this.state.flexBasis);var i=this.props.as||"div";return d.jsxs(i,On({style:s,className:this.props.className},r,{ref:function(o){o&&(n.resizable=o)},children:[this.state.isResizing&&d.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},e.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},e}(V.PureComponent);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var zh=function(t,e){return zh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},zh(t,e)};function FD(t,e){zh(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Xe=function(){return Xe=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Xe.apply(this,arguments)};function UD(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}var zD={width:"auto",height:"auto",display:"inline-block",position:"absolute",top:0,left:0},BD=function(t){return{bottom:t,bottomLeft:t,bottomRight:t,left:t,right:t,top:t,topLeft:t,topRight:t}},$D=function(t){FD(e,t);function e(n){var r=t.call(this,n)||this;return r.resizingPosition={x:0,y:0},r.offsetFromParent={left:0,top:0},r.resizableElement={current:null},r.originalPosition={x:0,y:0},r.state={resizing:!1,bounds:{top:0,right:0,bottom:0,left:0},maxWidth:n.maxWidth,maxHeight:n.maxHeight},r.onResizeStart=r.onResizeStart.bind(r),r.onResize=r.onResize.bind(r),r.onResizeStop=r.onResizeStop.bind(r),r.onDragStart=r.onDragStart.bind(r),r.onDrag=r.onDrag.bind(r),r.onDragStop=r.onDragStop.bind(r),r.getMaxSizesFromProps=r.getMaxSizesFromProps.bind(r),r}return e.prototype.componentDidMount=function(){this.updateOffsetFromParent();var n=this.offsetFromParent,r=n.left,s=n.top,i=this.getDraggablePosition(),o=i.x,l=i.y;this.draggable.setState({x:o-r,y:l-s}),this.forceUpdate()},e.prototype.getDraggablePosition=function(){var n=this.draggable.state,r=n.x,s=n.y;return{x:r,y:s}},e.prototype.getParent=function(){return this.resizable&&this.resizable.parentNode},e.prototype.getParentSize=function(){return this.resizable.getParentSize()},e.prototype.getMaxSizesFromProps=function(){var n=typeof this.props.maxWidth>"u"?Number.MAX_SAFE_INTEGER:this.props.maxWidth,r=typeof this.props.maxHeight>"u"?Number.MAX_SAFE_INTEGER:this.props.maxHeight;return{maxWidth:n,maxHeight:r}},e.prototype.getSelfElement=function(){return this.resizable&&this.resizable.resizable},e.prototype.getOffsetHeight=function(n){var r=this.props.scale;switch(this.props.bounds){case"window":return window.innerHeight/r;case"body":return document.body.offsetHeight/r;default:return n.offsetHeight}},e.prototype.getOffsetWidth=function(n){var r=this.props.scale;switch(this.props.bounds){case"window":return window.innerWidth/r;case"body":return document.body.offsetWidth/r;default:return n.offsetWidth}},e.prototype.onDragStart=function(n,r){this.props.onDragStart&&this.props.onDragStart(n,r);var s=this.getDraggablePosition();if(this.originalPosition=s,!!this.props.bounds){var i=this.getParent(),o=this.props.scale,l;if(this.props.bounds==="parent")l=i;else if(this.props.bounds==="body"){var u=i.getBoundingClientRect(),c=u.left,f=u.top,p=document.body.getBoundingClientRect(),y=-(c-i.offsetLeft*o-p.left)/o,I=-(f-i.offsetTop*o-p.top)/o,D=(document.body.offsetWidth-this.resizable.size.width*o)/o+y,E=(document.body.offsetHeight-this.resizable.size.height*o)/o+I;return this.setState({bounds:{top:I,right:D,bottom:E,left:y}})}else if(this.props.bounds==="window"){if(!this.resizable)return;var N=i.getBoundingClientRect(),b=N.left,w=N.top,v=-(b-i.offsetLeft*o)/o,S=-(w-i.offsetTop*o)/o,D=(window.innerWidth-this.resizable.size.width*o)/o+v,E=(window.innerHeight-this.resizable.size.height*o)/o+S;return this.setState({bounds:{top:S,right:D,bottom:E,left:v}})}else typeof this.props.bounds=="string"?l=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(l=this.props.bounds);if(!(!(l instanceof HTMLElement)||!(i instanceof HTMLElement))){var P=l.getBoundingClientRect(),C=P.left,x=P.top,g=i.getBoundingClientRect(),_=g.left,A=g.top,k=(C-_)/o,j=x-A;if(this.resizable){this.updateOffsetFromParent();var R=this.offsetFromParent;this.setState({bounds:{top:j-R.top,right:k+(l.offsetWidth-this.resizable.size.width)-R.left/o,bottom:j+(l.offsetHeight-this.resizable.size.height)-R.top,left:k-R.left/o}})}}}},e.prototype.onDrag=function(n,r){if(this.props.onDrag){var s=this.offsetFromParent,i=s.left,o=s.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDrag(n,Xe(Xe({},r),{x:r.x+i,y:r.y+o}));if(this.props.dragAxis==="x")return this.props.onDrag(n,Xe(Xe({},r),{x:r.x+i,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDrag(n,Xe(Xe({},r),{x:this.originalPosition.x+i,y:r.y+o,deltaX:0}))}},e.prototype.onDragStop=function(n,r){if(this.props.onDragStop){var s=this.offsetFromParent,i=s.left,o=s.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDragStop(n,Xe(Xe({},r),{x:r.x+i,y:r.y+o}));if(this.props.dragAxis==="x")return this.props.onDragStop(n,Xe(Xe({},r),{x:r.x+i,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDragStop(n,Xe(Xe({},r),{x:this.originalPosition.x+i,y:r.y+o,deltaX:0}))}},e.prototype.onResizeStart=function(n,r,s){n.stopPropagation(),this.setState({resizing:!0});var i=this.props.scale,o=this.offsetFromParent,l=this.getDraggablePosition();if(this.resizingPosition={x:l.x+o.left,y:l.y+o.top},this.originalPosition=l,this.props.bounds){var u=this.getParent(),c=void 0;this.props.bounds==="parent"?c=u:this.props.bounds==="body"?c=document.body:this.props.bounds==="window"?c=window:typeof this.props.bounds=="string"?c=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(c=this.props.bounds);var f=this.getSelfElement();if(f instanceof Element&&(c instanceof HTMLElement||c===window)&&u instanceof HTMLElement){var p=this.getMaxSizesFromProps(),y=p.maxWidth,I=p.maxHeight,D=this.getParentSize();if(y&&typeof y=="string")if(y.endsWith("%")){var E=Number(y.replace("%",""))/100;y=D.width*E}else y.endsWith("px")&&(y=Number(y.replace("px","")));if(I&&typeof I=="string")if(I.endsWith("%")){var E=Number(I.replace("%",""))/100;I=D.height*E}else I.endsWith("px")&&(I=Number(I.replace("px","")));var N=f.getBoundingClientRect(),b=N.left,w=N.top,v=this.props.bounds==="window"?{left:0,top:0}:c.getBoundingClientRect(),S=v.left,P=v.top,C=this.getOffsetWidth(c),x=this.getOffsetHeight(c),g=r.toLowerCase().endsWith("left"),_=r.toLowerCase().endsWith("right"),A=r.startsWith("top"),k=r.startsWith("bottom");if((g||A)&&this.resizable){var j=(b-S)/i+this.resizable.size.width;this.setState({maxWidth:j>Number(y)?y:j})}if(_||this.props.lockAspectRatio&&!g&&!A){var j=C+(S-b)/i;this.setState({maxWidth:j>Number(y)?y:j})}if((A||g)&&this.resizable){var j=(w-P)/i+this.resizable.size.height;this.setState({maxHeight:j>Number(I)?I:j})}if(k||this.props.lockAspectRatio&&!A&&!g){var j=x+(P-w)/i;this.setState({maxHeight:j>Number(I)?I:j})}}}else this.setState({maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight});this.props.onResizeStart&&this.props.onResizeStart(n,r,s)},e.prototype.onResize=function(n,r,s,i){var o=this,l={x:this.originalPosition.x,y:this.originalPosition.y},u=-i.width,c=-i.height,f=["top","left","topLeft","bottomLeft","topRight"];f.includes(r)&&(r==="bottomLeft"?l.x+=u:(r==="topRight"||(l.x+=u),l.y+=c));var p=this.draggable.state;(l.x!==p.x||l.y!==p.y)&&xa.flushSync(function(){o.draggable.setState(l)}),this.updateOffsetFromParent();var y=this.offsetFromParent,I=this.getDraggablePosition().x+y.left,D=this.getDraggablePosition().y+y.top;this.resizingPosition={x:I,y:D},this.props.onResize&&this.props.onResize(n,r,s,i,{x:I,y:D})},e.prototype.onResizeStop=function(n,r,s,i){this.setState({resizing:!1});var o=this.getMaxSizesFromProps(),l=o.maxWidth,u=o.maxHeight;this.setState({maxWidth:l,maxHeight:u}),this.props.onResizeStop&&this.props.onResizeStop(n,r,s,i,this.resizingPosition)},e.prototype.updateSize=function(n){this.resizable&&this.resizable.updateSize({width:n.width,height:n.height})},e.prototype.updatePosition=function(n){this.draggable.setState(n)},e.prototype.updateOffsetFromParent=function(){var n=this.props.scale,r=this.getParent(),s=this.getSelfElement();if(!r||s===null)return{top:0,left:0};var i=r.getBoundingClientRect(),o=i.left,l=i.top,u=s.getBoundingClientRect(),c=this.getDraggablePosition(),f=r.scrollLeft,p=r.scrollTop;this.offsetFromParent={left:u.left-o+f-c.x*n,top:u.top-l+p-c.y*n}},e.prototype.render=function(){var n=this,r=this.props,s=r.disableDragging,i=r.style,o=r.dragHandleClassName,l=r.position,u=r.onMouseDown,c=r.onMouseUp,f=r.dragAxis,p=r.dragGrid,y=r.bounds,I=r.enableUserSelectHack,D=r.cancel,E=r.children;r.onResizeStart,r.onResize,r.onResizeStop,r.onDragStart,r.onDrag,r.onDragStop;var N=r.resizeHandleStyles,b=r.resizeHandleClasses,w=r.resizeHandleComponent,v=r.enableResizing,S=r.resizeGrid,P=r.resizeHandleWrapperClass,C=r.resizeHandleWrapperStyle,x=r.scale,g=r.allowAnyClick,_=r.dragPositionOffset,A=UD(r,["disableDragging","style","dragHandleClassName","position","onMouseDown","onMouseUp","dragAxis","dragGrid","bounds","enableUserSelectHack","cancel","children","onResizeStart","onResize","onResizeStop","onDragStart","onDrag","onDragStop","resizeHandleStyles","resizeHandleClasses","resizeHandleComponent","enableResizing","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","scale","allowAnyClick","dragPositionOffset"]),k=this.props.default?Xe({},this.props.default):void 0;delete A.default;var j=s||o?{cursor:"auto"}:{cursor:"move"},R=Xe(Xe(Xe({},zD),j),i),H=this.offsetFromParent,ne=H.left,re=H.top,oe;l&&(oe={x:l.x-ne,y:l.y-re});var F=this.state.resizing?void 0:oe,K=this.state.resizing?"both":f;return V.createElement(PD,{ref:function(Q){Q&&(n.draggable=Q)},handle:o?".".concat(o):void 0,defaultPosition:k,onMouseDown:u,onMouseUp:c,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,axis:K,disabled:s,grid:p,bounds:y?this.state.bounds:void 0,position:F,enableUserSelectHack:I,cancel:D,scale:x,allowAnyClick:g,nodeRef:this.resizableElement,positionOffset:_},V.createElement(LD,Xe({},A,{ref:function(Q){Q&&(n.resizable=Q,n.resizableElement.current=Q.resizable)},defaultSize:k,size:this.props.size,enable:typeof v=="boolean"?BD(v):v,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,style:R,minWidth:this.props.minWidth,minHeight:this.props.minHeight,maxWidth:this.state.resizing?this.state.maxWidth:this.props.maxWidth,maxHeight:this.state.resizing?this.state.maxHeight:this.props.maxHeight,grid:S,handleWrapperClass:P,handleWrapperStyle:C,lockAspectRatio:this.props.lockAspectRatio,lockAspectRatioExtraWidth:this.props.lockAspectRatioExtraWidth,lockAspectRatioExtraHeight:this.props.lockAspectRatioExtraHeight,handleStyles:N,handleClasses:b,handleComponent:w,scale:this.props.scale}),E))},e.defaultProps={maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,scale:1,onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},onDragStart:function(){},onDrag:function(){},onDragStop:function(){}},e}(V.PureComponent);const HD="/assets/storycraft-bg-classic-DHho0FOo.png",Du={input:{name:"Campo de Input (Texto)",color:"rgba(3, 169, 244, 0.4)",borderColor:"#03a9f4"},textarea:{name:"rea de Texto (Grande)",color:"rgba(76, 175, 80, 0.4)",borderColor:"#4caf50"},rollable:{name:"rea Clicvel (Roll)",color:"rgba(244, 67, 54, 0.4)",borderColor:"#f44336"},label:{name:"Texto Calculado (Label)",color:"rgba(255, 152, 0, 0.4)",borderColor:"#ff9800"},image:{name:"Zona de Imagem (Foto)",color:"rgba(156, 39, 176, 0.4)",borderColor:"#9c27b0"}},go=827,yo=1170,WD=({id:t,data:e,onUpdate:n,onSelect:r,isSelected:s})=>{const{type:i,top:o,left:l,width:u,height:c}=e,f=Du[i]||Du.input,p={border:`2px solid ${s?f.borderColor:"transparent"}`,backgroundColor:f.color,boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontFamily:"monospace",fontSize:"12px",textShadow:"0 0 2px black"};return d.jsx($D,{style:p,size:{width:u,height:c},position:{x:l,y:o},onDragStart:r,onDragStop:(y,I)=>{n(t,{top:I.y,left:I.x})},onResizeStop:(y,I,D,E,N)=>{n(t,{width:parseInt(D.style.width,10),height:parseInt(D.style.height,10),...N})},onClick:y=>{y.stopPropagation(),r()},className:"z-10",children:t})},qD=({onBack:t})=>{const[e,n]=V.useState({}),[r,s]=V.useState(null),i=V.useRef(null),o=V.useMemo(()=>r?e[r]:null,[r,e]),l=E=>{if(!E)return;const N=prompt('Digite o ID nico para este elemento (ex: "name", "attr_for", "roll_des"):');if(N){if(e[N]){alert("Erro: Este ID j est em uso.");return}n(b=>({...b,[N]:{type:E,top:10,left:10,width:150,height:30}})),s(N)}},u=(E,N)=>{n(b=>({...b,[E]:{...b[E],...N}}))},c=E=>{if(!r)return;const{name:N,value:b}=E.target;u(r,{[N]:parseInt(b,10)||0})},f=E=>{const N=E.target.value.trim();if(!(!N||N===r)){if(e[N]){console.warn(`ID "${N}" j existe.`);return}n(b=>{const{[r]:w,...v}=b;return{...v,[N]:w}}),s(N)}},p=E=>{if(!r)return;const{value:N}=E.target;u(r,{type:N})},y=()=>{if(!r||!e[r])return;const E=e[r];let N=prompt("Digite o NOVO ID nico para a cpia:",`${r}_copia`);if(!N)return;for(;e[N];)if(alert(`Erro: O ID "${N}" j est em uso.`),N=prompt("Por favor, digite um ID DIFERENTE:",`${N}_2`),!N)return;const b={...E,top:E.top,left:E.left+20};n(w=>({...w,[N]:b})),s(N)},I=()=>{const E={};Object.entries(e).forEach(([S,P])=>{E[S]={type:P.type,top:P.top/yo*100,left:P.left/go*100,width:P.width/go*100,height:P.height/yo*100}});const N=JSON.stringify(E,null,2),b=new Blob([N],{type:"application/json"}),w=URL.createObjectURL(b),v=document.createElement("a");v.href=w,v.download="sheet_layout.json",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(w)},D=E=>{const N=E.target.files[0];if(!N)return;const b=new FileReader;b.onload=w=>{try{const v=JSON.parse(w.target.result),S={};Object.entries(v).forEach(([P,C])=>{if(!C.type||C.top==null)throw new Error(`Elemento "${P}"  invlido.`);S[P]={type:C.type,top:C.top/100*yo,left:C.left/100*go,width:C.width/100*go,height:C.height/100*yo}}),n(S)}catch(v){console.error("Erro ao importar JSON:",v),alert(`Arquivo JSON invlido: ${v.message}`)}},b.readAsText(N),E.target.value=null};return d.jsxs("div",{className:"w-full min-h-screen bg-gray-900 text-white",children:[d.jsx("input",{type:"file",ref:i,onChange:D,accept:".json",className:"hidden"}),d.jsxs("header",{className:"p-2 bg-gray-800 flex items-center gap-4 sticky top-0 z-50",children:[d.jsx("button",{onClick:t,className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 rounded",children:" Voltar"}),d.jsxs("select",{onChange:E=>{l(E.target.value),E.target.value=""},className:"bg-gray-700 text-white px-3 py-1 rounded",value:"",children:[d.jsx("option",{value:"",disabled:!0,children:"Adicionar Zona..."}),Object.entries(Du).map(([E,N])=>d.jsx("option",{value:E,children:N.name},E))]}),d.jsx("button",{onClick:()=>i.current.click(),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded",children:"Importar JSON"}),d.jsx("button",{onClick:I,className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded",children:"Exportar JSON (%)"}),r&&d.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[d.jsx("button",{onClick:y,className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded",title:`Copiar ${r}`,children:"Copiar"}),d.jsx("button",{onClick:()=>{if(window.confirm(`Tem certeza que quer remover o elemento "${r}"?`)){const{[r]:E,...N}=e;n(N),s(null)}},className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded",title:`Remover ${r}`,children:"Remover"})]})]}),d.jsxs("div",{className:"flex",style:{height:"calc(100vh - 48px)"},children:[d.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-900",children:d.jsx("div",{className:"mx-auto",style:{position:"relative",width:`${go}px`,height:`${yo}px`,backgroundImage:`url(${HD})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"},onClick:()=>s(null),children:Object.entries(e).map(([E,N])=>d.jsx(WD,{id:E,data:N,onUpdate:u,onSelect:()=>s(E),isSelected:E===r},E))})}),d.jsxs("aside",{className:"w-64 bg-gray-800 p-4 overflow-y-auto",children:[d.jsx("h2",{className:"text-lg font-bold mb-4",children:"Propriedades"}),o?d.jsxs("div",{className:"space-y-2",children:[d.jsxs("fieldset",{className:"border border-gray-600 p-2 rounded",children:[d.jsx("legend",{className:"text-sm px-1",children:"Elemento"}),d.jsx(vo,{label:"ID",name:"id",value:r,onChange:f,onBlur:f,type:"text"}),d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsx("label",{htmlFor:"type",className:"text-sm text-gray-300",children:"Tipo:"}),d.jsx("select",{id:"type",name:"type",value:o.type,onChange:p,className:"w-2/3 p-1 rounded bg-gray-700 text-white",children:Object.entries(Du).map(([E,N])=>d.jsx("option",{value:E,children:N.name},E))})]})]}),d.jsxs("fieldset",{className:"border border-gray-600 p-2 rounded",children:[d.jsx("legend",{className:"text-sm px-1",children:"Posio (em pixels)"}),d.jsx(vo,{label:"Top",name:"top",value:o.top,onChange:c}),d.jsx(vo,{label:"Left",name:"left",value:o.left,onChange:c}),d.jsx(vo,{label:"Width",name:"width",value:o.width,onChange:c}),d.jsx(vo,{label:"Height",name:"height",value:o.height,onChange:c})]})]}):d.jsx("p",{className:"text-gray-400",children:"Selecione um elemento ou adicione uma nova zona."})]})]})]})},vo=({label:t,name:e,value:n,onChange:r,onBlur:s,readOnly:i=!1,type:o="number"})=>d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsxs("label",{htmlFor:e,className:"text-sm text-gray-300",children:[t,":"]}),d.jsx("input",{type:o,id:e,name:e,value:n,onChange:r,onBlur:s,readOnly:i,className:`w-2/3 p-1 rounded ${i?"bg-gray-600 text-gray-400":"bg-gray-700 text-white"}`})]}),GD=({activeTheme:t,setActiveTheme:e,setPreviewTheme:n})=>{const{user:r,googleSignOut:s,isMaster:i}=ze(),[o,l]=V.useState(null),[u,c]=V.useState([]),f=V.useRef(null),[p,y]=V.useState(!1),[I,D]=V.useState(!1),{currentSystem:E,setCurrentSystem:N,characterDataCollectionRoot:b,GLOBAL_APP_IDENTIFIER:w}=gr(),[v,S]=V.useState({type:null,props:{}}),P=()=>S({type:null,props:{}}),C=R=>{l(R)},x=async()=>{if(r){console.log("%c[DIAGNSTICO DASHBOARD V2]","color: #f59e0b; font-weight: bold;",`Buscando fichas V2. isMaster: ${i}, viewingAll: ${p}`);const R=await Yw(b,r.uid,i&&p);c(R)}};V.useEffect(()=>{x()},[r,p,i,b]);const g=async()=>{await Xw(b,r.uid)&&x()},_=()=>{f.current.click()},A=R=>{const H=R.target.files[0];if(!H)return;const ne=new FileReader;ne.onload=re=>{try{const oe=JSON.parse(re.target.result);if(!oe.name)throw new Error("Ficheiro JSON invlido ou incompatvel.");S({type:"confirm",props:{message:`Deseja criar um novo personagem para o sistema ${E.toUpperCase()} com os dados de "${oe.name}"?`,onConfirm:async()=>{const F=Bt(Zt(Ne,`${b}/users/${r.uid}/characterSheets`)),K={...oe,ownerUid:r.uid,system:E};delete K.id,await js(F,K),x(),P()},onCancel:P}})}catch(oe){S({type:"info",props:{message:`Erro ao ler arquivo: ${oe.message}`,onConfirm:P}})}},ne.readAsText(H),R.target.value=null},k=R=>{const H=R.ownerUid||r.uid;S({type:"confirm",props:{message:`Tem a certeza que deseja excluir permanentemente a ficha de "${R.name}" do sistema ${E.toUpperCase()}?`,onConfirm:async()=>{await Jw(b,H,R.id)?c(re=>re.filter(oe=>oe.id!==R.id)):alert("No foi possvel excluir a ficha."),P()},onCancel:P}})},j=d.jsx(sE,{onCharacterClick:C});return d.jsxs(d.Fragment,{children:[j,o?d.jsx(qD,{onBack:()=>l(null)}):d.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 md:p-8",children:[d.jsx(gc,{modalState:v,closeModal:P}),d.jsx("input",{type:"file",ref:f,onChange:A,accept:".json",className:"hidden"}),d.jsxs("header",{className:"flex justify-between items-center mb-8",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-textPrimary",children:"Painel StoryCraft V2 (Clssico)"}),d.jsxs("p",{className:"text-textSecondary",children:["Bem-vindo, ",r.displayName,"!"]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{onClick:()=>N(null),className:"px-4 py-2 bg-bgElement hover:bg-opacity-80 text-textPrimary font-semibold rounded-lg shadow-lg",children:"Trocar Sistema"}),d.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg",children:"Sair"})]})]}),d.jsx("main",{children:d.jsx(Kw,{user:r,onSelectCharacter:l,handleImportClick:_,handleDeleteClick:k,handleCreateClick:g,characters:u,isMaster:i,viewingAll:p,onToggleView:y})})]})]})},KD=t=>{const{currentSystem:e,setCurrentSystem:n}=gr();return e?d.jsxs(d.Fragment,{children:[e==="v1"&&d.jsx(Fk,{...t}),e==="v2"&&d.jsx(GD,{...t})]}):d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-bgPage p-4",children:[d.jsx("h1",{className:"text-4xl font-bold text-textPrimary mb-10",children:"Selecione o Sistema"}),d.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[d.jsxs("div",{onClick:()=>n("v1"),className:"bg-bgSurface border-2 border-borderAccent rounded-lg p-8 w-80 h-60 flex flex-col justify-center items-center text-center cursor-pointer transform hover:scale-105 transition-transform duration-300 shadow-lg",children:[d.jsx("h2",{className:"text-3xl font-bold text-textAccent mb-2",children:"StoryCraft V1"}),d.jsx("p",{className:"text-textSecondary",children:"A experincia clssica com temas personalizveis."})]}),d.jsxs("div",{onClick:()=>n("v2"),className:"bg-bgSurface border-2 border-borderAccent rounded-lg p-8 w-80 h-60 flex flex-col justify-center items-center text-center cursor-pointer transform hover:scale-105 transition-transform duration-300 shadow-lg",children:[d.jsx("h2",{className:"text-3xl font-bold text-textAccent mb-2",children:"StoryCraft V2"}),d.jsx("p",{className:"text-textSecondary",children:"O novo sistema com regras de Escala de Poder."})]})]})]})},QD=()=>{const{googleSignIn:t}=ze(),[e,n]=V.useState(!1),[r,s]=V.useState(""),i=async()=>{n(!0),s("");try{await t()}catch(o){console.error("Erro ao fazer login com o Google:",o),o.code!=="auth/popup-closed-by-user"&&s("Ocorreu um erro ao tentar fazer login. Tente novamente.")}finally{n(!1)}};return d.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background p-4",children:d.jsxs("div",{className:"text-center max-w-md w-full",children:[d.jsx("h1",{className:"text-5xl font-bold text-primary mb-2",children:"StoryCraft V2"}),d.jsx("p",{className:"text-xl text-secondary mb-8",children:"Sua ficha de RPG, do seu jeito."}),d.jsx("button",{onClick:i,disabled:e,className:"px-8 py-4 bg-highlight hover:bg-opacity-80 text-primary font-bold rounded-lg shadow-lg text-lg transition-opacity duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e?"Carregando...":"Entrar com Google"}),r&&d.jsx("p",{className:"text-red-500 mt-4",children:r})]})})};function YD(t){if(!t)return"55, 65, 81";const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?`${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)}`:"55, 65, 81"}const XD=t=>{const e=document.documentElement;t?(e.style.setProperty("--background-image",t.backgroundImage||"none"),e.style.setProperty("--font-family",t.fontFamily||"ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb",YD(t.colors.bgSurface)),e.style.setProperty("--surface-opacity",(t.surfaceOpacity||80)/100),e.style.setProperty("--color-bgPage",t.colors.bgPage),e.style.setProperty("--color-bgElement",t.colors.bgElement),e.style.setProperty("--color-bgInput",t.colors.bgInput),e.style.setProperty("--color-textPrimary",t.colors.textPrimary),e.style.setProperty("--color-textSecondary",t.colors.textSecondary),e.style.setProperty("--color-borderAccent",t.colors.borderAccent),e.style.setProperty("--color-textAccent",t.colors.textAccent),e.style.setProperty("--color-btnHighlightBg",t.colors.btnHighlightBg),e.style.setProperty("--color-btnHighlightText",t.colors.btnHighlightText)):(e.style.setProperty("--background-image","none"),e.style.setProperty("--font-family","ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb","55, 65, 81"),e.style.setProperty("--surface-opacity","0.8"),e.style.setProperty("--color-bgPage","#111827"),e.style.setProperty("--color-bgElement","#374151"),e.style.setProperty("--color-bgInput","#4b5563"),e.style.setProperty("--color-textPrimary","#f9fafb"),e.style.setProperty("--color-textSecondary","#9ca3af"),e.style.setProperty("--color-borderAccent","#f59e0b"),e.style.setProperty("--color-textAccent","#fcd34d"),e.style.setProperty("--color-btnHighlightBg","#8b5cf6"),e.style.setProperty("--color-btnHighlightText","#ffffff"))};function JD(){const{user:t,loading:e}=ze(),[n,r]=V.useState(null),[s,i]=V.useState(null);return V.useEffect(()=>{const o=s||n;XD(o?o.styles:null)},[n,s]),e?d.jsx("div",{className:"bg-bgPage text-textPrimary min-h-screen flex items-center justify-center",children:d.jsx("h1",{className:"text-3xl",children:"A carregar StoryCraft..."})}):d.jsxs("div",{className:"bg-bgPage bg-theme bg-cover bg-center bg-fixed text-textPrimary min-h-screen",children:[t?d.jsxs(d.Fragment,{children:[d.jsx(KD,{activeTheme:n,setActiveTheme:r,previewTheme:s,setPreviewTheme:i}),d.jsx(hk,{})," "]}):d.jsx(QD,{})," "]})}Td.createRoot(document.getElementById("root")).render(d.jsx(Gh.StrictMode,{children:d.jsx(JN,{children:d.jsx(YN,{children:d.jsx(dk,{children:d.jsxs(s1,{children:[d.jsx(JD,{})," "]})})})})}));
