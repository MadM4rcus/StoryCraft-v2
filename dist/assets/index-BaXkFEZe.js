(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function t0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var sy={exports:{}},oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ro=Symbol.for("react.element"),n0=Symbol.for("react.portal"),r0=Symbol.for("react.fragment"),i0=Symbol.for("react.strict_mode"),s0=Symbol.for("react.profiler"),o0=Symbol.for("react.provider"),a0=Symbol.for("react.context"),l0=Symbol.for("react.forward_ref"),u0=Symbol.for("react.suspense"),c0=Symbol.for("react.memo"),d0=Symbol.for("react.lazy"),Rm=Symbol.iterator;function h0(t){return t===null||typeof t!="object"?null:(t=Rm&&t[Rm]||t["@@iterator"],typeof t=="function"?t:null)}var oy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ay=Object.assign,ly={};function es(t,e,n){this.props=t,this.context=e,this.refs=ly,this.updater=n||oy}es.prototype.isReactComponent={};es.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};es.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function uy(){}uy.prototype=es.prototype;function Bd(t,e,n){this.props=t,this.context=e,this.refs=ly,this.updater=n||oy}var jd=Bd.prototype=new uy;jd.constructor=Bd;ay(jd,es.prototype);jd.isPureReactComponent=!0;var Nm=Array.isArray,cy=Object.prototype.hasOwnProperty,zd={current:null},dy={key:!0,ref:!0,__self:!0,__source:!0};function hy(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)cy.call(e,r)&&!dy.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Ro,type:t,key:s,ref:o,props:i,_owner:zd.current}}function f0(t,e){return{$$typeof:Ro,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $d(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ro}function m0(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Dm=/\/+/g;function Mu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?m0(""+t.key):e.toString(36)}function Da(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ro:case n0:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Mu(o,0):r,Nm(i)?(n="",t!=null&&(n=t.replace(Dm,"$&/")+"/"),Da(i,e,n,"",function(c){return c})):i!=null&&($d(i)&&(i=f0(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Dm,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Nm(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+Mu(s,l);o+=Da(s,e,n,u,i)}else if(u=h0(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+Mu(s,l++),o+=Da(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function da(t,e,n){if(t==null)return t;var r=[],i=0;return Da(t,r,"","",function(s){return e.call(n,s,i++)}),r}function p0(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var wt={current:null},Va={transition:null},g0={ReactCurrentDispatcher:wt,ReactCurrentBatchConfig:Va,ReactCurrentOwner:zd};function fy(){throw Error("act(...) is not supported in production builds of React.")}oe.Children={map:da,forEach:function(t,e,n){da(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return da(t,function(){e++}),e},toArray:function(t){return da(t,function(e){return e})||[]},only:function(t){if(!$d(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};oe.Component=es;oe.Fragment=r0;oe.Profiler=s0;oe.PureComponent=Bd;oe.StrictMode=i0;oe.Suspense=u0;oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g0;oe.act=fy;oe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ay({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=zd.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)cy.call(e,u)&&!dy.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:Ro,type:t.type,key:i,ref:s,props:r,_owner:o}};oe.createContext=function(t){return t={$$typeof:a0,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:o0,_context:t},t.Consumer=t};oe.createElement=hy;oe.createFactory=function(t){var e=hy.bind(null,t);return e.type=t,e};oe.createRef=function(){return{current:null}};oe.forwardRef=function(t){return{$$typeof:l0,render:t}};oe.isValidElement=$d;oe.lazy=function(t){return{$$typeof:d0,_payload:{_status:-1,_result:t},_init:p0}};oe.memo=function(t,e){return{$$typeof:c0,type:t,compare:e===void 0?null:e}};oe.startTransition=function(t){var e=Va.transition;Va.transition={};try{t()}finally{Va.transition=e}};oe.unstable_act=fy;oe.useCallback=function(t,e){return wt.current.useCallback(t,e)};oe.useContext=function(t){return wt.current.useContext(t)};oe.useDebugValue=function(){};oe.useDeferredValue=function(t){return wt.current.useDeferredValue(t)};oe.useEffect=function(t,e){return wt.current.useEffect(t,e)};oe.useId=function(){return wt.current.useId()};oe.useImperativeHandle=function(t,e,n){return wt.current.useImperativeHandle(t,e,n)};oe.useInsertionEffect=function(t,e){return wt.current.useInsertionEffect(t,e)};oe.useLayoutEffect=function(t,e){return wt.current.useLayoutEffect(t,e)};oe.useMemo=function(t,e){return wt.current.useMemo(t,e)};oe.useReducer=function(t,e,n){return wt.current.useReducer(t,e,n)};oe.useRef=function(t){return wt.current.useRef(t)};oe.useState=function(t){return wt.current.useState(t)};oe.useSyncExternalStore=function(t,e,n){return wt.current.useSyncExternalStore(t,e,n)};oe.useTransition=function(){return wt.current.useTransition()};oe.version="18.3.1";sy.exports=oe;var B=sy.exports;const h=t0(B);var Tc={},my={exports:{}},Ot={},py={exports:{}},gy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,z){var $=M.length;M.push(z);e:for(;0<$;){var Z=$-1>>>1,ee=M[Z];if(0<i(ee,z))M[Z]=z,M[$]=ee,$=Z;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var z=M[0],$=M.pop();if($!==z){M[0]=$;e:for(var Z=0,ee=M.length,J=ee>>>1;Z<J;){var fe=2*(Z+1)-1,Le=M[fe],nt=fe+1,Be=M[nt];if(0>i(Le,$))nt<ee&&0>i(Be,Le)?(M[Z]=Be,M[nt]=$,Z=nt):(M[Z]=Le,M[fe]=$,Z=fe);else if(nt<ee&&0>i(Be,$))M[Z]=Be,M[nt]=$,Z=nt;else break e}}return z}function i(M,z){var $=M.sortIndex-z.sortIndex;return $!==0?$:M.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],m=1,p=null,g=3,x=!1,N=!1,C=!1,D=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(M){for(var z=n(c);z!==null;){if(z.callback===null)r(c);else if(z.startTime<=M)r(c),z.sortIndex=z.expirationTime,e(u,z);else break;z=n(c)}}function P(M){if(C=!1,S(M),!N)if(n(u)!==null)N=!0,X(R);else{var z=n(c);z!==null&&Oe(P,z.startTime-M)}}function R(M,z){N=!1,C&&(C=!1,I(y),y=-1),x=!0;var $=g;try{for(S(z),p=n(u);p!==null&&(!(p.expirationTime>z)||M&&!_());){var Z=p.callback;if(typeof Z=="function"){p.callback=null,g=p.priorityLevel;var ee=Z(p.expirationTime<=z);z=t.unstable_now(),typeof ee=="function"?p.callback=ee:p===n(u)&&r(u),S(z)}else r(u);p=n(u)}if(p!==null)var J=!0;else{var fe=n(c);fe!==null&&Oe(P,fe.startTime-z),J=!1}return J}finally{p=null,g=$,x=!1}}var V=!1,v=null,y=-1,T=5,A=-1;function _(){return!(t.unstable_now()-A<T)}function k(){if(v!==null){var M=t.unstable_now();A=M;var z=!0;try{z=v(!0,M)}finally{z?b():(V=!1,v=null)}}else V=!1}var b;if(typeof w=="function")b=function(){w(k)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,W=q.port2;q.port1.onmessage=k,b=function(){W.postMessage(null)}}else b=function(){D(k,0)};function X(M){v=M,V||(V=!0,b())}function Oe(M,z){y=D(function(){M(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){N||x||(N=!0,X(R))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(M){switch(g){case 1:case 2:case 3:var z=3;break;default:z=g}var $=g;g=z;try{return M()}finally{g=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,z){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var $=g;g=M;try{return z()}finally{g=$}},t.unstable_scheduleCallback=function(M,z,$){var Z=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?Z+$:Z):$=Z,M){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=$+ee,M={id:m++,callback:z,priorityLevel:M,startTime:$,expirationTime:ee,sortIndex:-1},$>Z?(M.sortIndex=$,e(c,M),n(u)===null&&M===n(c)&&(C?(I(y),y=-1):C=!0,Oe(P,$-Z))):(M.sortIndex=ee,e(u,M),N||x||(N=!0,X(R))),M},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(M){var z=g;return function(){var $=g;g=z;try{return M.apply(this,arguments)}finally{g=$}}}})(gy);py.exports=gy;var y0=py.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v0=B,Vt=y0;function j(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yy=new Set,ro={};function ti(t,e){Fi(t,e),Fi(t+"Capture",e)}function Fi(t,e){for(ro[t]=e,t=0;t<e.length;t++)yy.add(e[t])}var Vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bc=Object.prototype.hasOwnProperty,_0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vm={},Om={};function E0(t){return bc.call(Om,t)?!0:bc.call(Vm,t)?!1:_0.test(t)?Om[t]=!0:(Vm[t]=!0,!1)}function w0(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function I0(t,e,n,r){if(e===null||typeof e>"u"||w0(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function It(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){et[t]=new It(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];et[e]=new It(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){et[t]=new It(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){et[t]=new It(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){et[t]=new It(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){et[t]=new It(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){et[t]=new It(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){et[t]=new It(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){et[t]=new It(t,5,!1,t.toLowerCase(),null,!1,!1)});var Hd=/[\-:]([a-z])/g;function Wd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Hd,Wd);et[e]=new It(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Hd,Wd);et[e]=new It(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Hd,Wd);et[e]=new It(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){et[t]=new It(t,1,!1,t.toLowerCase(),null,!1,!1)});et.xlinkHref=new It("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){et[t]=new It(t,1,!1,t.toLowerCase(),null,!0,!0)});function qd(t,e,n,r){var i=et.hasOwnProperty(e)?et[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(I0(e,n,i,r)&&(n=null),r||i===null?E0(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var zn=v0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ha=Symbol.for("react.element"),gi=Symbol.for("react.portal"),yi=Symbol.for("react.fragment"),Kd=Symbol.for("react.strict_mode"),xc=Symbol.for("react.profiler"),vy=Symbol.for("react.provider"),_y=Symbol.for("react.context"),Gd=Symbol.for("react.forward_ref"),Sc=Symbol.for("react.suspense"),Cc=Symbol.for("react.suspense_list"),Qd=Symbol.for("react.memo"),Xn=Symbol.for("react.lazy"),Ey=Symbol.for("react.offscreen"),Lm=Symbol.iterator;function xs(t){return t===null||typeof t!="object"?null:(t=Lm&&t[Lm]||t["@@iterator"],typeof t=="function"?t:null)}var Ce=Object.assign,Fu;function Vs(t){if(Fu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Fu=e&&e[1]||""}return`
`+Fu+t}var Uu=!1;function Bu(t,e){if(!t||Uu)return"";Uu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var u=`
`+i[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Uu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Vs(t):""}function T0(t){switch(t.tag){case 5:return Vs(t.type);case 16:return Vs("Lazy");case 13:return Vs("Suspense");case 19:return Vs("SuspenseList");case 0:case 2:case 15:return t=Bu(t.type,!1),t;case 11:return t=Bu(t.type.render,!1),t;case 1:return t=Bu(t.type,!0),t;default:return""}}function Ac(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case yi:return"Fragment";case gi:return"Portal";case xc:return"Profiler";case Kd:return"StrictMode";case Sc:return"Suspense";case Cc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _y:return(t.displayName||"Context")+".Consumer";case vy:return(t._context.displayName||"Context")+".Provider";case Gd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Qd:return e=t.displayName||null,e!==null?e:Ac(t.type)||"Memo";case Xn:e=t._payload,t=t._init;try{return Ac(t(e))}catch{}}return null}function b0(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ac(e);case 8:return e===Kd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function wy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function x0(t){var e=wy(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fa(t){t._valueTracker||(t._valueTracker=x0(t))}function Iy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=wy(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function tl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Pc(t,e){var n=e.checked;return Ce({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Mm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=vr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ty(t,e){e=e.checked,e!=null&&qd(t,"checked",e,!1)}function kc(t,e){Ty(t,e);var n=vr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Rc(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rc(t,e.type,vr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Fm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Rc(t,e,n){(e!=="number"||tl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Os=Array.isArray;function Ai(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+vr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Nc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return Ce({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Um(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(j(92));if(Os(n)){if(1<n.length)throw Error(j(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:vr(n)}}function by(t,e){var n=vr(e.value),r=vr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Bm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function xy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?xy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ma,Sy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ma=ma||document.createElement("div"),ma.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ma.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function io(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var zs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},S0=["Webkit","ms","Moz","O"];Object.keys(zs).forEach(function(t){S0.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),zs[e]=zs[t]})});function Cy(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||zs.hasOwnProperty(t)&&zs[t]?(""+e).trim():e+"px"}function Ay(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Cy(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var C0=Ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vc(t,e){if(e){if(C0[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function Oc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lc=null;function Xd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Mc=null,Pi=null,ki=null;function jm(t){if(t=Vo(t)){if(typeof Mc!="function")throw Error(j(280));var e=t.stateNode;e&&(e=ql(e),Mc(t.stateNode,t.type,e))}}function Py(t){Pi?ki?ki.push(t):ki=[t]:Pi=t}function ky(){if(Pi){var t=Pi,e=ki;if(ki=Pi=null,jm(t),e)for(t=0;t<e.length;t++)jm(e[t])}}function Ry(t,e){return t(e)}function Ny(){}var ju=!1;function Dy(t,e,n){if(ju)return t(e,n);ju=!0;try{return Ry(t,e,n)}finally{ju=!1,(Pi!==null||ki!==null)&&(Ny(),ky())}}function so(t,e){var n=t.stateNode;if(n===null)return null;var r=ql(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(j(231,e,typeof n));return n}var Fc=!1;if(Vn)try{var Ss={};Object.defineProperty(Ss,"passive",{get:function(){Fc=!0}}),window.addEventListener("test",Ss,Ss),window.removeEventListener("test",Ss,Ss)}catch{Fc=!1}function A0(t,e,n,r,i,s,o,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(m){this.onError(m)}}var $s=!1,nl=null,rl=!1,Uc=null,P0={onError:function(t){$s=!0,nl=t}};function k0(t,e,n,r,i,s,o,l,u){$s=!1,nl=null,A0.apply(P0,arguments)}function R0(t,e,n,r,i,s,o,l,u){if(k0.apply(this,arguments),$s){if($s){var c=nl;$s=!1,nl=null}else throw Error(j(198));rl||(rl=!0,Uc=c)}}function ni(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Vy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zm(t){if(ni(t)!==t)throw Error(j(188))}function N0(t){var e=t.alternate;if(!e){if(e=ni(t),e===null)throw Error(j(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return zm(i),t;if(s===r)return zm(i),e;s=s.sibling}throw Error(j(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(j(189))}}if(n.alternate!==r)throw Error(j(190))}if(n.tag!==3)throw Error(j(188));return n.stateNode.current===n?t:e}function Oy(t){return t=N0(t),t!==null?Ly(t):null}function Ly(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ly(t);if(e!==null)return e;t=t.sibling}return null}var My=Vt.unstable_scheduleCallback,$m=Vt.unstable_cancelCallback,D0=Vt.unstable_shouldYield,V0=Vt.unstable_requestPaint,Ve=Vt.unstable_now,O0=Vt.unstable_getCurrentPriorityLevel,Yd=Vt.unstable_ImmediatePriority,Fy=Vt.unstable_UserBlockingPriority,il=Vt.unstable_NormalPriority,L0=Vt.unstable_LowPriority,Uy=Vt.unstable_IdlePriority,zl=null,hn=null;function M0(t){if(hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(zl,t,void 0,(t.current.flags&128)===128)}catch{}}var Zt=Math.clz32?Math.clz32:B0,F0=Math.log,U0=Math.LN2;function B0(t){return t>>>=0,t===0?32:31-(F0(t)/U0|0)|0}var pa=64,ga=4194304;function Ls(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function sl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=Ls(l):(s&=o,s!==0&&(r=Ls(s)))}else o=n&~i,o!==0?r=Ls(o):s!==0&&(r=Ls(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Zt(e),i=1<<n,r|=t[n],e&=~i;return r}function j0(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z0(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Zt(s),l=1<<o,u=i[o];u===-1?(!(l&n)||l&r)&&(i[o]=j0(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function Bc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function By(){var t=pa;return pa<<=1,!(pa&4194240)&&(pa=64),t}function zu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function No(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Zt(e),t[e]=n}function $0(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Zt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Jd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Zt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var me=0;function jy(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var zy,Zd,$y,Hy,Wy,jc=!1,ya=[],or=null,ar=null,lr=null,oo=new Map,ao=new Map,Jn=[],H0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hm(t,e){switch(t){case"focusin":case"focusout":or=null;break;case"dragenter":case"dragleave":ar=null;break;case"mouseover":case"mouseout":lr=null;break;case"pointerover":case"pointerout":oo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ao.delete(e.pointerId)}}function Cs(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Vo(e),e!==null&&Zd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function W0(t,e,n,r,i){switch(e){case"focusin":return or=Cs(or,t,e,n,r,i),!0;case"dragenter":return ar=Cs(ar,t,e,n,r,i),!0;case"mouseover":return lr=Cs(lr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return oo.set(s,Cs(oo.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ao.set(s,Cs(ao.get(s)||null,t,e,n,r,i)),!0}return!1}function qy(t){var e=Or(t.target);if(e!==null){var n=ni(e);if(n!==null){if(e=n.tag,e===13){if(e=Vy(n),e!==null){t.blockedOn=e,Wy(t.priority,function(){$y(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Oa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=zc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Lc=r,n.target.dispatchEvent(r),Lc=null}else return e=Vo(n),e!==null&&Zd(e),t.blockedOn=n,!1;e.shift()}return!0}function Wm(t,e,n){Oa(t)&&n.delete(e)}function q0(){jc=!1,or!==null&&Oa(or)&&(or=null),ar!==null&&Oa(ar)&&(ar=null),lr!==null&&Oa(lr)&&(lr=null),oo.forEach(Wm),ao.forEach(Wm)}function As(t,e){t.blockedOn===e&&(t.blockedOn=null,jc||(jc=!0,Vt.unstable_scheduleCallback(Vt.unstable_NormalPriority,q0)))}function lo(t){function e(i){return As(i,t)}if(0<ya.length){As(ya[0],t);for(var n=1;n<ya.length;n++){var r=ya[n];r.blockedOn===t&&(r.blockedOn=null)}}for(or!==null&&As(or,t),ar!==null&&As(ar,t),lr!==null&&As(lr,t),oo.forEach(e),ao.forEach(e),n=0;n<Jn.length;n++)r=Jn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jn.length&&(n=Jn[0],n.blockedOn===null);)qy(n),n.blockedOn===null&&Jn.shift()}var Ri=zn.ReactCurrentBatchConfig,ol=!0;function K0(t,e,n,r){var i=me,s=Ri.transition;Ri.transition=null;try{me=1,eh(t,e,n,r)}finally{me=i,Ri.transition=s}}function G0(t,e,n,r){var i=me,s=Ri.transition;Ri.transition=null;try{me=4,eh(t,e,n,r)}finally{me=i,Ri.transition=s}}function eh(t,e,n,r){if(ol){var i=zc(t,e,n,r);if(i===null)Ju(t,e,r,al,n),Hm(t,r);else if(W0(i,t,e,n,r))r.stopPropagation();else if(Hm(t,r),e&4&&-1<H0.indexOf(t)){for(;i!==null;){var s=Vo(i);if(s!==null&&zy(s),s=zc(t,e,n,r),s===null&&Ju(t,e,r,al,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ju(t,e,r,null,n)}}var al=null;function zc(t,e,n,r){if(al=null,t=Xd(r),t=Or(t),t!==null)if(e=ni(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Vy(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return al=t,null}function Ky(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(O0()){case Yd:return 1;case Fy:return 4;case il:case L0:return 16;case Uy:return 536870912;default:return 16}default:return 16}}var rr=null,th=null,La=null;function Gy(){if(La)return La;var t,e=th,n=e.length,r,i="value"in rr?rr.value:rr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return La=i.slice(t,1<r?1-r:void 0)}function Ma(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function va(){return!0}function qm(){return!1}function Lt(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?va:qm,this.isPropagationStopped=qm,this}return Ce(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=va)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=va)},persist:function(){},isPersistent:va}),e}var ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nh=Lt(ts),Do=Ce({},ts,{view:0,detail:0}),Q0=Lt(Do),$u,Hu,Ps,$l=Ce({},Do,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ps&&(Ps&&t.type==="mousemove"?($u=t.screenX-Ps.screenX,Hu=t.screenY-Ps.screenY):Hu=$u=0,Ps=t),$u)},movementY:function(t){return"movementY"in t?t.movementY:Hu}}),Km=Lt($l),X0=Ce({},$l,{dataTransfer:0}),Y0=Lt(X0),J0=Ce({},Do,{relatedTarget:0}),Wu=Lt(J0),Z0=Ce({},ts,{animationName:0,elapsedTime:0,pseudoElement:0}),eI=Lt(Z0),tI=Ce({},ts,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nI=Lt(tI),rI=Ce({},ts,{data:0}),Gm=Lt(rI),iI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=oI[t])?!!e[t]:!1}function rh(){return aI}var lI=Ce({},Do,{key:function(t){if(t.key){var e=iI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ma(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?sI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rh,charCode:function(t){return t.type==="keypress"?Ma(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ma(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uI=Lt(lI),cI=Ce({},$l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qm=Lt(cI),dI=Ce({},Do,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rh}),hI=Lt(dI),fI=Ce({},ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),mI=Lt(fI),pI=Ce({},$l,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),gI=Lt(pI),yI=[9,13,27,32],ih=Vn&&"CompositionEvent"in window,Hs=null;Vn&&"documentMode"in document&&(Hs=document.documentMode);var vI=Vn&&"TextEvent"in window&&!Hs,Qy=Vn&&(!ih||Hs&&8<Hs&&11>=Hs),Xm=" ",Ym=!1;function Xy(t,e){switch(t){case"keyup":return yI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vi=!1;function _I(t,e){switch(t){case"compositionend":return Yy(e);case"keypress":return e.which!==32?null:(Ym=!0,Xm);case"textInput":return t=e.data,t===Xm&&Ym?null:t;default:return null}}function EI(t,e){if(vi)return t==="compositionend"||!ih&&Xy(t,e)?(t=Gy(),La=th=rr=null,vi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Qy&&e.locale!=="ko"?null:e.data;default:return null}}var wI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!wI[t.type]:e==="textarea"}function Jy(t,e,n,r){Py(r),e=ll(e,"onChange"),0<e.length&&(n=new nh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ws=null,uo=null;function II(t){uv(t,0)}function Hl(t){var e=wi(t);if(Iy(e))return t}function TI(t,e){if(t==="change")return e}var Zy=!1;if(Vn){var qu;if(Vn){var Ku="oninput"in document;if(!Ku){var Zm=document.createElement("div");Zm.setAttribute("oninput","return;"),Ku=typeof Zm.oninput=="function"}qu=Ku}else qu=!1;Zy=qu&&(!document.documentMode||9<document.documentMode)}function ep(){Ws&&(Ws.detachEvent("onpropertychange",ev),uo=Ws=null)}function ev(t){if(t.propertyName==="value"&&Hl(uo)){var e=[];Jy(e,uo,t,Xd(t)),Dy(II,e)}}function bI(t,e,n){t==="focusin"?(ep(),Ws=e,uo=n,Ws.attachEvent("onpropertychange",ev)):t==="focusout"&&ep()}function xI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Hl(uo)}function SI(t,e){if(t==="click")return Hl(e)}function CI(t,e){if(t==="input"||t==="change")return Hl(e)}function AI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var rn=typeof Object.is=="function"?Object.is:AI;function co(t,e){if(rn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!bc.call(e,i)||!rn(t[i],e[i]))return!1}return!0}function tp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function np(t,e){var n=tp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tp(n)}}function tv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?tv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function nv(){for(var t=window,e=tl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=tl(t.document)}return e}function sh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function PI(t){var e=nv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&tv(n.ownerDocument.documentElement,n)){if(r!==null&&sh(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=np(n,s);var o=np(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var kI=Vn&&"documentMode"in document&&11>=document.documentMode,_i=null,$c=null,qs=null,Hc=!1;function rp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Hc||_i==null||_i!==tl(r)||(r=_i,"selectionStart"in r&&sh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),qs&&co(qs,r)||(qs=r,r=ll($c,"onSelect"),0<r.length&&(e=new nh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_i)))}function _a(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ei={animationend:_a("Animation","AnimationEnd"),animationiteration:_a("Animation","AnimationIteration"),animationstart:_a("Animation","AnimationStart"),transitionend:_a("Transition","TransitionEnd")},Gu={},rv={};Vn&&(rv=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);function Wl(t){if(Gu[t])return Gu[t];if(!Ei[t])return t;var e=Ei[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rv)return Gu[t]=e[n];return t}var iv=Wl("animationend"),sv=Wl("animationiteration"),ov=Wl("animationstart"),av=Wl("transitionend"),lv=new Map,ip="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function br(t,e){lv.set(t,e),ti(e,[t])}for(var Qu=0;Qu<ip.length;Qu++){var Xu=ip[Qu],RI=Xu.toLowerCase(),NI=Xu[0].toUpperCase()+Xu.slice(1);br(RI,"on"+NI)}br(iv,"onAnimationEnd");br(sv,"onAnimationIteration");br(ov,"onAnimationStart");br("dblclick","onDoubleClick");br("focusin","onFocus");br("focusout","onBlur");br(av,"onTransitionEnd");Fi("onMouseEnter",["mouseout","mouseover"]);Fi("onMouseLeave",["mouseout","mouseover"]);Fi("onPointerEnter",["pointerout","pointerover"]);Fi("onPointerLeave",["pointerout","pointerover"]);ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ti("onBeforeInput",["compositionend","keypress","textInput","paste"]);ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ms));function sp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,R0(r,e,void 0,t),t.currentTarget=null}function uv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;sp(i,l,c),s=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,c=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;sp(i,l,c),s=u}}}if(rl)throw t=Uc,rl=!1,Uc=null,t}function Ee(t,e){var n=e[Qc];n===void 0&&(n=e[Qc]=new Set);var r=t+"__bubble";n.has(r)||(cv(e,t,2,!1),n.add(r))}function Yu(t,e,n){var r=0;e&&(r|=4),cv(n,t,r,e)}var Ea="_reactListening"+Math.random().toString(36).slice(2);function ho(t){if(!t[Ea]){t[Ea]=!0,yy.forEach(function(n){n!=="selectionchange"&&(DI.has(n)||Yu(n,!1,t),Yu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ea]||(e[Ea]=!0,Yu("selectionchange",!1,e))}}function cv(t,e,n,r){switch(Ky(e)){case 1:var i=K0;break;case 4:i=G0;break;default:i=eh}n=i.bind(null,e,n,t),i=void 0,!Fc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ju(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Or(l),o===null)return;if(u=o.tag,u===5||u===6){r=s=o;continue e}l=l.parentNode}}r=r.return}Dy(function(){var c=s,m=Xd(n),p=[];e:{var g=lv.get(t);if(g!==void 0){var x=nh,N=t;switch(t){case"keypress":if(Ma(n)===0)break e;case"keydown":case"keyup":x=uI;break;case"focusin":N="focus",x=Wu;break;case"focusout":N="blur",x=Wu;break;case"beforeblur":case"afterblur":x=Wu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Km;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=Y0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=hI;break;case iv:case sv:case ov:x=eI;break;case av:x=mI;break;case"scroll":x=Q0;break;case"wheel":x=gI;break;case"copy":case"cut":case"paste":x=nI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Qm}var C=(e&4)!==0,D=!C&&t==="scroll",I=C?g!==null?g+"Capture":null:g;C=[];for(var w=c,S;w!==null;){S=w;var P=S.stateNode;if(S.tag===5&&P!==null&&(S=P,I!==null&&(P=so(w,I),P!=null&&C.push(fo(w,P,S)))),D)break;w=w.return}0<C.length&&(g=new x(g,N,null,n,m),p.push({event:g,listeners:C}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",g&&n!==Lc&&(N=n.relatedTarget||n.fromElement)&&(Or(N)||N[On]))break e;if((x||g)&&(g=m.window===m?m:(g=m.ownerDocument)?g.defaultView||g.parentWindow:window,x?(N=n.relatedTarget||n.toElement,x=c,N=N?Or(N):null,N!==null&&(D=ni(N),N!==D||N.tag!==5&&N.tag!==6)&&(N=null)):(x=null,N=c),x!==N)){if(C=Km,P="onMouseLeave",I="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(C=Qm,P="onPointerLeave",I="onPointerEnter",w="pointer"),D=x==null?g:wi(x),S=N==null?g:wi(N),g=new C(P,w+"leave",x,n,m),g.target=D,g.relatedTarget=S,P=null,Or(m)===c&&(C=new C(I,w+"enter",N,n,m),C.target=S,C.relatedTarget=D,P=C),D=P,x&&N)t:{for(C=x,I=N,w=0,S=C;S;S=hi(S))w++;for(S=0,P=I;P;P=hi(P))S++;for(;0<w-S;)C=hi(C),w--;for(;0<S-w;)I=hi(I),S--;for(;w--;){if(C===I||I!==null&&C===I.alternate)break t;C=hi(C),I=hi(I)}C=null}else C=null;x!==null&&op(p,g,x,C,!1),N!==null&&D!==null&&op(p,D,N,C,!0)}}e:{if(g=c?wi(c):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var R=TI;else if(Jm(g))if(Zy)R=CI;else{R=xI;var V=bI}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(R=SI);if(R&&(R=R(t,c))){Jy(p,R,n,m);break e}V&&V(t,g,c),t==="focusout"&&(V=g._wrapperState)&&V.controlled&&g.type==="number"&&Rc(g,"number",g.value)}switch(V=c?wi(c):window,t){case"focusin":(Jm(V)||V.contentEditable==="true")&&(_i=V,$c=c,qs=null);break;case"focusout":qs=$c=_i=null;break;case"mousedown":Hc=!0;break;case"contextmenu":case"mouseup":case"dragend":Hc=!1,rp(p,n,m);break;case"selectionchange":if(kI)break;case"keydown":case"keyup":rp(p,n,m)}var v;if(ih)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else vi?Xy(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(Qy&&n.locale!=="ko"&&(vi||y!=="onCompositionStart"?y==="onCompositionEnd"&&vi&&(v=Gy()):(rr=m,th="value"in rr?rr.value:rr.textContent,vi=!0)),V=ll(c,y),0<V.length&&(y=new Gm(y,t,null,n,m),p.push({event:y,listeners:V}),v?y.data=v:(v=Yy(n),v!==null&&(y.data=v)))),(v=vI?_I(t,n):EI(t,n))&&(c=ll(c,"onBeforeInput"),0<c.length&&(m=new Gm("onBeforeInput","beforeinput",null,n,m),p.push({event:m,listeners:c}),m.data=v))}uv(p,e)})}function fo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ll(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=so(t,n),s!=null&&r.unshift(fo(t,s,i)),s=so(t,e),s!=null&&r.push(fo(t,s,i))),t=t.return}return r}function hi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function op(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,i?(u=so(n,s),u!=null&&o.unshift(fo(n,u,l))):i||(u=so(n,s),u!=null&&o.push(fo(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var VI=/\r\n?/g,OI=/\u0000|\uFFFD/g;function ap(t){return(typeof t=="string"?t:""+t).replace(VI,`
`).replace(OI,"")}function wa(t,e,n){if(e=ap(e),ap(t)!==e&&n)throw Error(j(425))}function ul(){}var Wc=null,qc=null;function Kc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Gc=typeof setTimeout=="function"?setTimeout:void 0,LI=typeof clearTimeout=="function"?clearTimeout:void 0,lp=typeof Promise=="function"?Promise:void 0,MI=typeof queueMicrotask=="function"?queueMicrotask:typeof lp<"u"?function(t){return lp.resolve(null).then(t).catch(FI)}:Gc;function FI(t){setTimeout(function(){throw t})}function Zu(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),lo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);lo(e)}function ur(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function up(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ns=Math.random().toString(36).slice(2),dn="__reactFiber$"+ns,mo="__reactProps$"+ns,On="__reactContainer$"+ns,Qc="__reactEvents$"+ns,UI="__reactListeners$"+ns,BI="__reactHandles$"+ns;function Or(t){var e=t[dn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[On]||n[dn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=up(t);t!==null;){if(n=t[dn])return n;t=up(t)}return e}t=n,n=t.parentNode}return null}function Vo(t){return t=t[dn]||t[On],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(j(33))}function ql(t){return t[mo]||null}var Xc=[],Ii=-1;function xr(t){return{current:t}}function Ie(t){0>Ii||(t.current=Xc[Ii],Xc[Ii]=null,Ii--)}function ye(t,e){Ii++,Xc[Ii]=t.current,t.current=e}var _r={},ft=xr(_r),xt=xr(!1),Wr=_r;function Ui(t,e){var n=t.type.contextTypes;if(!n)return _r;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function St(t){return t=t.childContextTypes,t!=null}function cl(){Ie(xt),Ie(ft)}function cp(t,e,n){if(ft.current!==_r)throw Error(j(168));ye(ft,e),ye(xt,n)}function dv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(j(108,b0(t)||"Unknown",i));return Ce({},n,r)}function dl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_r,Wr=ft.current,ye(ft,t),ye(xt,xt.current),!0}function dp(t,e,n){var r=t.stateNode;if(!r)throw Error(j(169));n?(t=dv(t,e,Wr),r.__reactInternalMemoizedMergedChildContext=t,Ie(xt),Ie(ft),ye(ft,t)):Ie(xt),ye(xt,n)}var bn=null,Kl=!1,ec=!1;function hv(t){bn===null?bn=[t]:bn.push(t)}function jI(t){Kl=!0,hv(t)}function Sr(){if(!ec&&bn!==null){ec=!0;var t=0,e=me;try{var n=bn;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}bn=null,Kl=!1}catch(i){throw bn!==null&&(bn=bn.slice(t+1)),My(Yd,Sr),i}finally{me=e,ec=!1}}return null}var Ti=[],bi=0,hl=null,fl=0,Mt=[],Ft=0,qr=null,Sn=1,Cn="";function Nr(t,e){Ti[bi++]=fl,Ti[bi++]=hl,hl=t,fl=e}function fv(t,e,n){Mt[Ft++]=Sn,Mt[Ft++]=Cn,Mt[Ft++]=qr,qr=t;var r=Sn;t=Cn;var i=32-Zt(r)-1;r&=~(1<<i),n+=1;var s=32-Zt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Sn=1<<32-Zt(e)+i|n<<i|r,Cn=s+t}else Sn=1<<s|n<<i|r,Cn=t}function oh(t){t.return!==null&&(Nr(t,1),fv(t,1,0))}function ah(t){for(;t===hl;)hl=Ti[--bi],Ti[bi]=null,fl=Ti[--bi],Ti[bi]=null;for(;t===qr;)qr=Mt[--Ft],Mt[Ft]=null,Cn=Mt[--Ft],Mt[Ft]=null,Sn=Mt[--Ft],Mt[Ft]=null}var Dt=null,Nt=null,Te=!1,Yt=null;function mv(t,e){var n=Bt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function hp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Dt=t,Nt=ur(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Dt=t,Nt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qr!==null?{id:Sn,overflow:Cn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Bt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Dt=t,Nt=null,!0):!1;default:return!1}}function Yc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Jc(t){if(Te){var e=Nt;if(e){var n=e;if(!hp(t,e)){if(Yc(t))throw Error(j(418));e=ur(n.nextSibling);var r=Dt;e&&hp(t,e)?mv(r,n):(t.flags=t.flags&-4097|2,Te=!1,Dt=t)}}else{if(Yc(t))throw Error(j(418));t.flags=t.flags&-4097|2,Te=!1,Dt=t}}}function fp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Dt=t}function Ia(t){if(t!==Dt)return!1;if(!Te)return fp(t),Te=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Kc(t.type,t.memoizedProps)),e&&(e=Nt)){if(Yc(t))throw pv(),Error(j(418));for(;e;)mv(t,e),e=ur(e.nextSibling)}if(fp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(j(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Nt=ur(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Nt=null}}else Nt=Dt?ur(t.stateNode.nextSibling):null;return!0}function pv(){for(var t=Nt;t;)t=ur(t.nextSibling)}function Bi(){Nt=Dt=null,Te=!1}function lh(t){Yt===null?Yt=[t]:Yt.push(t)}var zI=zn.ReactCurrentBatchConfig;function ks(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(j(309));var r=n.stateNode}if(!r)throw Error(j(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(j(284));if(!n._owner)throw Error(j(290,t))}return t}function Ta(t,e){throw t=Object.prototype.toString.call(e),Error(j(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function mp(t){var e=t._init;return e(t._payload)}function gv(t){function e(I,w){if(t){var S=I.deletions;S===null?(I.deletions=[w],I.flags|=16):S.push(w)}}function n(I,w){if(!t)return null;for(;w!==null;)e(I,w),w=w.sibling;return null}function r(I,w){for(I=new Map;w!==null;)w.key!==null?I.set(w.key,w):I.set(w.index,w),w=w.sibling;return I}function i(I,w){return I=fr(I,w),I.index=0,I.sibling=null,I}function s(I,w,S){return I.index=S,t?(S=I.alternate,S!==null?(S=S.index,S<w?(I.flags|=2,w):S):(I.flags|=2,w)):(I.flags|=1048576,w)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function l(I,w,S,P){return w===null||w.tag!==6?(w=ac(S,I.mode,P),w.return=I,w):(w=i(w,S),w.return=I,w)}function u(I,w,S,P){var R=S.type;return R===yi?m(I,w,S.props.children,P,S.key):w!==null&&(w.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Xn&&mp(R)===w.type)?(P=i(w,S.props),P.ref=ks(I,w,S),P.return=I,P):(P=Ha(S.type,S.key,S.props,null,I.mode,P),P.ref=ks(I,w,S),P.return=I,P)}function c(I,w,S,P){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=lc(S,I.mode,P),w.return=I,w):(w=i(w,S.children||[]),w.return=I,w)}function m(I,w,S,P,R){return w===null||w.tag!==7?(w=jr(S,I.mode,P,R),w.return=I,w):(w=i(w,S),w.return=I,w)}function p(I,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return w=ac(""+w,I.mode,S),w.return=I,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ha:return S=Ha(w.type,w.key,w.props,null,I.mode,S),S.ref=ks(I,null,w),S.return=I,S;case gi:return w=lc(w,I.mode,S),w.return=I,w;case Xn:var P=w._init;return p(I,P(w._payload),S)}if(Os(w)||xs(w))return w=jr(w,I.mode,S,null),w.return=I,w;Ta(I,w)}return null}function g(I,w,S,P){var R=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return R!==null?null:l(I,w,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ha:return S.key===R?u(I,w,S,P):null;case gi:return S.key===R?c(I,w,S,P):null;case Xn:return R=S._init,g(I,w,R(S._payload),P)}if(Os(S)||xs(S))return R!==null?null:m(I,w,S,P,null);Ta(I,S)}return null}function x(I,w,S,P,R){if(typeof P=="string"&&P!==""||typeof P=="number")return I=I.get(S)||null,l(w,I,""+P,R);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case ha:return I=I.get(P.key===null?S:P.key)||null,u(w,I,P,R);case gi:return I=I.get(P.key===null?S:P.key)||null,c(w,I,P,R);case Xn:var V=P._init;return x(I,w,S,V(P._payload),R)}if(Os(P)||xs(P))return I=I.get(S)||null,m(w,I,P,R,null);Ta(w,P)}return null}function N(I,w,S,P){for(var R=null,V=null,v=w,y=w=0,T=null;v!==null&&y<S.length;y++){v.index>y?(T=v,v=null):T=v.sibling;var A=g(I,v,S[y],P);if(A===null){v===null&&(v=T);break}t&&v&&A.alternate===null&&e(I,v),w=s(A,w,y),V===null?R=A:V.sibling=A,V=A,v=T}if(y===S.length)return n(I,v),Te&&Nr(I,y),R;if(v===null){for(;y<S.length;y++)v=p(I,S[y],P),v!==null&&(w=s(v,w,y),V===null?R=v:V.sibling=v,V=v);return Te&&Nr(I,y),R}for(v=r(I,v);y<S.length;y++)T=x(v,I,y,S[y],P),T!==null&&(t&&T.alternate!==null&&v.delete(T.key===null?y:T.key),w=s(T,w,y),V===null?R=T:V.sibling=T,V=T);return t&&v.forEach(function(_){return e(I,_)}),Te&&Nr(I,y),R}function C(I,w,S,P){var R=xs(S);if(typeof R!="function")throw Error(j(150));if(S=R.call(S),S==null)throw Error(j(151));for(var V=R=null,v=w,y=w=0,T=null,A=S.next();v!==null&&!A.done;y++,A=S.next()){v.index>y?(T=v,v=null):T=v.sibling;var _=g(I,v,A.value,P);if(_===null){v===null&&(v=T);break}t&&v&&_.alternate===null&&e(I,v),w=s(_,w,y),V===null?R=_:V.sibling=_,V=_,v=T}if(A.done)return n(I,v),Te&&Nr(I,y),R;if(v===null){for(;!A.done;y++,A=S.next())A=p(I,A.value,P),A!==null&&(w=s(A,w,y),V===null?R=A:V.sibling=A,V=A);return Te&&Nr(I,y),R}for(v=r(I,v);!A.done;y++,A=S.next())A=x(v,I,y,A.value,P),A!==null&&(t&&A.alternate!==null&&v.delete(A.key===null?y:A.key),w=s(A,w,y),V===null?R=A:V.sibling=A,V=A);return t&&v.forEach(function(k){return e(I,k)}),Te&&Nr(I,y),R}function D(I,w,S,P){if(typeof S=="object"&&S!==null&&S.type===yi&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case ha:e:{for(var R=S.key,V=w;V!==null;){if(V.key===R){if(R=S.type,R===yi){if(V.tag===7){n(I,V.sibling),w=i(V,S.props.children),w.return=I,I=w;break e}}else if(V.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Xn&&mp(R)===V.type){n(I,V.sibling),w=i(V,S.props),w.ref=ks(I,V,S),w.return=I,I=w;break e}n(I,V);break}else e(I,V);V=V.sibling}S.type===yi?(w=jr(S.props.children,I.mode,P,S.key),w.return=I,I=w):(P=Ha(S.type,S.key,S.props,null,I.mode,P),P.ref=ks(I,w,S),P.return=I,I=P)}return o(I);case gi:e:{for(V=S.key;w!==null;){if(w.key===V)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){n(I,w.sibling),w=i(w,S.children||[]),w.return=I,I=w;break e}else{n(I,w);break}else e(I,w);w=w.sibling}w=lc(S,I.mode,P),w.return=I,I=w}return o(I);case Xn:return V=S._init,D(I,w,V(S._payload),P)}if(Os(S))return N(I,w,S,P);if(xs(S))return C(I,w,S,P);Ta(I,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,w!==null&&w.tag===6?(n(I,w.sibling),w=i(w,S),w.return=I,I=w):(n(I,w),w=ac(S,I.mode,P),w.return=I,I=w),o(I)):n(I,w)}return D}var ji=gv(!0),yv=gv(!1),ml=xr(null),pl=null,xi=null,uh=null;function ch(){uh=xi=pl=null}function dh(t){var e=ml.current;Ie(ml),t._currentValue=e}function Zc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ni(t,e){pl=t,uh=xi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(bt=!0),t.firstContext=null)}function $t(t){var e=t._currentValue;if(uh!==t)if(t={context:t,memoizedValue:e,next:null},xi===null){if(pl===null)throw Error(j(308));xi=t,pl.dependencies={lanes:0,firstContext:t}}else xi=xi.next=t;return e}var Lr=null;function hh(t){Lr===null?Lr=[t]:Lr.push(t)}function vv(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,hh(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ln(t,r)}function Ln(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Yn=!1;function fh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _v(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Nn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function cr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ce&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ln(t,n)}return i=r.interleaved,i===null?(e.next=e,hh(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ln(t,n)}function Fa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Jd(t,n)}}function pp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function gl(t,e,n,r){var i=t.updateQueue;Yn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,c=u.next;u.next=null,o===null?s=c:o.next=c,o=u;var m=t.alternate;m!==null&&(m=m.updateQueue,l=m.lastBaseUpdate,l!==o&&(l===null?m.firstBaseUpdate=c:l.next=c,m.lastBaseUpdate=u))}if(s!==null){var p=i.baseState;o=0,m=c=u=null,l=s;do{var g=l.lane,x=l.eventTime;if((r&g)===g){m!==null&&(m=m.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var N=t,C=l;switch(g=e,x=n,C.tag){case 1:if(N=C.payload,typeof N=="function"){p=N.call(x,p,g);break e}p=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=C.payload,g=typeof N=="function"?N.call(x,p,g):N,g==null)break e;p=Ce({},p,g);break e;case 2:Yn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[l]:g.push(l))}else x={eventTime:x,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},m===null?(c=m=x,u=p):m=m.next=x,o|=g;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;g=l,l=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(m===null&&(u=p),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=m,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Gr|=o,t.lanes=o,t.memoizedState=p}}function gp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(j(191,i));i.call(r)}}}var Oo={},fn=xr(Oo),po=xr(Oo),go=xr(Oo);function Mr(t){if(t===Oo)throw Error(j(174));return t}function mh(t,e){switch(ye(go,e),ye(po,t),ye(fn,Oo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Dc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Dc(e,t)}Ie(fn),ye(fn,e)}function zi(){Ie(fn),Ie(po),Ie(go)}function Ev(t){Mr(go.current);var e=Mr(fn.current),n=Dc(e,t.type);e!==n&&(ye(po,t),ye(fn,n))}function ph(t){po.current===t&&(Ie(fn),Ie(po))}var xe=xr(0);function yl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tc=[];function gh(){for(var t=0;t<tc.length;t++)tc[t]._workInProgressVersionPrimary=null;tc.length=0}var Ua=zn.ReactCurrentDispatcher,nc=zn.ReactCurrentBatchConfig,Kr=0,Se=null,je=null,qe=null,vl=!1,Ks=!1,yo=0,$I=0;function ot(){throw Error(j(321))}function yh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!rn(t[n],e[n]))return!1;return!0}function vh(t,e,n,r,i,s){if(Kr=s,Se=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ua.current=t===null||t.memoizedState===null?KI:GI,t=n(r,i),Ks){s=0;do{if(Ks=!1,yo=0,25<=s)throw Error(j(301));s+=1,qe=je=null,e.updateQueue=null,Ua.current=QI,t=n(r,i)}while(Ks)}if(Ua.current=_l,e=je!==null&&je.next!==null,Kr=0,qe=je=Se=null,vl=!1,e)throw Error(j(300));return t}function _h(){var t=yo!==0;return yo=0,t}function cn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?Se.memoizedState=qe=t:qe=qe.next=t,qe}function Ht(){if(je===null){var t=Se.alternate;t=t!==null?t.memoizedState:null}else t=je.next;var e=qe===null?Se.memoizedState:qe.next;if(e!==null)qe=e,je=t;else{if(t===null)throw Error(j(310));je=t,t={memoizedState:je.memoizedState,baseState:je.baseState,baseQueue:je.baseQueue,queue:je.queue,next:null},qe===null?Se.memoizedState=qe=t:qe=qe.next=t}return qe}function vo(t,e){return typeof e=="function"?e(t):e}function rc(t){var e=Ht(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var r=je,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,u=null,c=s;do{var m=c.lane;if((Kr&m)===m)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var p={lane:m,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=p,o=r):u=u.next=p,Se.lanes|=m,Gr|=m}c=c.next}while(c!==null&&c!==s);u===null?o=r:u.next=l,rn(r,e.memoizedState)||(bt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Se.lanes|=s,Gr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ic(t){var e=Ht(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);rn(s,e.memoizedState)||(bt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function wv(){}function Iv(t,e){var n=Se,r=Ht(),i=e(),s=!rn(r.memoizedState,i);if(s&&(r.memoizedState=i,bt=!0),r=r.queue,Eh(xv.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||qe!==null&&qe.memoizedState.tag&1){if(n.flags|=2048,_o(9,bv.bind(null,n,r,i,e),void 0,null),Ke===null)throw Error(j(349));Kr&30||Tv(n,e,i)}return i}function Tv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function bv(t,e,n,r){e.value=n,e.getSnapshot=r,Sv(e)&&Cv(t)}function xv(t,e,n){return n(function(){Sv(e)&&Cv(t)})}function Sv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!rn(t,n)}catch{return!0}}function Cv(t){var e=Ln(t,1);e!==null&&en(e,t,1,-1)}function yp(t){var e=cn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:t},e.queue=t,t=t.dispatch=qI.bind(null,Se,t),[e.memoizedState,t]}function _o(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Av(){return Ht().memoizedState}function Ba(t,e,n,r){var i=cn();Se.flags|=t,i.memoizedState=_o(1|e,n,void 0,r===void 0?null:r)}function Gl(t,e,n,r){var i=Ht();r=r===void 0?null:r;var s=void 0;if(je!==null){var o=je.memoizedState;if(s=o.destroy,r!==null&&yh(r,o.deps)){i.memoizedState=_o(e,n,s,r);return}}Se.flags|=t,i.memoizedState=_o(1|e,n,s,r)}function vp(t,e){return Ba(8390656,8,t,e)}function Eh(t,e){return Gl(2048,8,t,e)}function Pv(t,e){return Gl(4,2,t,e)}function kv(t,e){return Gl(4,4,t,e)}function Rv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Nv(t,e,n){return n=n!=null?n.concat([t]):null,Gl(4,4,Rv.bind(null,e,t),n)}function wh(){}function Dv(t,e){var n=Ht();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&yh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Vv(t,e){var n=Ht();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&yh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ov(t,e,n){return Kr&21?(rn(n,e)||(n=By(),Se.lanes|=n,Gr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,bt=!0),t.memoizedState=n)}function HI(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=nc.transition;nc.transition={};try{t(!1),e()}finally{me=n,nc.transition=r}}function Lv(){return Ht().memoizedState}function WI(t,e,n){var r=hr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Mv(t))Fv(e,n);else if(n=vv(t,e,n,r),n!==null){var i=vt();en(n,t,r,i),Uv(n,e,r)}}function qI(t,e,n){var r=hr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Mv(t))Fv(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,rn(l,o)){var u=e.interleaved;u===null?(i.next=i,hh(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=vv(t,e,i,r),n!==null&&(i=vt(),en(n,t,r,i),Uv(n,e,r))}}function Mv(t){var e=t.alternate;return t===Se||e!==null&&e===Se}function Fv(t,e){Ks=vl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Uv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Jd(t,n)}}var _l={readContext:$t,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useInsertionEffect:ot,useLayoutEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useMutableSource:ot,useSyncExternalStore:ot,useId:ot,unstable_isNewReconciler:!1},KI={readContext:$t,useCallback:function(t,e){return cn().memoizedState=[t,e===void 0?null:e],t},useContext:$t,useEffect:vp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ba(4194308,4,Rv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ba(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ba(4,2,t,e)},useMemo:function(t,e){var n=cn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=cn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=WI.bind(null,Se,t),[r.memoizedState,t]},useRef:function(t){var e=cn();return t={current:t},e.memoizedState=t},useState:yp,useDebugValue:wh,useDeferredValue:function(t){return cn().memoizedState=t},useTransition:function(){var t=yp(!1),e=t[0];return t=HI.bind(null,t[1]),cn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Se,i=cn();if(Te){if(n===void 0)throw Error(j(407));n=n()}else{if(n=e(),Ke===null)throw Error(j(349));Kr&30||Tv(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,vp(xv.bind(null,r,s,t),[t]),r.flags|=2048,_o(9,bv.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=cn(),e=Ke.identifierPrefix;if(Te){var n=Cn,r=Sn;n=(r&~(1<<32-Zt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=yo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=$I++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},GI={readContext:$t,useCallback:Dv,useContext:$t,useEffect:Eh,useImperativeHandle:Nv,useInsertionEffect:Pv,useLayoutEffect:kv,useMemo:Vv,useReducer:rc,useRef:Av,useState:function(){return rc(vo)},useDebugValue:wh,useDeferredValue:function(t){var e=Ht();return Ov(e,je.memoizedState,t)},useTransition:function(){var t=rc(vo)[0],e=Ht().memoizedState;return[t,e]},useMutableSource:wv,useSyncExternalStore:Iv,useId:Lv,unstable_isNewReconciler:!1},QI={readContext:$t,useCallback:Dv,useContext:$t,useEffect:Eh,useImperativeHandle:Nv,useInsertionEffect:Pv,useLayoutEffect:kv,useMemo:Vv,useReducer:ic,useRef:Av,useState:function(){return ic(vo)},useDebugValue:wh,useDeferredValue:function(t){var e=Ht();return je===null?e.memoizedState=t:Ov(e,je.memoizedState,t)},useTransition:function(){var t=ic(vo)[0],e=Ht().memoizedState;return[t,e]},useMutableSource:wv,useSyncExternalStore:Iv,useId:Lv,unstable_isNewReconciler:!1};function Qt(t,e){if(t&&t.defaultProps){e=Ce({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ed(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ce({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ql={isMounted:function(t){return(t=t._reactInternals)?ni(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=vt(),i=hr(t),s=Nn(r,i);s.payload=e,n!=null&&(s.callback=n),e=cr(t,s,i),e!==null&&(en(e,t,i,r),Fa(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=vt(),i=hr(t),s=Nn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=cr(t,s,i),e!==null&&(en(e,t,i,r),Fa(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vt(),r=hr(t),i=Nn(n,r);i.tag=2,e!=null&&(i.callback=e),e=cr(t,i,r),e!==null&&(en(e,t,r,n),Fa(e,t,r))}};function _p(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!co(n,r)||!co(i,s):!0}function Bv(t,e,n){var r=!1,i=_r,s=e.contextType;return typeof s=="object"&&s!==null?s=$t(s):(i=St(e)?Wr:ft.current,r=e.contextTypes,s=(r=r!=null)?Ui(t,i):_r),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ql,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Ep(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ql.enqueueReplaceState(e,e.state,null)}function td(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},fh(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=$t(s):(s=St(e)?Wr:ft.current,i.context=Ui(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ed(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ql.enqueueReplaceState(i,i.state,null),gl(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function $i(t,e){try{var n="",r=e;do n+=T0(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function sc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function nd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var XI=typeof WeakMap=="function"?WeakMap:Map;function jv(t,e,n){n=Nn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){wl||(wl=!0,hd=r),nd(t,e)},n}function zv(t,e,n){n=Nn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){nd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){nd(t,e),typeof r!="function"&&(dr===null?dr=new Set([this]):dr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function wp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new XI;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=cT.bind(null,t,e,n),e.then(t,t))}function Ip(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Tp(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Nn(-1,1),e.tag=2,cr(n,e,1))),n.lanes|=1),t)}var YI=zn.ReactCurrentOwner,bt=!1;function yt(t,e,n,r){e.child=t===null?yv(e,null,n,r):ji(e,t.child,n,r)}function bp(t,e,n,r,i){n=n.render;var s=e.ref;return Ni(e,i),r=vh(t,e,n,r,s,i),n=_h(),t!==null&&!bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Mn(t,e,i)):(Te&&n&&oh(e),e.flags|=1,yt(t,e,r,i),e.child)}function xp(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Ph(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,$v(t,e,s,r,i)):(t=Ha(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:co,n(o,r)&&t.ref===e.ref)return Mn(t,e,i)}return e.flags|=1,t=fr(s,r),t.ref=e.ref,t.return=e,e.child=t}function $v(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(co(s,r)&&t.ref===e.ref)if(bt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(bt=!0);else return e.lanes=t.lanes,Mn(t,e,i)}return rd(t,e,n,r,i)}function Hv(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ye(Ci,Rt),Rt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ye(Ci,Rt),Rt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ye(Ci,Rt),Rt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ye(Ci,Rt),Rt|=r;return yt(t,e,i,n),e.child}function Wv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function rd(t,e,n,r,i){var s=St(n)?Wr:ft.current;return s=Ui(e,s),Ni(e,i),n=vh(t,e,n,r,s,i),r=_h(),t!==null&&!bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Mn(t,e,i)):(Te&&r&&oh(e),e.flags|=1,yt(t,e,n,i),e.child)}function Sp(t,e,n,r,i){if(St(n)){var s=!0;dl(e)}else s=!1;if(Ni(e,i),e.stateNode===null)ja(t,e),Bv(e,n,r),td(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=$t(c):(c=St(n)?Wr:ft.current,c=Ui(e,c));var m=n.getDerivedStateFromProps,p=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Ep(e,o,r,c),Yn=!1;var g=e.memoizedState;o.state=g,gl(e,r,o,i),u=e.memoizedState,l!==r||g!==u||xt.current||Yn?(typeof m=="function"&&(ed(e,n,m,r),u=e.memoizedState),(l=Yn||_p(e,n,l,r,g,u,c))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,_v(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:Qt(e.type,l),o.props=c,p=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=$t(u):(u=St(n)?Wr:ft.current,u=Ui(e,u));var x=n.getDerivedStateFromProps;(m=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||g!==u)&&Ep(e,o,r,u),Yn=!1,g=e.memoizedState,o.state=g,gl(e,r,o,i);var N=e.memoizedState;l!==p||g!==N||xt.current||Yn?(typeof x=="function"&&(ed(e,n,x,r),N=e.memoizedState),(c=Yn||_p(e,n,c,r,g,N,u)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,N,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,N,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=N),o.props=r,o.state=N,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return id(t,e,n,r,s,i)}function id(t,e,n,r,i,s){Wv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&dp(e,n,!1),Mn(t,e,s);r=e.stateNode,YI.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ji(e,t.child,null,s),e.child=ji(e,null,l,s)):yt(t,e,l,s),e.memoizedState=r.state,i&&dp(e,n,!0),e.child}function qv(t){var e=t.stateNode;e.pendingContext?cp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cp(t,e.context,!1),mh(t,e.containerInfo)}function Cp(t,e,n,r,i){return Bi(),lh(i),e.flags|=256,yt(t,e,n,r),e.child}var sd={dehydrated:null,treeContext:null,retryLane:0};function od(t){return{baseLanes:t,cachePool:null,transitions:null}}function Kv(t,e,n){var r=e.pendingProps,i=xe.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ye(xe,i&1),t===null)return Jc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Jl(o,r,0,null),t=jr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=od(n),e.memoizedState=sd,t):Ih(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return JI(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=fr(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=fr(l,s):(s=jr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?od(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=sd,r}return s=t.child,t=s.sibling,r=fr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ih(t,e){return e=Jl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ba(t,e,n,r){return r!==null&&lh(r),ji(e,t.child,null,n),t=Ih(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function JI(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=sc(Error(j(422))),ba(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Jl({mode:"visible",children:r.children},i,0,null),s=jr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ji(e,t.child,null,o),e.child.memoizedState=od(o),e.memoizedState=sd,s);if(!(e.mode&1))return ba(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(j(419)),r=sc(s,r,void 0),ba(t,e,o,r)}if(l=(o&t.childLanes)!==0,bt||l){if(r=Ke,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ln(t,i),en(r,t,i,-1))}return Ah(),r=sc(Error(j(421))),ba(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=dT.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Nt=ur(i.nextSibling),Dt=e,Te=!0,Yt=null,t!==null&&(Mt[Ft++]=Sn,Mt[Ft++]=Cn,Mt[Ft++]=qr,Sn=t.id,Cn=t.overflow,qr=e),e=Ih(e,r.children),e.flags|=4096,e)}function Ap(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Zc(t.return,e,n)}function oc(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Gv(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(yt(t,e,r.children,n),r=xe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ap(t,n,e);else if(t.tag===19)Ap(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ye(xe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&yl(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),oc(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&yl(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}oc(e,!0,n,null,s);break;case"together":oc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ja(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Mn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(j(153));if(e.child!==null){for(t=e.child,n=fr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=fr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ZI(t,e,n){switch(e.tag){case 3:qv(e),Bi();break;case 5:Ev(e);break;case 1:St(e.type)&&dl(e);break;case 4:mh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ye(ml,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ye(xe,xe.current&1),e.flags|=128,null):n&e.child.childLanes?Kv(t,e,n):(ye(xe,xe.current&1),t=Mn(t,e,n),t!==null?t.sibling:null);ye(xe,xe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Gv(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ye(xe,xe.current),r)break;return null;case 22:case 23:return e.lanes=0,Hv(t,e,n)}return Mn(t,e,n)}var Qv,ad,Xv,Yv;Qv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ad=function(){};Xv=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Mr(fn.current);var s=null;switch(n){case"input":i=Pc(t,i),r=Pc(t,r),s=[];break;case"select":i=Ce({},i,{value:void 0}),r=Ce({},r,{value:void 0}),s=[];break;case"textarea":i=Nc(t,i),r=Nc(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ul)}Vc(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var l=i[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ro.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(l=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ro.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Ee("scroll",t),s||l===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Yv=function(t,e,n,r){n!==r&&(e.flags|=4)};function Rs(t,e){if(!Te)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function at(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function eT(t,e,n){var r=e.pendingProps;switch(ah(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return at(e),null;case 1:return St(e.type)&&cl(),at(e),null;case 3:return r=e.stateNode,zi(),Ie(xt),Ie(ft),gh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ia(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Yt!==null&&(pd(Yt),Yt=null))),ad(t,e),at(e),null;case 5:ph(e);var i=Mr(go.current);if(n=e.type,t!==null&&e.stateNode!=null)Xv(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(j(166));return at(e),null}if(t=Mr(fn.current),Ia(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[dn]=e,r[mo]=s,t=(e.mode&1)!==0,n){case"dialog":Ee("cancel",r),Ee("close",r);break;case"iframe":case"object":case"embed":Ee("load",r);break;case"video":case"audio":for(i=0;i<Ms.length;i++)Ee(Ms[i],r);break;case"source":Ee("error",r);break;case"img":case"image":case"link":Ee("error",r),Ee("load",r);break;case"details":Ee("toggle",r);break;case"input":Mm(r,s),Ee("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ee("invalid",r);break;case"textarea":Um(r,s),Ee("invalid",r)}Vc(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&wa(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&wa(r.textContent,l,t),i=["children",""+l]):ro.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ee("scroll",r)}switch(n){case"input":fa(r),Fm(r,s,!0);break;case"textarea":fa(r),Bm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ul)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xy(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[dn]=e,t[mo]=r,Qv(t,e,!1,!1),e.stateNode=t;e:{switch(o=Oc(n,r),n){case"dialog":Ee("cancel",t),Ee("close",t),i=r;break;case"iframe":case"object":case"embed":Ee("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ms.length;i++)Ee(Ms[i],t);i=r;break;case"source":Ee("error",t),i=r;break;case"img":case"image":case"link":Ee("error",t),Ee("load",t),i=r;break;case"details":Ee("toggle",t),i=r;break;case"input":Mm(t,r),i=Pc(t,r),Ee("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ce({},r,{value:void 0}),Ee("invalid",t);break;case"textarea":Um(t,r),i=Nc(t,r),Ee("invalid",t);break;default:i=r}Vc(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?Ay(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Sy(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&io(t,u):typeof u=="number"&&io(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ro.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Ee("scroll",t):u!=null&&qd(t,s,u,o))}switch(n){case"input":fa(t),Fm(t,r,!1);break;case"textarea":fa(t),Bm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+vr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ai(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ai(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ul)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return at(e),null;case 6:if(t&&e.stateNode!=null)Yv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(j(166));if(n=Mr(go.current),Mr(fn.current),Ia(e)){if(r=e.stateNode,n=e.memoizedProps,r[dn]=e,(s=r.nodeValue!==n)&&(t=Dt,t!==null))switch(t.tag){case 3:wa(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wa(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dn]=e,e.stateNode=r}return at(e),null;case 13:if(Ie(xe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Te&&Nt!==null&&e.mode&1&&!(e.flags&128))pv(),Bi(),e.flags|=98560,s=!1;else if(s=Ia(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(j(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(j(317));s[dn]=e}else Bi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;at(e),s=!1}else Yt!==null&&(pd(Yt),Yt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||xe.current&1?ze===0&&(ze=3):Ah())),e.updateQueue!==null&&(e.flags|=4),at(e),null);case 4:return zi(),ad(t,e),t===null&&ho(e.stateNode.containerInfo),at(e),null;case 10:return dh(e.type._context),at(e),null;case 17:return St(e.type)&&cl(),at(e),null;case 19:if(Ie(xe),s=e.memoizedState,s===null)return at(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Rs(s,!1);else{if(ze!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=yl(t),o!==null){for(e.flags|=128,Rs(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ye(xe,xe.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ve()>Hi&&(e.flags|=128,r=!0,Rs(s,!1),e.lanes=4194304)}else{if(!r)if(t=yl(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Rs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Te)return at(e),null}else 2*Ve()-s.renderingStartTime>Hi&&n!==1073741824&&(e.flags|=128,r=!0,Rs(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ve(),e.sibling=null,n=xe.current,ye(xe,r?n&1|2:n&1),e):(at(e),null);case 22:case 23:return Ch(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Rt&1073741824&&(at(e),e.subtreeFlags&6&&(e.flags|=8192)):at(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function tT(t,e){switch(ah(e),e.tag){case 1:return St(e.type)&&cl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zi(),Ie(xt),Ie(ft),gh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ph(e),null;case 13:if(Ie(xe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(j(340));Bi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ie(xe),null;case 4:return zi(),null;case 10:return dh(e.type._context),null;case 22:case 23:return Ch(),null;case 24:return null;default:return null}}var xa=!1,ct=!1,nT=typeof WeakSet=="function"?WeakSet:Set,K=null;function Si(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ke(t,e,r)}else n.current=null}function ld(t,e,n){try{n()}catch(r){ke(t,e,r)}}var Pp=!1;function rT(t,e){if(Wc=ol,t=nv(),sh(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,c=0,m=0,p=t,g=null;t:for(;;){for(var x;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==s||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(x=p.firstChild)!==null;)g=p,p=x;for(;;){if(p===t)break t;if(g===n&&++c===i&&(l=o),g===s&&++m===r&&(u=o),(x=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=x}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(qc={focusedElem:t,selectionRange:n},ol=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var N=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var C=N.memoizedProps,D=N.memoizedState,I=e.stateNode,w=I.getSnapshotBeforeUpdate(e.elementType===e.type?C:Qt(e.type,C),D);I.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(P){ke(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return N=Pp,Pp=!1,N}function Gs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&ld(e,n,s)}i=i.next}while(i!==r)}}function Xl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ud(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Jv(t){var e=t.alternate;e!==null&&(t.alternate=null,Jv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dn],delete e[mo],delete e[Qc],delete e[UI],delete e[BI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Zv(t){return t.tag===5||t.tag===3||t.tag===4}function kp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Zv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ul));else if(r!==4&&(t=t.child,t!==null))for(cd(t,e,n),t=t.sibling;t!==null;)cd(t,e,n),t=t.sibling}function dd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(dd(t,e,n),t=t.sibling;t!==null;)dd(t,e,n),t=t.sibling}var Qe=null,Xt=!1;function Gn(t,e,n){for(n=n.child;n!==null;)e_(t,e,n),n=n.sibling}function e_(t,e,n){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(zl,n)}catch{}switch(n.tag){case 5:ct||Si(n,e);case 6:var r=Qe,i=Xt;Qe=null,Gn(t,e,n),Qe=r,Xt=i,Qe!==null&&(Xt?(t=Qe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Qe.removeChild(n.stateNode));break;case 18:Qe!==null&&(Xt?(t=Qe,n=n.stateNode,t.nodeType===8?Zu(t.parentNode,n):t.nodeType===1&&Zu(t,n),lo(t)):Zu(Qe,n.stateNode));break;case 4:r=Qe,i=Xt,Qe=n.stateNode.containerInfo,Xt=!0,Gn(t,e,n),Qe=r,Xt=i;break;case 0:case 11:case 14:case 15:if(!ct&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&ld(n,e,o),i=i.next}while(i!==r)}Gn(t,e,n);break;case 1:if(!ct&&(Si(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ke(n,e,l)}Gn(t,e,n);break;case 21:Gn(t,e,n);break;case 22:n.mode&1?(ct=(r=ct)||n.memoizedState!==null,Gn(t,e,n),ct=r):Gn(t,e,n);break;default:Gn(t,e,n)}}function Rp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new nT),e.forEach(function(r){var i=hT.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Gt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Qe=l.stateNode,Xt=!1;break e;case 3:Qe=l.stateNode.containerInfo,Xt=!0;break e;case 4:Qe=l.stateNode.containerInfo,Xt=!0;break e}l=l.return}if(Qe===null)throw Error(j(160));e_(s,o,i),Qe=null,Xt=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(c){ke(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)t_(e,t),e=e.sibling}function t_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Gt(e,t),un(t),r&4){try{Gs(3,t,t.return),Xl(3,t)}catch(C){ke(t,t.return,C)}try{Gs(5,t,t.return)}catch(C){ke(t,t.return,C)}}break;case 1:Gt(e,t),un(t),r&512&&n!==null&&Si(n,n.return);break;case 5:if(Gt(e,t),un(t),r&512&&n!==null&&Si(n,n.return),t.flags&32){var i=t.stateNode;try{io(i,"")}catch(C){ke(t,t.return,C)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Ty(i,s),Oc(l,o);var c=Oc(l,s);for(o=0;o<u.length;o+=2){var m=u[o],p=u[o+1];m==="style"?Ay(i,p):m==="dangerouslySetInnerHTML"?Sy(i,p):m==="children"?io(i,p):qd(i,m,p,c)}switch(l){case"input":kc(i,s);break;case"textarea":by(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?Ai(i,!!s.multiple,x,!1):g!==!!s.multiple&&(s.defaultValue!=null?Ai(i,!!s.multiple,s.defaultValue,!0):Ai(i,!!s.multiple,s.multiple?[]:"",!1))}i[mo]=s}catch(C){ke(t,t.return,C)}}break;case 6:if(Gt(e,t),un(t),r&4){if(t.stateNode===null)throw Error(j(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(C){ke(t,t.return,C)}}break;case 3:if(Gt(e,t),un(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{lo(e.containerInfo)}catch(C){ke(t,t.return,C)}break;case 4:Gt(e,t),un(t);break;case 13:Gt(e,t),un(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(xh=Ve())),r&4&&Rp(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(ct=(c=ct)||m,Gt(e,t),ct=c):Gt(e,t),un(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!m&&t.mode&1)for(K=t,m=t.child;m!==null;){for(p=K=m;K!==null;){switch(g=K,x=g.child,g.tag){case 0:case 11:case 14:case 15:Gs(4,g,g.return);break;case 1:Si(g,g.return);var N=g.stateNode;if(typeof N.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,N.props=e.memoizedProps,N.state=e.memoizedState,N.componentWillUnmount()}catch(C){ke(r,n,C)}}break;case 5:Si(g,g.return);break;case 22:if(g.memoizedState!==null){Dp(p);continue}}x!==null?(x.return=g,K=x):Dp(p)}m=m.sibling}e:for(m=null,p=t;;){if(p.tag===5){if(m===null){m=p;try{i=p.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Cy("display",o))}catch(C){ke(t,t.return,C)}}}else if(p.tag===6){if(m===null)try{p.stateNode.nodeValue=c?"":p.memoizedProps}catch(C){ke(t,t.return,C)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;m===p&&(m=null),p=p.return}m===p&&(m=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Gt(e,t),un(t),r&4&&Rp(t);break;case 21:break;default:Gt(e,t),un(t)}}function un(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Zv(n)){var r=n;break e}n=n.return}throw Error(j(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(io(i,""),r.flags&=-33);var s=kp(t);dd(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=kp(t);cd(t,l,o);break;default:throw Error(j(161))}}catch(u){ke(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function iT(t,e,n){K=t,n_(t)}function n_(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var i=K,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||xa;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||ct;l=xa;var c=ct;if(xa=o,(ct=u)&&!c)for(K=i;K!==null;)o=K,u=o.child,o.tag===22&&o.memoizedState!==null?Vp(i):u!==null?(u.return=o,K=u):Vp(i);for(;s!==null;)K=s,n_(s),s=s.sibling;K=i,xa=l,ct=c}Np(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,K=s):Np(t)}}function Np(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ct||Xl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ct)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Qt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&gp(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}gp(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var m=c.memoizedState;if(m!==null){var p=m.dehydrated;p!==null&&lo(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}ct||e.flags&512&&ud(e)}catch(g){ke(e,e.return,g)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function Dp(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function Vp(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Xl(4,e)}catch(u){ke(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){ke(e,i,u)}}var s=e.return;try{ud(e)}catch(u){ke(e,s,u)}break;case 5:var o=e.return;try{ud(e)}catch(u){ke(e,o,u)}}}catch(u){ke(e,e.return,u)}if(e===t){K=null;break}var l=e.sibling;if(l!==null){l.return=e.return,K=l;break}K=e.return}}var sT=Math.ceil,El=zn.ReactCurrentDispatcher,Th=zn.ReactCurrentOwner,jt=zn.ReactCurrentBatchConfig,ce=0,Ke=null,Fe=null,Je=0,Rt=0,Ci=xr(0),ze=0,Eo=null,Gr=0,Yl=0,bh=0,Qs=null,Tt=null,xh=0,Hi=1/0,Tn=null,wl=!1,hd=null,dr=null,Sa=!1,ir=null,Il=0,Xs=0,fd=null,za=-1,$a=0;function vt(){return ce&6?Ve():za!==-1?za:za=Ve()}function hr(t){return t.mode&1?ce&2&&Je!==0?Je&-Je:zI.transition!==null?($a===0&&($a=By()),$a):(t=me,t!==0||(t=window.event,t=t===void 0?16:Ky(t.type)),t):1}function en(t,e,n,r){if(50<Xs)throw Xs=0,fd=null,Error(j(185));No(t,n,r),(!(ce&2)||t!==Ke)&&(t===Ke&&(!(ce&2)&&(Yl|=n),ze===4&&Zn(t,Je)),Ct(t,r),n===1&&ce===0&&!(e.mode&1)&&(Hi=Ve()+500,Kl&&Sr()))}function Ct(t,e){var n=t.callbackNode;z0(t,e);var r=sl(t,t===Ke?Je:0);if(r===0)n!==null&&$m(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&$m(n),e===1)t.tag===0?jI(Op.bind(null,t)):hv(Op.bind(null,t)),MI(function(){!(ce&6)&&Sr()}),n=null;else{switch(jy(r)){case 1:n=Yd;break;case 4:n=Fy;break;case 16:n=il;break;case 536870912:n=Uy;break;default:n=il}n=c_(n,r_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function r_(t,e){if(za=-1,$a=0,ce&6)throw Error(j(327));var n=t.callbackNode;if(Di()&&t.callbackNode!==n)return null;var r=sl(t,t===Ke?Je:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Tl(t,r);else{e=r;var i=ce;ce|=2;var s=s_();(Ke!==t||Je!==e)&&(Tn=null,Hi=Ve()+500,Br(t,e));do try{lT();break}catch(l){i_(t,l)}while(!0);ch(),El.current=s,ce=i,Fe!==null?e=0:(Ke=null,Je=0,e=ze)}if(e!==0){if(e===2&&(i=Bc(t),i!==0&&(r=i,e=md(t,i))),e===1)throw n=Eo,Br(t,0),Zn(t,r),Ct(t,Ve()),n;if(e===6)Zn(t,r);else{if(i=t.current.alternate,!(r&30)&&!oT(i)&&(e=Tl(t,r),e===2&&(s=Bc(t),s!==0&&(r=s,e=md(t,s))),e===1))throw n=Eo,Br(t,0),Zn(t,r),Ct(t,Ve()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(j(345));case 2:Dr(t,Tt,Tn);break;case 3:if(Zn(t,r),(r&130023424)===r&&(e=xh+500-Ve(),10<e)){if(sl(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){vt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Gc(Dr.bind(null,t,Tt,Tn),e);break}Dr(t,Tt,Tn);break;case 4:if(Zn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Zt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ve()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*sT(r/1960))-r,10<r){t.timeoutHandle=Gc(Dr.bind(null,t,Tt,Tn),r);break}Dr(t,Tt,Tn);break;case 5:Dr(t,Tt,Tn);break;default:throw Error(j(329))}}}return Ct(t,Ve()),t.callbackNode===n?r_.bind(null,t):null}function md(t,e){var n=Qs;return t.current.memoizedState.isDehydrated&&(Br(t,e).flags|=256),t=Tl(t,e),t!==2&&(e=Tt,Tt=n,e!==null&&pd(e)),t}function pd(t){Tt===null?Tt=t:Tt.push.apply(Tt,t)}function oT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!rn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zn(t,e){for(e&=~bh,e&=~Yl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Zt(e),r=1<<n;t[n]=-1,e&=~r}}function Op(t){if(ce&6)throw Error(j(327));Di();var e=sl(t,0);if(!(e&1))return Ct(t,Ve()),null;var n=Tl(t,e);if(t.tag!==0&&n===2){var r=Bc(t);r!==0&&(e=r,n=md(t,r))}if(n===1)throw n=Eo,Br(t,0),Zn(t,e),Ct(t,Ve()),n;if(n===6)throw Error(j(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Dr(t,Tt,Tn),Ct(t,Ve()),null}function Sh(t,e){var n=ce;ce|=1;try{return t(e)}finally{ce=n,ce===0&&(Hi=Ve()+500,Kl&&Sr())}}function Qr(t){ir!==null&&ir.tag===0&&!(ce&6)&&Di();var e=ce;ce|=1;var n=jt.transition,r=me;try{if(jt.transition=null,me=1,t)return t()}finally{me=r,jt.transition=n,ce=e,!(ce&6)&&Sr()}}function Ch(){Rt=Ci.current,Ie(Ci)}function Br(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,LI(n)),Fe!==null)for(n=Fe.return;n!==null;){var r=n;switch(ah(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&cl();break;case 3:zi(),Ie(xt),Ie(ft),gh();break;case 5:ph(r);break;case 4:zi();break;case 13:Ie(xe);break;case 19:Ie(xe);break;case 10:dh(r.type._context);break;case 22:case 23:Ch()}n=n.return}if(Ke=t,Fe=t=fr(t.current,null),Je=Rt=e,ze=0,Eo=null,bh=Yl=Gr=0,Tt=Qs=null,Lr!==null){for(e=0;e<Lr.length;e++)if(n=Lr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Lr=null}return t}function i_(t,e){do{var n=Fe;try{if(ch(),Ua.current=_l,vl){for(var r=Se.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}vl=!1}if(Kr=0,qe=je=Se=null,Ks=!1,yo=0,Th.current=null,n===null||n.return===null){ze=1,Eo=e,Fe=null;break}e:{var s=t,o=n.return,l=n,u=e;if(e=Je,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,m=l,p=m.tag;if(!(m.mode&1)&&(p===0||p===11||p===15)){var g=m.alternate;g?(m.updateQueue=g.updateQueue,m.memoizedState=g.memoizedState,m.lanes=g.lanes):(m.updateQueue=null,m.memoizedState=null)}var x=Ip(o);if(x!==null){x.flags&=-257,Tp(x,o,l,s,e),x.mode&1&&wp(s,c,e),e=x,u=c;var N=e.updateQueue;if(N===null){var C=new Set;C.add(u),e.updateQueue=C}else N.add(u);break e}else{if(!(e&1)){wp(s,c,e),Ah();break e}u=Error(j(426))}}else if(Te&&l.mode&1){var D=Ip(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),Tp(D,o,l,s,e),lh($i(u,l));break e}}s=u=$i(u,l),ze!==4&&(ze=2),Qs===null?Qs=[s]:Qs.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var I=jv(s,u,e);pp(s,I);break e;case 1:l=u;var w=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(dr===null||!dr.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=zv(s,l,e);pp(s,P);break e}}s=s.return}while(s!==null)}a_(n)}catch(R){e=R,Fe===n&&n!==null&&(Fe=n=n.return);continue}break}while(!0)}function s_(){var t=El.current;return El.current=_l,t===null?_l:t}function Ah(){(ze===0||ze===3||ze===2)&&(ze=4),Ke===null||!(Gr&268435455)&&!(Yl&268435455)||Zn(Ke,Je)}function Tl(t,e){var n=ce;ce|=2;var r=s_();(Ke!==t||Je!==e)&&(Tn=null,Br(t,e));do try{aT();break}catch(i){i_(t,i)}while(!0);if(ch(),ce=n,El.current=r,Fe!==null)throw Error(j(261));return Ke=null,Je=0,ze}function aT(){for(;Fe!==null;)o_(Fe)}function lT(){for(;Fe!==null&&!D0();)o_(Fe)}function o_(t){var e=u_(t.alternate,t,Rt);t.memoizedProps=t.pendingProps,e===null?a_(t):Fe=e,Th.current=null}function a_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=tT(n,e),n!==null){n.flags&=32767,Fe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ze=6,Fe=null;return}}else if(n=eT(n,e,Rt),n!==null){Fe=n;return}if(e=e.sibling,e!==null){Fe=e;return}Fe=e=t}while(e!==null);ze===0&&(ze=5)}function Dr(t,e,n){var r=me,i=jt.transition;try{jt.transition=null,me=1,uT(t,e,n,r)}finally{jt.transition=i,me=r}return null}function uT(t,e,n,r){do Di();while(ir!==null);if(ce&6)throw Error(j(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(j(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if($0(t,s),t===Ke&&(Fe=Ke=null,Je=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Sa||(Sa=!0,c_(il,function(){return Di(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=jt.transition,jt.transition=null;var o=me;me=1;var l=ce;ce|=4,Th.current=null,rT(t,n),t_(n,t),PI(qc),ol=!!Wc,qc=Wc=null,t.current=n,iT(n),V0(),ce=l,me=o,jt.transition=s}else t.current=n;if(Sa&&(Sa=!1,ir=t,Il=i),s=t.pendingLanes,s===0&&(dr=null),M0(n.stateNode),Ct(t,Ve()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(wl)throw wl=!1,t=hd,hd=null,t;return Il&1&&t.tag!==0&&Di(),s=t.pendingLanes,s&1?t===fd?Xs++:(Xs=0,fd=t):Xs=0,Sr(),null}function Di(){if(ir!==null){var t=jy(Il),e=jt.transition,n=me;try{if(jt.transition=null,me=16>t?16:t,ir===null)var r=!1;else{if(t=ir,ir=null,Il=0,ce&6)throw Error(j(331));var i=ce;for(ce|=4,K=t.current;K!==null;){var s=K,o=s.child;if(K.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(K=c;K!==null;){var m=K;switch(m.tag){case 0:case 11:case 15:Gs(8,m,s)}var p=m.child;if(p!==null)p.return=m,K=p;else for(;K!==null;){m=K;var g=m.sibling,x=m.return;if(Jv(m),m===c){K=null;break}if(g!==null){g.return=x,K=g;break}K=x}}}var N=s.alternate;if(N!==null){var C=N.child;if(C!==null){N.child=null;do{var D=C.sibling;C.sibling=null,C=D}while(C!==null)}}K=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,K=o;else e:for(;K!==null;){if(s=K,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Gs(9,s,s.return)}var I=s.sibling;if(I!==null){I.return=s.return,K=I;break e}K=s.return}}var w=t.current;for(K=w;K!==null;){o=K;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,K=S;else e:for(o=w;K!==null;){if(l=K,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Xl(9,l)}}catch(R){ke(l,l.return,R)}if(l===o){K=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,K=P;break e}K=l.return}}if(ce=i,Sr(),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(zl,t)}catch{}r=!0}return r}finally{me=n,jt.transition=e}}return!1}function Lp(t,e,n){e=$i(n,e),e=jv(t,e,1),t=cr(t,e,1),e=vt(),t!==null&&(No(t,1,e),Ct(t,e))}function ke(t,e,n){if(t.tag===3)Lp(t,t,n);else for(;e!==null;){if(e.tag===3){Lp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(dr===null||!dr.has(r))){t=$i(n,t),t=zv(e,t,1),e=cr(e,t,1),t=vt(),e!==null&&(No(e,1,t),Ct(e,t));break}}e=e.return}}function cT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=vt(),t.pingedLanes|=t.suspendedLanes&n,Ke===t&&(Je&n)===n&&(ze===4||ze===3&&(Je&130023424)===Je&&500>Ve()-xh?Br(t,0):bh|=n),Ct(t,e)}function l_(t,e){e===0&&(t.mode&1?(e=ga,ga<<=1,!(ga&130023424)&&(ga=4194304)):e=1);var n=vt();t=Ln(t,e),t!==null&&(No(t,e,n),Ct(t,n))}function dT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),l_(t,n)}function hT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(j(314))}r!==null&&r.delete(e),l_(t,n)}var u_;u_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||xt.current)bt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return bt=!1,ZI(t,e,n);bt=!!(t.flags&131072)}else bt=!1,Te&&e.flags&1048576&&fv(e,fl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ja(t,e),t=e.pendingProps;var i=Ui(e,ft.current);Ni(e,n),i=vh(null,e,r,t,i,n);var s=_h();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,St(r)?(s=!0,dl(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,fh(e),i.updater=Ql,e.stateNode=i,i._reactInternals=e,td(e,r,t,n),e=id(null,e,r,!0,s,n)):(e.tag=0,Te&&s&&oh(e),yt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ja(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=mT(r),t=Qt(r,t),i){case 0:e=rd(null,e,r,t,n);break e;case 1:e=Sp(null,e,r,t,n);break e;case 11:e=bp(null,e,r,t,n);break e;case 14:e=xp(null,e,r,Qt(r.type,t),n);break e}throw Error(j(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qt(r,i),rd(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qt(r,i),Sp(t,e,r,i,n);case 3:e:{if(qv(e),t===null)throw Error(j(387));r=e.pendingProps,s=e.memoizedState,i=s.element,_v(t,e),gl(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=$i(Error(j(423)),e),e=Cp(t,e,r,n,i);break e}else if(r!==i){i=$i(Error(j(424)),e),e=Cp(t,e,r,n,i);break e}else for(Nt=ur(e.stateNode.containerInfo.firstChild),Dt=e,Te=!0,Yt=null,n=yv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Bi(),r===i){e=Mn(t,e,n);break e}yt(t,e,r,n)}e=e.child}return e;case 5:return Ev(e),t===null&&Jc(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Kc(r,i)?o=null:s!==null&&Kc(r,s)&&(e.flags|=32),Wv(t,e),yt(t,e,o,n),e.child;case 6:return t===null&&Jc(e),null;case 13:return Kv(t,e,n);case 4:return mh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ji(e,null,r,n):yt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qt(r,i),bp(t,e,r,i,n);case 7:return yt(t,e,e.pendingProps,n),e.child;case 8:return yt(t,e,e.pendingProps.children,n),e.child;case 12:return yt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ye(ml,r._currentValue),r._currentValue=o,s!==null)if(rn(s.value,o)){if(s.children===i.children&&!xt.current){e=Mn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Nn(-1,n&-n),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var m=c.pending;m===null?u.next=u:(u.next=m.next,m.next=u),c.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Zc(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(j(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Zc(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}yt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ni(e,n),i=$t(i),r=r(i),e.flags|=1,yt(t,e,r,n),e.child;case 14:return r=e.type,i=Qt(r,e.pendingProps),i=Qt(r.type,i),xp(t,e,r,i,n);case 15:return $v(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qt(r,i),ja(t,e),e.tag=1,St(r)?(t=!0,dl(e)):t=!1,Ni(e,n),Bv(e,r,i),td(e,r,i,n),id(null,e,r,!0,t,n);case 19:return Gv(t,e,n);case 22:return Hv(t,e,n)}throw Error(j(156,e.tag))};function c_(t,e){return My(t,e)}function fT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bt(t,e,n,r){return new fT(t,e,n,r)}function Ph(t){return t=t.prototype,!(!t||!t.isReactComponent)}function mT(t){if(typeof t=="function")return Ph(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Gd)return 11;if(t===Qd)return 14}return 2}function fr(t,e){var n=t.alternate;return n===null?(n=Bt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ha(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Ph(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case yi:return jr(n.children,i,s,e);case Kd:o=8,i|=8;break;case xc:return t=Bt(12,n,e,i|2),t.elementType=xc,t.lanes=s,t;case Sc:return t=Bt(13,n,e,i),t.elementType=Sc,t.lanes=s,t;case Cc:return t=Bt(19,n,e,i),t.elementType=Cc,t.lanes=s,t;case Ey:return Jl(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case vy:o=10;break e;case _y:o=9;break e;case Gd:o=11;break e;case Qd:o=14;break e;case Xn:o=16,r=null;break e}throw Error(j(130,t==null?t:typeof t,""))}return e=Bt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function jr(t,e,n,r){return t=Bt(7,t,r,e),t.lanes=n,t}function Jl(t,e,n,r){return t=Bt(22,t,r,e),t.elementType=Ey,t.lanes=n,t.stateNode={isHidden:!1},t}function ac(t,e,n){return t=Bt(6,t,null,e),t.lanes=n,t}function lc(t,e,n){return e=Bt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function pT(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zu(0),this.expirationTimes=zu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function kh(t,e,n,r,i,s,o,l,u){return t=new pT(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Bt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},fh(s),t}function gT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function d_(t){if(!t)return _r;t=t._reactInternals;e:{if(ni(t)!==t||t.tag!==1)throw Error(j(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(St(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(t.tag===1){var n=t.type;if(St(n))return dv(t,n,e)}return e}function h_(t,e,n,r,i,s,o,l,u){return t=kh(n,r,!0,t,i,s,o,l,u),t.context=d_(null),n=t.current,r=vt(),i=hr(n),s=Nn(r,i),s.callback=e??null,cr(n,s,i),t.current.lanes=i,No(t,i,r),Ct(t,r),t}function Zl(t,e,n,r){var i=e.current,s=vt(),o=hr(i);return n=d_(n),e.context===null?e.context=n:e.pendingContext=n,e=Nn(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=cr(i,e,o),t!==null&&(en(t,i,o,s),Fa(t,i,o)),o}function bl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Mp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Rh(t,e){Mp(t,e),(t=t.alternate)&&Mp(t,e)}function yT(){return null}var f_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Nh(t){this._internalRoot=t}eu.prototype.render=Nh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(j(409));Zl(t,e,null,null)};eu.prototype.unmount=Nh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Qr(function(){Zl(null,t,null,null)}),e[On]=null}};function eu(t){this._internalRoot=t}eu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Hy();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jn.length&&e!==0&&e<Jn[n].priority;n++);Jn.splice(n,0,t),n===0&&qy(t)}};function Dh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function tu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Fp(){}function vT(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=bl(o);s.call(c)}}var o=h_(e,r,t,0,null,!1,!1,"",Fp);return t._reactRootContainer=o,t[On]=o.current,ho(t.nodeType===8?t.parentNode:t),Qr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var c=bl(u);l.call(c)}}var u=kh(t,0,!1,null,null,!1,!1,"",Fp);return t._reactRootContainer=u,t[On]=u.current,ho(t.nodeType===8?t.parentNode:t),Qr(function(){Zl(e,u,n,r)}),u}function nu(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var u=bl(o);l.call(u)}}Zl(e,o,t,i)}else o=vT(n,e,t,i,r);return bl(o)}zy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ls(e.pendingLanes);n!==0&&(Jd(e,n|1),Ct(e,Ve()),!(ce&6)&&(Hi=Ve()+500,Sr()))}break;case 13:Qr(function(){var r=Ln(t,1);if(r!==null){var i=vt();en(r,t,1,i)}}),Rh(t,1)}};Zd=function(t){if(t.tag===13){var e=Ln(t,134217728);if(e!==null){var n=vt();en(e,t,134217728,n)}Rh(t,134217728)}};$y=function(t){if(t.tag===13){var e=hr(t),n=Ln(t,e);if(n!==null){var r=vt();en(n,t,e,r)}Rh(t,e)}};Hy=function(){return me};Wy=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};Mc=function(t,e,n){switch(e){case"input":if(kc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ql(r);if(!i)throw Error(j(90));Iy(r),kc(r,i)}}}break;case"textarea":by(t,n);break;case"select":e=n.value,e!=null&&Ai(t,!!n.multiple,e,!1)}};Ry=Sh;Ny=Qr;var _T={usingClientEntryPoint:!1,Events:[Vo,wi,ql,Py,ky,Sh]},Ns={findFiberByHostInstance:Or,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ET={bundleType:Ns.bundleType,version:Ns.version,rendererPackageName:Ns.rendererPackageName,rendererConfig:Ns.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Oy(t),t===null?null:t.stateNode},findFiberByHostInstance:Ns.findFiberByHostInstance||yT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ca=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ca.isDisabled&&Ca.supportsFiber)try{zl=Ca.inject(ET),hn=Ca}catch{}}Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_T;Ot.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dh(e))throw Error(j(200));return gT(t,e,null,n)};Ot.createRoot=function(t,e){if(!Dh(t))throw Error(j(299));var n=!1,r="",i=f_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=kh(t,1,!1,null,null,n,!1,r,i),t[On]=e.current,ho(t.nodeType===8?t.parentNode:t),new Nh(e)};Ot.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(j(188)):(t=Object.keys(t).join(","),Error(j(268,t)));return t=Oy(e),t=t===null?null:t.stateNode,t};Ot.flushSync=function(t){return Qr(t)};Ot.hydrate=function(t,e,n){if(!tu(e))throw Error(j(200));return nu(null,t,e,!0,n)};Ot.hydrateRoot=function(t,e,n){if(!Dh(t))throw Error(j(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=f_;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=h_(e,null,t,1,n??null,i,!1,s,o),t[On]=e.current,ho(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new eu(e)};Ot.render=function(t,e,n){if(!tu(e))throw Error(j(200));return nu(null,t,e,!1,n)};Ot.unmountComponentAtNode=function(t){if(!tu(t))throw Error(j(40));return t._reactRootContainer?(Qr(function(){nu(null,null,t,!1,function(){t._reactRootContainer=null,t[On]=null})}),!0):!1};Ot.unstable_batchedUpdates=Sh;Ot.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!tu(n))throw Error(j(200));if(t==null||t._reactInternals===void 0)throw Error(j(38));return nu(t,e,n,!1,r)};Ot.version="18.3.1-next-f1338f8080-20240426";function m_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m_)}catch(t){console.error(t)}}m_(),my.exports=Ot;var wT=my.exports,Up=wT;Tc.createRoot=Up.createRoot,Tc.hydrateRoot=Up.hydrateRoot;var Bp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},IT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},g_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,m=s>>2,p=(s&3)<<4|l>>4;let g=(l&15)<<2|c>>6,x=c&63;u||(x=64,o||(g=64)),r.push(n[m],n[p],n[g],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(p_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):IT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||c==null||p==null)throw new TT;const g=s<<2|l>>4;if(r.push(g),c!==64){const x=l<<4&240|c>>2;if(r.push(x),p!==64){const N=c<<6&192|p;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class TT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bT=function(t){const e=p_(t);return g_.encodeByteArray(e,!0)},xl=function(t){return bT(t).replace(/\./g,"")},y_=function(t){try{return g_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST=()=>xT().__FIREBASE_DEFAULTS__,CT=()=>{if(typeof process>"u"||typeof Bp>"u")return;const t=Bp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},AT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&y_(t[1]);return e&&JSON.parse(e)},ru=()=>{try{return ST()||CT()||AT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},v_=t=>{var e,n;return(n=(e=ru())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},PT=t=>{const e=v_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},__=()=>{var t;return(t=ru())===null||t===void 0?void 0:t.config},E_=t=>{var e;return(e=ru())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[xl(JSON.stringify(n)),xl(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mt())}function DT(){var t;const e=(t=ru())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function VT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function OT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function LT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function MT(){const t=mt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function FT(){return!DT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UT(){try{return typeof indexedDB=="object"}catch{return!1}}function BT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="FirebaseError";class $n extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=jT,Object.setPrototypeOf(this,$n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Lo.prototype.create)}}class Lo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?zT(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new $n(i,l,r)}}function zT(t,e){return t.replace($T,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const $T=/\{\$([^}]+)}/g;function HT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Sl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(jp(s)&&jp(o)){if(!Sl(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function jp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function WT(t,e){const n=new qT(t,e);return n.subscribe.bind(n)}class qT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");KT(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=uc),i.error===void 0&&(i.error=uc),i.complete===void 0&&(i.complete=uc);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function KT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function uc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(t){return t&&t._delegate?t._delegate:t}class Xr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new kT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(XT(e))try{this.getOrInitializeService({instanceIdentifier:Vr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Vr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vr){return this.instances.has(e)}getOptions(e=Vr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:QT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vr){return this.component?this.component.multipleInstances?e:Vr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function QT(t){return t===Vr?void 0:t}function XT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new GT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const JT={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},ZT=le.INFO,eb={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},tb=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=eb[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vh{constructor(e){this.name=e,this._logLevel=ZT,this._logHandler=tb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}const nb=(t,e)=>e.some(n=>t instanceof n);let zp,$p;function rb(){return zp||(zp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ib(){return $p||($p=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const w_=new WeakMap,gd=new WeakMap,I_=new WeakMap,cc=new WeakMap,Oh=new WeakMap;function sb(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(mr(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&w_.set(n,t)}).catch(()=>{}),Oh.set(e,t),e}function ob(t){if(gd.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});gd.set(t,e)}let yd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return gd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||I_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ab(t){yd=t(yd)}function lb(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(dc(this),e,...n);return I_.set(r,e.sort?e.sort():[e]),mr(r)}:ib().includes(t)?function(...e){return t.apply(dc(this),e),mr(w_.get(this))}:function(...e){return mr(t.apply(dc(this),e))}}function ub(t){return typeof t=="function"?lb(t):(t instanceof IDBTransaction&&ob(t),nb(t,rb())?new Proxy(t,yd):t)}function mr(t){if(t instanceof IDBRequest)return sb(t);if(cc.has(t))return cc.get(t);const e=ub(t);return e!==t&&(cc.set(t,e),Oh.set(e,t)),e}const dc=t=>Oh.get(t);function cb(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=mr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(mr(o.result),u.oldVersion,u.newVersion,mr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const db=["get","getKey","getAll","getAllKeys","count"],hb=["put","add","delete","clear"],hc=new Map;function Hp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(hc.get(e))return hc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=hb.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||db.includes(n)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),i&&u.done]))[0]};return hc.set(e,s),s}ab(t=>({...t,get:(e,n,r)=>Hp(e,n)||t.get(e,n,r),has:(e,n)=>!!Hp(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mb(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function mb(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const vd="@firebase/app",Wp="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn=new Vh("@firebase/app"),pb="@firebase/app-compat",gb="@firebase/analytics-compat",yb="@firebase/analytics",vb="@firebase/app-check-compat",_b="@firebase/app-check",Eb="@firebase/auth",wb="@firebase/auth-compat",Ib="@firebase/database",Tb="@firebase/data-connect",bb="@firebase/database-compat",xb="@firebase/functions",Sb="@firebase/functions-compat",Cb="@firebase/installations",Ab="@firebase/installations-compat",Pb="@firebase/messaging",kb="@firebase/messaging-compat",Rb="@firebase/performance",Nb="@firebase/performance-compat",Db="@firebase/remote-config",Vb="@firebase/remote-config-compat",Ob="@firebase/storage",Lb="@firebase/storage-compat",Mb="@firebase/firestore",Fb="@firebase/vertexai-preview",Ub="@firebase/firestore-compat",Bb="firebase",jb="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _d="[DEFAULT]",zb={[vd]:"fire-core",[pb]:"fire-core-compat",[yb]:"fire-analytics",[gb]:"fire-analytics-compat",[_b]:"fire-app-check",[vb]:"fire-app-check-compat",[Eb]:"fire-auth",[wb]:"fire-auth-compat",[Ib]:"fire-rtdb",[Tb]:"fire-data-connect",[bb]:"fire-rtdb-compat",[xb]:"fire-fn",[Sb]:"fire-fn-compat",[Cb]:"fire-iid",[Ab]:"fire-iid-compat",[Pb]:"fire-fcm",[kb]:"fire-fcm-compat",[Rb]:"fire-perf",[Nb]:"fire-perf-compat",[Db]:"fire-rc",[Vb]:"fire-rc-compat",[Ob]:"fire-gcs",[Lb]:"fire-gcs-compat",[Mb]:"fire-fst",[Ub]:"fire-fst-compat",[Fb]:"fire-vertex","fire-js":"fire-js",[Bb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl=new Map,$b=new Map,Ed=new Map;function qp(t,e){try{t.container.addComponent(e)}catch(n){Fn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Wi(t){const e=t.name;if(Ed.has(e))return Fn.debug(`There were multiple attempts to register component ${e}.`),!1;Ed.set(e,t);for(const n of Cl.values())qp(n,t);for(const n of $b.values())qp(n,t);return!0}function Lh(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function An(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pr=new Lo("app","Firebase",Hb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=jb;function T_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:_d,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw pr.create("bad-app-name",{appName:String(i)});if(n||(n=__()),!n)throw pr.create("no-options");const s=Cl.get(i);if(s){if(Sl(n,s.options)&&Sl(r,s.config))return s;throw pr.create("duplicate-app",{appName:i})}const o=new YT(i);for(const u of Ed.values())o.addComponent(u);const l=new Wb(n,r,o);return Cl.set(i,l),l}function b_(t=_d){const e=Cl.get(t);if(!e&&t===_d&&__())return T_();if(!e)throw pr.create("no-app",{appName:t});return e}function gr(t,e,n){var r;let i=(r=zb[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fn.warn(l.join(" "));return}Wi(new Xr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="firebase-heartbeat-database",Kb=1,wo="firebase-heartbeat-store";let fc=null;function x_(){return fc||(fc=cb(qb,Kb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(wo)}catch(n){console.warn(n)}}}}).catch(t=>{throw pr.create("idb-open",{originalErrorMessage:t.message})})),fc}async function Gb(t){try{const n=(await x_()).transaction(wo),r=await n.objectStore(wo).get(S_(t));return await n.done,r}catch(e){if(e instanceof $n)Fn.warn(e.message);else{const n=pr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Fn.warn(n.message)}}}async function Kp(t,e){try{const r=(await x_()).transaction(wo,"readwrite");await r.objectStore(wo).put(e,S_(t)),await r.done}catch(n){if(n instanceof $n)Fn.warn(n.message);else{const r=pr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Fn.warn(r.message)}}}function S_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb=1024,Xb=30*24*60*60*1e3;class Yb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Zb(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Gp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=Xb}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Fn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Gp(),{heartbeatsToSend:r,unsentEntries:i}=Jb(this._heartbeatsCache.heartbeats),s=xl(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Fn.warn(n),""}}}function Gp(){return new Date().toISOString().substring(0,10)}function Jb(t,e=Qb){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Qp(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Qp(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Zb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UT()?BT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Gb(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Kp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Kp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Qp(t){return xl(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(t){Wi(new Xr("platform-logger",e=>new fb(e),"PRIVATE")),Wi(new Xr("heartbeat",e=>new Yb(e),"PRIVATE")),gr(vd,Wp,t),gr(vd,Wp,"esm2017"),gr("fire-js","")}ex("");function Mh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function C_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tx=C_,A_=new Lo("auth","Firebase",C_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al=new Vh("@firebase/auth");function nx(t,...e){Al.logLevel<=le.WARN&&Al.warn(`Auth (${rs}): ${t}`,...e)}function Wa(t,...e){Al.logLevel<=le.ERROR&&Al.error(`Auth (${rs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(t,...e){throw Uh(t,...e)}function tn(t,...e){return Uh(t,...e)}function Fh(t,e,n){const r=Object.assign(Object.assign({},tx()),{[e]:n});return new Lo("auth","Firebase",r).create(e,{appName:t.name})}function zr(t){return Fh(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rx(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&yn(t,"argument-error"),Fh(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Uh(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return A_.create(t,...e)}function te(t,e,...n){if(!t)throw Uh(e,...n)}function Pn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Wa(e),new Error(e)}function Un(t,e){t||Pn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ix(){return Xp()==="http:"||Xp()==="https:"}function Xp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ix()||OT()||"connection"in navigator)?navigator.onLine:!0}function ox(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,n){this.shortDelay=e,this.longDelay=n,Un(n>e,"Short delay should be less than long delay!"),this.isMobile=NT()||LT()}get(){return sx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bh(t,e){Un(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ax={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx=new Fo(3e4,6e4);function jh(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function is(t,e,n,r,i={}){return k_(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=Mo(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:u},s);return VT()||(c.referrerPolicy="no-referrer"),P_.fetch()(R_(t,t.config.apiHost,n,l),c)})}async function k_(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},ax),e);try{const i=new cx(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Aa(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,c]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Aa(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Aa(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Aa(t,"user-disabled",o);const m=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Fh(t,m,c);yn(t,m)}}catch(i){if(i instanceof $n)throw i;yn(t,"network-request-failed",{message:String(i)})}}async function ux(t,e,n,r,i={}){const s=await is(t,e,n,r,i);return"mfaPendingCredential"in s&&yn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function R_(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Bh(t.config,i):`${t.config.apiScheme}://${i}`}class cx{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(tn(this.auth,"network-request-failed")),lx.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Aa(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=tn(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dx(t,e){return is(t,"POST","/v1/accounts:delete",e)}async function N_(t,e){return is(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hx(t,e=!1){const n=Et(t),r=await n.getIdToken(e),i=zh(r);te(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ys(mc(i.auth_time)),issuedAtTime:Ys(mc(i.iat)),expirationTime:Ys(mc(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function mc(t){return Number(t)*1e3}function zh(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Wa("JWT malformed, contained fewer than 3 sections"),null;try{const i=y_(n);return i?JSON.parse(i):(Wa("Failed to decode base64 JWT payload"),null)}catch(i){return Wa("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Yp(t){const e=zh(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof $n&&fx(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function fx({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ys(this.lastLoginAt),this.creationTime=Ys(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pl(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Io(t,N_(n,{idToken:r}));te(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?D_(s.providerUserInfo):[],l=gx(t.providerData,o),u=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),m=u?c:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Id(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(t,p)}async function px(t){const e=Et(t);await Pl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gx(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function D_(t){return t.map(e=>{var{providerId:n}=e,r=Mh(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yx(t,e){const n=await k_(t,{},async()=>{const r=Mo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=R_(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",P_.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function vx(t,e){return is(t,"POST","/v2/accounts:revokeToken",jh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yp(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){te(e.length!==0,"internal-error");const n=Yp(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await yx(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Vi;return r&&(te(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(te(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(te(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vi,this.toJSON())}_performRefresh(){return Pn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qn(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class kn{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Mh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Id(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Io(this,this.stsTokenManager.getToken(this.auth,e));return te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return hx(this,e)}reload(){return px(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new kn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Pl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(An(this.auth.app))return Promise.reject(zr(this.auth));const e=await this.getIdToken();return await Io(this,dx(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,l,u,c,m;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(i=n.email)!==null&&i!==void 0?i:void 0,x=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,N=(o=n.photoURL)!==null&&o!==void 0?o:void 0,C=(l=n.tenantId)!==null&&l!==void 0?l:void 0,D=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,I=(c=n.createdAt)!==null&&c!==void 0?c:void 0,w=(m=n.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:S,emailVerified:P,isAnonymous:R,providerData:V,stsTokenManager:v}=n;te(S&&v,e,"internal-error");const y=Vi.fromJSON(this.name,v);te(typeof S=="string",e,"internal-error"),Qn(p,e.name),Qn(g,e.name),te(typeof P=="boolean",e,"internal-error"),te(typeof R=="boolean",e,"internal-error"),Qn(x,e.name),Qn(N,e.name),Qn(C,e.name),Qn(D,e.name),Qn(I,e.name),Qn(w,e.name);const T=new kn({uid:S,auth:e,email:g,emailVerified:P,displayName:p,isAnonymous:R,photoURL:N,phoneNumber:x,tenantId:C,stsTokenManager:y,createdAt:I,lastLoginAt:w});return V&&Array.isArray(V)&&(T.providerData=V.map(A=>Object.assign({},A))),D&&(T._redirectEventId=D),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new Vi;i.updateFromServerResponse(n);const s=new kn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Pl(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];te(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?D_(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Vi;l.updateFromIdToken(r);const u=new kn({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Id(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jp=new Map;function Rn(t){Un(t instanceof Function,"Expected a class definition");let e=Jp.get(t);return e?(Un(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Jp.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}V_.type="NONE";const Zp=V_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(t,e,n){return`firebase:${t}:${e}:${n}`}class Oi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=qa(this.userKey,i.apiKey,s),this.fullPersistenceKey=qa("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?kn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Oi(Rn(Zp),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Rn(Zp);const o=qa(r,e.config.apiKey,e.name);let l=null;for(const c of n)try{const m=await c._get(o);if(m){const p=kn._fromJSON(e,m);c!==s&&(l=p),s=c;break}}catch{}const u=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Oi(s,e,r):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Oi(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(F_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(O_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(B_(e))return"Blackberry";if(j_(e))return"Webos";if(L_(e))return"Safari";if((e.includes("chrome/")||M_(e))&&!e.includes("edge/"))return"Chrome";if(U_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function O_(t=mt()){return/firefox\//i.test(t)}function L_(t=mt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function M_(t=mt()){return/crios\//i.test(t)}function F_(t=mt()){return/iemobile/i.test(t)}function U_(t=mt()){return/android/i.test(t)}function B_(t=mt()){return/blackberry/i.test(t)}function j_(t=mt()){return/webos/i.test(t)}function $h(t=mt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function _x(t=mt()){var e;return $h(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Ex(){return MT()&&document.documentMode===10}function z_(t=mt()){return $h(t)||U_(t)||j_(t)||B_(t)||/windows phone/i.test(t)||F_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(t,e=[]){let n;switch(t){case"Browser":n=eg(mt());break;case"Worker":n=`${eg(mt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${rs}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ix(t,e={}){return is(t,"GET","/v2/passwordPolicy",jh(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx=6;class bx{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Tx,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tg(this),this.idTokenSubscription=new tg(this),this.beforeStateQueue=new wx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=A_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Rn(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Oi.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await N_(this,{idToken:e}),r=await kn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(An(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Pl(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ox()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(An(this.app))return Promise.reject(zr(this));const n=e?Et(e):null;return n&&te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return An(this.app)?Promise.reject(zr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return An(this.app)?Promise.reject(zr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ix(this),n=new bx(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Lo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await vx(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Rn(e)||this._popupRedirectResolver;te(n,this,"argument-error"),this.redirectPersistenceManager=await Oi.create(this,[Rn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&nx(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function iu(t){return Et(t)}class tg{constructor(e){this.auth=e,this.observer=null,this.addObserver=WT(n=>this.observer=n)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Sx(t){Hh=t}function Cx(t){return Hh.loadJS(t)}function Ax(){return Hh.gapiScript}function Px(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kx(t,e){const n=Lh(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Sl(s,e??{}))return i;yn(i,"already-initialized")}return n.initialize({options:e})}function Rx(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Rn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Nx(t,e,n){const r=iu(t);te(r._canInitEmulator,r,"emulator-config-failed"),te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=H_(e),{host:o,port:l}=Dx(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),Vx()}function H_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Dx(t){const e=H_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:ng(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:ng(o)}}}function ng(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Vx(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Pn("not implemented")}_getIdTokenResponse(e){return Pn("not implemented")}_linkToIdToken(e,n){return Pn("not implemented")}_getReauthenticationResolver(e){return Pn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Li(t,e){return ux(t,"POST","/v1/accounts:signInWithIdp",jh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox="http://localhost";class Yr extends W_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Yr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):yn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Mh(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Yr(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Li(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Li(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Li(e,n)}buildRequest(){const e={requestUri:Ox,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Mo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo extends Wh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er extends Uo{constructor(){super("facebook.com")}static credential(e){return Yr._fromParams({providerId:er.PROVIDER_ID,signInMethod:er.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return er.credentialFromTaggedObject(e)}static credentialFromError(e){return er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return er.credential(e.oauthAccessToken)}catch{return null}}}er.FACEBOOK_SIGN_IN_METHOD="facebook.com";er.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn extends Uo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Yr._fromParams({providerId:xn.PROVIDER_ID,signInMethod:xn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return xn.credentialFromTaggedObject(e)}static credentialFromError(e){return xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return xn.credential(n,r)}catch{return null}}}xn.GOOGLE_SIGN_IN_METHOD="google.com";xn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends Uo{constructor(){super("github.com")}static credential(e){return Yr._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tr.credential(e.oauthAccessToken)}catch{return null}}}tr.GITHUB_SIGN_IN_METHOD="github.com";tr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr extends Uo{constructor(){super("twitter.com")}static credential(e,n){return Yr._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return nr.credential(n,r)}catch{return null}}}nr.TWITTER_SIGN_IN_METHOD="twitter.com";nr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await kn._fromIdTokenResponse(e,r,i),o=rg(r);return new qi({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=rg(r);return new qi({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function rg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl extends $n{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,kl.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new kl(e,n,r,i)}}function q_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?kl._fromErrorAndOperation(t,s,e,r):s})}async function Lx(t,e,n=!1){const r=await Io(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return qi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mx(t,e,n=!1){const{auth:r}=t;if(An(r.app))return Promise.reject(zr(r));const i="reauthenticate";try{const s=await Io(t,q_(r,i,e,t),n);te(s.idToken,r,"internal-error");const o=zh(s.idToken);te(o,r,"internal-error");const{sub:l}=o;return te(t.uid===l,r,"user-mismatch"),qi._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&yn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fx(t,e,n=!1){if(An(t.app))return Promise.reject(zr(t));const r="signIn",i=await q_(t,r,e),s=await qi._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function Ux(t,e,n,r){return Et(t).onIdTokenChanged(e,n,r)}function Bx(t,e,n){return Et(t).beforeAuthStateChanged(e,n)}function jx(t,e,n,r){return Et(t).onAuthStateChanged(e,n,r)}function zx(t){return Et(t).signOut()}const Rl="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Rl,"1"),this.storage.removeItem(Rl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=1e3,Hx=10;class G_ extends K_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=z_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);Ex()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Hx):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},$x)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}G_.type="LOCAL";const Wx=G_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_ extends K_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Q_.type="SESSION";const X_=Q_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new su(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async c=>c(n.origin,s)),u=await qx(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}su.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const c=qh("",20);i.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===c)switch(g.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(m),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(){return window}function Gx(t){mn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(){return typeof mn().WorkerGlobalScope<"u"&&typeof mn().importScripts=="function"}async function Qx(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Xx(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Yx(){return Y_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_="firebaseLocalStorageDb",Jx=1,Nl="firebaseLocalStorage",Z_="fbase_key";class Bo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function ou(t,e){return t.transaction([Nl],e?"readwrite":"readonly").objectStore(Nl)}function Zx(){const t=indexedDB.deleteDatabase(J_);return new Bo(t).toPromise()}function Td(){const t=indexedDB.open(J_,Jx);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Nl,{keyPath:Z_})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Nl)?e(r):(r.close(),await Zx(),e(await Td()))})})}async function ig(t,e,n){const r=ou(t,!0).put({[Z_]:e,value:n});return new Bo(r).toPromise()}async function eS(t,e){const n=ou(t,!1).get(e),r=await new Bo(n).toPromise();return r===void 0?null:r.value}function sg(t,e){const n=ou(t,!0).delete(e);return new Bo(n).toPromise()}const tS=800,nS=3;class eE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Td(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>nS)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Y_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=su._getInstance(Yx()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Qx(),!this.activeServiceWorker)return;this.sender=new Kx(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Xx()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Td();return await ig(e,Rl,"1"),await sg(e,Rl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ig(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>eS(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>sg(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ou(i,!1).getAll();return new Bo(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),tS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eE.type="LOCAL";const rS=eE;new Fo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(t,e){return e?Rn(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh extends W_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Li(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Li(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Li(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function iS(t){return Fx(t.auth,new Kh(t),t.bypassAuthState)}function sS(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),Mx(n,new Kh(t),t.bypassAuthState)}async function oS(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),Lx(n,new Kh(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iS;case"linkViaPopup":case"linkViaRedirect":return oS;case"reauthViaPopup":case"reauthViaRedirect":return sS;default:yn(this.auth,"internal-error")}}resolve(e){Un(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Un(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=new Fo(2e3,1e4);async function lS(t,e,n){if(An(t.app))return Promise.reject(tn(t,"operation-not-supported-in-this-environment"));const r=iu(t);rx(t,e,Wh);const i=tE(r,n);return new Fr(r,"signInViaPopup",e,i).executeNotNull()}class Fr extends nE{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Fr.currentPopupAction&&Fr.currentPopupAction.cancel(),Fr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){Un(this.filter.length===1,"Popup operations only handle one event");const e=qh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(tn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(tn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(tn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,aS.get())};e()}}Fr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS="pendingRedirect",Ka=new Map;class cS extends nE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ka.get(this.auth._key());if(!e){try{const r=await dS(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ka.set(this.auth._key(),e)}return this.bypassAuthState||Ka.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dS(t,e){const n=mS(e),r=fS(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function hS(t,e){Ka.set(t._key(),e)}function fS(t){return Rn(t._redirectPersistence)}function mS(t){return qa(uS,t.config.apiKey,t.name)}async function pS(t,e,n=!1){if(An(t.app))return Promise.reject(zr(t));const r=iu(t),i=tE(r,e),o=await new cS(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS=10*60*1e3;class yS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!vS(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!rE(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(tn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gS&&this.cachedEventUids.clear(),this.cachedEventUids.has(og(e))}saveEventToCache(e){this.cachedEventUids.add(og(e)),this.lastProcessedEventTime=Date.now()}}function og(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function rE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function vS(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _S(t,e={}){return is(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wS=/^https?/;async function IS(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _S(t);for(const n of e)try{if(TS(n))return}catch{}yn(t,"unauthorized-domain")}function TS(t){const e=wd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!wS.test(n))return!1;if(ES.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS=new Fo(3e4,6e4);function ag(){const t=mn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function xS(t){return new Promise((e,n)=>{var r,i,s;function o(){ag(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ag(),n(tn(t,"network-request-failed"))},timeout:bS.get()})}if(!((i=(r=mn().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=mn().gapi)===null||s===void 0)&&s.load)o();else{const l=Px("iframefcb");return mn()[l]=()=>{gapi.load?o():n(tn(t,"network-request-failed"))},Cx(`${Ax()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw Ga=null,e})}let Ga=null;function SS(t){return Ga=Ga||xS(t),Ga}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS=new Fo(5e3,15e3),AS="__/auth/iframe",PS="emulator/auth/iframe",kS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},RS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NS(t){const e=t.config;te(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Bh(e,PS):`https://${t.config.authDomain}/${AS}`,r={apiKey:e.apiKey,appName:t.name,v:rs},i=RS.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Mo(r).slice(1)}`}async function DS(t){const e=await SS(t),n=mn().gapi;return te(n,t,"internal-error"),e.open({where:document.body,url:NS(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:kS,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=tn(t,"network-request-failed"),l=mn().setTimeout(()=>{s(o)},CS.get());function u(){mn().clearTimeout(l),i(r)}r.ping(u).then(u,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},OS=500,LS=600,MS="_blank",FS="http://localhost";class lg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function US(t,e,n,r=OS,i=LS){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},VS),{width:r.toString(),height:i.toString(),top:s,left:o}),c=mt().toLowerCase();n&&(l=M_(c)?MS:n),O_(c)&&(e=e||FS,u.scrollbars="yes");const m=Object.entries(u).reduce((g,[x,N])=>`${g}${x}=${N},`,"");if(_x(c)&&l!=="_self")return BS(e||"",l),new lg(null);const p=window.open(e||"",l,m);te(p,t,"popup-blocked");try{p.focus()}catch{}return new lg(p)}function BS(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jS="__/auth/handler",zS="emulator/auth/handler",$S=encodeURIComponent("fac");async function ug(t,e,n,r,i,s){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:rs,eventId:i};if(e instanceof Wh){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",HT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,p]of Object.entries({}))o[m]=p}if(e instanceof Uo){const m=e.getScopes().filter(p=>p!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const u=await t._getAppCheckToken(),c=u?`#${$S}=${encodeURIComponent(u)}`:"";return`${HS(t)}?${Mo(l).slice(1)}${c}`}function HS({config:t}){return t.emulator?Bh(t,zS):`https://${t.authDomain}/${jS}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pc="webStorageSupport";class WS{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=X_,this._completeRedirectFn=pS,this._overrideRedirectResult=hS}async _openPopup(e,n,r,i){var s;Un((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await ug(e,n,r,wd(),i);return US(e,o,qh())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await ug(e,n,r,wd(),i);return Gx(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Un(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await DS(e),r=new yS(e);return n.register("authEvent",i=>(te(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(pc,{type:pc},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[pc];o!==void 0&&n(!!o),yn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=IS(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return z_()||L_()||$h()}}const qS=WS;var cg="@firebase/auth",dg="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function QS(t){Wi(new Xr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;te(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$_(t)},c=new xx(r,i,s,u);return Rx(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Wi(new Xr("auth-internal",e=>{const n=iu(e.getProvider("auth").getImmediate());return(r=>new KS(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),gr(cg,dg,GS(t)),gr(cg,dg,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XS=5*60,YS=E_("authIdTokenMaxAge")||XS;let hg=null;const JS=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>YS)return;const i=n==null?void 0:n.token;hg!==i&&(hg=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function ZS(t=b_()){const e=Lh(t,"auth");if(e.isInitialized())return e.getImmediate();const n=kx(t,{popupRedirectResolver:qS,persistence:[rS,Wx,X_]}),r=E_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=JS(s.toString());Bx(n,o,()=>o(n.currentUser)),Ux(n,l=>o(l))}}const i=v_("auth");return i&&Nx(n,`http://${i}`),n}function eC(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Sx({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=tn("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",eC().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});QS("Browser");var tC="firebase",nC="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gr(tC,nC,"app");var fg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $r,iE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,y){function T(){}T.prototype=y.prototype,v.D=y.prototype,v.prototype=new T,v.prototype.constructor=v,v.C=function(A,_,k){for(var b=Array(arguments.length-2),q=2;q<arguments.length;q++)b[q-2]=arguments[q];return y.prototype[_].apply(A,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,y,T){T||(T=0);var A=Array(16);if(typeof y=="string")for(var _=0;16>_;++_)A[_]=y.charCodeAt(T++)|y.charCodeAt(T++)<<8|y.charCodeAt(T++)<<16|y.charCodeAt(T++)<<24;else for(_=0;16>_;++_)A[_]=y[T++]|y[T++]<<8|y[T++]<<16|y[T++]<<24;y=v.g[0],T=v.g[1],_=v.g[2];var k=v.g[3],b=y+(k^T&(_^k))+A[0]+3614090360&4294967295;y=T+(b<<7&4294967295|b>>>25),b=k+(_^y&(T^_))+A[1]+3905402710&4294967295,k=y+(b<<12&4294967295|b>>>20),b=_+(T^k&(y^T))+A[2]+606105819&4294967295,_=k+(b<<17&4294967295|b>>>15),b=T+(y^_&(k^y))+A[3]+3250441966&4294967295,T=_+(b<<22&4294967295|b>>>10),b=y+(k^T&(_^k))+A[4]+4118548399&4294967295,y=T+(b<<7&4294967295|b>>>25),b=k+(_^y&(T^_))+A[5]+1200080426&4294967295,k=y+(b<<12&4294967295|b>>>20),b=_+(T^k&(y^T))+A[6]+2821735955&4294967295,_=k+(b<<17&4294967295|b>>>15),b=T+(y^_&(k^y))+A[7]+4249261313&4294967295,T=_+(b<<22&4294967295|b>>>10),b=y+(k^T&(_^k))+A[8]+1770035416&4294967295,y=T+(b<<7&4294967295|b>>>25),b=k+(_^y&(T^_))+A[9]+2336552879&4294967295,k=y+(b<<12&4294967295|b>>>20),b=_+(T^k&(y^T))+A[10]+4294925233&4294967295,_=k+(b<<17&4294967295|b>>>15),b=T+(y^_&(k^y))+A[11]+2304563134&4294967295,T=_+(b<<22&4294967295|b>>>10),b=y+(k^T&(_^k))+A[12]+1804603682&4294967295,y=T+(b<<7&4294967295|b>>>25),b=k+(_^y&(T^_))+A[13]+4254626195&4294967295,k=y+(b<<12&4294967295|b>>>20),b=_+(T^k&(y^T))+A[14]+2792965006&4294967295,_=k+(b<<17&4294967295|b>>>15),b=T+(y^_&(k^y))+A[15]+1236535329&4294967295,T=_+(b<<22&4294967295|b>>>10),b=y+(_^k&(T^_))+A[1]+4129170786&4294967295,y=T+(b<<5&4294967295|b>>>27),b=k+(T^_&(y^T))+A[6]+3225465664&4294967295,k=y+(b<<9&4294967295|b>>>23),b=_+(y^T&(k^y))+A[11]+643717713&4294967295,_=k+(b<<14&4294967295|b>>>18),b=T+(k^y&(_^k))+A[0]+3921069994&4294967295,T=_+(b<<20&4294967295|b>>>12),b=y+(_^k&(T^_))+A[5]+3593408605&4294967295,y=T+(b<<5&4294967295|b>>>27),b=k+(T^_&(y^T))+A[10]+38016083&4294967295,k=y+(b<<9&4294967295|b>>>23),b=_+(y^T&(k^y))+A[15]+3634488961&4294967295,_=k+(b<<14&4294967295|b>>>18),b=T+(k^y&(_^k))+A[4]+3889429448&4294967295,T=_+(b<<20&4294967295|b>>>12),b=y+(_^k&(T^_))+A[9]+568446438&4294967295,y=T+(b<<5&4294967295|b>>>27),b=k+(T^_&(y^T))+A[14]+3275163606&4294967295,k=y+(b<<9&4294967295|b>>>23),b=_+(y^T&(k^y))+A[3]+4107603335&4294967295,_=k+(b<<14&4294967295|b>>>18),b=T+(k^y&(_^k))+A[8]+1163531501&4294967295,T=_+(b<<20&4294967295|b>>>12),b=y+(_^k&(T^_))+A[13]+2850285829&4294967295,y=T+(b<<5&4294967295|b>>>27),b=k+(T^_&(y^T))+A[2]+4243563512&4294967295,k=y+(b<<9&4294967295|b>>>23),b=_+(y^T&(k^y))+A[7]+1735328473&4294967295,_=k+(b<<14&4294967295|b>>>18),b=T+(k^y&(_^k))+A[12]+2368359562&4294967295,T=_+(b<<20&4294967295|b>>>12),b=y+(T^_^k)+A[5]+4294588738&4294967295,y=T+(b<<4&4294967295|b>>>28),b=k+(y^T^_)+A[8]+2272392833&4294967295,k=y+(b<<11&4294967295|b>>>21),b=_+(k^y^T)+A[11]+1839030562&4294967295,_=k+(b<<16&4294967295|b>>>16),b=T+(_^k^y)+A[14]+4259657740&4294967295,T=_+(b<<23&4294967295|b>>>9),b=y+(T^_^k)+A[1]+2763975236&4294967295,y=T+(b<<4&4294967295|b>>>28),b=k+(y^T^_)+A[4]+1272893353&4294967295,k=y+(b<<11&4294967295|b>>>21),b=_+(k^y^T)+A[7]+4139469664&4294967295,_=k+(b<<16&4294967295|b>>>16),b=T+(_^k^y)+A[10]+3200236656&4294967295,T=_+(b<<23&4294967295|b>>>9),b=y+(T^_^k)+A[13]+681279174&4294967295,y=T+(b<<4&4294967295|b>>>28),b=k+(y^T^_)+A[0]+3936430074&4294967295,k=y+(b<<11&4294967295|b>>>21),b=_+(k^y^T)+A[3]+3572445317&4294967295,_=k+(b<<16&4294967295|b>>>16),b=T+(_^k^y)+A[6]+76029189&4294967295,T=_+(b<<23&4294967295|b>>>9),b=y+(T^_^k)+A[9]+3654602809&4294967295,y=T+(b<<4&4294967295|b>>>28),b=k+(y^T^_)+A[12]+3873151461&4294967295,k=y+(b<<11&4294967295|b>>>21),b=_+(k^y^T)+A[15]+530742520&4294967295,_=k+(b<<16&4294967295|b>>>16),b=T+(_^k^y)+A[2]+3299628645&4294967295,T=_+(b<<23&4294967295|b>>>9),b=y+(_^(T|~k))+A[0]+4096336452&4294967295,y=T+(b<<6&4294967295|b>>>26),b=k+(T^(y|~_))+A[7]+1126891415&4294967295,k=y+(b<<10&4294967295|b>>>22),b=_+(y^(k|~T))+A[14]+2878612391&4294967295,_=k+(b<<15&4294967295|b>>>17),b=T+(k^(_|~y))+A[5]+4237533241&4294967295,T=_+(b<<21&4294967295|b>>>11),b=y+(_^(T|~k))+A[12]+1700485571&4294967295,y=T+(b<<6&4294967295|b>>>26),b=k+(T^(y|~_))+A[3]+2399980690&4294967295,k=y+(b<<10&4294967295|b>>>22),b=_+(y^(k|~T))+A[10]+4293915773&4294967295,_=k+(b<<15&4294967295|b>>>17),b=T+(k^(_|~y))+A[1]+2240044497&4294967295,T=_+(b<<21&4294967295|b>>>11),b=y+(_^(T|~k))+A[8]+1873313359&4294967295,y=T+(b<<6&4294967295|b>>>26),b=k+(T^(y|~_))+A[15]+4264355552&4294967295,k=y+(b<<10&4294967295|b>>>22),b=_+(y^(k|~T))+A[6]+2734768916&4294967295,_=k+(b<<15&4294967295|b>>>17),b=T+(k^(_|~y))+A[13]+1309151649&4294967295,T=_+(b<<21&4294967295|b>>>11),b=y+(_^(T|~k))+A[4]+4149444226&4294967295,y=T+(b<<6&4294967295|b>>>26),b=k+(T^(y|~_))+A[11]+3174756917&4294967295,k=y+(b<<10&4294967295|b>>>22),b=_+(y^(k|~T))+A[2]+718787259&4294967295,_=k+(b<<15&4294967295|b>>>17),b=T+(k^(_|~y))+A[9]+3951481745&4294967295,v.g[0]=v.g[0]+y&4294967295,v.g[1]=v.g[1]+(_+(b<<21&4294967295|b>>>11))&4294967295,v.g[2]=v.g[2]+_&4294967295,v.g[3]=v.g[3]+k&4294967295}r.prototype.u=function(v,y){y===void 0&&(y=v.length);for(var T=y-this.blockSize,A=this.B,_=this.h,k=0;k<y;){if(_==0)for(;k<=T;)i(this,v,k),k+=this.blockSize;if(typeof v=="string"){for(;k<y;)if(A[_++]=v.charCodeAt(k++),_==this.blockSize){i(this,A),_=0;break}}else for(;k<y;)if(A[_++]=v[k++],_==this.blockSize){i(this,A),_=0;break}}this.h=_,this.o+=y},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var y=1;y<v.length-8;++y)v[y]=0;var T=8*this.o;for(y=v.length-8;y<v.length;++y)v[y]=T&255,T/=256;for(this.u(v),v=Array(16),y=T=0;4>y;++y)for(var A=0;32>A;A+=8)v[T++]=this.g[y]>>>A&255;return v};function s(v,y){var T=l;return Object.prototype.hasOwnProperty.call(T,v)?T[v]:T[v]=y(v)}function o(v,y){this.h=y;for(var T=[],A=!0,_=v.length-1;0<=_;_--){var k=v[_]|0;A&&k==y||(T[_]=k,A=!1)}this.g=T}var l={};function u(v){return-128<=v&&128>v?s(v,function(y){return new o([y|0],0>y?-1:0)}):new o([v|0],0>v?-1:0)}function c(v){if(isNaN(v)||!isFinite(v))return p;if(0>v)return D(c(-v));for(var y=[],T=1,A=0;v>=T;A++)y[A]=v/T|0,T*=4294967296;return new o(y,0)}function m(v,y){if(v.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(v.charAt(0)=="-")return D(m(v.substring(1),y));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=c(Math.pow(y,8)),A=p,_=0;_<v.length;_+=8){var k=Math.min(8,v.length-_),b=parseInt(v.substring(_,_+k),y);8>k?(k=c(Math.pow(y,k)),A=A.j(k).add(c(b))):(A=A.j(T),A=A.add(c(b)))}return A}var p=u(0),g=u(1),x=u(16777216);t=o.prototype,t.m=function(){if(C(this))return-D(this).m();for(var v=0,y=1,T=0;T<this.g.length;T++){var A=this.i(T);v+=(0<=A?A:4294967296+A)*y,y*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(N(this))return"0";if(C(this))return"-"+D(this).toString(v);for(var y=c(Math.pow(v,6)),T=this,A="";;){var _=P(T,y).g;T=I(T,_.j(y));var k=((0<T.g.length?T.g[0]:T.h)>>>0).toString(v);if(T=_,N(T))return k+A;for(;6>k.length;)k="0"+k;A=k+A}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function N(v){if(v.h!=0)return!1;for(var y=0;y<v.g.length;y++)if(v.g[y]!=0)return!1;return!0}function C(v){return v.h==-1}t.l=function(v){return v=I(this,v),C(v)?-1:N(v)?0:1};function D(v){for(var y=v.g.length,T=[],A=0;A<y;A++)T[A]=~v.g[A];return new o(T,~v.h).add(g)}t.abs=function(){return C(this)?D(this):this},t.add=function(v){for(var y=Math.max(this.g.length,v.g.length),T=[],A=0,_=0;_<=y;_++){var k=A+(this.i(_)&65535)+(v.i(_)&65535),b=(k>>>16)+(this.i(_)>>>16)+(v.i(_)>>>16);A=b>>>16,k&=65535,b&=65535,T[_]=b<<16|k}return new o(T,T[T.length-1]&-2147483648?-1:0)};function I(v,y){return v.add(D(y))}t.j=function(v){if(N(this)||N(v))return p;if(C(this))return C(v)?D(this).j(D(v)):D(D(this).j(v));if(C(v))return D(this.j(D(v)));if(0>this.l(x)&&0>v.l(x))return c(this.m()*v.m());for(var y=this.g.length+v.g.length,T=[],A=0;A<2*y;A++)T[A]=0;for(A=0;A<this.g.length;A++)for(var _=0;_<v.g.length;_++){var k=this.i(A)>>>16,b=this.i(A)&65535,q=v.i(_)>>>16,W=v.i(_)&65535;T[2*A+2*_]+=b*W,w(T,2*A+2*_),T[2*A+2*_+1]+=k*W,w(T,2*A+2*_+1),T[2*A+2*_+1]+=b*q,w(T,2*A+2*_+1),T[2*A+2*_+2]+=k*q,w(T,2*A+2*_+2)}for(A=0;A<y;A++)T[A]=T[2*A+1]<<16|T[2*A];for(A=y;A<2*y;A++)T[A]=0;return new o(T,0)};function w(v,y){for(;(v[y]&65535)!=v[y];)v[y+1]+=v[y]>>>16,v[y]&=65535,y++}function S(v,y){this.g=v,this.h=y}function P(v,y){if(N(y))throw Error("division by zero");if(N(v))return new S(p,p);if(C(v))return y=P(D(v),y),new S(D(y.g),D(y.h));if(C(y))return y=P(v,D(y)),new S(D(y.g),y.h);if(30<v.g.length){if(C(v)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var T=g,A=y;0>=A.l(v);)T=R(T),A=R(A);var _=V(T,1),k=V(A,1);for(A=V(A,2),T=V(T,2);!N(A);){var b=k.add(A);0>=b.l(v)&&(_=_.add(T),k=b),A=V(A,1),T=V(T,1)}return y=I(v,_.j(y)),new S(_,y)}for(_=p;0<=v.l(y);){for(T=Math.max(1,Math.floor(v.m()/y.m())),A=Math.ceil(Math.log(T)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),k=c(T),b=k.j(y);C(b)||0<b.l(v);)T-=A,k=c(T),b=k.j(y);N(k)&&(k=g),_=_.add(k),v=I(v,b)}return new S(_,v)}t.A=function(v){return P(this,v).h},t.and=function(v){for(var y=Math.max(this.g.length,v.g.length),T=[],A=0;A<y;A++)T[A]=this.i(A)&v.i(A);return new o(T,this.h&v.h)},t.or=function(v){for(var y=Math.max(this.g.length,v.g.length),T=[],A=0;A<y;A++)T[A]=this.i(A)|v.i(A);return new o(T,this.h|v.h)},t.xor=function(v){for(var y=Math.max(this.g.length,v.g.length),T=[],A=0;A<y;A++)T[A]=this.i(A)^v.i(A);return new o(T,this.h^v.h)};function R(v){for(var y=v.g.length+1,T=[],A=0;A<y;A++)T[A]=v.i(A)<<1|v.i(A-1)>>>31;return new o(T,v.h)}function V(v,y){var T=y>>5;y%=32;for(var A=v.g.length-T,_=[],k=0;k<A;k++)_[k]=0<y?v.i(k+T)>>>y|v.i(k+T+1)<<32-y:v.i(k+T);return new o(_,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,iE=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=m,$r=o}).apply(typeof fg<"u"?fg:typeof self<"u"?self:typeof window<"u"?window:{});var Pa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sE,Fs,oE,Qa,bd,aE,lE,uE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,d,f){return a==Array.prototype||a==Object.prototype||(a[d]=f.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pa=="object"&&Pa];for(var d=0;d<a.length;++d){var f=a[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function i(a,d){if(d)e:{var f=r;a=a.split(".");for(var E=0;E<a.length-1;E++){var O=a[E];if(!(O in f))break e;f=f[O]}a=a[a.length-1],E=f[a],d=d(E),d!=E&&d!=null&&e(f,a,{configurable:!0,writable:!0,value:d})}}function s(a,d){a instanceof String&&(a+="");var f=0,E=!1,O={next:function(){if(!E&&f<a.length){var L=f++;return{value:d(L,a[L]),done:!1}}return E=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}i("Array.prototype.values",function(a){return a||function(){return s(this,function(d,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var d=typeof a;return d=d!="object"?d:a?Array.isArray(a)?"array":d:"null",d=="array"||d=="object"&&typeof a.length=="number"}function c(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function m(a,d,f){return a.call.apply(a.bind,arguments)}function p(a,d,f){if(!a)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,E),a.apply(d,O)}}return function(){return a.apply(d,arguments)}}function g(a,d,f){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:p,g.apply(null,arguments)}function x(a,d){var f=Array.prototype.slice.call(arguments,1);return function(){var E=f.slice();return E.push.apply(E,arguments),a.apply(this,E)}}function N(a,d){function f(){}f.prototype=d.prototype,a.aa=d.prototype,a.prototype=new f,a.prototype.constructor=a,a.Qb=function(E,O,L){for(var H=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)H[ge-2]=arguments[ge];return d.prototype[O].apply(E,H)}}function C(a){const d=a.length;if(0<d){const f=Array(d);for(let E=0;E<d;E++)f[E]=a[E];return f}return[]}function D(a,d){for(let f=1;f<arguments.length;f++){const E=arguments[f];if(u(E)){const O=a.length||0,L=E.length||0;a.length=O+L;for(let H=0;H<L;H++)a[O+H]=E[H]}else a.push(E)}}class I{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function w(a){return/^[\s\xa0]*$/.test(a)}function S(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function P(a){return P[" "](a),a}P[" "]=function(){};var R=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function V(a,d,f){for(const E in a)d.call(f,a[E],E,a)}function v(a,d){for(const f in a)d.call(void 0,a[f],f,a)}function y(a){const d={};for(const f in a)d[f]=a[f];return d}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(a,d){let f,E;for(let O=1;O<arguments.length;O++){E=arguments[O];for(f in E)a[f]=E[f];for(let L=0;L<T.length;L++)f=T[L],Object.prototype.hasOwnProperty.call(E,f)&&(a[f]=E[f])}}function _(a){var d=1;a=a.split(":");const f=[];for(;0<d&&a.length;)f.push(a.shift()),d--;return a.length&&f.push(a.join(":")),f}function k(a){l.setTimeout(()=>{throw a},0)}function b(){var a=z;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class q{constructor(){this.h=this.g=null}add(d,f){const E=W.get();E.set(d,f),this.h?this.h.next=E:this.g=E,this.h=E}}var W=new I(()=>new X,a=>a.reset());class X{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Oe,M=!1,z=new q,$=()=>{const a=l.Promise.resolve(void 0);Oe=()=>{a.then(Z)}};var Z=()=>{for(var a;a=b();){try{a.h.call(a.g)}catch(f){k(f)}var d=W;d.j(a),100>d.h&&(d.h++,a.next=d.g,d.g=a)}M=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var fe=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const f=()=>{};l.addEventListener("test",f,d),l.removeEventListener("test",f,d)}catch{}return a}();function Le(a,d){if(J.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var f=this.type=a.type,E=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget){if(R){e:{try{P(d.nodeName);var O=!0;break e}catch{}O=!1}O||(d=null)}}else f=="mouseover"?d=a.fromElement:f=="mouseout"&&(d=a.toElement);this.relatedTarget=d,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:nt[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Le.aa.h.call(this)}}N(Le,J);var nt={2:"touch",3:"pen",4:"mouse"};Le.prototype.h=function(){Le.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Be="closure_listenable_"+(1e6*Math.random()|0),us=0;function cs(a,d,f,E,O){this.listener=a,this.proxy=null,this.src=d,this.type=f,this.capture=!!E,this.ha=O,this.key=++us,this.da=this.fa=!1}function an(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ln(a){this.src=a,this.g={},this.h=0}ln.prototype.add=function(a,d,f,E,O){var L=a.toString();a=this.g[L],a||(a=this.g[L]=[],this.h++);var H=oi(a,d,E,O);return-1<H?(d=a[H],f||(d.fa=!1)):(d=new cs(d,this.src,L,!!E,O),d.fa=f,a.push(d)),d};function Wt(a,d){var f=d.type;if(f in a.g){var E=a.g[f],O=Array.prototype.indexOf.call(E,d,void 0),L;(L=0<=O)&&Array.prototype.splice.call(E,O,1),L&&(an(d),a.g[f].length==0&&(delete a.g[f],a.h--))}}function oi(a,d,f,E){for(var O=0;O<a.length;++O){var L=a[O];if(!L.da&&L.listener==d&&L.capture==!!f&&L.ha==E)return O}return-1}var Cr="closure_lm_"+(1e6*Math.random()|0),ds={};function se(a,d,f,E,O){if(Array.isArray(d)){for(var L=0;L<d.length;L++)se(a,d[L],f,E,O);return null}return f=ai(f),a&&a[Be]?a.K(d,f,c(E)?!!E.capture:!1,O):ve(a,d,f,!1,E,O)}function ve(a,d,f,E,O,L){if(!d)throw Error("Invalid event type");var H=c(O)?!!O.capture:!!O,ge=_n(a);if(ge||(a[Cr]=ge=new ln(a)),f=ge.add(d,f,E,H,L),f.proxy)return f;if(E=Re(),f.proxy=E,E.src=a,E.listener=f,a.addEventListener)fe||(O=H),O===void 0&&(O=!1),a.addEventListener(d.toString(),E,O);else if(a.attachEvent)a.attachEvent(Pt(d.toString()),E);else if(a.addListener&&a.removeListener)a.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Re(){function a(f){return d.call(a.src,a.listener,f)}const d=qt;return a}function Ne(a,d,f,E,O){if(Array.isArray(d))for(var L=0;L<d.length;L++)Ne(a,d[L],f,E,O);else E=c(E)?!!E.capture:!!E,f=ai(f),a&&a[Be]?(a=a.i,d=String(d).toString(),d in a.g&&(L=a.g[d],f=oi(L,f,E,O),-1<f&&(an(L[f]),Array.prototype.splice.call(L,f,1),L.length==0&&(delete a.g[d],a.h--)))):a&&(a=_n(a))&&(d=a.g[d.toString()],a=-1,d&&(a=oi(d,f,E,O)),(f=-1<a?d[a]:null)&&rt(f))}function rt(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[Be])Wt(d.i,a);else{var f=a.type,E=a.proxy;d.removeEventListener?d.removeEventListener(f,E,a.capture):d.detachEvent?d.detachEvent(Pt(f),E):d.addListener&&d.removeListener&&d.removeListener(E),(f=_n(d))?(Wt(f,a),f.h==0&&(f.src=null,d[Cr]=null)):an(a)}}}function Pt(a){return a in ds?ds[a]:ds[a]="on"+a}function qt(a,d){if(a.da)a=!0;else{d=new Le(d,this);var f=a.listener,E=a.ha||a.src;a.fa&&rt(a),a=f.call(E,d)}return a}function _n(a){return a=a[Cr],a instanceof ln?a:null}var Hn="__closure_events_fn_"+(1e9*Math.random()>>>0);function ai(a){return typeof a=="function"?a:(a[Hn]||(a[Hn]=function(d){return a.handleEvent(d)}),a[Hn])}function be(){ee.call(this),this.i=new ln(this),this.M=this,this.F=null}N(be,ee),be.prototype[Be]=!0,be.prototype.removeEventListener=function(a,d,f,E){Ne(this,a,d,f,E)};function He(a,d){var f,E=a.F;if(E)for(f=[];E;E=E.F)f.push(E);if(a=a.M,E=d.type||d,typeof d=="string")d=new J(d,a);else if(d instanceof J)d.target=d.target||a;else{var O=d;d=new J(E,a),A(d,O)}if(O=!0,f)for(var L=f.length-1;0<=L;L--){var H=d.g=f[L];O=En(H,E,!0,d)&&O}if(H=d.g=a,O=En(H,E,!0,d)&&O,O=En(H,E,!1,d)&&O,f)for(L=0;L<f.length;L++)H=d.g=f[L],O=En(H,E,!1,d)&&O}be.prototype.N=function(){if(be.aa.N.call(this),this.i){var a=this.i,d;for(d in a.g){for(var f=a.g[d],E=0;E<f.length;E++)an(f[E]);delete a.g[d],a.h--}}this.F=null},be.prototype.K=function(a,d,f,E){return this.i.add(String(a),d,!1,f,E)},be.prototype.L=function(a,d,f,E){return this.i.add(String(a),d,!0,f,E)};function En(a,d,f,E){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();for(var O=!0,L=0;L<d.length;++L){var H=d[L];if(H&&!H.da&&H.capture==f){var ge=H.listener,Ge=H.ha||H.src;H.fa&&Wt(a.i,H),O=ge.call(Ge,E)!==!1&&O}}return O&&!E.defaultPrevented}function Qo(a,d,f){if(typeof a=="function")f&&(a=g(a,f));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(a,d||0)}function Mf(a){a.g=Qo(()=>{a.g=null,a.i&&(a.i=!1,Mf(a))},a.l);const d=a.h;a.h=null,a.m.apply(null,d)}class Pw extends ee{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Mf(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hs(a){ee.call(this),this.h=a,this.g={}}N(hs,ee);var Ff=[];function Uf(a){V(a.g,function(d,f){this.g.hasOwnProperty(f)&&rt(d)},a),a.g={}}hs.prototype.N=function(){hs.aa.N.call(this),Uf(this)},hs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var wu=l.JSON.stringify,kw=l.JSON.parse,Rw=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Iu(){}Iu.prototype.h=null;function Bf(a){return a.h||(a.h=a.i())}function jf(){}var fs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Tu(){J.call(this,"d")}N(Tu,J);function bu(){J.call(this,"c")}N(bu,J);var Ar={},zf=null;function Xo(){return zf=zf||new be}Ar.La="serverreachability";function $f(a){J.call(this,Ar.La,a)}N($f,J);function ms(a){const d=Xo();He(d,new $f(d))}Ar.STAT_EVENT="statevent";function Hf(a,d){J.call(this,Ar.STAT_EVENT,a),this.stat=d}N(Hf,J);function gt(a){const d=Xo();He(d,new Hf(d,a))}Ar.Ma="timingevent";function Wf(a,d){J.call(this,Ar.Ma,a),this.size=d}N(Wf,J);function ps(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},d)}function gs(){this.g=!0}gs.prototype.xa=function(){this.g=!1};function Nw(a,d,f,E,O,L){a.info(function(){if(a.g)if(L)for(var H="",ge=L.split("&"),Ge=0;Ge<ge.length;Ge++){var de=ge[Ge].split("=");if(1<de.length){var it=de[0];de=de[1];var st=it.split("_");H=2<=st.length&&st[1]=="type"?H+(it+"="+de+"&"):H+(it+"=redacted&")}}else H=null;else H=L;return"XMLHTTP REQ ("+E+") [attempt "+O+"]: "+d+`
`+f+`
`+H})}function Dw(a,d,f,E,O,L,H){a.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+O+"]: "+d+`
`+f+`
`+L+" "+H})}function li(a,d,f,E){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+Ow(a,f)+(E?" "+E:"")})}function Vw(a,d){a.info(function(){return"TIMEOUT: "+d})}gs.prototype.info=function(){};function Ow(a,d){if(!a.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(a=0;a<f.length;a++)if(Array.isArray(f[a])){var E=f[a];if(!(2>E.length)){var O=E[1];if(Array.isArray(O)&&!(1>O.length)){var L=O[0];if(L!="noop"&&L!="stop"&&L!="close")for(var H=1;H<O.length;H++)O[H]=""}}}}return wu(f)}catch{return d}}var Yo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qf={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xu;function Jo(){}N(Jo,Iu),Jo.prototype.g=function(){return new XMLHttpRequest},Jo.prototype.i=function(){return{}},xu=new Jo;function Wn(a,d,f,E){this.j=a,this.i=d,this.l=f,this.R=E||1,this.U=new hs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Kf}function Kf(){this.i=null,this.g="",this.h=!1}var Gf={},Su={};function Cu(a,d,f){a.L=1,a.v=na(wn(d)),a.m=f,a.P=!0,Qf(a,null)}function Qf(a,d){a.F=Date.now(),Zo(a),a.A=wn(a.v);var f=a.A,E=a.R;Array.isArray(E)||(E=[String(E)]),um(f.i,"t",E),a.C=0,f=a.j.J,a.h=new Kf,a.g=Cm(a.j,f?d:null,!a.m),0<a.O&&(a.M=new Pw(g(a.Y,a,a.g),a.O)),d=a.U,f=a.g,E=a.ca;var O="readystatechange";Array.isArray(O)||(O&&(Ff[0]=O.toString()),O=Ff);for(var L=0;L<O.length;L++){var H=se(f,O[L],E||d.handleEvent,!1,d.h||d);if(!H)break;d.g[H.key]=H}d=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,d)):(a.u="GET",a.g.ea(a.A,a.u,null,d)),ms(),Nw(a.i,a.u,a.A,a.l,a.R,a.m)}Wn.prototype.ca=function(a){a=a.target;const d=this.M;d&&In(a)==3?d.j():this.Y(a)},Wn.prototype.Y=function(a){try{if(a==this.g)e:{const st=In(this.g);var d=this.g.Ba();const di=this.g.Z();if(!(3>st)&&(st!=3||this.g&&(this.h.h||this.g.oa()||gm(this.g)))){this.J||st!=4||d==7||(d==8||0>=di?ms(3):ms(2)),Au(this);var f=this.g.Z();this.X=f;t:if(Xf(this)){var E=gm(this.g);a="";var O=E.length,L=In(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Pr(this),ys(this);var H="";break t}this.h.i=new l.TextDecoder}for(d=0;d<O;d++)this.h.h=!0,a+=this.h.i.decode(E[d],{stream:!(L&&d==O-1)});E.length=0,this.h.g+=a,this.C=0,H=this.h.g}else H=this.g.oa();if(this.o=f==200,Dw(this.i,this.u,this.A,this.l,this.R,st,f),this.o){if(this.T&&!this.K){t:{if(this.g){var ge,Ge=this.g;if((ge=Ge.g?Ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(ge)){var de=ge;break t}}de=null}if(f=de)li(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pu(this,f);else{this.o=!1,this.s=3,gt(12),Pr(this),ys(this);break e}}if(this.P){f=!0;let Kt;for(;!this.J&&this.C<H.length;)if(Kt=Lw(this,H),Kt==Su){st==4&&(this.s=4,gt(14),f=!1),li(this.i,this.l,null,"[Incomplete Response]");break}else if(Kt==Gf){this.s=4,gt(15),li(this.i,this.l,H,"[Invalid Chunk]"),f=!1;break}else li(this.i,this.l,Kt,null),Pu(this,Kt);if(Xf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),st!=4||H.length!=0||this.h.h||(this.s=1,gt(16),f=!1),this.o=this.o&&f,!f)li(this.i,this.l,H,"[Invalid Chunked Response]"),Pr(this),ys(this);else if(0<H.length&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.ba&&!it.M&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),Ou(it),it.M=!0,gt(11))}}else li(this.i,this.l,H,null),Pu(this,H);st==4&&Pr(this),this.o&&!this.J&&(st==4?Tm(this.j,this):(this.o=!1,Zo(this)))}else Zw(this.g),f==400&&0<H.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),Pr(this),ys(this)}}}catch{}finally{}};function Xf(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Lw(a,d){var f=a.C,E=d.indexOf(`
`,f);return E==-1?Su:(f=Number(d.substring(f,E)),isNaN(f)?Gf:(E+=1,E+f>d.length?Su:(d=d.slice(E,E+f),a.C=E+f,d)))}Wn.prototype.cancel=function(){this.J=!0,Pr(this)};function Zo(a){a.S=Date.now()+a.I,Yf(a,a.I)}function Yf(a,d){if(a.B!=null)throw Error("WatchDog timer not null");a.B=ps(g(a.ba,a),d)}function Au(a){a.B&&(l.clearTimeout(a.B),a.B=null)}Wn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Vw(this.i,this.A),this.L!=2&&(ms(),gt(17)),Pr(this),this.s=2,ys(this)):Yf(this,this.S-a)};function ys(a){a.j.G==0||a.J||Tm(a.j,a)}function Pr(a){Au(a);var d=a.M;d&&typeof d.ma=="function"&&d.ma(),a.M=null,Uf(a.U),a.g&&(d=a.g,a.g=null,d.abort(),d.ma())}function Pu(a,d){try{var f=a.j;if(f.G!=0&&(f.g==a||ku(f.h,a))){if(!a.K&&ku(f.h,a)&&f.G==3){try{var E=f.Da.g.parse(d)}catch{E=null}if(Array.isArray(E)&&E.length==3){var O=E;if(O[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<a.F)la(f),oa(f);else break e;Vu(f),gt(18)}}else f.za=O[1],0<f.za-f.T&&37500>O[2]&&f.F&&f.v==0&&!f.C&&(f.C=ps(g(f.Za,f),6e3));if(1>=em(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Rr(f,11)}else if((a.K||f.g==a)&&la(f),!w(d))for(O=f.Da.g.parse(d),d=0;d<O.length;d++){let de=O[d];if(f.T=de[0],de=de[1],f.G==2)if(de[0]=="c"){f.K=de[1],f.ia=de[2];const it=de[3];it!=null&&(f.la=it,f.j.info("VER="+f.la));const st=de[4];st!=null&&(f.Aa=st,f.j.info("SVER="+f.Aa));const di=de[5];di!=null&&typeof di=="number"&&0<di&&(E=1.5*di,f.L=E,f.j.info("backChannelRequestTimeoutMs_="+E)),E=f;const Kt=a.g;if(Kt){const ca=Kt.g?Kt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ca){var L=E.h;L.g||ca.indexOf("spdy")==-1&&ca.indexOf("quic")==-1&&ca.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Ru(L,L.h),L.h=null))}if(E.D){const Lu=Kt.g?Kt.g.getResponseHeader("X-HTTP-Session-Id"):null;Lu&&(E.ya=Lu,_e(E.I,E.D,Lu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-a.F,f.j.info("Handshake RTT: "+f.R+"ms")),E=f;var H=a;if(E.qa=Sm(E,E.J?E.ia:null,E.W),H.K){tm(E.h,H);var ge=H,Ge=E.L;Ge&&(ge.I=Ge),ge.B&&(Au(ge),Zo(ge)),E.g=H}else wm(E);0<f.i.length&&aa(f)}else de[0]!="stop"&&de[0]!="close"||Rr(f,7);else f.G==3&&(de[0]=="stop"||de[0]=="close"?de[0]=="stop"?Rr(f,7):Du(f):de[0]!="noop"&&f.l&&f.l.ta(de),f.v=0)}}ms(4)}catch{}}var Mw=class{constructor(a,d){this.g=a,this.map=d}};function Jf(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Zf(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function em(a){return a.h?1:a.g?a.g.size:0}function ku(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function Ru(a,d){a.g?a.g.add(d):a.h=d}function tm(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}Jf.prototype.cancel=function(){if(this.i=nm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function nm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let d=a.i;for(const f of a.g.values())d=d.concat(f.D);return d}return C(a.i)}function Fw(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var d=[],f=a.length,E=0;E<f;E++)d.push(a[E]);return d}d=[],f=0;for(E in a)d[f++]=a[E];return d}function Uw(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var d=[];a=a.length;for(var f=0;f<a;f++)d.push(f);return d}d=[],f=0;for(const E in a)d[f++]=E;return d}}}function rm(a,d){if(a.forEach&&typeof a.forEach=="function")a.forEach(d,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,d,void 0);else for(var f=Uw(a),E=Fw(a),O=E.length,L=0;L<O;L++)d.call(void 0,E[L],f&&f[L],a)}var im=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bw(a,d){if(a){a=a.split("&");for(var f=0;f<a.length;f++){var E=a[f].indexOf("="),O=null;if(0<=E){var L=a[f].substring(0,E);O=a[f].substring(E+1)}else L=a[f];d(L,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function kr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof kr){this.h=a.h,ea(this,a.j),this.o=a.o,this.g=a.g,ta(this,a.s),this.l=a.l;var d=a.i,f=new Es;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),sm(this,f),this.m=a.m}else a&&(d=String(a).match(im))?(this.h=!1,ea(this,d[1]||"",!0),this.o=vs(d[2]||""),this.g=vs(d[3]||"",!0),ta(this,d[4]),this.l=vs(d[5]||"",!0),sm(this,d[6]||"",!0),this.m=vs(d[7]||"")):(this.h=!1,this.i=new Es(null,this.h))}kr.prototype.toString=function(){var a=[],d=this.j;d&&a.push(_s(d,om,!0),":");var f=this.g;return(f||d=="file")&&(a.push("//"),(d=this.o)&&a.push(_s(d,om,!0),"@"),a.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&a.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(_s(f,f.charAt(0)=="/"?$w:zw,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",_s(f,Ww)),a.join("")};function wn(a){return new kr(a)}function ea(a,d,f){a.j=f?vs(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function ta(a,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);a.s=d}else a.s=null}function sm(a,d,f){d instanceof Es?(a.i=d,qw(a.i,a.h)):(f||(d=_s(d,Hw)),a.i=new Es(d,a.h))}function _e(a,d,f){a.i.set(d,f)}function na(a){return _e(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function vs(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function _s(a,d,f){return typeof a=="string"?(a=encodeURI(a).replace(d,jw),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function jw(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var om=/[#\/\?@]/g,zw=/[#\?:]/g,$w=/[#\?]/g,Hw=/[#\?@]/g,Ww=/#/g;function Es(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function qn(a){a.g||(a.g=new Map,a.h=0,a.i&&Bw(a.i,function(d,f){a.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}t=Es.prototype,t.add=function(a,d){qn(this),this.i=null,a=ui(this,a);var f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(d),this.h+=1,this};function am(a,d){qn(a),d=ui(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function lm(a,d){return qn(a),d=ui(a,d),a.g.has(d)}t.forEach=function(a,d){qn(this),this.g.forEach(function(f,E){f.forEach(function(O){a.call(d,O,E,this)},this)},this)},t.na=function(){qn(this);const a=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let E=0;E<d.length;E++){const O=a[E];for(let L=0;L<O.length;L++)f.push(d[E])}return f},t.V=function(a){qn(this);let d=[];if(typeof a=="string")lm(this,a)&&(d=d.concat(this.g.get(ui(this,a))));else{a=Array.from(this.g.values());for(let f=0;f<a.length;f++)d=d.concat(a[f])}return d},t.set=function(a,d){return qn(this),this.i=null,a=ui(this,a),lm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},t.get=function(a,d){return a?(a=this.V(a),0<a.length?String(a[0]):d):d};function um(a,d,f){am(a,d),0<f.length&&(a.i=null,a.g.set(ui(a,d),C(f)),a.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var E=d[f];const L=encodeURIComponent(String(E)),H=this.V(E);for(E=0;E<H.length;E++){var O=L;H[E]!==""&&(O+="="+encodeURIComponent(String(H[E]))),a.push(O)}}return this.i=a.join("&")};function ui(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function qw(a,d){d&&!a.j&&(qn(a),a.i=null,a.g.forEach(function(f,E){var O=E.toLowerCase();E!=O&&(am(this,E),um(this,O,f))},a)),a.j=d}function Kw(a,d){const f=new gs;if(l.Image){const E=new Image;E.onload=x(Kn,f,"TestLoadImage: loaded",!0,d,E),E.onerror=x(Kn,f,"TestLoadImage: error",!1,d,E),E.onabort=x(Kn,f,"TestLoadImage: abort",!1,d,E),E.ontimeout=x(Kn,f,"TestLoadImage: timeout",!1,d,E),l.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=a}else d(!1)}function Gw(a,d){const f=new gs,E=new AbortController,O=setTimeout(()=>{E.abort(),Kn(f,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:E.signal}).then(L=>{clearTimeout(O),L.ok?Kn(f,"TestPingServer: ok",!0,d):Kn(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(O),Kn(f,"TestPingServer: error",!1,d)})}function Kn(a,d,f,E,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),E(f)}catch{}}function Qw(){this.g=new Rw}function Xw(a,d,f){const E=f||"";try{rm(a,function(O,L){let H=O;c(O)&&(H=wu(O)),d.push(E+L+"="+encodeURIComponent(H))})}catch(O){throw d.push(E+"type="+encodeURIComponent("_badmap")),O}}function ra(a){this.l=a.Ub||null,this.j=a.eb||!1}N(ra,Iu),ra.prototype.g=function(){return new ia(this.l,this.j)},ra.prototype.i=function(a){return function(){return a}}({});function ia(a,d){be.call(this),this.D=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(ia,be),t=ia.prototype,t.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=d,this.readyState=1,Is(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(d.body=a),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ws(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Is(this)),this.g&&(this.readyState=3,Is(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;cm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function cm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?ws(this):Is(this),this.readyState==3&&cm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,ws(this))},t.Qa=function(a){this.g&&(this.response=a,ws(this))},t.ga=function(){this.g&&ws(this)};function ws(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Is(a)}t.setRequestHeader=function(a,d){this.u.append(a,d)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=d.next();return a.join(`\r
`)};function Is(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ia.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function dm(a){let d="";return V(a,function(f,E){d+=E,d+=":",d+=f,d+=`\r
`}),d}function Nu(a,d,f){e:{for(E in f){var E=!1;break e}E=!0}E||(f=dm(f),typeof a=="string"?f!=null&&encodeURIComponent(String(f)):_e(a,d,f))}function Pe(a){be.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(Pe,be);var Yw=/^https?$/i,Jw=["POST","PUT"];t=Pe.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,d,f,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xu.g(),this.v=this.o?Bf(this.o):Bf(xu),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(L){hm(this,L);return}if(a=f||"",f=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var O in E)f.set(O,E[O]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const L of E.keys())f.set(L,E.get(L));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(f.keys()).find(L=>L.toLowerCase()=="content-type"),O=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Jw,d,void 0))||E||O||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,H]of f)this.g.setRequestHeader(L,H);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pm(this),this.u=!0,this.g.send(a),this.u=!1}catch(L){hm(this,L)}};function hm(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.m=5,fm(a),sa(a)}function fm(a){a.A||(a.A=!0,He(a,"complete"),He(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,He(this,"complete"),He(this,"abort"),sa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),sa(this,!0)),Pe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?mm(this):this.bb())},t.bb=function(){mm(this)};function mm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||In(a)!=4||a.Z()!=2)){if(a.u&&In(a)==4)Qo(a.Ea,0,a);else if(He(a,"readystatechange"),In(a)==4){a.h=!1;try{const H=a.Z();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var E;if(E=H===0){var O=String(a.D).match(im)[1]||null;!O&&l.self&&l.self.location&&(O=l.self.location.protocol.slice(0,-1)),E=!Yw.test(O?O.toLowerCase():"")}f=E}if(f)He(a,"complete"),He(a,"success");else{a.m=6;try{var L=2<In(a)?a.g.statusText:""}catch{L=""}a.l=L+" ["+a.Z()+"]",fm(a)}}finally{sa(a)}}}}function sa(a,d){if(a.g){pm(a);const f=a.g,E=a.v[0]?()=>{}:null;a.g=null,a.v=null,d||He(a,"ready");try{f.onreadystatechange=E}catch{}}}function pm(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function In(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<In(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),kw(d)}};function gm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Zw(a){const d={};a=(a.g&&2<=In(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<a.length;E++){if(w(a[E]))continue;var f=_(a[E]);const O=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const L=d[O]||[];d[O]=L,L.push(f)}v(d,function(E){return E.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ts(a,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||d}function ym(a){this.Aa=0,this.i=[],this.j=new gs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ts("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ts("baseRetryDelayMs",5e3,a),this.cb=Ts("retryDelaySeedMs",1e4,a),this.Wa=Ts("forwardChannelMaxRetries",2,a),this.wa=Ts("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Jf(a&&a.concurrentRequestLimit),this.Da=new Qw,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ym.prototype,t.la=8,t.G=1,t.connect=function(a,d,f,E){gt(0),this.W=a,this.H=d||{},f&&E!==void 0&&(this.H.OSID=f,this.H.OAID=E),this.F=this.X,this.I=Sm(this,null,this.W),aa(this)};function Du(a){if(vm(a),a.G==3){var d=a.U++,f=wn(a.I);if(_e(f,"SID",a.K),_e(f,"RID",d),_e(f,"TYPE","terminate"),bs(a,f),d=new Wn(a,a.j,d),d.L=2,d.v=na(wn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=d.v,f=!0),f||(d.g=Cm(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Zo(d)}xm(a)}function oa(a){a.g&&(Ou(a),a.g.cancel(),a.g=null)}function vm(a){oa(a),a.u&&(l.clearTimeout(a.u),a.u=null),la(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function aa(a){if(!Zf(a.h)&&!a.s){a.s=!0;var d=a.Ga;Oe||$(),M||(Oe(),M=!0),z.add(d,a),a.B=0}}function e0(a,d){return em(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=d.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=ps(g(a.Ga,a,d),bm(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const O=new Wn(this,this.j,a);let L=this.o;if(this.S&&(L?(L=y(L),A(L,this.S)):L=this.S),this.m!==null||this.O||(O.H=L,L=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var E=this.i[f];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(d+=E,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Em(this,O,d),f=wn(this.I),_e(f,"RID",a),_e(f,"CVER",22),this.D&&_e(f,"X-HTTP-Session-Id",this.D),bs(this,f),L&&(this.O?d="headers="+encodeURIComponent(String(dm(L)))+"&"+d:this.m&&Nu(f,this.m,L)),Ru(this.h,O),this.Ua&&_e(f,"TYPE","init"),this.P?(_e(f,"$req",d),_e(f,"SID","null"),O.T=!0,Cu(O,f,null)):Cu(O,f,d),this.G=2}}else this.G==3&&(a?_m(this,a):this.i.length==0||Zf(this.h)||_m(this))};function _m(a,d){var f;d?f=d.l:f=a.U++;const E=wn(a.I);_e(E,"SID",a.K),_e(E,"RID",f),_e(E,"AID",a.T),bs(a,E),a.m&&a.o&&Nu(E,a.m,a.o),f=new Wn(a,a.j,f,a.B+1),a.m===null&&(f.H=a.o),d&&(a.i=d.D.concat(a.i)),d=Em(a,f,1e3),f.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ru(a.h,f),Cu(f,E,d)}function bs(a,d){a.H&&V(a.H,function(f,E){_e(d,E,f)}),a.l&&rm({},function(f,E){_e(d,E,f)})}function Em(a,d,f){f=Math.min(a.i.length,f);var E=a.l?g(a.l.Na,a.l,a):null;e:{var O=a.i;let L=-1;for(;;){const H=["count="+f];L==-1?0<f?(L=O[0].g,H.push("ofs="+L)):L=0:H.push("ofs="+L);let ge=!0;for(let Ge=0;Ge<f;Ge++){let de=O[Ge].g;const it=O[Ge].map;if(de-=L,0>de)L=Math.max(0,O[Ge].g-100),ge=!1;else try{Xw(it,H,"req"+de+"_")}catch{E&&E(it)}}if(ge){E=H.join("&");break e}}}return a=a.i.splice(0,f),d.D=a,E}function wm(a){if(!a.g&&!a.u){a.Y=1;var d=a.Fa;Oe||$(),M||(Oe(),M=!0),z.add(d,a),a.v=0}}function Vu(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=ps(g(a.Fa,a),bm(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Im(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=ps(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),oa(this),Im(this))};function Ou(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Im(a){a.g=new Wn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var d=wn(a.qa);_e(d,"RID","rpc"),_e(d,"SID",a.K),_e(d,"AID",a.T),_e(d,"CI",a.F?"0":"1"),!a.F&&a.ja&&_e(d,"TO",a.ja),_e(d,"TYPE","xmlhttp"),bs(a,d),a.m&&a.o&&Nu(d,a.m,a.o),a.L&&(a.g.I=a.L);var f=a.g;a=a.ia,f.L=1,f.v=na(wn(d)),f.m=null,f.P=!0,Qf(f,a)}t.Za=function(){this.C!=null&&(this.C=null,oa(this),Vu(this),gt(19))};function la(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Tm(a,d){var f=null;if(a.g==d){la(a),Ou(a),a.g=null;var E=2}else if(ku(a.h,d))f=d.D,tm(a.h,d),E=1;else return;if(a.G!=0){if(d.o)if(E==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var O=a.B;E=Xo(),He(E,new Wf(E,f)),aa(a)}else wm(a);else if(O=d.s,O==3||O==0&&0<d.X||!(E==1&&e0(a,d)||E==2&&Vu(a)))switch(f&&0<f.length&&(d=a.h,d.i=d.i.concat(f)),O){case 1:Rr(a,5);break;case 4:Rr(a,10);break;case 3:Rr(a,6);break;default:Rr(a,2)}}}function bm(a,d){let f=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(f*=2),f*d}function Rr(a,d){if(a.j.info("Error code "+d),d==2){var f=g(a.fb,a),E=a.Xa;const O=!E;E=new kr(E||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ea(E,"https"),na(E),O?Kw(E.toString(),f):Gw(E.toString(),f)}else gt(2);a.G=0,a.l&&a.l.sa(d),xm(a),vm(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function xm(a){if(a.G=0,a.ka=[],a.l){const d=nm(a.h);(d.length!=0||a.i.length!=0)&&(D(a.ka,d),D(a.ka,a.i),a.h.i.length=0,C(a.i),a.i.length=0),a.l.ra()}}function Sm(a,d,f){var E=f instanceof kr?wn(f):new kr(f);if(E.g!="")d&&(E.g=d+"."+E.g),ta(E,E.s);else{var O=l.location;E=O.protocol,d=d?d+"."+O.hostname:O.hostname,O=+O.port;var L=new kr(null);E&&ea(L,E),d&&(L.g=d),O&&ta(L,O),f&&(L.l=f),E=L}return f=a.D,d=a.ya,f&&d&&_e(E,f,d),_e(E,"VER",a.la),bs(a,E),E}function Cm(a,d,f){if(d&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Ca&&!a.pa?new Pe(new ra({eb:f})):new Pe(a.pa),d.Ha(a.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Am(){}t=Am.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ua(){}ua.prototype.g=function(a,d){return new kt(a,d)};function kt(a,d){be.call(this),this.g=new ym(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(a?a["X-WebChannel-Client-Profile"]=d.va:a={"X-WebChannel-Client-Profile":d.va}),this.g.S=a,(a=d&&d.Sb)&&!w(a)&&(this.g.m=a),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!w(d)&&(this.g.D=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new ci(this)}N(kt,be),kt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kt.prototype.close=function(){Du(this.g)},kt.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.u&&(f={},f.__data__=wu(a),a=f);d.i.push(new Mw(d.Ya++,a)),d.G==3&&aa(d)},kt.prototype.N=function(){this.g.l=null,delete this.j,Du(this.g),delete this.g,kt.aa.N.call(this)};function Pm(a){Tu.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(const f in d){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}N(Pm,Tu);function km(){bu.call(this),this.status=1}N(km,bu);function ci(a){this.g=a}N(ci,Am),ci.prototype.ua=function(){He(this.g,"a")},ci.prototype.ta=function(a){He(this.g,new Pm(a))},ci.prototype.sa=function(a){He(this.g,new km)},ci.prototype.ra=function(){He(this.g,"b")},ua.prototype.createWebChannel=ua.prototype.g,kt.prototype.send=kt.prototype.o,kt.prototype.open=kt.prototype.m,kt.prototype.close=kt.prototype.close,uE=function(){return new ua},lE=function(){return Xo()},aE=Ar,bd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Yo.NO_ERROR=0,Yo.TIMEOUT=8,Yo.HTTP_ERROR=6,Qa=Yo,qf.COMPLETE="complete",oE=qf,jf.EventType=fs,fs.OPEN="a",fs.CLOSE="b",fs.ERROR="c",fs.MESSAGE="d",be.prototype.listen=be.prototype.K,Fs=jf,Pe.prototype.listenOnce=Pe.prototype.L,Pe.prototype.getLastError=Pe.prototype.Ka,Pe.prototype.getLastErrorCode=Pe.prototype.Ba,Pe.prototype.getStatus=Pe.prototype.Z,Pe.prototype.getResponseJson=Pe.prototype.Oa,Pe.prototype.getResponseText=Pe.prototype.oa,Pe.prototype.send=Pe.prototype.ea,Pe.prototype.setWithCredentials=Pe.prototype.Ha,sE=Pe}).apply(typeof Pa<"u"?Pa:typeof self<"u"?self:typeof window<"u"?window:{});const mg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ss="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new Vh("@firebase/firestore");function Ds(){return Jr.logLevel}function Q(t,...e){if(Jr.logLevel<=le.DEBUG){const n=e.map(Gh);Jr.debug(`Firestore (${ss}): ${t}`,...n)}}function Bn(t,...e){if(Jr.logLevel<=le.ERROR){const n=e.map(Gh);Jr.error(`Firestore (${ss}): ${t}`,...n)}}function Ki(t,...e){if(Jr.logLevel<=le.WARN){const n=e.map(Gh);Jr.warn(`Firestore (${ss}): ${t}`,...n)}}function Gh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(t="Unexpected state"){const e=`FIRESTORE (${ss}) INTERNAL ASSERTION FAILED: `+t;throw Bn(e),new Error(e)}function pe(t,e){t||ne()}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends $n{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ut.UNAUTHENTICATED))}shutdown(){}}class iC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class sC{constructor(e){this.t=e,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){pe(this.o===void 0);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new Dn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dn,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pe(typeof r.accessToken=="string"),new cE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pe(e===null||typeof e=="string"),new ut(e)}}class oC{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class aC{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new oC(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uC{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){pe(this.o===void 0);const r=s=>{s.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(pe(typeof n.token=="string"),this.R=n.token,new lC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=cC(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function he(t,e){return t<e?-1:t>e?1:0}function Gi(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $e.fromMillis(Date.now())}static fromDate(e){return $e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new $e(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new $e(0,0))}static max(){return new re(new $e(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n,r){n===void 0?n=0:n>e.length&&ne(),r===void 0?r=e.length-n:r>e.length-n&&ne(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return To.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof To?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class we extends To{construct(e,n,r){return new we(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new we(n)}static emptyPath(){return new we([])}}const dC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ye extends To{construct(e,n,r){return new Ye(e,n,r)}static isValidIdentifier(e){return dC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ye.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ye(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new G(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new G(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new G(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ye(n)}static emptyPath(){return new Ye([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(we.fromString(e))}static fromName(e){return new Y(we.fromString(e).popFirst(5))}static empty(){return new Y(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return we.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new we(e.slice()))}}function hC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=re.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new Er(i,Y.empty(),e)}function fC(t){return new Er(t.readTime,t.key,-1)}class Er{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Er(re.min(),Y.empty(),-1)}static max(){return new Er(re.max(),Y.empty(),-1)}}function mC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Y.comparator(t.documentKey,e.documentKey),n!==0?n:he(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jo(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==pC)throw t;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ne(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(i=>i?U.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new U((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const c=u;n(e[c]).next(m=>{o[c]=m,++l,l===s&&r(o)},m=>i(m))}})}static doWhile(e,n){return new U((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function yC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function zo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Qh.oe=-1;function au(t){return t==null}function Dl(t){return t===0&&1/t==-1/0}function vC(t){return typeof t=="number"&&Number.isInteger(t)&&!Dl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function os(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e,n){this.comparator=e,this.root=n||Xe.EMPTY}insert(e,n){return new Ae(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Xe.BLACK,null,null))}remove(e){return new Ae(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xe.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ka(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ka(this.root,e,this.comparator,!1)}getReverseIterator(){return new ka(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ka(this.root,e,this.comparator,!0)}}class ka{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xe{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Xe.RED,this.left=i??Xe.EMPTY,this.right=s??Xe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Xe(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Xe.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ne();const e=this.left.check();if(e!==this.right.check())throw ne();return e+(this.isRed()?0:1)}}Xe.EMPTY=null,Xe.RED=!0,Xe.BLACK=!1;Xe.EMPTY=new class{constructor(){this.size=0}get key(){throw ne()}get value(){throw ne()}get color(){throw ne()}get left(){throw ne()}get right(){throw ne()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Xe(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new gg(this.data.getIterator())}getIteratorFrom(e){return new gg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ze)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ze(this.comparator);return n.data=e,n}}class gg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.fields=e,e.sort(Ye.comparator)}static empty(){return new Jt([])}unionWith(e){let n=new Ze(Ye.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Jt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Gi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new fE("Invalid base64 string: "+s):s}}(e);return new tt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new tt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tt.EMPTY_BYTE_STRING=new tt("");const _C=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wr(t){if(pe(!!t),typeof t=="string"){let e=0;const n=_C.exec(t);if(pe(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:De(t.seconds),nanos:De(t.nanos)}}function De(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zr(t){return typeof t=="string"?tt.fromBase64String(t):tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Yh(t){const e=t.mapValue.fields.__previous_value__;return Xh(e)?Yh(e):e}function bo(t){const e=wr(t.mapValue.fields.__local_write_time__.timestampValue);return new $e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,n,r,i,s,o,l,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=c}}class xo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new xo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof xo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra={mapValue:{}};function ei(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xh(t)?4:IC(t)?9007199254740991:wC(t)?10:11:ne()}function vn(t,e){if(t===e)return!0;const n=ei(t);if(n!==ei(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bo(t).isEqual(bo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=wr(i.timestampValue),l=wr(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Zr(i.bytesValue).isEqual(Zr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return De(i.geoPointValue.latitude)===De(s.geoPointValue.latitude)&&De(i.geoPointValue.longitude)===De(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return De(i.integerValue)===De(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=De(i.doubleValue),l=De(s.doubleValue);return o===l?Dl(o)===Dl(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Gi(t.arrayValue.values||[],e.arrayValue.values||[],vn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(pg(o)!==pg(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!vn(o[u],l[u])))return!1;return!0}(t,e);default:return ne()}}function So(t,e){return(t.values||[]).find(n=>vn(n,e))!==void 0}function Qi(t,e){if(t===e)return 0;const n=ei(t),r=ei(e);if(n!==r)return he(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return he(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=De(s.integerValue||s.doubleValue),u=De(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return yg(t.timestampValue,e.timestampValue);case 4:return yg(bo(t),bo(e));case 5:return he(t.stringValue,e.stringValue);case 6:return function(s,o){const l=Zr(s),u=Zr(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),u=o.split("/");for(let c=0;c<l.length&&c<u.length;c++){const m=he(l[c],u[c]);if(m!==0)return m}return he(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=he(De(s.latitude),De(o.latitude));return l!==0?l:he(De(s.longitude),De(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return vg(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,u,c,m;const p=s.fields||{},g=o.fields||{},x=(l=p.value)===null||l===void 0?void 0:l.arrayValue,N=(u=g.value)===null||u===void 0?void 0:u.arrayValue,C=he(((c=x==null?void 0:x.values)===null||c===void 0?void 0:c.length)||0,((m=N==null?void 0:N.values)===null||m===void 0?void 0:m.length)||0);return C!==0?C:vg(x,N)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ra.mapValue&&o===Ra.mapValue)return 0;if(s===Ra.mapValue)return 1;if(o===Ra.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),c=o.fields||{},m=Object.keys(c);u.sort(),m.sort();for(let p=0;p<u.length&&p<m.length;++p){const g=he(u[p],m[p]);if(g!==0)return g;const x=Qi(l[u[p]],c[m[p]]);if(x!==0)return x}return he(u.length,m.length)}(t.mapValue,e.mapValue);default:throw ne()}}function yg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return he(t,e);const n=wr(t),r=wr(e),i=he(n.seconds,r.seconds);return i!==0?i:he(n.nanos,r.nanos)}function vg(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Qi(n[i],r[i]);if(s)return s}return he(n.length,r.length)}function Xi(t){return xd(t)}function xd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=wr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Zr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Y.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=xd(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${xd(n.fields[o])}`;return i+"}"}(t.mapValue):ne()}function _g(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Sd(t){return!!t&&"integerValue"in t}function Jh(t){return!!t&&"arrayValue"in t}function Eg(t){return!!t&&"nullValue"in t}function wg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xa(t){return!!t&&"mapValue"in t}function wC(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Js(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return os(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Js(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Js(t.arrayValue.values[n]);return e}return Object.assign({},t)}function IC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.value=e}static empty(){return new Ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Xa(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Js(n)}setAll(e){let n=Ye.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=Js(o):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Xa(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return vn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Xa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){os(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ut(Js(this.value))}}function mE(t){const e=[];return os(t.fields,(n,r)=>{const i=new Ye([n]);if(Xa(r)){const s=mE(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Jt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n,r,i,s,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new dt(e,0,re.min(),re.min(),re.min(),Ut.empty(),0)}static newFoundDocument(e,n,r,i){return new dt(e,1,n,re.min(),r,i,0)}static newNoDocument(e,n){return new dt(e,2,n,re.min(),re.min(),Ut.empty(),0)}static newUnknownDocument(e,n){return new dt(e,3,n,re.min(),re.min(),Ut.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n){this.position=e,this.inclusive=n}}function Ig(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),n.key):r=Qi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Tg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!vn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,n="asc"){this.field=e,this.dir=n}}function TC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{}class Ue extends pE{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new xC(e,n,r):n==="array-contains"?new AC(e,r):n==="in"?new PC(e,r):n==="not-in"?new kC(e,r):n==="array-contains-any"?new RC(e,r):new Ue(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new SC(e,r):new CC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Qi(n,this.value)):n!==null&&ei(this.value)===ei(n)&&this.matchesComparison(Qi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ne()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class sn extends pE{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new sn(e,n)}matches(e){return gE(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function gE(t){return t.op==="and"}function yE(t){return bC(t)&&gE(t)}function bC(t){for(const e of t.filters)if(e instanceof sn)return!1;return!0}function Cd(t){if(t instanceof Ue)return t.field.canonicalString()+t.op.toString()+Xi(t.value);if(yE(t))return t.filters.map(e=>Cd(e)).join(",");{const e=t.filters.map(n=>Cd(n)).join(",");return`${t.op}(${e})`}}function vE(t,e){return t instanceof Ue?function(r,i){return i instanceof Ue&&r.op===i.op&&r.field.isEqual(i.field)&&vn(r.value,i.value)}(t,e):t instanceof sn?function(r,i){return i instanceof sn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&vE(o,i.filters[l]),!0):!1}(t,e):void ne()}function _E(t){return t instanceof Ue?function(n){return`${n.field.canonicalString()} ${n.op} ${Xi(n.value)}`}(t):t instanceof sn?function(n){return n.op.toString()+" {"+n.getFilters().map(_E).join(" ,")+"}"}(t):"Filter"}class xC extends Ue{constructor(e,n,r){super(e,n,r),this.key=Y.fromName(r.referenceValue)}matches(e){const n=Y.comparator(e.key,this.key);return this.matchesComparison(n)}}class SC extends Ue{constructor(e,n){super(e,"in",n),this.keys=EE("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class CC extends Ue{constructor(e,n){super(e,"not-in",n),this.keys=EE("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function EE(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Y.fromName(r.referenceValue))}class AC extends Ue{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Jh(n)&&So(n.arrayValue,this.value)}}class PC extends Ue{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&So(this.value.arrayValue,n)}}class kC extends Ue{constructor(e,n){super(e,"not-in",n)}matches(e){if(So(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!So(this.value.arrayValue,n)}}class RC extends Ue{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Jh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>So(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,n=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function bg(t,e=null,n=[],r=[],i=null,s=null,o=null){return new NC(t,e,n,r,i,s,o)}function Zh(t){const e=ie(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Cd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),au(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Xi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Xi(r)).join(",")),e.ue=n}return e.ue}function ef(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!TC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!vE(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Tg(t.startAt,e.startAt)&&Tg(t.endAt,e.endAt)}function Ad(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e,n=null,r=[],i=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function DC(t,e,n,r,i,s,o,l){return new $o(t,e,n,r,i,s,o,l)}function lu(t){return new $o(t)}function xg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function wE(t){return t.collectionGroup!==null}function Zs(t){const e=ie(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ze(Ye.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(l=l.add(c.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ol(s,r))}),n.has(Ye.keyField().canonicalString())||e.ce.push(new Ol(Ye.keyField(),r))}return e.ce}function pn(t){const e=ie(t);return e.le||(e.le=VC(e,Zs(t))),e.le}function VC(t,e){if(t.limitType==="F")return bg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ol(i.field,s)});const n=t.endAt?new Vl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Vl(t.startAt.position,t.startAt.inclusive):null;return bg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Pd(t,e){const n=t.filters.concat([e]);return new $o(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function kd(t,e,n){return new $o(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function uu(t,e){return ef(pn(t),pn(e))&&t.limitType===e.limitType}function IE(t){return`${Zh(pn(t))}|lt:${t.limitType}`}function fi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>_E(i)).join(", ")}]`),au(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Xi(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Xi(i)).join(",")),`Target(${r})`}(pn(t))}; limitType=${t.limitType})`}function cu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Y.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Zs(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,u){const c=Ig(o,l,u);return o.inclusive?c<=0:c<0}(r.startAt,Zs(r),i)||r.endAt&&!function(o,l,u){const c=Ig(o,l,u);return o.inclusive?c>=0:c>0}(r.endAt,Zs(r),i))}(t,e)}function OC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function TE(t){return(e,n)=>{let r=!1;for(const i of Zs(t)){const s=LC(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function LC(t,e,n){const r=t.field.isKeyField()?Y.comparator(e.key,n.key):function(s,o,l){const u=o.data.field(s),c=l.data.field(s);return u!==null&&c!==null?Qi(u,c):ne()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ne()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){os(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return hE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC=new Ae(Y.comparator);function jn(){return MC}const bE=new Ae(Y.comparator);function Us(...t){let e=bE;for(const n of t)e=e.insert(n.key,n);return e}function xE(t){let e=bE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ur(){return eo()}function SE(){return eo()}function eo(){return new as(t=>t.toString(),(t,e)=>t.isEqual(e))}const FC=new Ae(Y.comparator),UC=new Ze(Y.comparator);function ae(...t){let e=UC;for(const n of t)e=e.add(n);return e}const BC=new Ze(he);function jC(){return BC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dl(e)?"-0":e}}function CE(t){return{integerValue:""+t}}function zC(t,e){return vC(e)?CE(e):tf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(){this._=void 0}}function $C(t,e,n){return t instanceof Co?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Xh(s)&&(s=Yh(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ao?PE(t,e):t instanceof Po?kE(t,e):function(i,s){const o=AE(i,s),l=Sg(o)+Sg(i.Pe);return Sd(o)&&Sd(i.Pe)?CE(l):tf(i.serializer,l)}(t,e)}function HC(t,e,n){return t instanceof Ao?PE(t,e):t instanceof Po?kE(t,e):n}function AE(t,e){return t instanceof Ll?function(r){return Sd(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Co extends du{}class Ao extends du{constructor(e){super(),this.elements=e}}function PE(t,e){const n=RE(e);for(const r of t.elements)n.some(i=>vn(i,r))||n.push(r);return{arrayValue:{values:n}}}class Po extends du{constructor(e){super(),this.elements=e}}function kE(t,e){let n=RE(e);for(const r of t.elements)n=n.filter(i=>!vn(i,r));return{arrayValue:{values:n}}}class Ll extends du{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Sg(t){return De(t.integerValue||t.doubleValue)}function RE(t){return Jh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,n){this.field=e,this.transform=n}}function qC(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ao&&i instanceof Ao||r instanceof Po&&i instanceof Po?Gi(r.elements,i.elements,vn):r instanceof Ll&&i instanceof Ll?vn(r.Pe,i.Pe):r instanceof Co&&i instanceof Co}(t.transform,e.transform)}class KC{constructor(e,n){this.version=e,this.transformResults=n}}class nn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new nn}static exists(e){return new nn(void 0,e)}static updateTime(e){return new nn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ya(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class hu{}function NE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new nf(t.key,nn.none()):new Ho(t.key,t.data,nn.none());{const n=t.data,r=Ut.empty();let i=new Ze(Ye.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ri(t.key,r,new Jt(i.toArray()),nn.none())}}function GC(t,e,n){t instanceof Ho?function(i,s,o){const l=i.value.clone(),u=Ag(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ri?function(i,s,o){if(!Ya(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=Ag(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(DE(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function to(t,e,n,r){return t instanceof Ho?function(s,o,l,u){if(!Ya(s.precondition,o))return l;const c=s.value.clone(),m=Pg(s.fieldTransforms,u,o);return c.setAll(m),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ri?function(s,o,l,u){if(!Ya(s.precondition,o))return l;const c=Pg(s.fieldTransforms,u,o),m=o.data;return m.setAll(DE(s)),m.setAll(c),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,l){return Ya(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function QC(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=AE(r.transform,i||null);s!=null&&(n===null&&(n=Ut.empty()),n.set(r.field,s))}return n||null}function Cg(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Gi(r,i,(s,o)=>qC(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ho extends hu{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ri extends hu{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function DE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Ag(t,e,n){const r=new Map;pe(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,HC(o,l,n[i]))}return r}function Pg(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,$C(s,o,e))}return r}class nf extends hu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XC extends hu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&GC(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=to(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=to(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=SE();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=n.has(i.key)?null:l;const u=NE(o,l);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ae())}isEqual(e){return this.batchId===e.batchId&&Gi(this.mutations,e.mutations,(n,r)=>Cg(n,r))&&Gi(this.baseMutations,e.baseMutations,(n,r)=>Cg(n,r))}}class rf{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){pe(e.mutations.length===r.length);let i=function(){return FC}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new rf(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me,ue;function eA(t){switch(t){default:return ne();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function VE(t){if(t===void 0)return Bn("GRPC error has no .code"),F.UNKNOWN;switch(t){case Me.OK:return F.OK;case Me.CANCELLED:return F.CANCELLED;case Me.UNKNOWN:return F.UNKNOWN;case Me.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Me.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Me.INTERNAL:return F.INTERNAL;case Me.UNAVAILABLE:return F.UNAVAILABLE;case Me.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Me.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Me.NOT_FOUND:return F.NOT_FOUND;case Me.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Me.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Me.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Me.ABORTED:return F.ABORTED;case Me.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Me.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Me.DATA_LOSS:return F.DATA_LOSS;default:return ne()}}(ue=Me||(Me={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA=new $r([4294967295,4294967295],0);function kg(t){const e=tA().encode(t),n=new iE;return n.update(e),new Uint8Array(n.digest())}function Rg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $r([n,r],0),new $r([i,s],0)]}class sf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Bs(`Invalid padding: ${n}`);if(r<0)throw new Bs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Bs(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Bs(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=$r.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply($r.fromNumber(r)));return i.compare(nA)===1&&(i=new $r([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=kg(e),[r,i]=Rg(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new sf(s,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=kg(e),[r,i]=Rg(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Bs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Wo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new fu(re.min(),i,new Ae(he),jn(),ae())}}class Wo{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Wo(r,n,ae(),ae(),ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class OE{constructor(e,n){this.targetId=e,this.me=n}}class LE{constructor(e,n,r=tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Ng{constructor(){this.fe=0,this.ge=Vg(),this.pe=tt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ae(),n=ae(),r=ae();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ne()}}),new Wo(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Vg()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,pe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class rA{constructor(e){this.Le=e,this.Be=new Map,this.ke=jn(),this.qe=Dg(),this.Qe=new Ae(he)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ne()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Ad(s))if(r===0){const o=new Y(s.path);this.Ue(n,o,dt.newNoDocument(o,re.min()))}else pe(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,l;try{o=Zr(r).toUint8Array()}catch(u){if(u instanceof fE)return Ki("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new sf(o,i,s)}catch(u){return Ki(u instanceof Bs?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&Ad(l.target)){const u=new Y(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,dt.newNoDocument(u,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=ae();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(u=>{const c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new fu(e,n,this.Qe,this.ke,r);return this.ke=jn(),this.qe=Dg(),this.Qe=new Ae(he),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Ng,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ze(he),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Q("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ng),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Dg(){return new Ae(Y.comparator)}function Vg(){return new Ae(Y.comparator)}const iA={asc:"ASCENDING",desc:"DESCENDING"},sA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oA={and:"AND",or:"OR"};class aA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Rd(t,e){return t.useProto3Json||au(e)?e:{value:e}}function Ml(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ME(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function lA(t,e){return Ml(t,e.toTimestamp())}function gn(t){return pe(!!t),re.fromTimestamp(function(n){const r=wr(n);return new $e(r.seconds,r.nanos)}(t))}function of(t,e){return Nd(t,e).canonicalString()}function Nd(t,e){const n=function(i){return new we(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function FE(t){const e=we.fromString(t);return pe($E(e)),e}function Dd(t,e){return of(t.databaseId,e.path)}function gc(t,e){const n=FE(e);if(n.get(1)!==t.databaseId.projectId)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Y(BE(n))}function UE(t,e){return of(t.databaseId,e)}function uA(t){const e=FE(t);return e.length===4?we.emptyPath():BE(e)}function Vd(t){return new we(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function BE(t){return pe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Og(t,e,n){return{name:Dd(t,e),fields:n.value.mapValue.fields}}function cA(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ne()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,m){return c.useProto3Json?(pe(m===void 0||typeof m=="string"),tt.fromBase64String(m||"")):(pe(m===void 0||m instanceof Buffer||m instanceof Uint8Array),tt.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(c){const m=c.code===void 0?F.UNKNOWN:VE(c.code);return new G(m,c.message||"")}(o);n=new LE(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=gc(t,r.document.name),s=gn(r.document.updateTime),o=r.document.createTime?gn(r.document.createTime):re.min(),l=new Ut({mapValue:{fields:r.document.fields}}),u=dt.newFoundDocument(i,s,o,l),c=r.targetIds||[],m=r.removedTargetIds||[];n=new Ja(c,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=gc(t,r.document),s=r.readTime?gn(r.readTime):re.min(),o=dt.newNoDocument(i,s),l=r.removedTargetIds||[];n=new Ja([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=gc(t,r.document),s=r.removedTargetIds||[];n=new Ja([],s,i,null)}else{if(!("filter"in e))return ne();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new ZC(i,s),l=r.targetId;n=new OE(l,o)}}return n}function dA(t,e){let n;if(e instanceof Ho)n={update:Og(t,e.key,e.value)};else if(e instanceof nf)n={delete:Dd(t,e.key)};else if(e instanceof ri)n={update:Og(t,e.key,e.data),updateMask:EA(e.fieldMask)};else{if(!(e instanceof XC))return ne();n={verify:Dd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Co)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ao)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Po)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ll)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ne()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:lA(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ne()}(t,e.precondition)),n}function hA(t,e){return t&&t.length>0?(pe(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?gn(i.updateTime):gn(s);return o.isEqual(re.min())&&(o=gn(s)),new KC(o,i.transformResults||[])}(n,e))):[]}function fA(t,e){return{documents:[UE(t,e.path)]}}function mA(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=UE(t,i);const s=function(c){if(c.length!==0)return zE(sn.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(m=>function(g){return{field:mi(g.field),direction:yA(g.dir)}}(m))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Rd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function pA(t){let e=uA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){pe(r===1);const m=n.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];n.where&&(s=function(p){const g=jE(p);return g instanceof sn&&yE(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(N){return new Ol(pi(N.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(p){let g;return g=typeof p=="object"?p.value:p,au(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(p){const g=!!p.before,x=p.values||[];return new Vl(x,g)}(n.startAt));let c=null;return n.endAt&&(c=function(p){const g=!p.before,x=p.values||[];return new Vl(x,g)}(n.endAt)),DC(e,i,o,s,l,"F",u,c)}function gA(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ne()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function jE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=pi(n.unaryFilter.field);return Ue.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=pi(n.unaryFilter.field);return Ue.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=pi(n.unaryFilter.field);return Ue.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=pi(n.unaryFilter.field);return Ue.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ne()}}(t):t.fieldFilter!==void 0?function(n){return Ue.create(pi(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ne()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return sn.create(n.compositeFilter.filters.map(r=>jE(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ne()}}(n.compositeFilter.op))}(t):ne()}function yA(t){return iA[t]}function vA(t){return sA[t]}function _A(t){return oA[t]}function mi(t){return{fieldPath:t.canonicalString()}}function pi(t){return Ye.fromServerFormat(t.fieldPath)}function zE(t){return t instanceof Ue?function(n){if(n.op==="=="){if(wg(n.value))return{unaryFilter:{field:mi(n.field),op:"IS_NAN"}};if(Eg(n.value))return{unaryFilter:{field:mi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(wg(n.value))return{unaryFilter:{field:mi(n.field),op:"IS_NOT_NAN"}};if(Eg(n.value))return{unaryFilter:{field:mi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mi(n.field),op:vA(n.op),value:n.value}}}(t):t instanceof sn?function(n){const r=n.getFilters().map(i=>zE(i));return r.length===1?r[0]:{compositeFilter:{op:_A(n.op),filters:r}}}(t):ne()}function EA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function $E(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,n,r,i,s=re.min(),o=re.min(),l=tt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.ct=e}}function IA(t){const e=pA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?kd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(){this.un=new bA}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Er.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Er.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class bA{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ze(we.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ze(we.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Yi(0)}static kn(){return new Yi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(){this.changes=new as(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,dt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&to(r.mutation,i,Jt.empty(),$e.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ae()){const i=Ur();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Us();return s.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ur();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ae()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let s=jn();const o=eo(),l=function(){return eo()}();return n.forEach((u,c)=>{const m=r.get(c.key);i.has(c.key)&&(m===void 0||m.mutation instanceof ri)?s=s.insert(c.key,c):m!==void 0?(o.set(c.key,m.mutation.getFieldMask()),to(m.mutation,c,m.mutation.getFieldMask(),$e.now())):o.set(c.key,Jt.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,m)=>o.set(c,m)),n.forEach((c,m)=>{var p;return l.set(c,new SA(m,(p=o.get(c))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,n){const r=eo();let i=new Ae((o,l)=>o-l),s=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let m=r.get(u)||Jt.empty();m=l.applyToLocalView(c,m),r.set(u,m);const p=(i.get(l.batchId)||ae()).add(u);i=i.insert(l.batchId,p)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),c=u.key,m=u.value,p=SE();m.forEach(g=>{if(!s.has(g)){const x=NE(n.get(g),r.get(g));x!==null&&p.set(g,x),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,p))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):wE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):U.resolve(Ur());let l=-1,u=s;return o.next(c=>U.forEach(c,(m,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(m)?U.resolve():this.remoteDocumentCache.getEntry(e,m).next(g=>{u=u.insert(m,g)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,ae())).next(m=>({batchId:l,changes:xE(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Y(n)).next(r=>{let i=Us();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Us();return this.indexManager.getCollectionParents(e,s).next(l=>U.forEach(l,u=>{const c=function(p,g){return new $o(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(m=>{m.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{const m=c.getKey();o.get(m)===null&&(o=o.insert(m,dt.newInvalidDocument(m)))});let l=Us();return o.forEach((u,c)=>{const m=s.get(u);m!==void 0&&to(m.mutation,c,Jt.empty(),$e.now()),cu(n,c)&&(l=l.insert(u,c))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:gn(i.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:IA(i.bundledQuery),readTime:gn(i.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(){this.overlays=new Ae(Y.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ur();return U.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const i=Ur(),s=n.length+1,o=new Y(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return U.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ae((c,m)=>c-m);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let m=s.get(c.largestBatchId);m===null&&(m=Ur(),s=s.insert(c.largestBatchId,m)),m.set(c.getKey(),c)}}const l=Ur(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,m)=>l.set(c,m)),!(l.size()>=i)););return U.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new JC(n,r));let s=this.Ir.get(n);s===void 0&&(s=ae(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(){this.sessionToken=tt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(){this.Tr=new Ze(We.Er),this.dr=new Ze(We.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new We(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new We(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Y(new we([])),r=new We(n,e),i=new We(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Y(new we([])),r=new We(n,e),i=new We(n,e+1);let s=ae();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new We(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class We{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Y.comparator(e.key,n.key)||he(e.wr,n.wr)}static Ar(e,n){return he(e.wr,n.wr)||Y.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ze(We.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new YC(s,n,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new We(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return U.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new We(n,0),i=new We(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),U.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ze(he);return n.forEach(i=>{const s=new We(i,0),o=new We(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Y.isDocumentKey(s)||(s=s.child(""));const o=new We(new Y(s),0);let l=new Ze(he);return this.br.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(l=l.add(u.wr)),!0)},o),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){pe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,i=>{const s=new We(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new We(n,0),i=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e){this.Mr=e,this.docs=function(){return new Ae(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():dt.newInvalidDocument(n))}getEntries(e,n){let r=jn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():dt.newInvalidDocument(i))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=jn();const o=n.path,l=new Y(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:c,value:{document:m}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||mC(fC(m),r)<=0||(i.has(m.key)||cu(n,m))&&(s=s.insert(m.key,m.mutableCopy()))}return U.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ne()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new DA(this)}getSize(e){return U.resolve(this.size)}}class DA extends xA{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e){this.persistence=e,this.Nr=new as(n=>Zh(n),ef),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Lr=0,this.Br=new af,this.targetCount=0,this.kr=Yi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Yi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),U.waitFor(s).next(()=>i)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),U.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Qh(0),this.Kr=!1,this.Kr=!0,this.$r=new kA,this.referenceDelegate=e(this),this.Ur=new VA(this),this.indexManager=new TA,this.remoteDocumentCache=function(i){return new NA(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new wA(n),this.Gr=new AA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new PA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new RA(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Q("MemoryPersistence","Starting transaction:",e);const i=new LA(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class LA extends gC{constructor(e){super(),this.currentSequenceNumber=e}}class lf{constructor(e){this.persistence=e,this.Jr=new af,this.Yr=null}static Zr(e){return new lf(e)}get Xr(){if(this.Yr)return this.Yr;throw ne()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const i=Y.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,re.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=ae(),i=ae();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new uf(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return FT()?8:yC(mt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new MA;return this.Xi(e,n,o).next(l=>{if(s.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Ds()<=le.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",fi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(Ds()<=le.DEBUG&&Q("QueryEngine","Query:",fi(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ds()<=le.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",fi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pn(n))):U.resolve())}Yi(e,n){if(xg(n))return U.resolve(null);let r=pn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=kd(n,null,"F"),r=pn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ae(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ts(n,l);return this.ns(n,c,o,u.readTime)?this.Yi(e,kd(n,null,"F")):this.rs(e,c,n,u)}))})))}Zi(e,n,r,i){return xg(n)||i.isEqual(re.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?U.resolve(null):(Ds()<=le.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fi(n)),this.rs(e,o,n,hC(i,-1)).next(l=>l))})}ts(e,n){let r=new Ze(TE(e));return n.forEach((i,s)=>{cu(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Ds()<=le.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",fi(n)),this.Ji.getDocumentsMatchingQuery(e,n,Er.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Ae(he),this._s=new as(s=>Zh(s),ef),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CA(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function BA(t,e,n,r){return new UA(t,e,n,r)}async function HE(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let u=ae();for(const c of i){o.push(c.batchId);for(const m of c.mutations)u=u.add(m.key)}for(const c of s){l.push(c.batchId);for(const m of c.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:l}))})})}function jA(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,c,m){const p=c.batch,g=p.keys();let x=U.resolve();return g.forEach(N=>{x=x.next(()=>m.getEntry(u,N)).next(C=>{const D=c.docVersions.get(N);pe(D!==null),C.version.compareTo(D)<0&&(p.applyToRemoteDocument(C,c),C.isValidDocument()&&(C.setReadTime(c.commitVersion),m.addEntry(C)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ae();for(let c=0;c<l.mutationResults.length;++c)l.mutationResults[c].transformResults.length>0&&(u=u.add(l.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function WE(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function zA(t,e){const n=ie(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((m,p)=>{const g=i.get(p);if(!g)return;l.push(n.Ur.removeMatchingKeys(s,m.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(s,m.addedDocuments,p)));let x=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?x=x.withResumeToken(tt.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):m.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(m.resumeToken,r)),i=i.insert(p,x),function(C,D,I){return C.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(g,x,m)&&l.push(n.Ur.updateTargetData(s,x))});let u=jn(),c=ae();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push($A(s,o,e.documentUpdates).next(m=>{u=m.Ps,c=m.Is})),!r.isEqual(re.min())){const m=n.Ur.getLastRemoteSnapshotVersion(s).next(p=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(m)}return U.waitFor(l).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.os=i,s))}function $A(t,e,n){let r=ae(),i=ae();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=jn();return n.forEach((l,u)=>{const c=s.get(l);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(re.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Q("LocalStore","Ignoring outdated watch update for ",l,". Current version:",c.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function HA(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function WA(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,U.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new sr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Od(t,e,n){const r=ie(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!zo(o))throw o;Q("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Lg(t,e,n){const r=ie(t);let i=re.min(),s=ae();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,m){const p=ie(u),g=p._s.get(m);return g!==void 0?U.resolve(p.os.get(g)):p.Ur.getTargetData(c,m)}(r,o,pn(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:re.min(),n?s:ae())).next(l=>(qA(r,OC(e),l),{documents:l,Ts:s})))}function qA(t,e,n){let r=t.us.get(e)||re.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class Mg{constructor(){this.activeTargetIds=jC()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class KA{constructor(){this.so=new Mg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Mg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Na=null;function yc(){return Na===null?Na=function(){return 268435456+Math.round(2147483648*Math.random())}():Na++,"0x"+Na.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lt="WebChannelConnection";class YA extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const l=yc(),u=this.xo(n,r.toUriEncodedString());Q("RestConnection",`Sending RPC '${n}' ${l}:`,u,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(n,u,c,i).then(m=>(Q("RestConnection",`Received RPC '${n}' ${l}: `,m),m),m=>{throw Ki("RestConnection",`RPC '${n}' ${l} failed with error: `,m,"url: ",u,"request:",i),m})}Lo(n,r,i,s,o,l){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ss}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=QA[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=yc();return new Promise((o,l)=>{const u=new sE;u.setWithCredentials(!0),u.listenOnce(oE.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Qa.NO_ERROR:const m=u.getResponseJson();Q(lt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(m)),o(m);break;case Qa.TIMEOUT:Q(lt,`RPC '${e}' ${s} timed out`),l(new G(F.DEADLINE_EXCEEDED,"Request time out"));break;case Qa.HTTP_ERROR:const p=u.getStatus();if(Q(lt,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const x=g==null?void 0:g.error;if(x&&x.status&&x.message){const N=function(D){const I=D.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(I)>=0?I:F.UNKNOWN}(x.status);l(new G(N,x.message))}else l(new G(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new G(F.UNAVAILABLE,"Connection failed."));break;default:ne()}}finally{Q(lt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Q(lt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Bo(e,n,r){const i=yc(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=uE(),l=lE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=s.join("");Q(lt,`Creating RPC '${e}' stream ${i}: ${m}`,u);const p=o.createWebChannel(m,u);let g=!1,x=!1;const N=new XA({Io:D=>{x?Q(lt,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(g||(Q(lt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),Q(lt,`RPC '${e}' stream ${i} sending:`,D),p.send(D))},To:()=>p.close()}),C=(D,I,w)=>{D.listen(I,S=>{try{w(S)}catch(P){setTimeout(()=>{throw P},0)}})};return C(p,Fs.EventType.OPEN,()=>{x||(Q(lt,`RPC '${e}' stream ${i} transport opened.`),N.yo())}),C(p,Fs.EventType.CLOSE,()=>{x||(x=!0,Q(lt,`RPC '${e}' stream ${i} transport closed`),N.So())}),C(p,Fs.EventType.ERROR,D=>{x||(x=!0,Ki(lt,`RPC '${e}' stream ${i} transport errored:`,D),N.So(new G(F.UNAVAILABLE,"The operation could not be completed")))}),C(p,Fs.EventType.MESSAGE,D=>{var I;if(!x){const w=D.data[0];pe(!!w);const S=w,P=S.error||((I=S[0])===null||I===void 0?void 0:I.error);if(P){Q(lt,`RPC '${e}' stream ${i} received error:`,P);const R=P.status;let V=function(T){const A=Me[T];if(A!==void 0)return VE(A)}(R),v=P.message;V===void 0&&(V=F.INTERNAL,v="Unknown error status: "+R+" with message "+P.message),x=!0,N.So(new G(V,v)),p.close()}else Q(lt,`RPC '${e}' stream ${i} received:`,w),N.bo(w)}}),C(l,aE.STAT_EVENT,D=>{D.stat===bd.PROXY?Q(lt,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===bd.NOPROXY&&Q(lt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}}function vc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(t){return new aA(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&Q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e,n,r,i,s,o,l,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new qE(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Bn(n.toString()),Bn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new G(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class JA extends KE{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=cA(this.serializer,e),r=function(s){if(!("targetChange"in s))return re.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?re.min():o.readTime?gn(o.readTime):re.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Vd(this.serializer),n.addTarget=function(s,o){let l;const u=o.target;if(l=Ad(u)?{documents:fA(s,u)}:{query:mA(s,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=ME(s,o.resumeToken);const c=Rd(s,o.expectedCount);c!==null&&(l.expectedCount=c)}else if(o.snapshotVersion.compareTo(re.min())>0){l.readTime=Ml(s,o.snapshotVersion.toTimestamp());const c=Rd(s,o.expectedCount);c!==null&&(l.expectedCount=c)}return l}(this.serializer,e);const r=gA(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Vd(this.serializer),n.removeTarget=e,this.a_(n)}}class ZA extends KE{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return pe(!!e.streamToken),this.lastStreamToken=e.streamToken,pe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){pe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=hA(e.writeResults,e.commitTime),r=gn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Vd(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>dA(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Nd(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new G(F.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Nd(n,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class t1{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Bn(n),this.D_=!1):Q("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{ii(this)&&(Q("RemoteStore","Restarting streams for network reachability change."),await async function(u){const c=ie(u);c.L_.add(4),await qo(c),c.q_.set("Unknown"),c.L_.delete(4),await pu(c)}(this))})}),this.q_=new t1(r,i)}}async function pu(t){if(ii(t))for(const e of t.B_)await e(!0)}async function qo(t){for(const e of t.B_)await e(!1)}function GE(t,e){const n=ie(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),ff(n)?hf(n):ls(n).r_()&&df(n,e))}function cf(t,e){const n=ie(t),r=ls(n);n.N_.delete(e),r.r_()&&QE(n,e),n.N_.size===0&&(r.r_()?r.o_():ii(n)&&n.q_.set("Unknown"))}function df(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ls(t).A_(e)}function QE(t,e){t.Q_.xe(e),ls(t).R_(e)}function hf(t){t.Q_=new rA({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ls(t).start(),t.q_.v_()}function ff(t){return ii(t)&&!ls(t).n_()&&t.N_.size>0}function ii(t){return ie(t).L_.size===0}function XE(t){t.Q_=void 0}async function r1(t){t.q_.set("Online")}async function i1(t){t.N_.forEach((e,n)=>{df(t,e)})}async function s1(t,e){XE(t),ff(t)?(t.q_.M_(e),hf(t)):t.q_.set("Unknown")}async function o1(t,e,n){if(t.q_.set("Online"),e instanceof LE&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){Q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Fl(t,r)}else if(e instanceof Ja?t.Q_.Ke(e):e instanceof OE?t.Q_.He(e):t.Q_.We(e),!n.isEqual(re.min()))try{const r=await WE(t.localStore);n.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const m=s.N_.get(c);m&&s.N_.set(c,m.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,c)=>{const m=s.N_.get(u);if(!m)return;s.N_.set(u,m.withResumeToken(tt.EMPTY_BYTE_STRING,m.snapshotVersion)),QE(s,u);const p=new sr(m.target,u,c,m.sequenceNumber);df(s,p)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Q("RemoteStore","Failed to raise snapshot:",r),await Fl(t,r)}}async function Fl(t,e,n){if(!zo(e))throw e;t.L_.add(1),await qo(t),t.q_.set("Offline"),n||(n=()=>WE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Q("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await pu(t)})}function YE(t,e){return e().catch(n=>Fl(t,n,e))}async function gu(t){const e=ie(t),n=Ir(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;a1(e);)try{const i=await HA(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,l1(e,i)}catch(i){await Fl(e,i)}JE(e)&&ZE(e)}function a1(t){return ii(t)&&t.O_.length<10}function l1(t,e){t.O_.push(e);const n=Ir(t);n.r_()&&n.V_&&n.m_(e.mutations)}function JE(t){return ii(t)&&!Ir(t).n_()&&t.O_.length>0}function ZE(t){Ir(t).start()}async function u1(t){Ir(t).p_()}async function c1(t){const e=Ir(t);for(const n of t.O_)e.m_(n.mutations)}async function d1(t,e,n){const r=t.O_.shift(),i=rf.from(r,e,n);await YE(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await gu(t)}async function h1(t,e){e&&Ir(t).V_&&await async function(r,i){if(function(o){return eA(o)&&o!==F.ABORTED}(i.code)){const s=r.O_.shift();Ir(r).s_(),await YE(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await gu(r)}}(t,e),JE(t)&&ZE(t)}async function Ug(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const r=ii(n);n.L_.add(3),await qo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await pu(n)}async function f1(t,e){const n=ie(t);e?(n.L_.delete(2),await pu(n)):e||(n.L_.add(2),await qo(n),n.q_.set("Unknown"))}function ls(t){return t.K_||(t.K_=function(n,r,i){const s=ie(n);return s.w_(),new JA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:r1.bind(null,t),Ro:i1.bind(null,t),mo:s1.bind(null,t),d_:o1.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),ff(t)?hf(t):t.q_.set("Unknown")):(await t.K_.stop(),XE(t))})),t.K_}function Ir(t){return t.U_||(t.U_=function(n,r,i){const s=ie(n);return s.w_(),new ZA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:u1.bind(null,t),mo:h1.bind(null,t),f_:c1.bind(null,t),g_:d1.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await gu(t)):(await t.U_.stop(),t.O_.length>0&&(Q("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Dn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,l=new mf(e,n,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pf(t,e){if(Bn("AsyncQueue",`${e}: ${t}`),zo(t))return new G(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Y.comparator(n.key,r.key):(n,r)=>Y.comparator(n.key,r.key),this.keyedMap=Us(),this.sortedSet=new Ae(this.comparator)}static emptySet(e){return new Mi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Mi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(){this.W_=new Ae(Y.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ne():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ji{constructor(e,n,r,i,s,o,l,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Ji(e,n,Mi.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class p1{constructor(){this.queries=jg(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=ie(n),s=i.queries;i.queries=jg(),s.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new G(F.ABORTED,"Firestore shutting down"))}}function jg(){return new as(t=>IE(t),uu)}async function gf(t,e){const n=ie(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new m1,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=pf(o,`Initialization of query '${fi(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&vf(n)}async function yf(t,e){const n=ie(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function g1(t,e){const n=ie(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&vf(n)}function y1(t,e,n){const r=ie(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function vf(t){t.Y_.forEach(e=>{e.next()})}var Ld,zg;(zg=Ld||(Ld={})).ea="default",zg.Cache="cache";class _f{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ji(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ji.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ld.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e){this.key=e}}class tw{constructor(e){this.key=e}}class v1{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ae(),this.mutatedKeys=ae(),this.Aa=TE(e),this.Ra=new Mi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Bg,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,p)=>{const g=i.get(m),x=cu(this.query,p)?p:null,N=!!g&&this.mutatedKeys.has(g.key),C=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let D=!1;g&&x?g.data.isEqual(x.data)?N!==C&&(r.track({type:3,doc:x}),D=!0):this.ga(g,x)||(r.track({type:2,doc:x}),D=!0,(u&&this.Aa(x,u)>0||c&&this.Aa(x,c)<0)&&(l=!0)):!g&&x?(r.track({type:0,doc:x}),D=!0):g&&!x&&(r.track({type:1,doc:g}),D=!0,(u||c)&&(l=!0)),D&&(x?(o=o.add(x),s=C?s.add(m):s.delete(m)):(o=o.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),s=s.delete(m.key),r.track({type:1,doc:m})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((m,p)=>function(x,N){const C=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne()}};return C(x)-C(N)}(m.type,p.type)||this.Aa(m.doc,p.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,c=u!==this.Ea;return this.Ea=u,o.length!==0||c?{snapshot:new Ji(this.query,e.Ra,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Bg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ae(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new tw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new ew(r))}),n}ba(e){this.Ta=e.Ts,this.da=ae();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ji.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class _1{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class E1{constructor(e){this.key=e,this.va=!1}}class w1{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new as(l=>IE(l),uu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ae(Y.comparator),this.Na=new Map,this.La=new af,this.Ba={},this.ka=new Map,this.qa=Yi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function I1(t,e,n=!0){const r=aw(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await nw(r,e,n,!0),i}async function T1(t,e){const n=aw(t);await nw(n,e,!0,!1)}async function nw(t,e,n,r){const i=await WA(t.localStore,pn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await b1(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&GE(t.remoteStore,i),l}async function b1(t,e,n,r,i){t.Ka=(p,g,x)=>async function(C,D,I,w){let S=D.view.ma(I);S.ns&&(S=await Lg(C.localStore,D.query,!1).then(({documents:v})=>D.view.ma(v,S)));const P=w&&w.targetChanges.get(D.targetId),R=w&&w.targetMismatches.get(D.targetId)!=null,V=D.view.applyChanges(S,C.isPrimaryClient,P,R);return Hg(C,D.targetId,V.wa),V.snapshot}(t,p,g,x);const s=await Lg(t.localStore,e,!0),o=new v1(e,s.Ts),l=o.ma(s.documents),u=Wo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(l,t.isPrimaryClient,u);Hg(t,n,c.wa);const m=new _1(e,n,o);return t.Fa.set(e,m),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function x1(t,e,n){const r=ie(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!uu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Od(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&cf(r.remoteStore,i.targetId),Md(r,i.targetId)}).catch(jo)):(Md(r,i.targetId),await Od(r.localStore,i.targetId,!0))}async function S1(t,e){const n=ie(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),cf(n.remoteStore,r.targetId))}async function C1(t,e,n){const r=V1(t);try{const i=await function(o,l){const u=ie(o),c=$e.now(),m=l.reduce((x,N)=>x.add(N.key),ae());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let N=jn(),C=ae();return u.cs.getEntries(x,m).next(D=>{N=D,N.forEach((I,w)=>{w.isValidDocument()||(C=C.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,N)).next(D=>{p=D;const I=[];for(const w of l){const S=QC(w,p.get(w.key).overlayedDocument);S!=null&&I.push(new ri(w.key,S,mE(S.value.mapValue),nn.exists(!0)))}return u.mutationQueue.addMutationBatch(x,c,I,l)}).next(D=>{g=D;const I=D.applyToLocalDocumentSet(p,C);return u.documentOverlayCache.saveOverlays(x,D.batchId,I)})}).then(()=>({batchId:g.batchId,changes:xE(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,u){let c=o.Ba[o.currentUser.toKey()];c||(c=new Ae(he)),c=c.insert(l,u),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,n),await Ko(r,i.changes),await gu(r.remoteStore)}catch(i){const s=pf(i,"Failed to persist write");n.reject(s)}}async function rw(t,e){const n=ie(t);try{const r=await zA(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?pe(o.va):i.removedDocuments.size>0&&(pe(o.va),o.va=!1))}),await Ko(n,r,e)}catch(r){await jo(r)}}function $g(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const u=ie(o);u.onlineState=l;let c=!1;u.queries.forEach((m,p)=>{for(const g of p.j_)g.Z_(l)&&(c=!0)}),c&&vf(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function A1(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Ae(Y.comparator);o=o.insert(s,dt.newNoDocument(s,re.min()));const l=ae().add(s),u=new fu(re.min(),new Map,new Ae(he),o,l);await rw(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),Ef(r)}else await Od(r.localStore,e,!1).then(()=>Md(r,e,n)).catch(jo)}async function P1(t,e){const n=ie(t),r=e.batch.batchId;try{const i=await jA(n.localStore,e);sw(n,r,null),iw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ko(n,i)}catch(i){await jo(i)}}async function k1(t,e,n){const r=ie(t);try{const i=await function(o,l){const u=ie(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let m;return u.mutationQueue.lookupMutationBatch(c,l).next(p=>(pe(p!==null),m=p.keys(),u.mutationQueue.removeMutationBatch(c,p))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,m,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,m)).next(()=>u.localDocuments.getDocuments(c,m))})}(r.localStore,e);sw(r,e,n),iw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ko(r,i)}catch(i){await jo(i)}}function iw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function sw(t,e,n){const r=ie(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Md(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||ow(t,r)})}function ow(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(cf(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Ef(t))}function Hg(t,e,n){for(const r of n)r instanceof ew?(t.La.addReference(r.key,e),R1(t,r)):r instanceof tw?(Q("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||ow(t,r.key)):ne()}function R1(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Q("SyncEngine","New document in limbo: "+n),t.xa.add(r),Ef(t))}function Ef(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Y(we.fromString(e)),r=t.qa.next();t.Na.set(r,new E1(n)),t.Oa=t.Oa.insert(n,r),GE(t.remoteStore,new sr(pn(lu(n.path)),r,"TargetPurposeLimboResolution",Qh.oe))}}async function Ko(t,e,n){const r=ie(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(c=>{var m;if((c||n)&&r.isPrimaryClient){const p=c?!c.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(c){i.push(c);const p=uf.Wi(u.targetId,c);s.push(p)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(u,c){const m=ie(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>U.forEach(c,g=>U.forEach(g.$i,x=>m.persistence.referenceDelegate.addReference(p,g.targetId,x)).next(()=>U.forEach(g.Ui,x=>m.persistence.referenceDelegate.removeReference(p,g.targetId,x)))))}catch(p){if(!zo(p))throw p;Q("LocalStore","Failed to update sequence numbers: "+p)}for(const p of c){const g=p.targetId;if(!p.fromCache){const x=m.os.get(g),N=x.snapshotVersion,C=x.withLastLimboFreeSnapshotVersion(N);m.os=m.os.insert(g,C)}}}(r.localStore,s))}async function N1(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){Q("SyncEngine","User change. New user:",e.toKey());const r=await HE(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(u=>{u.reject(new G(F.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ko(n,r.hs)}}function D1(t,e){const n=ie(t),r=n.Na.get(e);if(r&&r.va)return ae().add(r.key);{let i=ae();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const l=n.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function aw(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=D1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=A1.bind(null,e),e.Ca.d_=g1.bind(null,e.eventManager),e.Ca.$a=y1.bind(null,e.eventManager),e}function V1(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=P1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=k1.bind(null,e),e}class Ul{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return BA(this.persistence,new FA,e.initialUser,this.serializer)}Ga(e){return new OA(lf.Zr,this.serializer)}Wa(e){return new KA}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ul.provider={build:()=>new Ul};class Fd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>$g(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=N1.bind(null,this.syncEngine),await f1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new p1}()}createDatastore(e){const n=mu(e.databaseInfo.databaseId),r=function(s){return new YA(s)}(e.databaseInfo);return function(s,o,l,u){return new e1(s,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,l){return new n1(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>$g(this.syncEngine,n,0),function(){return Fg.D()?new Fg:new GA}())}createSyncEngine(e,n){return function(i,s,o,l,u,c,m){const p=new w1(i,s,o,l,u,c);return m&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ie(i);Q("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await qo(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Fd.provider={build:()=>new Fd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Bn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ut.UNAUTHENTICATED,this.clientId=dE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Q("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Q("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=pf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function _c(t,e){t.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await HE(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Wg(t,e){t.asyncQueue.verifyOperationInProgress();const n=await L1(t);Q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Ug(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Ug(e.remoteStore,i)),t._onlineComponents=e}async function L1(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{await _c(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ki("Error using user provided cache. Falling back to memory cache: "+n),await _c(t,new Ul)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),await _c(t,new Ul);return t._offlineComponents}async function lw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),await Wg(t,t._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),await Wg(t,new Fd))),t._onlineComponents}function M1(t){return lw(t).then(e=>e.syncEngine)}async function Bl(t){const e=await lw(t),n=e.eventManager;return n.onListen=I1.bind(null,e.syncEngine),n.onUnlisten=x1.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=T1.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=S1.bind(null,e.syncEngine),n}function F1(t,e,n={}){const r=new Dn;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,c){const m=new wf({next:g=>{m.Za(),o.enqueueAndForget(()=>yf(s,p));const x=g.docs.has(l);!x&&g.fromCache?c.reject(new G(F.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&g.fromCache&&u&&u.source==="server"?c.reject(new G(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),p=new _f(lu(l.path),m,{includeMetadataChanges:!0,_a:!0});return gf(s,p)}(await Bl(t),t.asyncQueue,e,n,r)),r.promise}function U1(t,e,n={}){const r=new Dn;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,c){const m=new wf({next:g=>{m.Za(),o.enqueueAndForget(()=>yf(s,p)),g.fromCache&&u.source==="server"?c.reject(new G(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),p=new _f(l,m,{includeMetadataChanges:!0,_a:!0});return gf(s,p)}(await Bl(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qg=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(t,e,n){if(!n)throw new G(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function B1(t,e,n,r){if(e===!0&&r===!0)throw new G(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Kg(t){if(!Y.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Gg(t){if(Y.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function yu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ne()}function zt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=yu(t);throw new G(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}B1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vu{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qg({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new rC;switch(r.type){case"firstParty":return new aC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=qg.get(n);r&&(Q("ComponentProvider","Removing Datastore"),qg.delete(n),r.terminate())}(this),Promise.resolve()}}function j1(t,e,n,r={}){var i;const s=(t=zt(t,vu))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ki("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=ut.MOCK_USER;else{l=RT(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new G(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ut(c)}t._authCredentials=new iC(new cE(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new si(this.firestore,e,this._query)}}class _t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}}class yr extends si{constructor(e,n,r){super(e,n,lu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new Y(e))}withConverter(e){return new yr(this.firestore,e,this._path)}}function Hr(t,e,...n){if(t=Et(t),cw("collection","path",e),t instanceof vu){const r=we.fromString(e,...n);return Gg(r),new yr(t,null,r)}{if(!(t instanceof _t||t instanceof yr))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return Gg(r),new yr(t.firestore,null,r)}}function on(t,e,...n){if(t=Et(t),arguments.length===1&&(e=dE.newId()),cw("doc","path",e),t instanceof vu){const r=we.fromString(e,...n);return Kg(r),new _t(t,null,new Y(r))}{if(!(t instanceof _t||t instanceof yr))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return Kg(r),new _t(t.firestore,t instanceof yr?t.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new qE(this,"async_queue_retry"),this.Vu=()=>{const r=vc();r&&Q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=vc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=vc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Dn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!zo(e))throw e;Q("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Bn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=mf.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ne()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Yg(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Tr extends vu{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Xg,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xg(e),this._firestoreClient=void 0,await e}}}function z1(t,e){const n=typeof t=="object"?t:b_(),r=typeof t=="string"?t:"(default)",i=Lh(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=PT("firestore");s&&j1(i,...s)}return i}function _u(t){if(t._terminated)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||$1(t),t._firestoreClient}function $1(t){var e,n,r;const i=t._freezeSettings(),s=function(l,u,c,m){return new EC(l,u,c,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,uw(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new O1(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zi(tt.fromBase64String(e))}catch(n){throw new G(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Zi(tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ye(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1=/^__.*__$/;class W1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ri(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ho(e,this.data,n,this.fieldTransforms)}}function dw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne()}}class Sf{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Sf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return jl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(dw(this.Cu)&&H1.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class q1{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||mu(e)}Qu(e,n,r,i=!1){return new Sf({Cu:e,methodName:n,qu:r,path:Ye.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cf(t){const e=t._freezeSettings(),n=mu(t._databaseId);return new q1(t._databaseId,!!e.ignoreUndefinedProperties,n)}function hw(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);pw("Data must be an object, but it was:",o,r);const l=fw(r,o);let u,c;if(s.merge)u=new Jt(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const m=[];for(const p of s.mergeFields){const g=G1(e,p,n);if(!o.contains(g))throw new G(F.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);X1(m,g)||m.push(g)}u=new Jt(m),c=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,c=o.fieldTransforms;return new W1(new Ut(l),u,c)}class Af extends Tf{_toFieldTransform(e){return new WC(e.path,new Co)}isEqual(e){return e instanceof Af}}function K1(t,e,n,r=!1){return Pf(n,t.Qu(r?4:3,e))}function Pf(t,e){if(mw(t=Et(t)))return pw("Unsupported field value:",e,t),fw(t,e);if(t instanceof Tf)return function(r,i){if(!dw(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let u=Pf(l,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Et(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return zC(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=$e.fromDate(r);return{timestampValue:Ml(i.serializer,s)}}if(r instanceof $e){const s=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ml(i.serializer,s)}}if(r instanceof bf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Zi)return{bytesValue:ME(i.serializer,r._byteString)};if(r instanceof _t){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:of(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof xf)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return tf(l.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${yu(r)}`)}(t,e)}function fw(t,e){const n={};return hE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):os(t,(r,i)=>{const s=Pf(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function mw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof bf||t instanceof Zi||t instanceof _t||t instanceof Tf||t instanceof xf)}function pw(t,e,n){if(!mw(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=yu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function G1(t,e,n){if((e=Et(e))instanceof If)return e._internalPath;if(typeof e=="string")return gw(t,e);throw jl("Field path arguments must be of type string or ",t,!1,void 0,n)}const Q1=new RegExp("[~\\*/\\[\\]]");function gw(t,e,n){if(e.search(Q1)>=0)throw jl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new If(...e.split("."))._internalPath}catch{throw jl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function jl(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new G(F.INVALID_ARGUMENT,l+t+u)}function X1(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Y1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(kf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Y1 extends yw{data(){return super.data()}}function kf(t,e){return typeof e=="string"?gw(t,e):e instanceof If?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Rf{}class J1 extends Rf{}function Ud(t,e,...n){let r=[];e instanceof Rf&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof Nf).length,l=s.filter(u=>u instanceof Eu).length;if(o>1||o>0&&l>0)throw new G(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Eu extends J1{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Eu(e,n,r)}_apply(e){const n=this._parse(e);return _w(e._query,n),new si(e.firestore,e.converter,Pd(e._query,n))}_parse(e){const n=Cf(e.firestore);return function(s,o,l,u,c,m,p){let g;if(c.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new G(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){Zg(p,m);const x=[];for(const N of p)x.push(Jg(u,s,N));g={arrayValue:{values:x}}}else g=Jg(u,s,p)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||Zg(p,m),g=K1(l,o,p,m==="in"||m==="not-in");return Ue.create(c,m,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Z1(t,e,n){const r=e,i=kf("where",t);return Eu._create(i,r,n)}class Nf extends Rf{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Nf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:sn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const u of l)_w(o,u),o=Pd(o,u)}(e._query,n),new si(e.firestore,e.converter,Pd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Jg(t,e,n){if(typeof(n=Et(n))=="string"){if(n==="")throw new G(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wE(e)&&n.indexOf("/")!==-1)throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(we.fromString(n));if(!Y.isDocumentKey(r))throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _g(t,new Y(r))}if(n instanceof _t)return _g(t,n._key);throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yu(n)}.`)}function Zg(t,e){if(!Array.isArray(t)||t.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _w(t,e){const n=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class eP{convertValue(e,n="none"){switch(ei(e)){case 0:return null;case 1:return e.booleanValue;case 2:return De(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Zr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ne()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return os(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>De(o.doubleValue));return new xf(s)}convertGeoPoint(e){return new bf(De(e.latitude),De(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Yh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(bo(e));default:return null}}convertTimestamp(e){const n=wr(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=we.fromString(e);pe($E(r));const i=new xo(r.get(1),r.get(3)),s=new Y(r.popFirst(5));return i.isEqual(n)||Bn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ww extends yw{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Za(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(kf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Za extends ww{data(e={}){return super.data(e)}}class Iw{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new js(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Za(this._firestore,this._userDataWriter,r.key,r,new js(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const u=new Za(i._firestore,i._userDataWriter,l.doc.key,l.doc,new js(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new Za(i._firestore,i._userDataWriter,l.doc.key,l.doc,new js(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,m=-1;return l.type!==0&&(c=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),m=o.indexOf(l.doc.key)),{type:tP(l.type),doc:u,oldIndex:c,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function tP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(t){t=zt(t,_t);const e=zt(t.firestore,Tr);return F1(_u(e),t._key).then(n=>xw(e,t,n))}class Df extends eP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,n)}}function el(t){t=zt(t,si);const e=zt(t.firestore,Tr),n=_u(e),r=new Df(e);return vw(t._query),U1(n,t._query).then(i=>new Iw(e,r,t,i))}function Go(t,e,n){t=zt(t,_t);const r=zt(t.firestore,Tr),i=Ew(t.converter,e,n);return Of(r,[hw(Cf(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,nn.none())])}function Tw(t){return Of(zt(t.firestore,Tr),[new nf(t._key,nn.none())])}function bw(t,e){const n=zt(t.firestore,Tr),r=on(t),i=Ew(t.converter,e);return Of(n,[hw(Cf(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,nn.exists(!1))]).then(()=>r)}function Vf(t,...e){var n,r,i;t=Et(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Yg(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Yg(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,c,m;if(t instanceof _t)c=zt(t.firestore,Tr),m=lu(t._key.path),u={next:p=>{e[o]&&e[o](xw(c,t,p))},error:e[o+1],complete:e[o+2]};else{const p=zt(t,si);c=zt(p.firestore,Tr),m=p._query;const g=new Df(c);u={next:x=>{e[o]&&e[o](new Iw(c,g,p,x))},error:e[o+1],complete:e[o+2]},vw(t._query)}return function(g,x,N,C){const D=new wf(C),I=new _f(x,D,N);return g.asyncQueue.enqueueAndForget(async()=>gf(await Bl(g),I)),()=>{D.Za(),g.asyncQueue.enqueueAndForget(async()=>yf(await Bl(g),I))}}(_u(c),m,l,u)}function Of(t,e){return function(r,i){const s=new Dn;return r.asyncQueue.enqueueAndForget(async()=>C1(await M1(r),i,s)),s.promise}(_u(t),e)}function xw(t,e,n){const r=n.docs.get(e._key),i=new Df(t);return new ww(t,i,e._key,r,new js(n.hasPendingWrites,n.fromCache),e.converter)}function rP(){return new Af("serverTimestamp")}(function(e,n=!0){(function(i){ss=i})(rs),Wi(new Xr("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new Tr(new sC(r.getProvider("auth-internal")),new uC(r.getProvider("app-check-internal")),function(c,m){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new G(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xo(c.options.projectId,m)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),gr(mg,"4.7.3",e),gr(mg,"4.7.3","esm2017")})();const iP={apiKey:"AIzaSyDfsK4K4vhOmSSGeVHOlLnJuNlHGNha4LU",authDomain:"storycraft-a5f7e.firebaseapp.com",projectId:"storycraft-a5f7e",storageBucket:"storycraft-a5f7e.firebasestorage.app",messagingSenderId:"727724875985",appId:"1:727724875985:web:97411448885c68c289e5f0",measurementId:"G-JH03Y2NZDK"},Sw=T_(iP),Ec=ZS(Sw),ht=z1(Sw),sP="1:727724875985:web:97411448885c68c289e5f0",Cw=B.createContext(),oP=({children:t})=>{const[e,n]=B.useState(null),[r,i]=B.useState(!1),[s,o]=B.useState(!0);B.useEffect(()=>{const m=jx(Ec,p=>{n(p),p||(o(!1),i(!1))});return()=>m()},[]),B.useEffect(()=>{if(e){const m=on(ht,`artifacts2/${sP}/users/${e.uid}`),p=Vf(m,async g=>{if(g.exists())i(g.data().isMaster===!0);else try{await Go(m,{displayName:e.displayName,email:e.email,isMaster:!1}),i(!1)}catch(x){console.error("Erro ao criar o documento do utilizador:",x)}o(!1)},g=>{console.error("Erro ao escutar documento do utilizador:",g),o(!1)});return()=>p()}},[e]);const c={user:e,loading:s,isMaster:r,googleSignIn:()=>{const m=new xn;return lS(Ec,m)},googleSignOut:()=>zx(Ec)};return h.createElement(Cw.Provider,{value:c},!s&&t)},pt=()=>{const t=B.useContext(Cw);if(!t)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return t},aP=()=>{const{googleSignIn:t}=pt(),e=async()=>{try{await t()}catch(n){console.error("Erro ao fazer login com o Google:",n)}};return h.createElement("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background p-4"},h.createElement("div",{className:"text-center"},h.createElement("h1",{className:"text-5xl font-bold text-primary mb-2"},"StoryCraft V2"),h.createElement("p",{className:"text-xl text-secondary mb-8"},"Sua ficha de RPG, do seu jeito."),h.createElement("button",{onClick:e,className:"px-8 py-4 bg-highlight hover:bg-opacity-80 text-primary font-bold rounded-lg shadow-lg text-lg"},"Entrar com Google")))},lP=({user:t,onSelectCharacter:e,handleCreateClick:n,handleImportClick:r,handleDeleteClick:i,characters:s,isMaster:o,viewingAll:l,onToggleView:u})=>h.createElement("div",{className:"bg-bgSurface/80 backdrop-blur-sm p-6 rounded-lg shadow-lg border border-bgElement w-full"},h.createElement("h2",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2"},l?"Todas as Fichas":"Meus Personagens"),h.createElement("div",{className:"flex flex-wrap gap-4 mb-4"},h.createElement("button",{onClick:n,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md"},"Criar Novo Personagem"),h.createElement("button",{onClick:r,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md"},"Importar Ficha (JSON)"),o&&h.createElement("button",{onClick:()=>u(!l),className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md"},l?"Ver Apenas Minhas Fichas":"Ver Todas as Fichas")),s.length>0?h.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},s.map(c=>h.createElement("div",{key:c.id,className:"bg-bgElement p-4 rounded-lg shadow-md flex flex-col justify-between"},h.createElement("div",null,h.createElement("h3",{className:"text-xl font-bold text-textPrimary mb-1"},c.name),h.createElement("p",{className:"text-sm text-textSecondary"},"Nível: ",c.level||"1"),o&&l&&h.createElement("p",{className:"text-xs text-textSecondary mt-2 break-all"},"Dono: ",c.ownerUid)),h.createElement("div",{className:"flex justify-end gap-2 mt-4"},h.createElement("button",{onClick:()=>e(c),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-lg"},"Ver/Editar"),t&&(t.uid===c.ownerUid||o)&&h.createElement("button",{onClick:()=>i(c),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-lg"},"Excluir"))))):h.createElement("p",{className:"text-textSecondary italic"},"Nenhum personagem encontrado.")),ey="1:727724875985:web:97411448885c68c289e5f0",uP=(t,e)=>{const[n,r]=B.useState(null),[i,s]=B.useState(!0);B.useEffect(()=>{if(!t||!e){s(!1);return}const u=on(ht,`artifacts2/${ey}/users/${e}/characterSheets/${t}`),c=Vf(u,m=>{if(m.exists()){const g={...m.data()};Object.keys(g).forEach(x=>{if(typeof g[x]=="string")try{g[x]=JSON.parse(g[x])}catch{}}),r({id:m.id,...g})}else console.error("Personagem não encontrado!"),r(null);s(!1)},m=>{console.error("Erro ao carregar o personagem:",m),s(!1)});return()=>c()},[t,e]);const o=B.useCallback(async(u,c)=>{if(!t||!e)return;const m=on(ht,`artifacts2/${ey}/users/${e}/characterSheets/${t}`),p=typeof c=="object"&&c!==null?JSON.stringify(c):c;try{await Go(m,{[u]:p},{merge:!0})}catch(g){console.error(`Erro ao atualizar o campo ${u}:`,g)}},[t,e]),l=B.useCallback(u=>{var c;if(n){const m=((c=n.collapsedStates)==null?void 0:c[u])??!1,p={...n.collapsedStates,[u]:!m};o("collapsedStates",p)}},[n,o]);return{character:n,loading:i,updateCharacterField:o,toggleSection:l}},cP=({message:t,onConfirm:e,onCancel:n,type:r,showCopyButton:i,copyText:s})=>{const[o,l]=B.useState(""),u=()=>{navigator.clipboard.writeText(s).then(()=>{l("Copiado!"),setTimeout(()=>l(""),2e3)},()=>{l("Falhou em copiar.")})},c=r==="confirm"?"Confirmar":"OK",m=r==="confirm"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700";return h.createElement(h.Fragment,null,h.createElement("div",{className:"text-lg text-textPrimary mb-4 text-center whitespace-pre-wrap"},t),i&&h.createElement("div",{className:"my-4 p-2 bg-bgElement rounded-md text-center"},h.createElement("p",{className:"text-textSecondary text-sm mb-1"},"Comando para Discord/Roll20:"),h.createElement("code",{className:"text-textAccent break-words"},s),h.createElement("button",{onClick:u,className:"ml-4 px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-xs font-bold rounded-md"},o||"Copiar")),h.createElement("div",{className:"flex justify-around gap-4 mt-4"},h.createElement("button",{onClick:e,className:`px-5 py-2 rounded-lg font-bold shadow-md text-white ${m}`},c),r!=="info"&&h.createElement("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md"},"Cancelar")))},dP=({title:t,onConfirm:e,onClose:n,type:r})=>{const[i,s]=B.useState(""),[o,l]=B.useState("HP"),u=()=>{const m=parseInt(i,10);!isNaN(m)&&m>0?e(m,o):console.error("Valor inválido.")},c=m=>{m.key==="Enter"&&u()};return h.createElement(h.Fragment,null,h.createElement("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center"},t),h.createElement("input",{type:"number",value:i,onChange:m=>s(m.target.value),onKeyDown:c,className:"w-full p-2 mb-4 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg focus:ring-btnHighlightBg focus:border-btnHighlightBg",placeholder:"Valor",autoFocus:!0}),h.createElement("div",{className:"flex justify-center gap-4 mb-6"},h.createElement("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer"},h.createElement("input",{type:"radio",name:"target",value:"HP",checked:o==="HP",onChange:()=>l("HP"),className:"form-radio text-btnHighlightBg"})," HP"),r==="heal"&&h.createElement("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer"},h.createElement("input",{type:"radio",name:"target",value:"HP Bonus",checked:o==="HP Bonus",onChange:()=>l("HP Bonus"),className:"form-radio text-btnHighlightBg"})," HP Bonus"),h.createElement("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer"},h.createElement("input",{type:"radio",name:"target",value:"MP",checked:o==="MP",onChange:()=>l("MP"),className:"form-radio text-btnHighlightBg"})," MP")),h.createElement("div",{className:"flex justify-around gap-4"},h.createElement("button",{onClick:u,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md"},"Confirmar"),h.createElement("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md"},"Cancelar")))},hP=({attributeName:t,onConfirm:e,onClose:n})=>{const[r,i]=B.useState("1d20"),[s,o]=B.useState(""),l=()=>e(r,parseInt(s,10)||0),u=c=>{c.key==="Enter"&&l()};return h.createElement(h.Fragment,null,h.createElement("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center"},"Rolar ",t),h.createElement("div",{className:"mb-4"},h.createElement("label",{htmlFor:"dice-input",className:"block text-sm font-medium text-textSecondary mb-1"},"Dado:"),h.createElement("input",{id:"dice-input",type:"text",value:r,onChange:c=>i(c.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"Ex: 1d20, 2d6",autoFocus:!0})),h.createElement("div",{className:"mb-6"},h.createElement("label",{htmlFor:"bonus-input",className:"block text-sm font-medium text-textSecondary mb-1"},"Bónus Adicional:"),h.createElement("input",{id:"bonus-input",type:"number",value:s,onChange:c=>o(c.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"0"})),h.createElement("div",{className:"flex justify-around gap-4"},h.createElement("button",{onClick:l,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md"},"Confirmar"),h.createElement("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md"},"Cancelar")))},Lf=({modalState:t,closeModal:e})=>{if(!t.type)return null;const n=()=>{const{type:r,props:i}=t;switch(r){case"info":case"confirm":return h.createElement(cP,{...i});case"action":return h.createElement(dP,{...i});case"rollAttribute":return h.createElement(hP,{...i});default:return null}};return h.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",onClick:e},h.createElement("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-sm border border-bgElement",onClick:r=>r.stopPropagation()},n()))},fP=[2,3,4,6,8,10,12,20,50,100],mP=({character:t})=>{const[e,n]=B.useState(!1),r=B.useCallback(async(s,o)=>{if(t&&t.discordWebhookUrl)try{await fetch(t.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[{title:s,description:o,color:7506394}]})})}catch(l){console.error("Failed to send to Discord:",l)}else{const l=`**${s}**
${o}`;alert(`Webhook do Discord não configurado. Copie o comando:

${l}`)}},[t]),i=s=>{const o=Math.floor(Math.random()*s)+1;r(`Rolagem de d${s}`,`**Resultado: ${o}**`),n(!1)};return h.createElement("div",{className:"relative"},h.createElement("button",{onClick:()=>n(!e),title:"Rolagem Rápida",className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600"},"🎲"),e&&h.createElement("div",{className:"absolute bottom-12 right-0 bg-gray-900 bg-opacity-90 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700 w-40"},h.createElement("div",{className:"grid grid-cols-2 gap-2"},fP.map(s=>h.createElement("button",{key:s,onClick:()=>i(s),className:"bg-gray-700 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-colors"},"d",s)))))},pP=({href:t,title:e,children:n})=>h.createElement("a",{href:t,title:e,className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600"},n),gP=({character:t})=>{const e=[{href:"#info",title:"Informações",icon:"👤"},{href:"#main-attributes",title:"Atributos Principais",icon:"❤️"},{href:"#actions",title:"Ações",icon:"⚔️"},{href:"#buffs",title:"Buffs",icon:"✨"},{href:"#attributes",title:"Atributos",icon:"📊"},{href:"#wallet",title:"Carteira",icon:"💰"},{href:"#inventory",title:"Inventário",icon:"🎒"},{href:"#equipped",title:"Equipados",icon:"🛡️"},{href:"#perks",title:"Vantagens",icon:"🌟"},{href:"#skills",title:"Habilidades",icon:"🎯"},{href:"#specializations",title:"Especializações",icon:"📜"},{href:"#story",title:"História",icon:"📖"},{href:"#notes",title:"Anotações",icon:"📝"},{href:"#discord",title:"Discord",icon:"💬"}];return h.createElement("div",{className:"fixed bottom-4 right-4 z-40 bg-gray-900 bg-opacity-80 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700"},h.createElement("div",{className:"grid grid-cols-2 gap-2"},e.map(n=>h.createElement(pP,{key:n.href,href:n.href,title:n.title},n.icon)),h.createElement(mP,{character:t})))},yP=({character:t,onExport:e,onReset:n})=>h.createElement("div",{className:"flex flex-wrap justify-center gap-4 mt-8 p-4 bg-bgSurface/80 backdrop-blur-sm rounded-xl border border-bgElement"},h.createElement("button",{onClick:e,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!t},"Exportar Ficha (JSON)"),h.createElement("button",{onClick:n,className:"px-8 py-3 bg-red-700 hover:bg-red-800 text-white font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!t},"Resetar Ficha")),At=({title:t,isCollapsed:e,toggleSection:n,actions:r,children:i,isComplexTitle:s})=>h.createElement("section",{className:"mb-8 p-6 bg-bgSurface backdrop-blur-sm rounded-xl shadow-inner border border-bgElement"},h.createElement("div",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2 cursor-pointer flex justify-between items-center",onClick:n},h.createElement("h2",{className:`flex-grow ${s?"":"truncate"}`.trim()},t),h.createElement("div",{className:"flex items-center gap-4"},h.createElement("div",{onClick:o=>o.stopPropagation()},r),h.createElement("span",null,e?"▼":"▲"))),!e&&h.createElement("div",{className:"mt-4"},i)),vP=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:i})=>{const{user:s}=pt(),[o,l]=B.useState({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""});B.useEffect(()=>{l({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""})},[t]);const u=g=>{const{name:x,value:N}=g.target;l(C=>({...C,[x]:N}))},c=B.useCallback(g=>{const x=o[g],N=t[g],D=["age","level","xp"].includes(g)?parseInt(x,10)||0:x;D!==N&&e(g,D)},[o,t,e]),m=()=>{const g=prompt("Insira a URL da imagem do personagem:",t.photoUrl||"");g!==null&&e("photoUrl",g)},p=["name","age","height","gender","race","class","alignment","level","xp"];return h.createElement(At,{title:"Informações do Personagem",isCollapsed:r,toggleSection:i},h.createElement("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6"},h.createElement("div",{className:"flex-shrink-0"},t.photoUrl?h.createElement("img",{src:t.photoUrl,alt:"Foto",className:"w-48 h-48 object-cover rounded-full border-2 border-btnHighlightBg cursor-pointer",onClick:m,onError:g=>{g.target.onerror=null,g.target.src="https://placehold.co/192x192/1f2937/FFFFFF?text=Erro"}}):h.createElement("div",{className:"w-48 h-48 bg-bgElement rounded-full border-2 border-btnHighlightBg flex items-center justify-center text-6xl text-textSecondary cursor-pointer",onClick:m},"+")),h.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 flex-grow w-full"},p.map(g=>h.createElement("div",{key:g},h.createElement("label",{htmlFor:g,className:"block text-sm font-medium text-textSecondary mb-1 capitalize"},g,":"),h.createElement("input",{type:["age","level","xp"].includes(g)?"number":"text",id:g,name:g,value:o[g],onChange:u,onBlur:()=>c(g),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary focus:ring-btnHighlightBg focus:border-btnHighlightBg",disabled:!s||s.uid!==t.ownerUid&&!n}))))))},_P=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:i,buffModifiers:s})=>{var C,D,I,w,S;const{user:o}=pt(),l=o&&(o.uid===t.ownerUid||n),[u,c]=B.useState(t.mainAttributes||{hp:{},mp:{}});B.useEffect(()=>{c(t.mainAttributes||{hp:{},mp:{}})},[t.mainAttributes]);const m=B.useMemo(()=>{const P=["dex","des","agi"],R=(t.attributes||[]).find(v=>v.name?P.some(y=>v.name.toLowerCase().includes(y)):!1);if(!R)return 0;const V=s&&s[R.name]||0;return(R.base||0)+(R.perm||0)+V+(R.arma||0)},[t.attributes,s]),p=m+(s&&s.Iniciativa||0),g=(P,R)=>{const{name:V,value:v}=P.target,y=v===""?"":parseInt(v,10);c(T=>R?{...T,[R]:{...T[R]||{},[V]:y}}:{...T,[V]:y})},x=B.useCallback((P,R)=>{var v;if(!t)return;const V=t.mainAttributes||{};if(R){const y=(v=u==null?void 0:u[R])==null?void 0:v[P],T=V[R]||{},A=T[P],_=parseInt(y,10)||0;if(_!==(A||0)){const k={...T,[P]:_},b={...V,[R]:k};e("mainAttributes",b)}}else{const y=u==null?void 0:u[P],T=V[P],A=parseInt(y,10)||0;if(A!==(T||0)){const _={...V,[P]:A};e("mainAttributes",_)}}},[u,t,e]),N=(P,R)=>(parseInt(P,10)||0)+(s&&s[R]||0);return h.createElement(At,{title:"Atributos Principais",isCollapsed:r,toggleSection:i},h.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},h.createElement("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md"},h.createElement("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase"},"HP"),h.createElement("div",{className:"flex items-center gap-1"},h.createElement("input",{type:"number",name:"current",value:((C=u.hp)==null?void 0:C.current)??"",onChange:P=>g(P,"hp"),onBlur:()=>x("current","hp"),className:"w-14 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),h.createElement("span",{className:"text-textSecondary"},"/"),h.createElement("input",{type:"number",name:"max",value:((D=u.hp)==null?void 0:D.max)??"",onChange:P=>g(P,"hp"),onBlur:()=>x("max","hp"),className:"w-14 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),h.createElement("span",{className:"text-blue-400 font-bold text-xl ml-1"},"+"),h.createElement("input",{type:"number",title:"HP Temporário",name:"temp",value:((I=u.hp)==null?void 0:I.temp)??"",onChange:P=>g(P,"hp"),onBlur:()=>x("temp","hp"),className:"w-14 p-2 text-center bg-bgInput border border-blue-400 rounded-md text-blue-300 text-xl font-bold",disabled:!n}))),h.createElement("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md"},h.createElement("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase"},"MP"),h.createElement("div",{className:"flex items-center gap-2"},h.createElement("input",{type:"number",name:"current",value:((w=u.mp)==null?void 0:w.current)??"",onChange:P=>g(P,"mp"),onBlur:()=>x("current","mp"),className:"w-14 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),h.createElement("span",{className:"text-textSecondary"},"/"),h.createElement("input",{type:"number",name:"max",value:((S=u.mp)==null?void 0:S.max)??"",onChange:P=>g(P,"mp"),onBlur:()=>x("max","mp"),className:"w-14 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}))),["Iniciativa","fa","fm","fd"].map(P=>{const R=P==="Iniciativa",V=R?m:(u==null?void 0:u[P.toLowerCase()])??"",v=R?p:N((u==null?void 0:u[P.toLowerCase()])||0,P.toUpperCase());return h.createElement("div",{key:P,className:"flex flex-col items-center p-2 bg-bgElement rounded-md"},h.createElement("label",{htmlFor:P,className:"capitalize text-lg font-medium text-textSecondary mb-1"},P.toUpperCase(),":"),h.createElement("div",{className:"flex items-center gap-2"},h.createElement("input",{type:"number",id:P,name:P.toLowerCase(),value:V,onChange:g,onBlur:()=>x(P.toLowerCase()),className:"w-14 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!l||R}),h.createElement("span",{className:"text-textSecondary"},"="),h.createElement("span",{className:"w-14 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold"},v)))})))},EP=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:i})=>{var I,w;const{user:s}=pt(),[o,l]=B.useState(0),u=((I=t.wallet)==null?void 0:I.zeni)||0,c=((w=t.wallet)==null?void 0:w.inspiration)||0,m=s&&(s.uid===t.ownerUid||e),p=(S,P)=>{const R={...t.wallet,[S]:Math.max(0,P)};n("wallet",R)},g=()=>{p("zeni",u+o),l(0)},x=()=>{p("zeni",u-o),l(0)},N=()=>p("inspiration",c+1),C=()=>p("inspiration",c-1),D=h.createElement("div",{className:"flex justify-between items-center w-full"},h.createElement("span",null,"Zeni: ",u),h.createElement("span",{className:"text-textPrimary text-base"},"Inspiração: ",c));return h.createElement(At,{title:D,isCollapsed:r,toggleSection:i,isComplexTitle:!0},h.createElement("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6"},h.createElement("div",{className:"flex items-center gap-2"},h.createElement("span",{className:"hidden sm:inline font-semibold text-textSecondary"},"Zeni:"),h.createElement("input",{type:"number",value:o===0?"":o,onChange:S=>l(parseInt(S.target.value,10)||0),className:"w-20 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-lg",placeholder:"Valor",disabled:!m}),h.createElement("button",{onClick:g,className:"px-3 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg text-sm",disabled:!m},"Adicionar"),h.createElement("button",{onClick:x,className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm",disabled:!m},"Remover")),h.createElement("div",{className:"flex items-center gap-2"},h.createElement("span",{className:"hidden sm:inline font-semibold text-textSecondary"},"Inspiração:"),h.createElement("button",{onClick:N,className:"px-3 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg text-sm",disabled:!m},"+1"),h.createElement("button",{onClick:C,className:"px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-lg text-sm",disabled:!m},"-1"))))},wP=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:i})=>{const{user:s}=pt(),o=s&&(s.uid===t.ownerUid||n),[l,u]=B.useState(t.discordWebhookUrl||"");B.useEffect(()=>{u(t.discordWebhookUrl||"")},[t.discordWebhookUrl]);const c=p=>{u(p.target.value)},m=B.useCallback(()=>{l!==t.discordWebhookUrl&&e("discordWebhookUrl",l)},[l,t.discordWebhookUrl,e]);return h.createElement(At,{title:"Integração com Discord",isCollapsed:r,toggleSection:i},h.createElement("div",null,h.createElement("label",{htmlFor:"discordWebhookUrl",className:"block text-sm font-medium text-textSecondary mb-1"},"URL do Webhook do Canal:"),h.createElement("input",{type:"text",id:"discordWebhookUrl",name:"discordWebhookUrl",value:l,onChange:c,onBlur:m,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md focus:ring-btnHighlightBg focus:border-btnHighlightBg text-textPrimary",placeholder:"Cole a URL do Webhook do seu canal do Discord aqui",disabled:!o}),h.createElement("p",{className:"text-xs text-textSecondary mt-2"},"Com a URL do Webhook configurada, os comandos de rolagem serão enviados diretamente para o seu canal do Discord.")))},ko=({value:t,onChange:e,onBlur:n,placeholder:r,className:i,disabled:s,name:o})=>{const l=B.useRef(null);return B.useEffect(()=>{l.current&&(l.current.style.height="auto",l.current.style.height=`${l.current.scrollHeight}px`)},[t]),h.createElement("textarea",{ref:l,value:t,onChange:e,onBlur:n,placeholder:r,className:`${i} resize-none overflow-hidden`,rows:"1",disabled:s,name:o})},IP=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:i,onShowDiscord:s})=>{const{user:o}=pt(),l=o.uid===t.ownerUid||n,[u,c]=B.useState(t.inventory||[]);B.useEffect(()=>{c(t.inventory||[])},[t.inventory]);const m=()=>e("inventory",[...t.inventory||[],{id:crypto.randomUUID(),name:"",description:"",isCollapsed:!1}]),p=C=>e("inventory",(t.inventory||[]).filter(D=>D.id!==C)),g=(C,D,I)=>{c(w=>w.map(S=>S.id===C?{...S,[D]:I}:S))},x=B.useCallback((C,D)=>{const I=u.find(S=>S.id===C),w=(t.inventory||[]).find(S=>S.id===C);I&&w&&I[D]!==w[D]&&e("inventory",(t.inventory||[]).map(S=>S.id===C?{...S,[D]:I[D]}:S))},[u,t.inventory,e]),N=C=>{u.find(I=>I.id===C)&&e("inventory",(t.inventory||[]).map(I=>I.id===C?{...I,isCollapsed:!I.isCollapsed}:I))};return h.createElement(At,{title:"Inventário",isCollapsed:r,toggleSection:i},h.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},(u||[]).map(C=>C.isCollapsed!==!1?h.createElement("div",{key:C.id,className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(C.id)},C.name||"Item Sem Nome"),h.createElement("div",{className:"flex items-center gap-2 flex-shrink-0 ml-2"},h.createElement("button",{onClick:()=>s(C.name,C.description),title:"Mostrar no Discord",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap"},"Mostrar"),l&&h.createElement("button",{onClick:()=>p(C.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md"},"X"))):h.createElement("div",{key:C.id,className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput"},h.createElement("div",{className:"flex justify-between items-center mb-1"},h.createElement("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(C.id)},C.name||"Item Sem Nome"),h.createElement("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4"},h.createElement("button",{onClick:()=>s(C.name,C.description),title:"Mostrar no Discord",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap"},"Mostrar"),l&&h.createElement("button",{onClick:()=>p(C.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md"},"Remover"))),h.createElement("input",{type:"text",value:C.name,onChange:I=>g(C.id,"name",I.target.value),onBlur:()=>x(C.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome do Item",disabled:!l}),h.createElement(ko,{name:"description",value:C.description,onChange:I=>g(C.id,"description",I.target.value),onBlur:()=>x(C.id,"description"),placeholder:"Descrição do item",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l})))),(u||[]).length===0&&h.createElement("p",{className:"text-textSecondary italic mt-4"},"Nenhum item no inventário."),l&&h.createElement("div",{className:"flex justify-center mt-4"},h.createElement("button",{onClick:m,className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white text-2xl font-bold rounded-full shadow-lg flex items-center justify-center"},"+")))},TP=({character:t,isMaster:e,onUpdate:n,onShowDiscord:r,isCollapsed:i,toggleSection:s})=>{const{user:o}=pt(),l=o.uid===t.ownerUid||e,[u,c]=B.useState(t.equippedItems||[]);B.useEffect(()=>{c(t.equippedItems||[])},[t.equippedItems]);const m=()=>n("equippedItems",[...t.equippedItems||[],{id:crypto.randomUUID(),name:"",description:"",attributes:"",isCollapsed:!1}]),p=C=>n("equippedItems",(t.equippedItems||[]).filter(D=>D.id!==C)),g=(C,D,I)=>{c(w=>w.map(S=>S.id===C?{...S,[D]:I}:S))},x=B.useCallback((C,D)=>{const I=u.find(S=>S.id===C),w=(t.equippedItems||[]).find(S=>S.id===C);I&&w&&I[D]!==w[D]&&n("equippedItems",(t.equippedItems||[]).map(S=>S.id===C?{...S,[D]:I[D]}:S))},[u,t.equippedItems,n]),N=C=>n("equippedItems",(t.equippedItems||[]).map(D=>D.id===C?{...D,isCollapsed:!D.isCollapsed}:D));return h.createElement(At,{title:"Itens Equipados",isCollapsed:i,toggleSection:s},h.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},(u||[]).map(C=>C.isCollapsed!==!1?h.createElement("div",{key:C.id,className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(C.id)},C.name||"Item Sem Nome"),h.createElement("div",{className:"flex items-center gap-2 flex-shrink-0 ml-2"},h.createElement("button",{onClick:()=>r(C.name,C.description),title:"Mostrar no Discord",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap"},"Mostrar"),l&&h.createElement("button",{onClick:()=>p(C.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md"},"X"))):h.createElement("div",{key:C.id,className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm"},h.createElement("div",{className:"flex justify-between items-center mb-1"},h.createElement("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(C.id)},C.name||"Item Sem Nome"),h.createElement("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4"},h.createElement("button",{onClick:()=>r(C.name,C.description),className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md"},"Mostrar"),l&&h.createElement("button",{onClick:()=>p(C.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md"},"Remover"))),h.createElement("input",{type:"text",value:C.name,onChange:I=>g(C.id,"name",I.target.value),onBlur:()=>x(C.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md mb-2 text-textPrimary",placeholder:"Nome",disabled:!l}),h.createElement(ko,{value:C.description,onChange:I=>g(C.id,"description",I.target.value),onBlur:()=>x(C.id,"description"),placeholder:"Descrição",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md mb-2",disabled:!l}),h.createElement(ko,{value:C.attributes,onChange:I=>g(C.id,"attributes",I.target.value),onBlur:()=>x(C.id,"attributes"),placeholder:"Atributos/Efeitos",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-sm text-textPrimary",disabled:!l})))),(u||[]).length===0&&h.createElement("p",{className:"text-textSecondary italic mt-4"},"Nenhum item equipado."),l&&h.createElement("div",{className:"flex justify-center mt-4"},h.createElement("button",{onClick:m,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg"},"+")))},bP=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:i,onShowDiscord:s})=>{const{user:o}=pt(),l=o.uid===t.ownerUid||e,[u,c]=B.useState(t.abilities||[]);B.useEffect(()=>{c(t.abilities||[])},[t.abilities]);const m=()=>n("abilities",[...t.abilities||[],{id:crypto.randomUUID(),title:"",description:"",isCollapsed:!1}]),p=C=>n("abilities",(t.abilities||[]).filter(D=>D.id!==C)),g=(C,D,I)=>{c(w=>w.map(S=>S.id===C?{...S,[D]:I}:S))},x=B.useCallback((C,D)=>{const I=u.find(S=>S.id===C),w=(t.abilities||[]).find(S=>S.id===C);I&&w&&I[D]!==w[D]&&n("abilities",(t.abilities||[]).map(S=>S.id===C?{...S,[D]:I[D]}:S))},[u,t.abilities,n]),N=C=>n("abilities",(t.abilities||[]).map(D=>D.id===C?{...D,isCollapsed:!D.isCollapsed}:D));return h.createElement(At,{title:"Habilidades",isCollapsed:r,toggleSection:i},h.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},(u||[]).map(C=>C.isCollapsed!==!1?h.createElement("div",{key:C.id,className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(C.id)},C.title||"Habilidade Sem Título"),h.createElement("div",{className:"flex items-center gap-2 flex-shrink-0 ml-2"},h.createElement("button",{onClick:()=>s(C.title,C.description),className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md"},"Mostrar"),l&&h.createElement("button",{onClick:()=>p(C.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md"},"X"))):h.createElement("div",{key:C.id,className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm"},h.createElement("div",{className:"flex justify-between items-center mb-1"},h.createElement("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(C.id)},C.title||"Habilidade Sem Título"),h.createElement("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4"},h.createElement("button",{onClick:()=>s(C.title,C.description),className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md"},"Mostrar"),l&&h.createElement("button",{onClick:()=>p(C.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md"},"Remover"))),h.createElement("input",{type:"text",value:C.title,onChange:I=>g(C.id,"title",I.target.value),onBlur:()=>x(C.id,"title"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Título",disabled:!l}),h.createElement(ko,{value:C.description,onChange:I=>g(C.id,"description",I.target.value),onBlur:()=>x(C.id,"description"),placeholder:"Descrição",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l})))),(u||[]).length===0&&h.createElement("p",{className:"text-textSecondary italic mt-4"},"Nenhuma habilidade adicionada."),l&&h.createElement("div",{className:"flex justify-center mt-4"},h.createElement("button",{onClick:m,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg"},"+")))},xP=({character:t,onUpdate:e,isCollapsed:n,toggleSection:r,onShowDiscord:i})=>{const o=p=>e(p,[...t[p]||[],{id:crypto.randomUUID(),name:"",description:"",origin:{class:!1,race:!1,manual:!0},value:0,isCollapsed:!1}]),l=(p,g)=>e(p,(t[p]||[]).filter(x=>x.id!==g)),u=(p,g,x)=>e(p,(t[p]||[]).map(N=>N.id===g?{...N,origin:{...N.origin,[x]:!N.origin[x]}}:N)),c=(p,g,x,N)=>e(p,(t[p]||[]).map(C=>C.id===g?{...C,[x]:N}:C)),m=(p,g)=>e(p,(t[p]||[]).map(x=>x.id===g?{...x,isCollapsed:!x.isCollapsed}:x));return h.createElement(At,{title:"Vantagens e Desvantagens",isCollapsed:n,toggleSection:r},h.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},h.createElement("div",null,h.createElement("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1"},"Vantagens"),h.createElement("div",{className:"space-y-2"},(t.advantages||[]).map(p=>h.createElement(ty,{key:p.id,perk:p,type:"advantages",canEdit:!0,onRemove:l,onChange:c,onOriginChange:u,onToggleCollapse:m,onShowDiscord:i})),h.createElement("div",{className:"flex justify-end mt-4"},h.createElement("button",{onClick:()=>o("advantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg"},"+")))),h.createElement("div",null,h.createElement("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1"},"Desvantagens"),h.createElement("div",{className:"space-y-2"},(t.disadvantages||[]).map(p=>h.createElement(ty,{key:p.id,perk:p,type:"disadvantages",canEdit:!0,onRemove:l,onChange:c,onOriginChange:u,onToggleCollapse:m,onShowDiscord:i})),h.createElement("div",{className:"flex justify-end mt-4"},h.createElement("button",{onClick:()=>o("disadvantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg"},"+"))))))},ty=({perk:t,type:e,canEdit:n,onRemove:r,onChange:i,onOriginChange:s,onToggleCollapse:o,onShowDiscord:l})=>{const[u,c]=B.useState(t);B.useEffect(()=>{c(t)},[t.id]);const m=g=>{const{name:x,value:N,type:C}=g.target,D=C==="number"?parseInt(N,10)||0:N;c(I=>({...I,[x]:D}))},p=B.useCallback(g=>{u[g]!==t[g]&&i(e,u.id,g,u[g])},[u,t,e,i]);return h.createElement("div",{className:"flex flex-col p-3 bg-bgElement rounded-md shadow-sm"},h.createElement("div",{className:"flex justify-between items-center mb-1"},h.createElement("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>o(e,t.id)},u.name||"Sem Nome"," ",t.isCollapsed?"...":""),h.createElement("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4"},h.createElement("button",{onClick:()=>l(u.name,u.description),title:"Mostrar no Discord",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md"},"Mostrar"),n&&h.createElement("button",{onClick:()=>r(e,t.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md"},"Remover"))),!t.isCollapsed&&h.createElement(h.Fragment,null,h.createElement("div",{className:"flex items-center gap-2 mb-2"},h.createElement("input",{type:"text",name:"name",value:u.name,onChange:m,onBlur:()=>p("name"),className:"font-semibold text-lg flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",placeholder:"Nome",disabled:!n}),h.createElement("input",{type:"number",name:"value",value:u.value===0?"":u.value,onChange:m,onBlur:()=>p("value"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary",placeholder:"Valor",disabled:!n})),h.createElement(ko,{name:"description",value:u.description,onChange:m,onBlur:()=>p("description"),placeholder:"Descrição",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!n}),h.createElement("div",{className:"flex gap-3 text-sm text-textSecondary mt-2"},["class","race","manual"].map(g=>{var x;return h.createElement("label",{key:g,className:"flex items-center gap-1"},h.createElement("input",{type:"checkbox",checked:((x=t.origin)==null?void 0:x[g])||!1,onChange:()=>s(e,t.id,g),className:"form-checkbox text-btnHighlightBg rounded",disabled:!n}),g.charAt(0).toUpperCase()+g.slice(1))}))))},SP=({value:t,onChange:e,onBlur:n,placeholder:r,className:i,disabled:s})=>{const o=B.useRef(null);return h.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),h.createElement("textarea",{ref:o,value:t,onChange:e,onBlur:n,placeholder:r,className:`${i} resize-none overflow-hidden`,rows:"1",disabled:s})},CP=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,allAttributes:i,onUpdate:s,onExecuteFormula:o})=>{const{user:l}=pt(),u=l.uid===t.ownerUid||e,[c,m]=B.useState(t.specializations||[]);B.useEffect(()=>{m(t.specializations||[])},[t.specializations]);const p=_=>{s("specializations",_)},g=(_,k)=>{const b=k==="attribute"?i[0]||"":0,q={id:crypto.randomUUID(),type:k,value:b},W=(t.specializations||[]).map(X=>X.id===_?{...X,components:[...X.components||[],q]}:X);p(W)},x=(_,k)=>{const b=(t.specializations||[]).map(q=>q.id===_?{...q,components:(q.components||[]).filter(W=>W.id!==k)}:q);p(b)},N=(_,k,b)=>{m(q=>q.map(W=>W.id===_?{...W,components:W.components.map(X=>X.id===k?{...X,value:b}:X)}:W))},C=B.useCallback((_,k)=>{const b=c.find(q=>q.id===_);b==null||b.components.find(q=>q.id===k),p(c)},[c,p]),D=()=>{const _={id:crypto.randomUUID(),name:"Nova Perícia",isCollapsed:!1,mainDice:"1d20",components:[],description:"",trained:!1,bonusRules:[]};p([...t.specializations||[],_])},I=_=>{p((t.specializations||[]).filter(k=>k.id!==_))},w=(_,k,b)=>{m(q=>q.map(W=>W.id===_?{...W,[k]:b}:W))},S=B.useCallback((_,k,b)=>{const q=(t.specializations||[]).map(W=>W.id===_?{...W,[k]:b}:W);p(q)},[t.specializations,p]),P=_=>{const k=(t.specializations||[]).map(b=>b.id===_?{...b,isCollapsed:!b.isCollapsed}:b);p(k)},R=_=>{const k={id:crypto.randomUUID(),enabled:!0,bonus:1,each:1,source:"level",condition:"none"},b=(t.specializations||[]).map(q=>q.id===_?{...q,bonusRules:[...q.bonusRules||[],k]}:q);p(b)},V=(_,k)=>{const b=(t.specializations||[]).map(q=>q.id===_?{...q,bonusRules:(q.bonusRules||[]).filter(W=>W.id!==k)}:q);p(b)},v=(_,k,b,q)=>{m(W=>W.map(X=>X.id===_?{...X,bonusRules:X.bonusRules.map(Oe=>Oe.id===k?{...Oe,[b]:q}:Oe)}:X))},y=_=>{const k=c.find(q=>q.id===_),b=(t.specializations||[]).map(q=>q.id===_?k:q);p(b)},T=_=>{if(!t)return 0;if(["Iniciativa","FA","FM","FD"].includes(_))return t.mainAttributes[_.toLowerCase()]||0;const k=(t.attributes||[]).find(b=>b.name===_);return k?(k.base||0)+(k.perm||0)+(k.arma||0):0},A=_=>{let k=(_.components||[]).reduce((b,q)=>q.type==="number"?b+(parseInt(q.value,10)||0):q.type==="attribute"?b+T(q.value):b,0);return(_.bonusRules||[]).forEach(b=>{if(!b.enabled||b.condition==="trained"&&!_.trained)return;let q=0;b.source==="level"?q=t.level||1:b.source&&b.source.startsWith("attribute_")&&(q=T(b.source.replace("attribute_","")));const W=parseInt(b.each,10)||1,X=parseInt(b.bonus,10)||0;W>0&&(k+=Math.floor(q/W)*X)}),k};return h.createElement(At,{title:"Perícias",isCollapsed:n,toggleSection:r},h.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},(c||[]).map(_=>{const k=_.isCollapsed!==!1,b=A(_),q=()=>{const W=[..._.components||[]];W.push({id:crypto.randomUUID(),type:"dice",value:_.mainDice}),(_.bonusRules||[]).forEach(X=>{if(!X.enabled||X.condition==="trained"&&!_.trained)return;let Oe=0,M="";if(X.source==="level")Oe=t.level||1,M="Nível";else if(X.source&&X.source.startsWith("attribute_")){const Z=X.source.replace("attribute_","");Oe=T(Z),M=Z}const z=parseInt(X.each,10)||1,$=parseInt(X.bonus,10)||0;if(z>0){const Z=Math.floor(Oe/z)*$;if(Z!==0){const ee=X.condition==="trained"?" (Treinado)":"";W.push({id:crypto.randomUUID(),type:"number",value:Z,label:`Bônus ${M}${ee}`})}}}),o({..._,discordText:_.description,components:W})};return k?h.createElement("div",{key:_.id,className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>P(_.id)},_.trained&&"✅"," ",_.name||"Perícia Sem Nome"," ",b!==0&&` (${b>0?"+":""}${b})`),h.createElement("button",{onClick:q,className:"px-4 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-2 text-sm"},"Rolar")):h.createElement("div",{key:_.id,className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput"},h.createElement("div",{className:"flex justify-between items-center gap-2 mb-3"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>P(_.id)},_.name||"Perícia Sem Nome"),h.createElement("button",{onClick:q,className:"px-5 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap"},"Rolar"),u&&h.createElement("button",{onClick:()=>P(_.id),className:"w-10 h-10 bg-gray-600 text-white text-lg rounded-md flex items-center justify-center font-bold"},"↑")),h.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 border-t border-bgInput pt-3 mt-3"},h.createElement("div",{className:"md:col-span-1"},h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-1"},"Nome da Perícia:"),h.createElement("input",{type:"text",placeholder:"Nome da Perícia",value:_.name,onChange:W=>w(_.id,"name",W.target.value),onBlur:W=>S(_.id,"name",W.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-3",disabled:!u}),h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-1"},"Dado Principal:"),h.createElement("input",{type:"text",placeholder:"1d20",value:_.mainDice,onChange:W=>w(_.id,"mainDice",W.target.value),onBlur:W=>S(_.id,"mainDice",W.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-3",disabled:!u}),h.createElement("div",{className:"flex items-center mb-3"},h.createElement("input",{type:"checkbox",id:`trained-${_.id}`,checked:_.trained,onChange:W=>S(_.id,"trained",W.target.checked),className:"form-checkbox text-green-500 rounded-sm",disabled:!u}),h.createElement("label",{htmlFor:`trained-${_.id}`,className:"ml-2 text-sm text-textSecondary"},"Treinado")),h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-2"},"Descrição:"),h.createElement(SP,{placeholder:"Descrição...",value:_.description,onChange:W=>w(_.id,"description",W.target.value),onBlur:W=>S(_.id,"description",W.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-sm mb-3",disabled:!u}),u&&h.createElement("button",{onClick:()=>I(_.id),className:"w-full px-3 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-md"},"Remover Perícia")),h.createElement("div",{className:"md:col-span-2 space-y-4"},h.createElement("div",null,h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-2"},"Bônus Adicionais:"),h.createElement("div",{className:"space-y-2"},(_.components||[]).map(W=>h.createElement("div",{key:W.id,className:"flex items-center gap-2"},W.type==="attribute"&&h.createElement("select",{value:W.value,onChange:X=>N(_.id,W.id,X.target.value),onBlur:()=>C(_.id,W.id),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary w-full",disabled:!u},h.createElement("option",{disabled:!0,value:""},"Selecione Atributo"),i.map(X=>h.createElement("option",{key:X,value:X},X))),W.type==="number"&&h.createElement("input",{type:"number",value:W.value,onChange:X=>N(_.id,W.id,X.target.value),onBlur:()=>C(_.id,W.id),className:"w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),u&&h.createElement("button",{onClick:()=>x(_.id,W.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0"},"-")))),u&&h.createElement("div",{className:"flex gap-2 mt-2"},h.createElement("button",{onClick:()=>g(_.id,"attribute"),className:"px-2 py-1 text-xs bg-green-600 text-white rounded-md"},"+ Atributo"),h.createElement("button",{onClick:()=>g(_.id,"number"),className:"px-2 py-1 text-xs bg-green-600 text-white rounded-md"},"+ Número"))),h.createElement("div",null,h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-2"},"Bônus Condicionais:"),h.createElement("div",{className:"space-y-2 mb-3"},(_.bonusRules||[]).map(W=>h.createElement("div",{key:W.id,className:"flex items-center gap-2 flex-wrap p-2 rounded-md border border-dashed border-textSecondary/30"},h.createElement("input",{type:"checkbox",checked:W.enabled,onChange:X=>v(_.id,W.id,"enabled",X.target.checked),onBlur:()=>y(_.id),disabled:!u}),h.createElement("span",null,"Se"),h.createElement("select",{value:W.condition,onChange:X=>v(_.id,W.id,"condition",X.target.value),onBlur:()=>y(_.id),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u},h.createElement("option",{value:"none"},"Sempre"),h.createElement("option",{value:"trained"},"Treinado")),h.createElement("span",null,", a cada"),h.createElement("input",{type:"number",value:W.each,onChange:X=>v(_.id,W.id,"each",X.target.value),onBlur:()=>y(_.id),className:"w-16 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),h.createElement("select",{value:W.source,onChange:X=>v(_.id,W.id,"source",X.target.value),onBlur:()=>y(_.id),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u},h.createElement("option",{value:"level"},"Nível"),i.map(X=>h.createElement("option",{key:X,value:`attribute_${X}`},X))),h.createElement("span",null,", +"),h.createElement("input",{type:"number",value:W.bonus,onChange:X=>v(_.id,W.id,"bonus",X.target.value),onBlur:()=>y(_.id),className:"w-16 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),u&&h.createElement("button",{onClick:()=>V(_.id,W.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0"},"-")))),u&&h.createElement("button",{onClick:()=>R(_.id),className:"px-2 py-1 text-xs bg-blue-600 text-white rounded-md"},"+ Regra de Bônus")))))})),u&&h.createElement("div",{className:"flex justify-center mt-4"},h.createElement("button",{onClick:D,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md"},"+ Adicionar Perícia")))},AP=({value:t,onChange:e,placeholder:n,className:r,disabled:i,onBlur:s})=>{const o=B.useRef(null);return B.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),h.createElement("textarea",{ref:o,value:t,onChange:e,onBlur:s,placeholder:n,className:`${r} resize-none overflow-hidden`,rows:"1",disabled:i})},PP=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:i})=>{const{user:s}=pt(),o=s.uid===t.ownerUid||e,l=m=>{const p=m==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(m==="image"){const g=prompt("Cole a URL da imagem:");g&&n("history",[...t.history||[],{...p,value:g}])}else n("history",[...t.history||[],p])},u=(m,p,g)=>n("history",(t.history||[]).map(x=>x.id===m?{...x,[p]:g}:x)),c=m=>n("history",(t.history||[]).filter(p=>p.id!==m));return h.createElement(At,{title:"História do Personagem",isCollapsed:r,toggleSection:i},h.createElement("div",{className:"space-y-4 mb-4"},(t.history||[]).length===0?h.createElement("p",{className:"text-textSecondary italic"},"Nenhum bloco de história adicionado."):t.history.map(m=>Aw(m,o,u,c))),o&&h.createElement("div",{className:"flex flex-wrap gap-4 mt-4 justify-center"},h.createElement("button",{onClick:()=>l("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg"},"Adicionar Texto"),h.createElement("button",{onClick:()=>l("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg"},"Adicionar Imagem")))},kP=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:i})=>{const{user:s}=pt(),o=s.uid===t.ownerUid||e,l=m=>{const p=m==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(m==="image"){const g=prompt("Cole a URL da imagem para a anotação:");g&&n("notes",[...t.notes||[],{...p,value:g}])}else n("notes",[...t.notes||[],p])},u=(m,p,g)=>n("notes",(t.notes||[]).map(x=>x.id===m?{...x,[p]:g}:x)),c=m=>n("notes",(t.notes||[]).filter(p=>p.id!==m));return h.createElement(At,{title:"Anotações",isCollapsed:r,toggleSection:i},h.createElement("div",{className:"space-y-4 mb-4"},(t.notes||[]).length===0?h.createElement("p",{className:"text-textSecondary italic"},"Nenhum bloco de anotação adicionado."):t.notes.map(m=>Aw(m,o,u,c))),o&&h.createElement("div",{className:"flex flex-wrap gap-4 mt-4 justify-center"},h.createElement("button",{onClick:()=>l("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg"},"Adicionar Texto"),h.createElement("button",{onClick:()=>l("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg"},"Adicionar Imagem")))},Aw=(t,e,n,r)=>h.createElement("div",{key:t.id,className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput relative"},e&&h.createElement("button",{onClick:()=>r(t.id),className:"absolute top-2 right-2 w-6 h-6 bg-red-600 hover:bg-red-700 text-white text-xs font-bold rounded-full flex items-center justify-center z-10"},"X"),t.type==="text"?h.createElement(RP,{block:t,canEdit:e,updateBlock:n}):h.createElement(NP,{block:t,canEdit:e,updateBlock:n})),RP=({block:t,canEdit:e,updateBlock:n})=>{const[r,i]=B.useState(t.value||"");B.useEffect(()=>{i(t.value||"")},[t.value]);const s=B.useCallback(()=>{r!==t.value&&n(t.id,"value",r)},[r,t.value,t.id,n]);return t.isCollapsed?h.createElement("div",{className:"cursor-pointer",onClick:()=>n(t.id,"isCollapsed",!1)},h.createElement("p",{className:"text-lg font-semibold mb-1 text-textPrimary"},"Bloco de Texto"),h.createElement("p",{className:"text-sm italic text-textSecondary truncate"},t.value||"Vazio...")):h.createElement(h.Fragment,null,h.createElement(AP,{value:r,onChange:o=>i(o.target.value),onBlur:s,placeholder:"Digite aqui...",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!e}),h.createElement("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary"},"Ocultar ▲"))},NP=({block:t,canEdit:e,updateBlock:n})=>{const[r,i]=B.useState(t.width===0?"":t.width),[s,o]=B.useState(t.height===0?"":t.height),[l,u]=B.useState(t.fitWidth);B.useEffect(()=>{i(t.width===0?"":t.width),o(t.height===0?"":t.height),u(t.fitWidth)},[t.width,t.height,t.fitWidth]);const c=B.useCallback(()=>n(t.id,"width",parseInt(r)||0),[t.id,n,r]),m=B.useCallback(()=>n(t.id,"height",parseInt(s)||0),[t.id,n,s]),p=B.useCallback(g=>n(t.id,"fitWidth",g.target.checked),[t.id,n]);return t.isCollapsed?h.createElement("div",{className:"cursor-pointer text-center py-2",onClick:()=>n(t.id,"isCollapsed",!1)},h.createElement("p",{className:"text-lg font-semibold text-textPrimary"},"Mostrar Imagem")):h.createElement("div",{className:"flex flex-col items-center"},h.createElement("img",{src:t.value,alt:"Imagem",className:"max-w-full h-auto rounded-md shadow-md",style:{width:l?"100%":r?`${r}px`:"auto",height:l?"auto":s?`${s}px`:"auto",objectFit:"contain"},onError:g=>{g.target.onerror=null,g.target.src="https://placehold.co/300x200/1f2937/FFFFFF?text=Erro"}}),e&&h.createElement("div",{className:"flex flex-wrap items-center justify-center gap-4 mt-2 text-sm text-textSecondary"},h.createElement("label",null,"Ajustar à Largura: ",h.createElement("input",{type:"checkbox",checked:l,onChange:g=>{u(g.target.checked),p(g)},className:"form-checkbox text-btnHighlightBg rounded"})),!l&&h.createElement(h.Fragment,null,h.createElement("label",null,"Largura (px): ",h.createElement("input",{type:"number",value:r,onChange:g=>i(g.target.value),onBlur:c,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})),h.createElement("label",null,"Altura (px): ",h.createElement("input",{type:"number",value:s,onChange:g=>o(g.target.value),onBlur:m,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})))),h.createElement("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 w-full text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary"},"Ocultar ▲"))},DP=({value:t,onChange:e,onBlur:n,placeholder:r,className:i,disabled:s})=>{const o=B.useRef(null);return h.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),h.createElement("textarea",{ref:o,value:t,onChange:e,onBlur:n,placeholder:r,className:`${i} resize-none overflow-hidden`,rows:"1",disabled:s})},VP=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,onOpenActionModal:i,allAttributes:s,onUpdate:o,onExecuteFormula:l})=>{const{user:u}=pt();if(!t||!u)return null;const c=u.uid===t.ownerUid||e,[m,p]=B.useState(t.formulaActions||[]);B.useEffect(()=>{p(t.formulaActions||[])},[t.formulaActions]);const g=()=>{const R={id:crypto.randomUUID(),name:"Nova Ação",components:[{id:crypto.randomUUID(),type:"dice",value:"1d6"}],multiplier:1,discordText:"",isCollapsed:!1,costValue:0,costType:"",recoverHP:!1,recoverMP:!1};o("formulaActions",[...t.formulaActions||[],R])},x=R=>{o("formulaActions",(t.formulaActions||[]).filter(V=>V.id!==R))},N=(R,V,v)=>{p(y=>y.map(T=>T.id===R?{...T,[V]:v}:T))},C=B.useCallback((R,V,v)=>{const y=m.find(A=>A.id===R),T=(t.formulaActions||[]).find(A=>A.id===R);if(y&&T){const A=v!==void 0?v:y[V];A!==T[V]&&o("formulaActions",(t.formulaActions||[]).map(_=>_.id===R?{..._,[V]:A}:_))}},[m,t.formulaActions,o]),D=(R,V)=>{let v;V==="dice"?v={id:crypto.randomUUID(),type:V,value:"1d6"}:V==="attribute"?v={id:crypto.randomUUID(),type:V,value:""}:V==="critDice"&&(v={id:crypto.randomUUID(),type:V,value:"1d6",critValue:6,critBonusAttribute:"",critBonusMultiplier:1}),o("formulaActions",(t.formulaActions||[]).map(y=>y.id===R?{...y,components:[...y.components||[],v]}:y))},I=(R,V)=>{o("formulaActions",(t.formulaActions||[]).map(v=>v.id===R?{...v,components:(v.components||[]).filter(y=>y.id!==V)}:v))},w=(R,V,v,y)=>{p(T=>T.map(A=>A.id===R?{...A,components:A.components.map(_=>_.id===V?{..._,[v]:y}:_)}:A))},S=B.useCallback((R,V,v,y)=>{const T=m.find(b=>b.id===R),A=T==null?void 0:T.components.find(b=>b.id===V),_=(t.formulaActions||[]).find(b=>b.id===R),k=_==null?void 0:_.components.find(b=>b.id===V);if(A&&k){const b=y!==void 0?y:A[v];b!==k[v]&&o("formulaActions",(t.formulaActions||[]).map(q=>q.id===R?{...q,components:q.components.map(W=>W.id===V?{...W,[v]:b}:W)}:q))}},[m,t.formulaActions,o]),P=R=>{o("formulaActions",(t.formulaActions||[]).map(V=>V.id===R?{...V,isCollapsed:!V.isCollapsed}:V))};return h.createElement(At,{title:"Ações",isCollapsed:n,toggleSection:r},h.createElement(h.Fragment,null,h.createElement("div",{className:"flex flex-wrap gap-4 mb-6 pb-4 border-b border-bgElement"},h.createElement("button",{onClick:()=>i("heal"),className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md"},"Curar"),h.createElement("button",{onClick:()=>i("damage"),className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-md"},"Receber Dano")),h.createElement("div",{className:"mb-6"},h.createElement("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3"},"Construtor de Ações Rápidas"),h.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},(m||[]).map(R=>R.isCollapsed!==!1?h.createElement("div",{key:R.id,className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>P(R.id)},R.name||"Ação Sem Nome"),h.createElement("button",{onClick:()=>l(R),className:"px-4 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-2 text-sm"},"Usar")):h.createElement("div",{key:R.id,className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput"},h.createElement("div",{className:"flex justify-between items-center gap-2 mb-3"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>P(R.id)},R.name||"Ação Sem Nome"),h.createElement("button",{onClick:()=>l(R),className:"px-5 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap"},"Usar"),c&&h.createElement("button",{onClick:()=>x(R.id),className:"w-10 h-10 bg-red-600 text-white text-lg rounded-md flex items-center justify-center font-bold"},"X")),h.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 border-t border-bgInput pt-3 mt-3"},h.createElement("div",null,h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-1"},"Nome da Ação:"),h.createElement("input",{type:"text",placeholder:"Nome da Ação",value:R.name,onChange:v=>N(R.id,"name",v.target.value),onBlur:()=>C(R.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-3",disabled:!c}),h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-2"},"Componentes da Fórmula:"),h.createElement("div",{className:"space-y-2 mb-3"},(R.components||[]).map(v=>h.createElement("div",{key:v.id,className:"flex flex-col gap-2 p-2 rounded-md border border-dashed border-textSecondary/30"},v.type==="dice"?h.createElement("div",{className:"flex items-center gap-2"},h.createElement("input",{type:"text",placeholder:"1d6 ou 10",value:v.value,onChange:y=>w(R.id,v.id,"value",y.target.value),onBlur:()=>S(R.id,v.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!c}),h.createElement("div",{className:"text-textSecondary flex-shrink-0"},"Dado/Nº"),c&&h.createElement("button",{onClick:()=>I(R.id,v.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0"},"-")):v.type==="attribute"?h.createElement("div",{className:"flex items-center gap-2"},h.createElement("select",{value:v.value,onChange:y=>w(R.id,v.id,"value",y.target.value),onBlur:()=>S(R.id,v.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!c},h.createElement("option",{value:""},"Selecione Atributo"),s.map(y=>h.createElement("option",{key:y,value:y},y))),h.createElement("div",{className:"text-textSecondary flex-shrink-0"},"Atributo"),c&&h.createElement("button",{onClick:()=>I(R.id,v.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0"},"-")):v.type==="critDice"?h.createElement("div",{className:"flex flex-col gap-2"},h.createElement("div",{className:"flex items-center gap-2"},h.createElement("input",{type:"text",placeholder:"1d6",value:v.value,onChange:y=>w(R.id,v.id,"value",y.target.value),onBlur:()=>S(R.id,v.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!c}),h.createElement("div",{className:"text-textSecondary flex-shrink-0"},"Dado Crítico"),c&&h.createElement("button",{onClick:()=>I(R.id,v.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0"},"-")),h.createElement("div",{className:"flex items-center gap-2 text-sm text-textSecondary"},h.createElement("span",{className:"flex-shrink-0"},"Crit. ≥"),h.createElement("input",{type:"number",placeholder:"6",value:v.critValue||"",onChange:y=>w(R.id,v.id,"critValue",y.target.value),onBlur:()=>S(R.id,v.id,"critValue"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!c}),h.createElement("span",{className:"flex-shrink-0"},"Bônus:"),h.createElement("select",{value:v.critBonusAttribute||"",onChange:y=>w(R.id,v.id,"critBonusAttribute",y.target.value),onBlur:()=>S(R.id,v.id,"critBonusAttribute"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!c},h.createElement("option",{value:""},"Nenhum"),s.map(y=>h.createElement("option",{key:y,value:y},y))),h.createElement("span",{className:"flex-shrink-0"},"x"),h.createElement("input",{type:"number",placeholder:"1",value:v.critBonusMultiplier||"",onChange:y=>w(R.id,v.id,"critBonusMultiplier",y.target.value),onBlur:()=>S(R.id,v.id,"critBonusMultiplier"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!c}))):null))),c&&h.createElement("div",{className:"flex gap-2 flex-wrap"},h.createElement("button",{onClick:()=>D(R.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md"},"+ Dado/Nº"),h.createElement("button",{onClick:()=>D(R.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md"},"+ Atributo"),h.createElement("button",{onClick:()=>D(R.id,"critDice"),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md"},"+ Dado Crítico"))),h.createElement("div",null,h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-2"},"Multiplicador:"),h.createElement("input",{type:"number",value:R.multiplier||"",onChange:v=>N(R.id,"multiplier",v.target.value),onBlur:()=>C(R.id,"multiplier"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-3",placeholder:"1",disabled:!c}),h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-2"},"Descrição da Ação:"),h.createElement(DP,{placeholder:"Descrição...",value:R.discordText,onChange:v=>N(R.id,"discordText",v.target.value),onBlur:()=>C(R.id,"discordText"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-sm",disabled:!c}),h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-2 mt-3"},"Custo da Ação:"),h.createElement("div",{className:"flex items-center gap-2"},h.createElement("input",{type:"number",placeholder:"Custo",value:R.costValue||"",onChange:v=>N(R.id,"costValue",v.target.value),onBlur:()=>C(R.id,"costValue"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!c}),h.createElement("select",{value:R.costType,onChange:v=>N(R.id,"costType",v.target.value),onBlur:()=>C(R.id,"costType"),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!c},h.createElement("option",{value:""},"N/A"),h.createElement("option",{value:"HP"},"HP"),h.createElement("option",{value:"MP"},"MP"))),c&&h.createElement("div",{className:"flex gap-4 mt-4"},h.createElement("div",{className:"flex items-center"},h.createElement("input",{type:"checkbox",id:`recover-hp-${R.id}`,checked:R.recoverHP||!1,onChange:v=>C(R.id,"recoverHP",v.target.checked),className:"form-checkbox text-green-500 rounded-sm",disabled:!c}),h.createElement("label",{htmlFor:`recover-hp-${R.id}`,className:"ml-2 text-sm text-textSecondary"},"Recuperar HP")),h.createElement("div",{className:"flex items-center"},h.createElement("input",{type:"checkbox",id:`recover-mp-${R.id}`,checked:R.recoverMP||!1,onChange:v=>C(R.id,"recoverMP",v.target.checked),className:"form-checkbox text-blue-500 rounded-sm",disabled:!c}),h.createElement("label",{htmlFor:`recover-mp-${R.id}`,className:"ml-2 text-sm text-textSecondary"},"Recuperar MP")))))))),c&&h.createElement("div",{className:"flex justify-center mt-4"},h.createElement("button",{onClick:g,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md"},"+ Adicionar Ação Rápida")))))},OP=({character:t,isMaster:e,onUpdate:n,allAttributes:r,isCollapsed:i,toggleSection:s})=>{const{user:o}=pt();if(!t||!o)return h.createElement("div",{className:"p-6 text-center text-textSecondary"},"A carregar buffs...");const l=o.uid===t.ownerUid||e,[u,c]=B.useState(t.buffs||[]);B.useEffect(()=>{c(t.buffs||[])},[t.buffs]);const m=()=>{const P={id:crypto.randomUUID(),name:"Novo Buff",effects:[],isActive:!1,isCollapsed:!1,costValue:0,costType:""};n("buffs",[...t.buffs||[],P])},p=P=>n("buffs",(t.buffs||[]).filter(R=>R.id!==P)),g=P=>n("buffs",(t.buffs||[]).map(R=>R.id===P?{...R,isActive:!R.isActive}:R)),x=P=>n("buffs",(t.buffs||[]).map(R=>R.id===P?{...R,isCollapsed:!R.isCollapsed}:R)),N=(P,R,V)=>{c(v=>v.map(y=>y.id===P?{...y,[R]:V}:y))},C=B.useCallback((P,R)=>{const V=u.find(y=>y.id===P),v=(t.buffs||[]).find(y=>y.id===P);if(V&&v&&V[R]!==v[R]){const y=R==="costValue"?parseInt(V[R],10)||0:V[R];n("buffs",(t.buffs||[]).map(T=>T.id===P?{...T,[R]:y}:T))}},[u,t.buffs,n]),D=(P,R)=>{const V={id:crypto.randomUUID(),type:R,target:"",value:R==="attribute"?0:"1d6"};n("buffs",(t.buffs||[]).map(v=>v.id===P?{...v,effects:[...v.effects||[],V]}:v))},I=(P,R)=>{n("buffs",(t.buffs||[]).map(V=>V.id===P?{...V,effects:(V.effects||[]).filter(v=>v.id!==R)}:V))},w=(P,R,V,v)=>{c(y=>y.map(T=>T.id===P?{...T,effects:T.effects.map(A=>{if(A.id===R){const _={...A,[V]:v};return V==="type"&&(_.target="",_.value=v==="attribute"?0:"1d6"),_}return A})}:T))},S=B.useCallback((P,R,V)=>{const v=u.find(_=>_.id===P),y=v==null?void 0:v.effects.find(_=>_.id===R),T=(t.buffs||[]).find(_=>_.id===P),A=T==null?void 0:T.effects.find(_=>_.id===R);y&&A&&y[V]!==A[V]&&n("buffs",(t.buffs||[]).map(_=>_.id===P?{..._,effects:_.effects.map(k=>k.id===R?{...k,[V]:y[V]}:k)}:_))},[u,t.buffs,n]);return h.createElement(At,{title:"Buffs",isCollapsed:i,toggleSection:s},h.createElement(h.Fragment,null,h.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},(u||[]).map(P=>P.isCollapsed!==!1?h.createElement("div",{key:P.id,className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>x(P.id)},P.name||"Buff Sem Nome"),h.createElement("label",{className:"flex items-center cursor-pointer ml-2"},h.createElement("div",{className:"relative"},h.createElement("input",{type:"checkbox",checked:P.isActive,onChange:()=>g(P.id),className:"sr-only",disabled:!l}),h.createElement("div",{className:`block w-12 h-6 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),h.createElement("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})))):h.createElement("div",{key:P.id,className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput"},h.createElement("div",{className:"flex justify-between items-center mb-3"},h.createElement("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>x(P.id)},P.name||"Buff Sem Nome"),h.createElement("div",{className:"flex items-center gap-4 ml-4"},h.createElement("label",{className:"flex items-center cursor-pointer"},h.createElement("div",{className:"relative"},h.createElement("input",{type:"checkbox",checked:P.isActive,onChange:()=>g(P.id),className:"sr-only",disabled:!l}),h.createElement("div",{className:`block w-14 h-8 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),h.createElement("div",{className:`dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`}))),l&&h.createElement("button",{onClick:()=>p(P.id),className:"w-8 h-8 bg-red-600 hover:bg-red-700 text-white text-lg font-bold rounded-full flex items-center justify-center flex-shrink-0"},"X"))),h.createElement("div",{className:"mt-3 pt-3 border-t border-bgInput/50 space-y-3"},h.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},h.createElement("div",null,h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-1"},"Nome do Buff:"),h.createElement("input",{type:"text",placeholder:"Nome do Buff",value:P.name,onChange:V=>N(P.id,"name",V.target.value),onBlur:()=>C(P.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-4",disabled:!l}),h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-1"},"Custo de Manutenção:"),h.createElement("div",{className:"flex items-center gap-2"},h.createElement("input",{type:"number",placeholder:"0",value:P.costValue||"",onChange:V=>N(P.id,"costValue",V.target.value),onBlur:()=>C(P.id,"costValue"),className:"w-20 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!l}),h.createElement("select",{value:P.costType,onChange:V=>N(P.id,"costType",V.target.value),onBlur:()=>C(P.id,"costType"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!l},h.createElement("option",{value:""},"N/A"),h.createElement("option",{value:"HP"},"HP"),h.createElement("option",{value:"MP"},"MP")))),h.createElement("div",null,h.createElement("label",{className:"text-sm font-medium text-textSecondary block mb-1"},"Efeitos do Buff:"),h.createElement("div",{className:"space-y-2"},(P.effects||[]).map(V=>h.createElement("div",{key:V.id,className:"grid grid-cols-3 gap-2"},h.createElement("select",{value:V.type,onChange:v=>w(P.id,V.id,"type",v.target.value),onBlur:()=>S(P.id,V.id,"type"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!l},h.createElement("option",{value:"attribute"},"Modificar Atributo"),h.createElement("option",{value:"dice"},"Adicionar Dado/Nº")),V.type==="attribute"?h.createElement("select",{value:V.target,onChange:v=>w(P.id,V.id,"target",v.target.value),onBlur:()=>S(P.id,V.id,"target"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!l},h.createElement("option",{value:""},"Selecione Atributo"),r.map(v=>h.createElement("option",{key:v,value:v},v))):h.createElement("div",{className:"p-2 bg-bgPage border-bgElement rounded-md text-textSecondary text-center italic col-span-3 sm:col-span-1"},"Não aplicável"),h.createElement("div",{className:"flex items-center gap-2 col-span-3 sm:col-span-1"},h.createElement("input",{type:"text",placeholder:V.type==="attribute"?"Valor (+/-)":"1d6 ou 6",value:V.value||"",onChange:v=>w(P.id,V.id,"value",v.target.value),onBlur:()=>S(P.id,V.id,"value"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center",disabled:!l}),l&&h.createElement("button",{onClick:()=>I(P.id,V.id),className:"w-7 h-7 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0"},"-"))))),l&&h.createElement("div",{className:"flex gap-2 mt-2"},h.createElement("button",{onClick:()=>D(P.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md"},"+ Atributo"),h.createElement("button",{onClick:()=>D(P.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md"},"+ Dado/Nº")))))))),(u||[]).length===0&&h.createElement("p",{className:"text-textSecondary italic"},"Nenhum buff criado."),l&&h.createElement("div",{className:"flex justify-center mt-4"},h.createElement("button",{onClick:m,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg flex items-center justify-center"},"+"))))},LP=({character:t,onUpdate:e,isCollapsed:n,toggleSection:r,buffModifiers:i,onOpenRollModal:s})=>{const[o,l]=B.useState(t.attributes||[]);B.useEffect(()=>{l(t.attributes||[])},[t.attributes]);const u=()=>{const x={id:crypto.randomUUID(),name:"",base:0,perm:0,arma:0,isCollapsed:!1};e("attributes",[...t.attributes||[],x])},c=x=>{e("attributes",(t.attributes||[]).filter(N=>N.id!==x))},m=(x,N,C)=>{l(D=>D.map(I=>I.id===x?{...I,[N]:C}:I))},p=B.useCallback((x,N)=>{const C=o.find(I=>I.id===x),D=(t.attributes||[]).find(I=>I.id===x);if(C&&D&&C[N]!==D[N]){const I=(t.attributes||[]).map(w=>w.id===x?{...w,[N]:N==="name"?C[N]:parseInt(C[N],10)||0}:w);e("attributes",I)}},[o,t.attributes,e]),g=x=>{e("attributes",(t.attributes||[]).map(N=>N.id===x?{...N,isCollapsed:!N.isCollapsed}:N))};return h.createElement(At,{title:"Atributos",isCollapsed:n,toggleSection:r},h.createElement(h.Fragment,null,h.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},(o||[]).map(x=>{const N=i[x.name]||0,C=(parseInt(x.base,10)||0)+(parseInt(x.perm,10)||0)+N+(parseInt(x.arma,10)||0);return x.isCollapsed!==!1?h.createElement("div",{key:x.id,className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center"},h.createElement("span",{className:"font-semibold text-lg text-textPrimary flex-grow cursor-pointer truncate",onClick:()=>g(x.id)},x.name||"Atributo Sem Nome",h.createElement("span",{className:"ml-2 font-bold text-btnHighlightBg"},C>=0?"+":"",C)),h.createElement("button",{onClick:()=>s(x.id),className:"px-4 py-1 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-4 text-sm shadow-md"},"Rolar")):h.createElement("div",{key:x.id,className:"col-span-1 md:col-span-2 p-3 bg-bgElement rounded-md shadow-sm border border-bgInput relative flex flex-col gap-3"},h.createElement("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>g(x.id)},h.createElement("input",{type:"text",placeholder:"Nome do Atributo",value:x.name,onClick:I=>I.stopPropagation(),onChange:I=>m(x.id,"name",I.target.value),onBlur:()=>p(x.id,"name"),className:"w-full flex-grow p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold cursor-text"}),h.createElement("span",{className:"text-textSecondary text-xs whitespace-nowrap"},"Recolher ▲")),h.createElement("div",{className:"flex items-center gap-1 sm:gap-2 text-xs justify-end w-full",onClick:I=>I.stopPropagation()},["base","perm","arma"].map(I=>h.createElement("div",{key:I,className:"flex flex-col items-center"},h.createElement("span",{className:"text-textSecondary text-xs text-center capitalize"},I),h.createElement("input",{type:"number",value:x[I]||"",onChange:w=>m(x.id,I,w.target.value),onBlur:()=>p(x.id,I),className:"w-12 p-1 border rounded-md text-textPrimary text-center bg-bgInput border-bgElement"}))),h.createElement("div",{className:"flex flex-col items-center"},h.createElement("span",{className:"text-textSecondary text-xs text-center capitalize"},"temp"),h.createElement("input",{type:"number",value:N||"",className:"w-12 p-1 border rounded-md text-textPrimary text-center bg-bgPage border-bgElement cursor-not-allowed",readOnly:!0})),h.createElement("div",{className:"flex flex-col items-center"},h.createElement("span",{className:"text-textSecondary text-xs text-center"},"Total"),h.createElement("input",{type:"number",value:C||"",readOnly:!0,className:"w-12 p-1 bg-bgPage border border-bgElement rounded-md text-textPrimary font-bold cursor-not-allowed text-center"}))),h.createElement("div",{className:"flex justify-start pt-2 mt-2 border-t border-bgInput/50",onClick:I=>I.stopPropagation()},h.createElement("button",{onClick:()=>c(x.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-xs font-bold rounded-md"},"Remover")))})),h.createElement("div",{className:"flex justify-center mt-4"},h.createElement("button",{onClick:u,className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white text-2xl font-bold rounded-full shadow-lg flex items-center justify-center"},"+"))))},MP=({character:t,onBack:e,isMaster:n})=>{var P,R,V,v,y,T,A,_,k,b,q,W,X,Oe;const{character:r,loading:i,updateCharacterField:s,toggleSection:o}=uP(t.id,t.ownerUid),[l,u]=B.useState({type:null,props:{}}),c=()=>u({type:null,props:{}}),m=B.useMemo(()=>{if(!r)return[];const M=["Iniciativa","FA","FM","FD"],z=(r.attributes||[]).map($=>$.name).filter(Boolean);return[...M,...z]},[r]),p=B.useMemo(()=>{const M={attributes:{},dice:[]};return r!=null&&r.buffs&&r.buffs.forEach(z=>{z.isActive&&z.effects&&z.effects.forEach($=>{if($.type==="attribute"&&$.target){const Z=parseInt($.value,10)||0;M.attributes[$.target]=(M.attributes[$.target]||0)+Z}else $.type==="dice"&&$.value&&M.dice.push({name:z.name,value:$.value})})}),M},[r==null?void 0:r.buffs]),g=async(M,z,$=[],Z="",ee="")=>{if(!r)return;const J={author:{name:r.name||"Personagem",icon_url:r.photoUrl||""},title:M||"Sem Título",description:z||"Sem Descrição.",fields:$,color:8141549,footer:Z?{text:Z}:void 0};if(r.discordWebhookUrl)try{await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[J]})}),ee&&await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:ee})})}catch(fe){u({type:"info",props:{message:`Falha ao enviar para o Discord: ${fe.message}`,onConfirm:c}})}else{const fe=`**${M||"Sem Título"}**
${z||"Sem Descrição."}`;u({type:"info",props:{message:"Webhook do Discord não configurado. Copie e cole no Discord:",copyText:fe,showCopyButton:!0,onConfirm:c}})}},x=(M,z,$)=>{if(!(r!=null&&r.mainAttributes))return;let Z="";const ee=r.name||"Personagem",J=JSON.parse(JSON.stringify(r.mainAttributes));if($==="heal")switch(z){case"HP":J.hp.current=Math.min(J.hp.max,J.hp.current+M),Z=`${ee} recuperou ${M} de HP.`;break;case"HP Bonus":J.hp.temp=(J.hp.temp||0)+M,Z=`${ee} recebeu ${M} de HP Bonus.`;break;case"MP":J.mp.current=Math.min(J.mp.max,J.mp.current+M),Z=`${ee} recuperou ${M} de MP.`;break}else switch(z){case"HP":let fe=M;const Le=Math.min(fe,J.hp.temp||0);J.hp.temp-=Le,fe-=Le,fe>0&&(J.hp.current-=fe),Z=`${ee} perdeu ${M} de HP.`;break;case"MP":J.mp.current=Math.max(0,J.mp.current-M),Z=`${ee} perdeu ${M} de MP.`;break}s("mainAttributes",J),g($==="heal"?"❤️ Cura / Restauração":"💥 Dano Sofrido",Z),c()},N=M=>{u({type:"action",props:{type:M,title:M==="heal"?"Curar / Restaurar":"Receber Dano / Perder",onConfirm:(z,$)=>x(z,$,M),onClose:c}})},C=M=>{const z=(r.attributes||[]).find($=>$.id===M);z&&u({type:"rollAttribute",props:{attributeName:z.name,onConfirm:($,Z)=>D($,Z,z),onClose:c}})},D=(M,z,$)=>{if(!$)return;const Z=p.attributes[$.name]||0,ee=($.base||0)+($.perm||0)+Z+($.arma||0);let J=0,fe="";const Le=M.match(/(\d+)d(\d+)/i);if(Le){const us=parseInt(Le[1],10),cs=parseInt(Le[2],10);let an=[];for(let ln=0;ln<us;ln++){const Wt=Math.floor(Math.random()*cs)+1;an.push(Wt),J+=Wt}fe=`${M}(${an.join("+")})`}else J=parseInt(M,10)||0,fe=`${J}`;const nt=J+ee+z,Be=[fe,`${$.name}(${ee})`];z!==0&&Be.push(`Bónus(${z>0?"+":""}${z})`),g(`Rolagem de ${$.name}`,`**Resultado Final: ${nt}**`,[{name:"Detalhes",value:Be.join(" + "),inline:!1}]),c()},I=async M=>{if(!M)return;let z=0,$=[],Z=[];const ee=M.multiplier||1;for(let se=0;se<ee;se++)for(const ve of M.components||[])if(ve.type==="attribute"){const Re=ve.value;let Ne=0;if(["Iniciativa","FA","FM","FD"].includes(Re))Ne=(r.mainAttributes[Re.toLowerCase()]||0)+(p.attributes[Re]||0);else{const rt=(r.attributes||[]).find(Pt=>Pt.name===Re);rt&&(Ne=(rt.base||0)+(rt.perm||0)+(rt.arma||0)+(p.attributes[Re]||0))}z+=Ne,$.push(`${Re}(${Ne})`)}else if(ve.type==="critDice"){const Re=String(ve.value||"").match(/(\d+)d(\d+)/i);if(Re){const Ne=parseInt(Re[1],10),rt=parseInt(Re[2],10);let Pt=[],qt=0;for(let _n=0;_n<Ne;_n++){const Hn=Math.floor(Math.random()*rt)+1;if(Pt.push(Hn),qt+=Hn,Hn>=(ve.critValue||rt)){let ai=0;const be=ve.critBonusAttribute;if(["Iniciativa","FA","FM","FD"].includes(be))ai=(r.mainAttributes[be.toLowerCase()]||0)+(p.attributes[be]||0);else{const En=(r.attributes||[]).find(Qo=>Qo.name===be);En&&(ai=(En.base||0)+(En.perm||0)+(En.arma||0)+(p.attributes[be]||0))}const He=ai*(ve.critBonusMultiplier||1);qt+=He,Z.push(`Crítico no ${Hn}! Adiciona ${be} (${He})`)}}z+=qt,$.push(`${ve.value}(${Pt.join("+")})`)}else{const Ne=parseInt(ve.value,10)||0;z+=Ne,$.push(`${Ne}`)}}else{const Re=String(ve.value||"").match(/(\d+)d(\d+)/i);if(Re){const Ne=parseInt(Re[1],10),rt=parseInt(Re[2],10);let Pt=[];for(let qt=0;qt<Ne;qt++){const _n=Math.floor(Math.random()*rt)+1;Pt.push(_n),z+=_n}$.push(`${ve.value}(${Pt.join("+")})`)}else{const Ne=parseInt(ve.value,10)||0;z+=Ne,ve.label?$.push(`${ve.label}(${Ne>=0?"+":""}${Ne})`):$.push(`${Ne}`)}}p.dice.forEach(se=>{const ve=(se.value||"").match(/(\d+)d(\d+)/i);if(ve){const Re=parseInt(ve[1],10),Ne=parseInt(ve[2],10);let rt=[];for(let Pt=0;Pt<Re;Pt++){const qt=Math.floor(Math.random()*Ne)+1;rt.push(qt),z+=qt}$.push(`${se.name}(${rt.join("+")})`)}else{const Re=parseInt(se.value,10)||0;z+=Re,$.push(`${se.name}(${Re})`)}});const J={HP:0,MP:0};let fe=[];const Le=(r.buffs||[]).filter(se=>se.isActive),nt=M.costType&&M.costIsRollResult?-z:parseInt(M.costValue,10)||0;M.costType&&nt!==0&&(J[M.costType]+=nt,fe.push(`Ação: ${nt>=0?"+":""}${nt} ${M.costType}`));const Be={HP:0,MP:0};M.recoverHP&&(Be.HP=z,fe.push(`Recupera: ${z} HP`)),M.recoverMP&&(Be.MP=z,fe.push(`Recupera: ${z} MP`)),Le.forEach(se=>{if(se.costType&&se.costValue!==void 0){const ve=parseInt(se.costValue,10)||0;ve!==0&&(J[se.costType]+=ve,fe.push(`${se.name}: ${ve>=0?"+":""}${ve} ${se.costType}`))}});const us=Math.abs(Math.min(0,J.HP)),cs=Math.abs(Math.min(0,J.MP));if(r.mainAttributes.hp.current<us||r.mainAttributes.mp.current<cs){u({type:"info",props:{message:"Custo de HP/MP insuficiente!",onConfirm:c}});return}const an=/(https?:\/\/[^\s]+)/i;let ln="",Wt=M.discordText||"";const oi=Wt.match(an);if(oi&&(ln=oi[0],Wt=Wt.replace(an,"").trim()),J.HP!==0||J.MP!==0||Be.HP>0||Be.MP>0){const se={...r.mainAttributes};se.hp.current=se.hp.current-J.HP+Be.HP,se.mp.current=se.mp.current-J.MP+Be.MP,se.hp.current=Math.min(se.hp.current,se.hp.max),se.hp.current=Math.max(se.hp.current,0),se.mp.current=Math.min(se.mp.current,se.mp.max),se.mp.current=Math.max(se.mp.current,0),await s("mainAttributes",se)}const Cr=[{name:"Detalhes da Rolagem",value:$.join(" + ")||"N/A",inline:!1}];Z.length>0&&Cr.push({name:"Críticos",value:Z.join(`
`),inline:!1}),Le.length>0&&Cr.push({name:"Buffs Ativos",value:Le.map(se=>se.name).join(", "),inline:!1});const ds=fe.length>0?`Custo Total: ${fe.join(" | ")}`:"";g(M.name,`${Wt}

**Resultado Final: ${z}**`,Cr,ds,ln)},w=()=>{u({type:"confirm",props:{message:`Tem a certeza que deseja resetar PERMANENTEMENTE a ficha de "${r.name}"?`,onConfirm:async()=>{const M={photoUrl:"",age:"",height:"",gender:"",race:"",class:"",alignment:"",level:1,xp:0,mainAttributes:{hp:{current:10,max:10,temp:0},mp:{current:10,max:10},initiative:0,fa:0,fm:0,fd:0},attributes:[],inventory:[],wallet:{zeni:0,inspiration:0},advantages:[],disadvantages:[],abilities:[],specializations:[],equippedItems:[],history:[],notes:[],buffs:[],formulaActions:[],discordWebhookUrl:""};for(const[z,$]of Object.entries(M))await s(z,$);c()},onCancel:c}})},S=()=>{const{collapsedStates:M,...z}=r,$=JSON.stringify(z,null,2),Z=new Blob([$],{type:"application/json"}),ee=document.createElement("a");ee.href=URL.createObjectURL(Z),ee.download=`${r.name||"ficha"}.json`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(ee.href)};return i?h.createElement("div",{className:"text-center p-8"},h.createElement("p",{className:"text-xl text-textSecondary"},"A carregar ficha...")):r?h.createElement("div",{className:"w-full max-w-4xl mx-auto p-4"},h.createElement(Lf,{modalState:l,closeModal:c}),h.createElement(gP,{character:r}),h.createElement("button",{onClick:e,className:"mb-4 px-4 py-2 bg-bgSurface hover:opacity-80 text-textPrimary font-bold rounded-lg"},"        ← Voltar para a Lista"),h.createElement("div",{id:"info"},h.createElement(vP,{character:r,onUpdate:s,isMaster:n,isCollapsed:(P=r.collapsedStates)==null?void 0:P.info,toggleSection:()=>o("info")})),h.createElement("div",{id:"main-attributes"},h.createElement(_P,{character:r,onUpdate:s,isMaster:n,buffModifiers:p.attributes,isCollapsed:(R=r.collapsedStates)==null?void 0:R.main,toggleSection:()=>o("main")})),h.createElement("div",{id:"actions"},h.createElement(VP,{character:r,isMaster:n,isCollapsed:(V=r.collapsedStates)==null?void 0:V.actions,toggleSection:()=>o("actions"),onOpenActionModal:N,allAttributes:m,onUpdate:s,onExecuteFormula:I})),h.createElement("div",{id:"buffs"},h.createElement(OP,{character:r,isMaster:n,onUpdate:s,allAttributes:m,isCollapsed:(v=r.collapsedStates)==null?void 0:v.buffs,toggleSection:()=>o("buffs")})),h.createElement("div",{id:"attributes"},h.createElement(LP,{character:r,isMaster:n,onUpdate:s,buffModifiers:p.attributes,isCollapsed:(y=r.collapsedStates)==null?void 0:y.attributes,toggleSection:()=>o("attributes"),onOpenRollModal:C})),h.createElement("div",{id:"wallet"},h.createElement(EP,{character:r,isMaster:n,onUpdate:s,isCollapsed:(T=r.collapsedStates)==null?void 0:T.wallet,toggleSection:()=>o("wallet")})),h.createElement("div",{id:"inventory"},h.createElement(IP,{character:r,onUpdate:s,isMaster:n,onShowDiscord:g,isCollapsed:(A=r.collapsedStates)==null?void 0:A.inventory,toggleSection:()=>o("inventory")})),h.createElement("div",{id:"equipped"},h.createElement(TP,{character:r,onUpdate:s,isMaster:n,onShowDiscord:g,isCollapsed:(_=r.collapsedStates)==null?void 0:_.equipped,toggleSection:()=>o("equipped")})),h.createElement("div",{id:"perks"},h.createElement(xP,{character:r,onUpdate:s,onShowDiscord:g,isCollapsed:(k=r.collapsedStates)==null?void 0:k.perks,toggleSection:()=>o("perks")})),h.createElement("div",{id:"skills"},h.createElement(bP,{character:r,onUpdate:s,isMaster:n,onShowDiscord:g,isCollapsed:(b=r.collapsedStates)==null?void 0:b.skills,toggleSection:()=>o("skills")})),h.createElement("div",{id:"specializations"},h.createElement(CP,{character:r,onUpdate:s,isMaster:n,isCollapsed:(q=r.collapsedStates)==null?void 0:q.specializations,toggleSection:()=>o("specializations"),allAttributes:m,onExecuteFormula:I})),h.createElement("div",{id:"story"},h.createElement(PP,{character:r,onUpdate:s,isMaster:n,isCollapsed:(W=r.collapsedStates)==null?void 0:W.story,toggleSection:()=>o("story")})),h.createElement("div",{id:"notes"},h.createElement(kP,{character:r,onUpdate:s,isMaster:n,isCollapsed:(X=r.collapsedStates)==null?void 0:X.notes,toggleSection:()=>o("notes")})),h.createElement("div",{id:"discord"},h.createElement(wP,{character:r,onUpdate:s,isMaster:n,isCollapsed:(Oe=r.collapsedStates)==null?void 0:Oe.discord,toggleSection:()=>o("discord")})),h.createElement(yP,{character:r,onExport:S,onReset:w})):h.createElement("div",{className:"text-center p-8"},h.createElement("p",{className:"text-xl text-red-400"},"Erro: Personagem não encontrado."))},FP="1:727724875985:web:97411448885c68c289e5f0",wc=async t=>{if(!t)return[];try{const e=Hr(ht,"themes"),n=Ud(e,Z1("ownerUid","==",t)),r=await el(n),i=[];return r.forEach(s=>{i.push({id:s.id,...s.data()})}),i}catch(e){return console.error("Erro ao buscar temas:",e),[]}},UP=async t=>{if(!t)return null;try{const e=on(ht,"themes",t),n=await nP(e);return n.exists()?{id:n.id,...n.data()}:null}catch(e){return console.error("Erro ao buscar tema por ID:",e),null}},ny=async t=>{try{if(t.id){const e=on(ht,"themes",t.id);return await Go(e,t,{merge:!0}),t.id}else{const e=Hr(ht,"themes");return(await bw(e,t)).id}}catch(e){return console.error("Erro ao salvar tema:",e),null}},BP=async t=>{if(!t)return!1;try{const e=on(ht,"themes",t);return await Tw(e),!0}catch(e){return console.error("Erro ao deletar tema:",e),!1}},jP=async(t,e,n)=>{if(!(!t||!e))try{const r=on(ht,`artifacts2/${FP}/users/${t}/characterSheets/${e}`);await Go(r,{activeThemeId:n},{merge:!0})}catch(r){console.error("Erro ao aplicar tema ao personagem:",r)}},Ic={name:"Novo Tema",ownerUid:"",isPublic:!1,styles:{backgroundImage:"url('')",fontFamily:"'Roboto', sans-serif",surfaceOpacity:80,colors:{bgPage:"#111827",bgSurface:"#1f2937",bgElement:"#374151",bgInput:"#4b5563",textPrimary:"#f9fafb",textSecondary:"#9ca3af",borderAccent:"#f59e0b",textAccent:"#fcd34d",btnHighlightBg:"#8b5cf6",btnHighlightText:"#ffffff"}}},zP=["'Roboto', sans-serif","'Merriweather', serif","'Lato', sans-serif","'Noto Sans', sans-serif","'Slabo 27px', serif"],ry=({character:t,setPreviewTheme:e,onClose:n})=>{const{user:r}=pt(),[i,s]=B.useState([]),[o,l]=B.useState(Ic),[u,c]=B.useState({type:null,props:{}}),m=()=>c({type:null,props:{}});B.useEffect(()=>{r&&(wc(r.uid).then(s),l(w=>({...Ic,ownerUid:r.uid})))},[r]),B.useEffect(()=>{e(o)},[o,e]);const p=w=>{if(w==="new")l({...Ic,ownerUid:r.uid});else{const S=i.find(P=>P.id===w);S&&l(S)}},g=(w,S)=>l(P=>({...P,styles:{...P.styles,[w]:S}})),x=(w,S)=>l(P=>({...P,styles:{...P.styles,colors:{...P.styles.colors,[w]:S}}})),N=w=>l(S=>({...S,name:w.target.value})),C=async()=>{const w={...o,ownerUid:r.uid};try{const S=await ny(w);if(S){c({type:"info",props:{message:"Tema salvo com sucesso!",onConfirm:m}});const P=await wc(r.uid);s(P);const R=P.find(V=>V.id===(w.id||S));R&&l(R)}else throw new Error("Ocorreu um erro desconhecido ao salvar.")}catch(S){console.error("Falha ao salvar o tema:",S),c({type:"info",props:{message:"Falha ao salvar o tema.",onConfirm:m}})}},D=()=>{if(!o.id){c({type:"info",props:{message:"Não pode apagar um tema que ainda não foi salvo.",onConfirm:m}});return}c({type:"confirm",props:{message:`Tem a certeza que quer apagar o tema "${o.name}"?`,onConfirm:async()=>{await BP(o.id),m(),wc(r.uid).then(s),p("new")},onCancel:m}})},I=async()=>{if(!t||!o.id){c({type:"info",props:{message:"Precisa ter uma ficha selecionada e um tema salvo para aplicar.",onConfirm:m}});return}await ny(o),await jP(t.ownerUid,t.id,o.id),c({type:"info",props:{message:`Tema "${o.name}" aplicado!`,onConfirm:()=>{m(),n()}}})};return h.createElement(h.Fragment,null,h.createElement(Lf,{modalState:u,closeModal:m}),h.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},h.createElement("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-3xl border border-bgElement max-h-[90vh] flex flex-col"},h.createElement("h2",{className:"text-2xl font-bold text-textAccent mb-4"},"Editor de Temas"),h.createElement("div",{className:"flex-grow overflow-y-auto pr-2"},h.createElement("div",{className:"mb-4"},h.createElement("label",{className:"block text-sm font-medium text-textSecondary mb-1"},"Tema a Editar"),h.createElement("select",{onChange:w=>p(w.target.value),value:o.id||"new",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"},h.createElement("option",{value:"new"},"-- Criar Novo Tema --"),i.map(w=>h.createElement("option",{key:w.id,value:w.id},w.name)))),h.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},h.createElement("div",null,h.createElement("label",{className:"block text-sm font-medium text-textSecondary mb-1"},"Nome do Tema"),h.createElement("input",{type:"text",value:o.name,onChange:N,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})),h.createElement("div",null,h.createElement("label",{className:"block text-sm font-medium text-textSecondary mb-1"},"URL da Imagem de Fundo"),h.createElement("input",{type:"text",value:o.styles.backgroundImage.replace(/url\(['"]?(.*?)['"]?\)/,"$1"),onChange:w=>g("backgroundImage",`url('${w.target.value}')`),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})),h.createElement("div",null,h.createElement("label",{className:"block text-sm font-medium text-textSecondary mb-1"},"Fonte Principal"),h.createElement("select",{value:o.styles.fontFamily,onChange:w=>g("fontFamily",w.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"},zP.map(w=>h.createElement("option",{key:w,value:w},w.split(",")[0].replace(/'/g,""))))),h.createElement("div",null,h.createElement("label",{className:"block text-sm font-medium text-textSecondary mb-1"},"Transparência dos Módulos (",o.styles.surfaceOpacity||80,"%)"),h.createElement("input",{type:"range",min:"10",max:"100",step:"5",value:o.styles.surfaceOpacity||80,onChange:w=>g("surfaceOpacity",parseInt(w.target.value)),className:"w-full h-2 bg-bgElement rounded-lg appearance-none cursor-pointer mt-2"}))),h.createElement("h3",{className:"text-lg font-semibold text-textAccent mt-6 mb-2"},"Cores"),h.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Object.entries(o.styles.colors).map(([w,S])=>h.createElement("div",{key:w},h.createElement("label",{className:"block text-sm font-medium text-textSecondary capitalize"},w.replace(/([A-Z])/g," $1")),h.createElement("div",{className:"flex items-center gap-2 p-1 bg-bgInput border border-bgElement rounded-md"},h.createElement("input",{type:"color",value:S,onChange:P=>x(w,P.target.value),className:"w-8 h-8 rounded border-none bg-transparent cursor-pointer"}),h.createElement("input",{type:"text",value:S,onChange:P=>x(w,P.target.value),className:"w-full bg-transparent text-textPrimary text-sm"})))))),h.createElement("div",{className:"flex flex-wrap justify-between items-center mt-6 pt-4 border-t border-bgElement"},h.createElement("div",null,h.createElement("button",{onClick:C,className:"px-4 py-2 bg-green-600 text-white font-bold rounded-lg mr-2"},"Salvar"),h.createElement("button",{onClick:D,className:"px-4 py-2 bg-red-600 text-white font-bold rounded-lg"},"Apagar")),h.createElement("div",{className:"flex items-center gap-4"},h.createElement("button",{onClick:I,disabled:!t||!o.id,className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg disabled:opacity-50"},"Aplicar"),h.createElement("button",{onClick:n,className:"px-4 py-2 bg-textSecondary/50 text-textPrimary font-bold rounded-lg"},"Fechar"))))))},no="1:727724875985:web:97411448885c68c289e5f0",$P=async(t,e=!1)=>{if(!t)return[];try{let n=[];if(e){const r=Hr(ht,`artifacts2/${no}/users`),i=await el(r);for(const s of i.docs){const o=Hr(ht,`artifacts2/${no}/users/${s.id}/characterSheets`),l=Ud(o);(await el(l)).forEach(c=>{n.push({id:c.id,ownerUid:s.id,...c.data()})})}}else{const r=Hr(ht,`artifacts2/${no}/users/${t}/characterSheets`),i=Ud(r);(await el(i)).forEach(o=>{n.push({id:o.id,...o.data()})})}return n}catch(n){return console.error("Erro ao buscar personagens:",n),[]}},HP=async t=>{if(!t)return null;const e=prompt("Qual o nome do novo personagem?");if(!e)return null;try{const n=Hr(ht,`artifacts2/${no}/users/${t}/characterSheets`),r={name:e,ownerUid:t,createdAt:rP(),level:1};return{id:(await bw(n,r)).id,...r}}catch(n){return console.error("Erro ao criar novo personagem:",n),null}},WP=async(t,e)=>{if(!t||!e)return!1;try{const n=on(ht,`artifacts2/${no}/users/${t}/characterSheets/${e}`);return await Tw(n),console.log("Ficha deletada com sucesso!"),!0}catch(n){return console.error("Erro ao deletar personagem:",n),!1}},iy="1:727724875985:web:97411448885c68c289e5f0",qP=({activeTheme:t,setActiveTheme:e,setPreviewTheme:n})=>{const{user:r,googleSignOut:i,isMaster:s}=pt(),[o,l]=B.useState(null),[u,c]=B.useState([]),m=B.useRef(null),[p,g]=B.useState(!1),[x,N]=B.useState(!1),[C,D]=B.useState({type:null,props:{}}),I=()=>D({type:null,props:{}});B.useEffect(()=>{if(o!=null&&o.id&&(o!=null&&o.ownerUid)){const y=on(ht,`artifacts2/${iy}/users/${o.ownerUid}/characterSheets/${o.id}`),T=Vf(y,async A=>{if(A.exists()){const _=A.data();if(_.activeThemeId){const k=await UP(_.activeThemeId);e(k)}else e(null)}});return()=>T()}else e(null)},[o,e]);const w=()=>{N(!1),n(null)},S=async()=>{if(r){const y=await $P(r.uid,s&&p);c(y)}};B.useEffect(()=>{S()},[r,p,s]);const P=async()=>{await HP(r.uid)&&S()},R=()=>{m.current.click()},V=y=>{const T=y.target.files[0];if(!T)return;const A=new FileReader;A.onload=_=>{try{const k=JSON.parse(_.target.result);if(!k.name)throw new Error("Ficheiro JSON inválido ou incompatível.");D({type:"confirm",props:{message:`Deseja criar um novo personagem com os dados de "${k.name}"?`,onConfirm:async()=>{const b=on(Hr(ht,`artifacts2/${iy}/users/${r.uid}/characterSheets`)),q={...k,ownerUid:r.uid};delete q.id,await Go(b,q),S(),I()},onCancel:I}})}catch(k){D({type:"info",props:{message:`Erro ao ler arquivo: ${k.message}`,onConfirm:I}})}},A.readAsText(T),y.target.value=null},v=y=>{const T=y.ownerUid||r.uid;D({type:"confirm",props:{message:`Tem a certeza que deseja excluir permanentemente a ficha de "${y.name}"?`,onConfirm:async()=>{await WP(T,y.id)?c(_=>_.filter(k=>k.id!==y.id)):alert("Não foi possível excluir a ficha."),I()},onCancel:I}})};return o?h.createElement(h.Fragment,null,x&&h.createElement(ry,{character:o,originalTheme:t,setPreviewTheme:n,onClose:w}),h.createElement("button",{onClick:()=>N(!0),className:"fixed top-4 right-4 z-[60] px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg shadow-lg"},"Editor de Temas"),h.createElement(MP,{character:o,onBack:()=>l(null),isMaster:s})):h.createElement("div",{className:"w-full max-w-5xl mx-auto p-4 md:p-8"},h.createElement(Lf,{modalState:C,closeModal:I}),h.createElement("input",{type:"file",ref:m,onChange:V,accept:".json",className:"hidden"}),x&&h.createElement(ry,{originalTheme:t,setPreviewTheme:n,onClose:w}),h.createElement("header",{className:"flex justify-between items-center mb-8"},h.createElement("div",null,h.createElement("h1",{className:"text-2xl font-bold text-textPrimary"},"Seu Painel"),h.createElement("p",{className:"text-textSecondary"},"Bem-vindo, ",r.displayName,"!")),h.createElement("div",{className:"flex items-center gap-4"},h.createElement("button",{onClick:()=>N(!0),className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-semibold rounded-lg"},"Editor de Temas"),h.createElement("button",{onClick:i,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg"},"Sair"))),h.createElement("main",null,h.createElement(lP,{user:r,onSelectCharacter:l,handleImportClick:R,handleDeleteClick:v,handleCreateClick:P,characters:u,isMaster:s,viewingAll:p,onToggleView:g})))};function KP(t){if(!t)return"55, 65, 81";const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?`${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)}`:"55, 65, 81"}const GP=t=>{const e=document.documentElement;t?(e.style.setProperty("--background-image",t.backgroundImage||"none"),e.style.setProperty("--font-family",t.fontFamily||"ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb",KP(t.colors.bgSurface)),e.style.setProperty("--surface-opacity",(t.surfaceOpacity||80)/100),e.style.setProperty("--color-bgPage",t.colors.bgPage),e.style.setProperty("--color-bgElement",t.colors.bgElement),e.style.setProperty("--color-bgInput",t.colors.bgInput),e.style.setProperty("--color-textPrimary",t.colors.textPrimary),e.style.setProperty("--color-textSecondary",t.colors.textSecondary),e.style.setProperty("--color-borderAccent",t.colors.borderAccent),e.style.setProperty("--color-textAccent",t.colors.textAccent),e.style.setProperty("--color-btnHighlightBg",t.colors.btnHighlightBg),e.style.setProperty("--color-btnHighlightText",t.colors.btnHighlightText)):(e.style.setProperty("--background-image","none"),e.style.setProperty("--font-family","ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb","55, 65, 81"),e.style.setProperty("--surface-opacity","0.8"),e.style.setProperty("--color-bgPage","#111827"),e.style.setProperty("--color-bgElement","#374151"),e.style.setProperty("--color-bgInput","#4b5563"),e.style.setProperty("--color-textPrimary","#f9fafb"),e.style.setProperty("--color-textSecondary","#9ca3af"),e.style.setProperty("--color-borderAccent","#f59e0b"),e.style.setProperty("--color-textAccent","#fcd34d"),e.style.setProperty("--color-btnHighlightBg","#8b5cf6"),e.style.setProperty("--color-btnHighlightText","#ffffff"))};function QP(){const{user:t,loading:e}=pt(),[n,r]=B.useState(null),[i,s]=B.useState(null);return B.useEffect(()=>{const o=i||n;GP(o?o.styles:null)},[n,i]),e?h.createElement("div",{className:"bg-bgPage text-textPrimary min-h-screen flex items-center justify-center"},h.createElement("h1",{className:"text-3xl"},"A carregar StoryCraft...")):h.createElement("div",{className:"bg-bgPage bg-theme bg-cover bg-center bg-fixed text-textPrimary min-h-screen"},t?h.createElement(qP,{activeTheme:n,setActiveTheme:r,setPreviewTheme:s}):h.createElement(aP,null))}Tc.createRoot(document.getElementById("root")).render(h.createElement(h.StrictMode,null,h.createElement(oP,null,h.createElement(QP,null))));
