(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function iv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function SE(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var ov={exports:{}},Cu={},av={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var la=Symbol.for("react.element"),TE=Symbol.for("react.portal"),IE=Symbol.for("react.fragment"),CE=Symbol.for("react.strict_mode"),AE=Symbol.for("react.profiler"),PE=Symbol.for("react.provider"),RE=Symbol.for("react.context"),NE=Symbol.for("react.forward_ref"),kE=Symbol.for("react.suspense"),DE=Symbol.for("react.memo"),jE=Symbol.for("react.lazy"),Tm=Symbol.iterator;function OE(t){return t===null||typeof t!="object"?null:(t=Tm&&t[Tm]||t["@@iterator"],typeof t=="function"?t:null)}var lv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uv=Object.assign,cv={};function Ci(t,e,n){this.props=t,this.context=e,this.refs=cv,this.updater=n||lv}Ci.prototype.isReactComponent={};Ci.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ci.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dv(){}dv.prototype=Ci.prototype;function Lh(t,e,n){this.props=t,this.context=e,this.refs=cv,this.updater=n||lv}var Fh=Lh.prototype=new dv;Fh.constructor=Lh;uv(Fh,Ci.prototype);Fh.isPureReactComponent=!0;var Im=Array.isArray,hv=Object.prototype.hasOwnProperty,Uh={current:null},fv={key:!0,ref:!0,__self:!0,__source:!0};function pv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)hv.call(e,r)&&!fv.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:la,type:t,key:i,ref:o,props:s,_owner:Uh.current}}function VE(t,e){return{$$typeof:la,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function zh(t){return typeof t=="object"&&t!==null&&t.$$typeof===la}function ME(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Cm=/\/+/g;function Pc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ME(""+t.key):e.toString(36)}function yl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case la:case TE:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Pc(o,0):r,Im(s)?(n="",t!=null&&(n=t.replace(Cm,"$&/")+"/"),yl(s,e,n,"",function(d){return d})):s!=null&&(zh(s)&&(s=VE(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Cm,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Im(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Pc(i,l);o+=yl(i,e,n,u,s)}else if(u=OE(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Pc(i,l++),o+=yl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ha(t,e,n){if(t==null)return t;var r=[],s=0;return yl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function LE(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ot={current:null},vl={transition:null},FE={ReactCurrentDispatcher:Ot,ReactCurrentBatchConfig:vl,ReactCurrentOwner:Uh};function mv(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:Ha,forEach:function(t,e,n){Ha(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ha(t,function(){e++}),e},toArray:function(t){return Ha(t,function(e){return e})||[]},only:function(t){if(!zh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};le.Component=Ci;le.Fragment=IE;le.Profiler=AE;le.PureComponent=Lh;le.StrictMode=CE;le.Suspense=kE;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FE;le.act=mv;le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=uv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Uh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)hv.call(e,u)&&!fv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:la,type:t.type,key:s,ref:i,props:r,_owner:o}};le.createContext=function(t){return t={$$typeof:RE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:PE,_context:t},t.Consumer=t};le.createElement=pv;le.createFactory=function(t){var e=pv.bind(null,t);return e.type=t,e};le.createRef=function(){return{current:null}};le.forwardRef=function(t){return{$$typeof:NE,render:t}};le.isValidElement=zh;le.lazy=function(t){return{$$typeof:jE,_payload:{_status:-1,_result:t},_init:LE}};le.memo=function(t,e){return{$$typeof:DE,type:t,compare:e===void 0?null:e}};le.startTransition=function(t){var e=vl.transition;vl.transition={};try{t()}finally{vl.transition=e}};le.unstable_act=mv;le.useCallback=function(t,e){return Ot.current.useCallback(t,e)};le.useContext=function(t){return Ot.current.useContext(t)};le.useDebugValue=function(){};le.useDeferredValue=function(t){return Ot.current.useDeferredValue(t)};le.useEffect=function(t,e){return Ot.current.useEffect(t,e)};le.useId=function(){return Ot.current.useId()};le.useImperativeHandle=function(t,e,n){return Ot.current.useImperativeHandle(t,e,n)};le.useInsertionEffect=function(t,e){return Ot.current.useInsertionEffect(t,e)};le.useLayoutEffect=function(t,e){return Ot.current.useLayoutEffect(t,e)};le.useMemo=function(t,e){return Ot.current.useMemo(t,e)};le.useReducer=function(t,e,n){return Ot.current.useReducer(t,e,n)};le.useRef=function(t){return Ot.current.useRef(t)};le.useState=function(t){return Ot.current.useState(t)};le.useSyncExternalStore=function(t,e,n){return Ot.current.useSyncExternalStore(t,e,n)};le.useTransition=function(){return Ot.current.useTransition()};le.version="18.3.1";av.exports=le;var V=av.exports;const gv=iv(V);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UE=V,zE=Symbol.for("react.element"),BE=Symbol.for("react.fragment"),$E=Object.prototype.hasOwnProperty,HE=UE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WE={key:!0,ref:!0,__self:!0,__source:!0};function yv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)$E.call(e,r)&&!WE.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:zE,type:t,key:i,ref:o,props:s,_owner:HE.current}}Cu.Fragment=BE;Cu.jsx=yv;Cu.jsxs=yv;ov.exports=Cu;var c=ov.exports,_d={},vv={exports:{}},Zt={},_v={exports:{}},xv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,K){var Q=z.length;z.push(K);e:for(;0<Q;){var Ee=Q-1>>>1,ve=z[Ee];if(0<s(ve,K))z[Ee]=K,z[Q]=ve,Q=Ee;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var K=z[0],Q=z.pop();if(Q!==K){z[0]=Q;e:for(var Ee=0,ve=z.length,Pe=ve>>>1;Ee<Pe;){var $=2*(Ee+1)-1,X=z[$],oe=$+1,ce=z[oe];if(0>s(X,Q))oe<ve&&0>s(ce,X)?(z[Ee]=ce,z[oe]=Q,Ee=oe):(z[Ee]=X,z[$]=Q,Ee=$);else if(oe<ve&&0>s(ce,Q))z[Ee]=ce,z[oe]=Q,Ee=oe;else break e}}return K}function s(z,K){var Q=z.sortIndex-K.sortIndex;return Q!==0?Q:z.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,g=null,y=3,C=!1,N=!1,E=!1,D=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(z){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=z)r(d),K.sortIndex=K.expirationTime,e(u,K);else break;K=n(d)}}function S(z){if(E=!1,v(z),!N)if(n(u)!==null)N=!0,ae(P);else{var K=n(d);K!==null&&re(S,K.startTime-z)}}function P(z,K){N=!1,E&&(E=!1,b(p),p=-1),C=!0;var Q=y;try{for(v(K),g=n(u);g!==null&&(!(g.expirationTime>K)||z&&!k());){var Ee=g.callback;if(typeof Ee=="function"){g.callback=null,y=g.priorityLevel;var ve=Ee(g.expirationTime<=K);K=t.unstable_now(),typeof ve=="function"?g.callback=ve:g===n(u)&&r(u),v(K)}else r(u);g=n(u)}if(g!==null)var Pe=!0;else{var $=n(d);$!==null&&re(S,$.startTime-K),Pe=!1}return Pe}finally{g=null,y=Q,C=!1}}var A=!1,_=null,p=-1,w=5,I=-1;function k(){return!(t.unstable_now()-I<w)}function j(){if(_!==null){var z=t.unstable_now();I=z;var K=!0;try{K=_(!0,z)}finally{K?R():(A=!1,_=null)}}else A=!1}var R;if(typeof x=="function")R=function(){x(j)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,ne=q.port2;q.port1.onmessage=j,R=function(){ne.postMessage(null)}}else R=function(){D(j,0)};function ae(z){_=z,A||(A=!0,R())}function re(z,K){p=D(function(){z(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){N||C||(N=!0,ae(P))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(z){switch(y){case 1:case 2:case 3:var K=3;break;default:K=y}var Q=y;y=K;try{return z()}finally{y=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,K){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Q=y;y=z;try{return K()}finally{y=Q}},t.unstable_scheduleCallback=function(z,K,Q){var Ee=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?Ee+Q:Ee):Q=Ee,z){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=Q+ve,z={id:h++,callback:K,priorityLevel:z,startTime:Q,expirationTime:ve,sortIndex:-1},Q>Ee?(z.sortIndex=Q,e(d,z),n(u)===null&&z===n(d)&&(E?(b(p),p=-1):E=!0,re(S,Q-Ee))):(z.sortIndex=ve,e(u,z),N||C||(N=!0,ae(P))),z},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(z){var K=y;return function(){var Q=y;y=K;try{return z.apply(this,arguments)}finally{y=Q}}}})(xv);_v.exports=xv;var qE=_v.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GE=V,Jt=qE;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wv=new Set,Oo={};function bs(t,e){di(t,e),di(t+"Capture",e)}function di(t,e){for(Oo[t]=e,t=0;t<e.length;t++)wv.add(e[t])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xd=Object.prototype.hasOwnProperty,KE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Am={},Pm={};function QE(t){return xd.call(Pm,t)?!0:xd.call(Am,t)?!1:KE.test(t)?Pm[t]=!0:(Am[t]=!0,!1)}function YE(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function XE(t,e,n,r){if(e===null||typeof e>"u"||YE(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Vt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var pt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){pt[t]=new Vt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];pt[e]=new Vt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){pt[t]=new Vt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){pt[t]=new Vt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){pt[t]=new Vt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){pt[t]=new Vt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){pt[t]=new Vt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){pt[t]=new Vt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){pt[t]=new Vt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Bh=/[\-:]([a-z])/g;function $h(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Bh,$h);pt[e]=new Vt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Bh,$h);pt[e]=new Vt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Bh,$h);pt[e]=new Vt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){pt[t]=new Vt(t,1,!1,t.toLowerCase(),null,!1,!1)});pt.xlinkHref=new Vt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){pt[t]=new Vt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Hh(t,e,n,r){var s=pt.hasOwnProperty(e)?pt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(XE(e,n,s,r)&&(n=null),r||s===null?QE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ur=GE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wa=Symbol.for("react.element"),Us=Symbol.for("react.portal"),zs=Symbol.for("react.fragment"),Wh=Symbol.for("react.strict_mode"),wd=Symbol.for("react.profiler"),Ev=Symbol.for("react.provider"),bv=Symbol.for("react.context"),qh=Symbol.for("react.forward_ref"),Ed=Symbol.for("react.suspense"),bd=Symbol.for("react.suspense_list"),Gh=Symbol.for("react.memo"),_r=Symbol.for("react.lazy"),Sv=Symbol.for("react.offscreen"),Rm=Symbol.iterator;function Ji(t){return t===null||typeof t!="object"?null:(t=Rm&&t[Rm]||t["@@iterator"],typeof t=="function"?t:null)}var De=Object.assign,Rc;function ho(t){if(Rc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Rc=e&&e[1]||""}return`
`+Rc+t}var Nc=!1;function kc(t,e){if(!t||Nc)return"";Nc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Nc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ho(t):""}function JE(t){switch(t.tag){case 5:return ho(t.type);case 16:return ho("Lazy");case 13:return ho("Suspense");case 19:return ho("SuspenseList");case 0:case 2:case 15:return t=kc(t.type,!1),t;case 11:return t=kc(t.type.render,!1),t;case 1:return t=kc(t.type,!0),t;default:return""}}function Sd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zs:return"Fragment";case Us:return"Portal";case wd:return"Profiler";case Wh:return"StrictMode";case Ed:return"Suspense";case bd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case bv:return(t.displayName||"Context")+".Consumer";case Ev:return(t._context.displayName||"Context")+".Provider";case qh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Gh:return e=t.displayName||null,e!==null?e:Sd(t.type)||"Memo";case _r:e=t._payload,t=t._init;try{return Sd(t(e))}catch{}}return null}function ZE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sd(e);case 8:return e===Wh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Tv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function eb(t){var e=Tv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function qa(t){t._valueTracker||(t._valueTracker=eb(t))}function Iv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Tv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Fl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Td(t,e){var n=e.checked;return De({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Nm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=zr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Cv(t,e){e=e.checked,e!=null&&Hh(t,"checked",e,!1)}function Id(t,e){Cv(t,e);var n=zr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Cd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Cd(t,e.type,zr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function km(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Cd(t,e,n){(e!=="number"||Fl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var fo=Array.isArray;function ei(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+zr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ad(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return De({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Dm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(fo(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:zr(n)}}function Av(t,e){var n=zr(e.value),r=zr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function jm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Pv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Pv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ga,Rv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ga=Ga||document.createElement("div"),Ga.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ga.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Vo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var xo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tb=["Webkit","ms","Moz","O"];Object.keys(xo).forEach(function(t){tb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),xo[e]=xo[t]})});function Nv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||xo.hasOwnProperty(t)&&xo[t]?(""+e).trim():e+"px"}function kv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Nv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var nb=De({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rd(t,e){if(e){if(nb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Nd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kd=null;function Kh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dd=null,ti=null,ni=null;function Om(t){if(t=da(t)){if(typeof Dd!="function")throw Error(U(280));var e=t.stateNode;e&&(e=ku(e),Dd(t.stateNode,t.type,e))}}function Dv(t){ti?ni?ni.push(t):ni=[t]:ti=t}function jv(){if(ti){var t=ti,e=ni;if(ni=ti=null,Om(t),e)for(t=0;t<e.length;t++)Om(e[t])}}function Ov(t,e){return t(e)}function Vv(){}var Dc=!1;function Mv(t,e,n){if(Dc)return t(e,n);Dc=!0;try{return Ov(t,e,n)}finally{Dc=!1,(ti!==null||ni!==null)&&(Vv(),jv())}}function Mo(t,e){var n=t.stateNode;if(n===null)return null;var r=ku(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var jd=!1;if(tr)try{var Zi={};Object.defineProperty(Zi,"passive",{get:function(){jd=!0}}),window.addEventListener("test",Zi,Zi),window.removeEventListener("test",Zi,Zi)}catch{jd=!1}function rb(t,e,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var wo=!1,Ul=null,zl=!1,Od=null,sb={onError:function(t){wo=!0,Ul=t}};function ib(t,e,n,r,s,i,o,l,u){wo=!1,Ul=null,rb.apply(sb,arguments)}function ob(t,e,n,r,s,i,o,l,u){if(ib.apply(this,arguments),wo){if(wo){var d=Ul;wo=!1,Ul=null}else throw Error(U(198));zl||(zl=!0,Od=d)}}function Ss(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Lv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vm(t){if(Ss(t)!==t)throw Error(U(188))}function ab(t){var e=t.alternate;if(!e){if(e=Ss(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Vm(s),t;if(i===r)return Vm(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function Fv(t){return t=ab(t),t!==null?Uv(t):null}function Uv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Uv(t);if(e!==null)return e;t=t.sibling}return null}var zv=Jt.unstable_scheduleCallback,Mm=Jt.unstable_cancelCallback,lb=Jt.unstable_shouldYield,ub=Jt.unstable_requestPaint,Ue=Jt.unstable_now,cb=Jt.unstable_getCurrentPriorityLevel,Qh=Jt.unstable_ImmediatePriority,Bv=Jt.unstable_UserBlockingPriority,Bl=Jt.unstable_NormalPriority,db=Jt.unstable_LowPriority,$v=Jt.unstable_IdlePriority,Au=null,kn=null;function hb(t){if(kn&&typeof kn.onCommitFiberRoot=="function")try{kn.onCommitFiberRoot(Au,t,void 0,(t.current.flags&128)===128)}catch{}}var xn=Math.clz32?Math.clz32:mb,fb=Math.log,pb=Math.LN2;function mb(t){return t>>>=0,t===0?32:31-(fb(t)/pb|0)|0}var Ka=64,Qa=4194304;function po(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function $l(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=po(l):(i&=o,i!==0&&(r=po(i)))}else o=n&~s,o!==0?r=po(o):i!==0&&(r=po(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-xn(e),s=1<<n,r|=t[n],e&=~s;return r}function gb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yb(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-xn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=gb(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Vd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Hv(){var t=Ka;return Ka<<=1,!(Ka&4194240)&&(Ka=64),t}function jc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ua(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-xn(e),t[e]=n}function vb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-xn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Yh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-xn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var xe=0;function Wv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qv,Xh,Gv,Kv,Qv,Md=!1,Ya=[],Pr=null,Rr=null,Nr=null,Lo=new Map,Fo=new Map,wr=[],_b="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lm(t,e){switch(t){case"focusin":case"focusout":Pr=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":Nr=null;break;case"pointerover":case"pointerout":Lo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fo.delete(e.pointerId)}}function eo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=da(e),e!==null&&Xh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function xb(t,e,n,r,s){switch(e){case"focusin":return Pr=eo(Pr,t,e,n,r,s),!0;case"dragenter":return Rr=eo(Rr,t,e,n,r,s),!0;case"mouseover":return Nr=eo(Nr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Lo.set(i,eo(Lo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Fo.set(i,eo(Fo.get(i)||null,t,e,n,r,s)),!0}return!1}function Yv(t){var e=ss(t.target);if(e!==null){var n=Ss(e);if(n!==null){if(e=n.tag,e===13){if(e=Lv(n),e!==null){t.blockedOn=e,Qv(t.priority,function(){Gv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _l(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ld(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);kd=r,n.target.dispatchEvent(r),kd=null}else return e=da(n),e!==null&&Xh(e),t.blockedOn=n,!1;e.shift()}return!0}function Fm(t,e,n){_l(t)&&n.delete(e)}function wb(){Md=!1,Pr!==null&&_l(Pr)&&(Pr=null),Rr!==null&&_l(Rr)&&(Rr=null),Nr!==null&&_l(Nr)&&(Nr=null),Lo.forEach(Fm),Fo.forEach(Fm)}function to(t,e){t.blockedOn===e&&(t.blockedOn=null,Md||(Md=!0,Jt.unstable_scheduleCallback(Jt.unstable_NormalPriority,wb)))}function Uo(t){function e(s){return to(s,t)}if(0<Ya.length){to(Ya[0],t);for(var n=1;n<Ya.length;n++){var r=Ya[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Pr!==null&&to(Pr,t),Rr!==null&&to(Rr,t),Nr!==null&&to(Nr,t),Lo.forEach(e),Fo.forEach(e),n=0;n<wr.length;n++)r=wr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wr.length&&(n=wr[0],n.blockedOn===null);)Yv(n),n.blockedOn===null&&wr.shift()}var ri=ur.ReactCurrentBatchConfig,Hl=!0;function Eb(t,e,n,r){var s=xe,i=ri.transition;ri.transition=null;try{xe=1,Jh(t,e,n,r)}finally{xe=s,ri.transition=i}}function bb(t,e,n,r){var s=xe,i=ri.transition;ri.transition=null;try{xe=4,Jh(t,e,n,r)}finally{xe=s,ri.transition=i}}function Jh(t,e,n,r){if(Hl){var s=Ld(t,e,n,r);if(s===null)Hc(t,e,r,Wl,n),Lm(t,r);else if(xb(s,t,e,n,r))r.stopPropagation();else if(Lm(t,r),e&4&&-1<_b.indexOf(t)){for(;s!==null;){var i=da(s);if(i!==null&&qv(i),i=Ld(t,e,n,r),i===null&&Hc(t,e,r,Wl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Hc(t,e,r,null,n)}}var Wl=null;function Ld(t,e,n,r){if(Wl=null,t=Kh(r),t=ss(t),t!==null)if(e=Ss(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Lv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Wl=t,null}function Xv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cb()){case Qh:return 1;case Bv:return 4;case Bl:case db:return 16;case $v:return 536870912;default:return 16}default:return 16}}var Ir=null,Zh=null,xl=null;function Jv(){if(xl)return xl;var t,e=Zh,n=e.length,r,s="value"in Ir?Ir.value:Ir.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return xl=s.slice(t,1<r?1-r:void 0)}function wl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xa(){return!0}function Um(){return!1}function en(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xa:Um,this.isPropagationStopped=Um,this}return De(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xa)},persist:function(){},isPersistent:Xa}),e}var Ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ef=en(Ai),ca=De({},Ai,{view:0,detail:0}),Sb=en(ca),Oc,Vc,no,Pu=De({},ca,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==no&&(no&&t.type==="mousemove"?(Oc=t.screenX-no.screenX,Vc=t.screenY-no.screenY):Vc=Oc=0,no=t),Oc)},movementY:function(t){return"movementY"in t?t.movementY:Vc}}),zm=en(Pu),Tb=De({},Pu,{dataTransfer:0}),Ib=en(Tb),Cb=De({},ca,{relatedTarget:0}),Mc=en(Cb),Ab=De({},Ai,{animationName:0,elapsedTime:0,pseudoElement:0}),Pb=en(Ab),Rb=De({},Ai,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Nb=en(Rb),kb=De({},Ai,{data:0}),Bm=en(kb),Db={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ob={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Ob[t])?!!e[t]:!1}function tf(){return Vb}var Mb=De({},ca,{key:function(t){if(t.key){var e=Db[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=wl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tf,charCode:function(t){return t.type==="keypress"?wl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?wl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Lb=en(Mb),Fb=De({},Pu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$m=en(Fb),Ub=De({},ca,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tf}),zb=en(Ub),Bb=De({},Ai,{propertyName:0,elapsedTime:0,pseudoElement:0}),$b=en(Bb),Hb=De({},Pu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Wb=en(Hb),qb=[9,13,27,32],nf=tr&&"CompositionEvent"in window,Eo=null;tr&&"documentMode"in document&&(Eo=document.documentMode);var Gb=tr&&"TextEvent"in window&&!Eo,Zv=tr&&(!nf||Eo&&8<Eo&&11>=Eo),Hm=" ",Wm=!1;function e_(t,e){switch(t){case"keyup":return qb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function t_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Bs=!1;function Kb(t,e){switch(t){case"compositionend":return t_(e);case"keypress":return e.which!==32?null:(Wm=!0,Hm);case"textInput":return t=e.data,t===Hm&&Wm?null:t;default:return null}}function Qb(t,e){if(Bs)return t==="compositionend"||!nf&&e_(t,e)?(t=Jv(),xl=Zh=Ir=null,Bs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Zv&&e.locale!=="ko"?null:e.data;default:return null}}var Yb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Yb[t.type]:e==="textarea"}function n_(t,e,n,r){Dv(r),e=ql(e,"onChange"),0<e.length&&(n=new ef("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var bo=null,zo=null;function Xb(t){f_(t,0)}function Ru(t){var e=Ws(t);if(Iv(e))return t}function Jb(t,e){if(t==="change")return e}var r_=!1;if(tr){var Lc;if(tr){var Fc="oninput"in document;if(!Fc){var Gm=document.createElement("div");Gm.setAttribute("oninput","return;"),Fc=typeof Gm.oninput=="function"}Lc=Fc}else Lc=!1;r_=Lc&&(!document.documentMode||9<document.documentMode)}function Km(){bo&&(bo.detachEvent("onpropertychange",s_),zo=bo=null)}function s_(t){if(t.propertyName==="value"&&Ru(zo)){var e=[];n_(e,zo,t,Kh(t)),Mv(Xb,e)}}function Zb(t,e,n){t==="focusin"?(Km(),bo=e,zo=n,bo.attachEvent("onpropertychange",s_)):t==="focusout"&&Km()}function eS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ru(zo)}function tS(t,e){if(t==="click")return Ru(e)}function nS(t,e){if(t==="input"||t==="change")return Ru(e)}function rS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Tn=typeof Object.is=="function"?Object.is:rS;function Bo(t,e){if(Tn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!xd.call(e,s)||!Tn(t[s],e[s]))return!1}return!0}function Qm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ym(t,e){var n=Qm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qm(n)}}function i_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?i_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function o_(){for(var t=window,e=Fl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Fl(t.document)}return e}function rf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sS(t){var e=o_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&i_(n.ownerDocument.documentElement,n)){if(r!==null&&rf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Ym(n,i);var o=Ym(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var iS=tr&&"documentMode"in document&&11>=document.documentMode,$s=null,Fd=null,So=null,Ud=!1;function Xm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ud||$s==null||$s!==Fl(r)||(r=$s,"selectionStart"in r&&rf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),So&&Bo(So,r)||(So=r,r=ql(Fd,"onSelect"),0<r.length&&(e=new ef("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=$s)))}function Ja(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Hs={animationend:Ja("Animation","AnimationEnd"),animationiteration:Ja("Animation","AnimationIteration"),animationstart:Ja("Animation","AnimationStart"),transitionend:Ja("Transition","TransitionEnd")},Uc={},a_={};tr&&(a_=document.createElement("div").style,"AnimationEvent"in window||(delete Hs.animationend.animation,delete Hs.animationiteration.animation,delete Hs.animationstart.animation),"TransitionEvent"in window||delete Hs.transitionend.transition);function Nu(t){if(Uc[t])return Uc[t];if(!Hs[t])return t;var e=Hs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in a_)return Uc[t]=e[n];return t}var l_=Nu("animationend"),u_=Nu("animationiteration"),c_=Nu("animationstart"),d_=Nu("transitionend"),h_=new Map,Jm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gr(t,e){h_.set(t,e),bs(e,[t])}for(var zc=0;zc<Jm.length;zc++){var Bc=Jm[zc],oS=Bc.toLowerCase(),aS=Bc[0].toUpperCase()+Bc.slice(1);Gr(oS,"on"+aS)}Gr(l_,"onAnimationEnd");Gr(u_,"onAnimationIteration");Gr(c_,"onAnimationStart");Gr("dblclick","onDoubleClick");Gr("focusin","onFocus");Gr("focusout","onBlur");Gr(d_,"onTransitionEnd");di("onMouseEnter",["mouseout","mouseover"]);di("onMouseLeave",["mouseout","mouseover"]);di("onPointerEnter",["pointerout","pointerover"]);di("onPointerLeave",["pointerout","pointerover"]);bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bs("onBeforeInput",["compositionend","keypress","textInput","paste"]);bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lS=new Set("cancel close invalid load scroll toggle".split(" ").concat(mo));function Zm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,ob(r,e,void 0,t),t.currentTarget=null}function f_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Zm(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Zm(s,l,d),i=u}}}if(zl)throw t=Od,zl=!1,Od=null,t}function Ie(t,e){var n=e[Wd];n===void 0&&(n=e[Wd]=new Set);var r=t+"__bubble";n.has(r)||(p_(e,t,2,!1),n.add(r))}function $c(t,e,n){var r=0;e&&(r|=4),p_(n,t,r,e)}var Za="_reactListening"+Math.random().toString(36).slice(2);function $o(t){if(!t[Za]){t[Za]=!0,wv.forEach(function(n){n!=="selectionchange"&&(lS.has(n)||$c(n,!1,t),$c(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Za]||(e[Za]=!0,$c("selectionchange",!1,e))}}function p_(t,e,n,r){switch(Xv(e)){case 1:var s=Eb;break;case 4:s=bb;break;default:s=Jh}n=s.bind(null,e,n,t),s=void 0,!jd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Hc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ss(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Mv(function(){var d=i,h=Kh(n),g=[];e:{var y=h_.get(t);if(y!==void 0){var C=ef,N=t;switch(t){case"keypress":if(wl(n)===0)break e;case"keydown":case"keyup":C=Lb;break;case"focusin":N="focus",C=Mc;break;case"focusout":N="blur",C=Mc;break;case"beforeblur":case"afterblur":C=Mc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=zm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Ib;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=zb;break;case l_:case u_:case c_:C=Pb;break;case d_:C=$b;break;case"scroll":C=Sb;break;case"wheel":C=Wb;break;case"copy":case"cut":case"paste":C=Nb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=$m}var E=(e&4)!==0,D=!E&&t==="scroll",b=E?y!==null?y+"Capture":null:y;E=[];for(var x=d,v;x!==null;){v=x;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,b!==null&&(S=Mo(x,b),S!=null&&E.push(Ho(x,S,v)))),D)break;x=x.return}0<E.length&&(y=new C(y,N,null,n,h),g.push({event:y,listeners:E}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",y&&n!==kd&&(N=n.relatedTarget||n.fromElement)&&(ss(N)||N[nr]))break e;if((C||y)&&(y=h.window===h?h:(y=h.ownerDocument)?y.defaultView||y.parentWindow:window,C?(N=n.relatedTarget||n.toElement,C=d,N=N?ss(N):null,N!==null&&(D=Ss(N),N!==D||N.tag!==5&&N.tag!==6)&&(N=null)):(C=null,N=d),C!==N)){if(E=zm,S="onMouseLeave",b="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(E=$m,S="onPointerLeave",b="onPointerEnter",x="pointer"),D=C==null?y:Ws(C),v=N==null?y:Ws(N),y=new E(S,x+"leave",C,n,h),y.target=D,y.relatedTarget=v,S=null,ss(h)===d&&(E=new E(b,x+"enter",N,n,h),E.target=v,E.relatedTarget=D,S=E),D=S,C&&N)t:{for(E=C,b=N,x=0,v=E;v;v=Os(v))x++;for(v=0,S=b;S;S=Os(S))v++;for(;0<x-v;)E=Os(E),x--;for(;0<v-x;)b=Os(b),v--;for(;x--;){if(E===b||b!==null&&E===b.alternate)break t;E=Os(E),b=Os(b)}E=null}else E=null;C!==null&&eg(g,y,C,E,!1),N!==null&&D!==null&&eg(g,D,N,E,!0)}}e:{if(y=d?Ws(d):window,C=y.nodeName&&y.nodeName.toLowerCase(),C==="select"||C==="input"&&y.type==="file")var P=Jb;else if(qm(y))if(r_)P=nS;else{P=eS;var A=Zb}else(C=y.nodeName)&&C.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(P=tS);if(P&&(P=P(t,d))){n_(g,P,n,h);break e}A&&A(t,y,d),t==="focusout"&&(A=y._wrapperState)&&A.controlled&&y.type==="number"&&Cd(y,"number",y.value)}switch(A=d?Ws(d):window,t){case"focusin":(qm(A)||A.contentEditable==="true")&&($s=A,Fd=d,So=null);break;case"focusout":So=Fd=$s=null;break;case"mousedown":Ud=!0;break;case"contextmenu":case"mouseup":case"dragend":Ud=!1,Xm(g,n,h);break;case"selectionchange":if(iS)break;case"keydown":case"keyup":Xm(g,n,h)}var _;if(nf)e:{switch(t){case"compositionstart":var p="onCompositionStart";break e;case"compositionend":p="onCompositionEnd";break e;case"compositionupdate":p="onCompositionUpdate";break e}p=void 0}else Bs?e_(t,n)&&(p="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(p="onCompositionStart");p&&(Zv&&n.locale!=="ko"&&(Bs||p!=="onCompositionStart"?p==="onCompositionEnd"&&Bs&&(_=Jv()):(Ir=h,Zh="value"in Ir?Ir.value:Ir.textContent,Bs=!0)),A=ql(d,p),0<A.length&&(p=new Bm(p,t,null,n,h),g.push({event:p,listeners:A}),_?p.data=_:(_=t_(n),_!==null&&(p.data=_)))),(_=Gb?Kb(t,n):Qb(t,n))&&(d=ql(d,"onBeforeInput"),0<d.length&&(h=new Bm("onBeforeInput","beforeinput",null,n,h),g.push({event:h,listeners:d}),h.data=_))}f_(g,e)})}function Ho(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ql(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Mo(t,n),i!=null&&r.unshift(Ho(t,i,s)),i=Mo(t,e),i!=null&&r.push(Ho(t,i,s))),t=t.return}return r}function Os(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function eg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=Mo(n,i),u!=null&&o.unshift(Ho(n,u,l))):s||(u=Mo(n,i),u!=null&&o.push(Ho(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var uS=/\r\n?/g,cS=/\u0000|\uFFFD/g;function tg(t){return(typeof t=="string"?t:""+t).replace(uS,`
`).replace(cS,"")}function el(t,e,n){if(e=tg(e),tg(t)!==e&&n)throw Error(U(425))}function Gl(){}var zd=null,Bd=null;function $d(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hd=typeof setTimeout=="function"?setTimeout:void 0,dS=typeof clearTimeout=="function"?clearTimeout:void 0,ng=typeof Promise=="function"?Promise:void 0,hS=typeof queueMicrotask=="function"?queueMicrotask:typeof ng<"u"?function(t){return ng.resolve(null).then(t).catch(fS)}:Hd;function fS(t){setTimeout(function(){throw t})}function Wc(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Uo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Uo(e)}function kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function rg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Pi=Math.random().toString(36).slice(2),Nn="__reactFiber$"+Pi,Wo="__reactProps$"+Pi,nr="__reactContainer$"+Pi,Wd="__reactEvents$"+Pi,pS="__reactListeners$"+Pi,mS="__reactHandles$"+Pi;function ss(t){var e=t[Nn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[nr]||n[Nn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=rg(t);t!==null;){if(n=t[Nn])return n;t=rg(t)}return e}t=n,n=t.parentNode}return null}function da(t){return t=t[Nn]||t[nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ws(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function ku(t){return t[Wo]||null}var qd=[],qs=-1;function Kr(t){return{current:t}}function Ae(t){0>qs||(t.current=qd[qs],qd[qs]=null,qs--)}function Se(t,e){qs++,qd[qs]=t.current,t.current=e}var Br={},Tt=Kr(Br),Ut=Kr(!1),fs=Br;function hi(t,e){var n=t.type.contextTypes;if(!n)return Br;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function zt(t){return t=t.childContextTypes,t!=null}function Kl(){Ae(Ut),Ae(Tt)}function sg(t,e,n){if(Tt.current!==Br)throw Error(U(168));Se(Tt,e),Se(Ut,n)}function m_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,ZE(t)||"Unknown",s));return De({},n,r)}function Ql(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Br,fs=Tt.current,Se(Tt,t),Se(Ut,Ut.current),!0}function ig(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=m_(t,e,fs),r.__reactInternalMemoizedMergedChildContext=t,Ae(Ut),Ae(Tt),Se(Tt,t)):Ae(Ut),Se(Ut,n)}var Wn=null,Du=!1,qc=!1;function g_(t){Wn===null?Wn=[t]:Wn.push(t)}function gS(t){Du=!0,g_(t)}function Qr(){if(!qc&&Wn!==null){qc=!0;var t=0,e=xe;try{var n=Wn;for(xe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Wn=null,Du=!1}catch(s){throw Wn!==null&&(Wn=Wn.slice(t+1)),zv(Qh,Qr),s}finally{xe=e,qc=!1}}return null}var Gs=[],Ks=0,Yl=null,Xl=0,tn=[],nn=0,ps=null,Gn=1,Kn="";function ts(t,e){Gs[Ks++]=Xl,Gs[Ks++]=Yl,Yl=t,Xl=e}function y_(t,e,n){tn[nn++]=Gn,tn[nn++]=Kn,tn[nn++]=ps,ps=t;var r=Gn;t=Kn;var s=32-xn(r)-1;r&=~(1<<s),n+=1;var i=32-xn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Gn=1<<32-xn(e)+s|n<<s|r,Kn=i+t}else Gn=1<<i|n<<s|r,Kn=t}function sf(t){t.return!==null&&(ts(t,1),y_(t,1,0))}function of(t){for(;t===Yl;)Yl=Gs[--Ks],Gs[Ks]=null,Xl=Gs[--Ks],Gs[Ks]=null;for(;t===ps;)ps=tn[--nn],tn[nn]=null,Kn=tn[--nn],tn[nn]=null,Gn=tn[--nn],tn[nn]=null}var Yt=null,Qt=null,Re=!1,vn=null;function v_(t,e){var n=sn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function og(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Yt=t,Qt=kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Yt=t,Qt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ps!==null?{id:Gn,overflow:Kn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=sn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Yt=t,Qt=null,!0):!1;default:return!1}}function Gd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Kd(t){if(Re){var e=Qt;if(e){var n=e;if(!og(t,e)){if(Gd(t))throw Error(U(418));e=kr(n.nextSibling);var r=Yt;e&&og(t,e)?v_(r,n):(t.flags=t.flags&-4097|2,Re=!1,Yt=t)}}else{if(Gd(t))throw Error(U(418));t.flags=t.flags&-4097|2,Re=!1,Yt=t}}}function ag(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Yt=t}function tl(t){if(t!==Yt)return!1;if(!Re)return ag(t),Re=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$d(t.type,t.memoizedProps)),e&&(e=Qt)){if(Gd(t))throw __(),Error(U(418));for(;e;)v_(t,e),e=kr(e.nextSibling)}if(ag(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Qt=kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Qt=null}}else Qt=Yt?kr(t.stateNode.nextSibling):null;return!0}function __(){for(var t=Qt;t;)t=kr(t.nextSibling)}function fi(){Qt=Yt=null,Re=!1}function af(t){vn===null?vn=[t]:vn.push(t)}var yS=ur.ReactCurrentBatchConfig;function ro(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function nl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lg(t){var e=t._init;return e(t._payload)}function x_(t){function e(b,x){if(t){var v=b.deletions;v===null?(b.deletions=[x],b.flags|=16):v.push(x)}}function n(b,x){if(!t)return null;for(;x!==null;)e(b,x),x=x.sibling;return null}function r(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function s(b,x){return b=Vr(b,x),b.index=0,b.sibling=null,b}function i(b,x,v){return b.index=v,t?(v=b.alternate,v!==null?(v=v.index,v<x?(b.flags|=2,x):v):(b.flags|=2,x)):(b.flags|=1048576,x)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,x,v,S){return x===null||x.tag!==6?(x=Zc(v,b.mode,S),x.return=b,x):(x=s(x,v),x.return=b,x)}function u(b,x,v,S){var P=v.type;return P===zs?h(b,x,v.props.children,S,v.key):x!==null&&(x.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===_r&&lg(P)===x.type)?(S=s(x,v.props),S.ref=ro(b,x,v),S.return=b,S):(S=Al(v.type,v.key,v.props,null,b.mode,S),S.ref=ro(b,x,v),S.return=b,S)}function d(b,x,v,S){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=ed(v,b.mode,S),x.return=b,x):(x=s(x,v.children||[]),x.return=b,x)}function h(b,x,v,S,P){return x===null||x.tag!==7?(x=cs(v,b.mode,S,P),x.return=b,x):(x=s(x,v),x.return=b,x)}function g(b,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Zc(""+x,b.mode,v),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Wa:return v=Al(x.type,x.key,x.props,null,b.mode,v),v.ref=ro(b,null,x),v.return=b,v;case Us:return x=ed(x,b.mode,v),x.return=b,x;case _r:var S=x._init;return g(b,S(x._payload),v)}if(fo(x)||Ji(x))return x=cs(x,b.mode,v,null),x.return=b,x;nl(b,x)}return null}function y(b,x,v,S){var P=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return P!==null?null:l(b,x,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Wa:return v.key===P?u(b,x,v,S):null;case Us:return v.key===P?d(b,x,v,S):null;case _r:return P=v._init,y(b,x,P(v._payload),S)}if(fo(v)||Ji(v))return P!==null?null:h(b,x,v,S,null);nl(b,v)}return null}function C(b,x,v,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(v)||null,l(x,b,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Wa:return b=b.get(S.key===null?v:S.key)||null,u(x,b,S,P);case Us:return b=b.get(S.key===null?v:S.key)||null,d(x,b,S,P);case _r:var A=S._init;return C(b,x,v,A(S._payload),P)}if(fo(S)||Ji(S))return b=b.get(v)||null,h(x,b,S,P,null);nl(x,S)}return null}function N(b,x,v,S){for(var P=null,A=null,_=x,p=x=0,w=null;_!==null&&p<v.length;p++){_.index>p?(w=_,_=null):w=_.sibling;var I=y(b,_,v[p],S);if(I===null){_===null&&(_=w);break}t&&_&&I.alternate===null&&e(b,_),x=i(I,x,p),A===null?P=I:A.sibling=I,A=I,_=w}if(p===v.length)return n(b,_),Re&&ts(b,p),P;if(_===null){for(;p<v.length;p++)_=g(b,v[p],S),_!==null&&(x=i(_,x,p),A===null?P=_:A.sibling=_,A=_);return Re&&ts(b,p),P}for(_=r(b,_);p<v.length;p++)w=C(_,b,p,v[p],S),w!==null&&(t&&w.alternate!==null&&_.delete(w.key===null?p:w.key),x=i(w,x,p),A===null?P=w:A.sibling=w,A=w);return t&&_.forEach(function(k){return e(b,k)}),Re&&ts(b,p),P}function E(b,x,v,S){var P=Ji(v);if(typeof P!="function")throw Error(U(150));if(v=P.call(v),v==null)throw Error(U(151));for(var A=P=null,_=x,p=x=0,w=null,I=v.next();_!==null&&!I.done;p++,I=v.next()){_.index>p?(w=_,_=null):w=_.sibling;var k=y(b,_,I.value,S);if(k===null){_===null&&(_=w);break}t&&_&&k.alternate===null&&e(b,_),x=i(k,x,p),A===null?P=k:A.sibling=k,A=k,_=w}if(I.done)return n(b,_),Re&&ts(b,p),P;if(_===null){for(;!I.done;p++,I=v.next())I=g(b,I.value,S),I!==null&&(x=i(I,x,p),A===null?P=I:A.sibling=I,A=I);return Re&&ts(b,p),P}for(_=r(b,_);!I.done;p++,I=v.next())I=C(_,b,p,I.value,S),I!==null&&(t&&I.alternate!==null&&_.delete(I.key===null?p:I.key),x=i(I,x,p),A===null?P=I:A.sibling=I,A=I);return t&&_.forEach(function(j){return e(b,j)}),Re&&ts(b,p),P}function D(b,x,v,S){if(typeof v=="object"&&v!==null&&v.type===zs&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Wa:e:{for(var P=v.key,A=x;A!==null;){if(A.key===P){if(P=v.type,P===zs){if(A.tag===7){n(b,A.sibling),x=s(A,v.props.children),x.return=b,b=x;break e}}else if(A.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===_r&&lg(P)===A.type){n(b,A.sibling),x=s(A,v.props),x.ref=ro(b,A,v),x.return=b,b=x;break e}n(b,A);break}else e(b,A);A=A.sibling}v.type===zs?(x=cs(v.props.children,b.mode,S,v.key),x.return=b,b=x):(S=Al(v.type,v.key,v.props,null,b.mode,S),S.ref=ro(b,x,v),S.return=b,b=S)}return o(b);case Us:e:{for(A=v.key;x!==null;){if(x.key===A)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){n(b,x.sibling),x=s(x,v.children||[]),x.return=b,b=x;break e}else{n(b,x);break}else e(b,x);x=x.sibling}x=ed(v,b.mode,S),x.return=b,b=x}return o(b);case _r:return A=v._init,D(b,x,A(v._payload),S)}if(fo(v))return N(b,x,v,S);if(Ji(v))return E(b,x,v,S);nl(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(n(b,x.sibling),x=s(x,v),x.return=b,b=x):(n(b,x),x=Zc(v,b.mode,S),x.return=b,b=x),o(b)):n(b,x)}return D}var pi=x_(!0),w_=x_(!1),Jl=Kr(null),Zl=null,Qs=null,lf=null;function uf(){lf=Qs=Zl=null}function cf(t){var e=Jl.current;Ae(Jl),t._currentValue=e}function Qd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function si(t,e){Zl=t,lf=Qs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ft=!0),t.firstContext=null)}function ln(t){var e=t._currentValue;if(lf!==t)if(t={context:t,memoizedValue:e,next:null},Qs===null){if(Zl===null)throw Error(U(308));Qs=t,Zl.dependencies={lanes:0,firstContext:t}}else Qs=Qs.next=t;return e}var is=null;function df(t){is===null?is=[t]:is.push(t)}function E_(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,df(e)):(n.next=s.next,s.next=n),e.interleaved=n,rr(t,r)}function rr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xr=!1;function hf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function b_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Dr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,rr(t,n)}return s=r.interleaved,s===null?(e.next=e,df(r)):(e.next=s.next,s.next=e),r.interleaved=e,rr(t,n)}function El(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Yh(t,n)}}function ug(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function eu(t,e,n,r){var s=t.updateQueue;xr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,h=d=u=null,l=i;do{var y=l.lane,C=l.eventTime;if((r&y)===y){h!==null&&(h=h.next={eventTime:C,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var N=t,E=l;switch(y=e,C=n,E.tag){case 1:if(N=E.payload,typeof N=="function"){g=N.call(C,g,y);break e}g=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=E.payload,y=typeof N=="function"?N.call(C,g,y):N,y==null)break e;g=De({},g,y);break e;case 2:xr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else C={eventTime:C,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=C,u=g):h=h.next=C,o|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(h===null&&(u=g),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);gs|=o,t.lanes=o,t.memoizedState=g}}function cg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var ha={},Dn=Kr(ha),qo=Kr(ha),Go=Kr(ha);function os(t){if(t===ha)throw Error(U(174));return t}function ff(t,e){switch(Se(Go,e),Se(qo,t),Se(Dn,ha),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pd(e,t)}Ae(Dn),Se(Dn,e)}function mi(){Ae(Dn),Ae(qo),Ae(Go)}function S_(t){os(Go.current);var e=os(Dn.current),n=Pd(e,t.type);e!==n&&(Se(qo,t),Se(Dn,n))}function pf(t){qo.current===t&&(Ae(Dn),Ae(qo))}var Ne=Kr(0);function tu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gc=[];function mf(){for(var t=0;t<Gc.length;t++)Gc[t]._workInProgressVersionPrimary=null;Gc.length=0}var bl=ur.ReactCurrentDispatcher,Kc=ur.ReactCurrentBatchConfig,ms=0,ke=null,Xe=null,it=null,nu=!1,To=!1,Ko=0,vS=0;function vt(){throw Error(U(321))}function gf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Tn(t[n],e[n]))return!1;return!0}function yf(t,e,n,r,s,i){if(ms=i,ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,bl.current=t===null||t.memoizedState===null?ES:bS,t=n(r,s),To){i=0;do{if(To=!1,Ko=0,25<=i)throw Error(U(301));i+=1,it=Xe=null,e.updateQueue=null,bl.current=SS,t=n(r,s)}while(To)}if(bl.current=ru,e=Xe!==null&&Xe.next!==null,ms=0,it=Xe=ke=null,nu=!1,e)throw Error(U(300));return t}function vf(){var t=Ko!==0;return Ko=0,t}function Pn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?ke.memoizedState=it=t:it=it.next=t,it}function un(){if(Xe===null){var t=ke.alternate;t=t!==null?t.memoizedState:null}else t=Xe.next;var e=it===null?ke.memoizedState:it.next;if(e!==null)it=e,Xe=t;else{if(t===null)throw Error(U(310));Xe=t,t={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},it===null?ke.memoizedState=it=t:it=it.next=t}return it}function Qo(t,e){return typeof e=="function"?e(t):e}function Qc(t){var e=un(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Xe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var h=d.lane;if((ms&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var g={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=g,o=r):u=u.next=g,ke.lanes|=h,gs|=h}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,Tn(r,e.memoizedState)||(Ft=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ke.lanes|=i,gs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Yc(t){var e=un(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Tn(i,e.memoizedState)||(Ft=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function T_(){}function I_(t,e){var n=ke,r=un(),s=e(),i=!Tn(r.memoizedState,s);if(i&&(r.memoizedState=s,Ft=!0),r=r.queue,_f(P_.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||it!==null&&it.memoizedState.tag&1){if(n.flags|=2048,Yo(9,A_.bind(null,n,r,s,e),void 0,null),ot===null)throw Error(U(349));ms&30||C_(n,e,s)}return s}function C_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ke.updateQueue,e===null?(e={lastEffect:null,stores:null},ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function A_(t,e,n,r){e.value=n,e.getSnapshot=r,R_(e)&&N_(t)}function P_(t,e,n){return n(function(){R_(e)&&N_(t)})}function R_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Tn(t,n)}catch{return!0}}function N_(t){var e=rr(t,1);e!==null&&wn(e,t,1,-1)}function dg(t){var e=Pn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:t},e.queue=t,t=t.dispatch=wS.bind(null,ke,t),[e.memoizedState,t]}function Yo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ke.updateQueue,e===null?(e={lastEffect:null,stores:null},ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function k_(){return un().memoizedState}function Sl(t,e,n,r){var s=Pn();ke.flags|=t,s.memoizedState=Yo(1|e,n,void 0,r===void 0?null:r)}function ju(t,e,n,r){var s=un();r=r===void 0?null:r;var i=void 0;if(Xe!==null){var o=Xe.memoizedState;if(i=o.destroy,r!==null&&gf(r,o.deps)){s.memoizedState=Yo(e,n,i,r);return}}ke.flags|=t,s.memoizedState=Yo(1|e,n,i,r)}function hg(t,e){return Sl(8390656,8,t,e)}function _f(t,e){return ju(2048,8,t,e)}function D_(t,e){return ju(4,2,t,e)}function j_(t,e){return ju(4,4,t,e)}function O_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function V_(t,e,n){return n=n!=null?n.concat([t]):null,ju(4,4,O_.bind(null,e,t),n)}function xf(){}function M_(t,e){var n=un();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&gf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function L_(t,e){var n=un();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&gf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function F_(t,e,n){return ms&21?(Tn(n,e)||(n=Hv(),ke.lanes|=n,gs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ft=!0),t.memoizedState=n)}function _S(t,e){var n=xe;xe=n!==0&&4>n?n:4,t(!0);var r=Kc.transition;Kc.transition={};try{t(!1),e()}finally{xe=n,Kc.transition=r}}function U_(){return un().memoizedState}function xS(t,e,n){var r=Or(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},z_(t))B_(e,n);else if(n=E_(t,e,n,r),n!==null){var s=kt();wn(n,t,r,s),$_(n,e,r)}}function wS(t,e,n){var r=Or(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(z_(t))B_(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Tn(l,o)){var u=e.interleaved;u===null?(s.next=s,df(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=E_(t,e,s,r),n!==null&&(s=kt(),wn(n,t,r,s),$_(n,e,r))}}function z_(t){var e=t.alternate;return t===ke||e!==null&&e===ke}function B_(t,e){To=nu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function $_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Yh(t,n)}}var ru={readContext:ln,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useInsertionEffect:vt,useLayoutEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useMutableSource:vt,useSyncExternalStore:vt,useId:vt,unstable_isNewReconciler:!1},ES={readContext:ln,useCallback:function(t,e){return Pn().memoizedState=[t,e===void 0?null:e],t},useContext:ln,useEffect:hg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Sl(4194308,4,O_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Sl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Sl(4,2,t,e)},useMemo:function(t,e){var n=Pn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Pn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=xS.bind(null,ke,t),[r.memoizedState,t]},useRef:function(t){var e=Pn();return t={current:t},e.memoizedState=t},useState:dg,useDebugValue:xf,useDeferredValue:function(t){return Pn().memoizedState=t},useTransition:function(){var t=dg(!1),e=t[0];return t=_S.bind(null,t[1]),Pn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ke,s=Pn();if(Re){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),ot===null)throw Error(U(349));ms&30||C_(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,hg(P_.bind(null,r,i,t),[t]),r.flags|=2048,Yo(9,A_.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Pn(),e=ot.identifierPrefix;if(Re){var n=Kn,r=Gn;n=(r&~(1<<32-xn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ko++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=vS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},bS={readContext:ln,useCallback:M_,useContext:ln,useEffect:_f,useImperativeHandle:V_,useInsertionEffect:D_,useLayoutEffect:j_,useMemo:L_,useReducer:Qc,useRef:k_,useState:function(){return Qc(Qo)},useDebugValue:xf,useDeferredValue:function(t){var e=un();return F_(e,Xe.memoizedState,t)},useTransition:function(){var t=Qc(Qo)[0],e=un().memoizedState;return[t,e]},useMutableSource:T_,useSyncExternalStore:I_,useId:U_,unstable_isNewReconciler:!1},SS={readContext:ln,useCallback:M_,useContext:ln,useEffect:_f,useImperativeHandle:V_,useInsertionEffect:D_,useLayoutEffect:j_,useMemo:L_,useReducer:Yc,useRef:k_,useState:function(){return Yc(Qo)},useDebugValue:xf,useDeferredValue:function(t){var e=un();return Xe===null?e.memoizedState=t:F_(e,Xe.memoizedState,t)},useTransition:function(){var t=Yc(Qo)[0],e=un().memoizedState;return[t,e]},useMutableSource:T_,useSyncExternalStore:I_,useId:U_,unstable_isNewReconciler:!1};function gn(t,e){if(t&&t.defaultProps){e=De({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Yd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:De({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ou={isMounted:function(t){return(t=t._reactInternals)?Ss(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=kt(),s=Or(t),i=Zn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Dr(t,i,s),e!==null&&(wn(e,t,s,r),El(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=kt(),s=Or(t),i=Zn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Dr(t,i,s),e!==null&&(wn(e,t,s,r),El(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=kt(),r=Or(t),s=Zn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Dr(t,s,r),e!==null&&(wn(e,t,r,n),El(e,t,r))}};function fg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Bo(n,r)||!Bo(s,i):!0}function H_(t,e,n){var r=!1,s=Br,i=e.contextType;return typeof i=="object"&&i!==null?i=ln(i):(s=zt(e)?fs:Tt.current,r=e.contextTypes,i=(r=r!=null)?hi(t,s):Br),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ou,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function pg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ou.enqueueReplaceState(e,e.state,null)}function Xd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},hf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ln(i):(i=zt(e)?fs:Tt.current,s.context=hi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Yd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ou.enqueueReplaceState(s,s.state,null),eu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function gi(t,e){try{var n="",r=e;do n+=JE(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Xc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Jd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var TS=typeof WeakMap=="function"?WeakMap:Map;function W_(t,e,n){n=Zn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){iu||(iu=!0,lh=r),Jd(t,e)},n}function q_(t,e,n){n=Zn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Jd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Jd(t,e),typeof r!="function"&&(jr===null?jr=new Set([this]):jr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function mg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new TS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=FS.bind(null,t,e,n),e.then(t,t))}function gg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Zn(-1,1),e.tag=2,Dr(n,e,1))),n.lanes|=1),t)}var IS=ur.ReactCurrentOwner,Ft=!1;function Nt(t,e,n,r){e.child=t===null?w_(e,null,n,r):pi(e,t.child,n,r)}function vg(t,e,n,r,s){n=n.render;var i=e.ref;return si(e,s),r=yf(t,e,n,r,i,s),n=vf(),t!==null&&!Ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(Re&&n&&sf(e),e.flags|=1,Nt(t,e,r,s),e.child)}function _g(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Af(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,G_(t,e,i,r,s)):(t=Al(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Bo,n(o,r)&&t.ref===e.ref)return sr(t,e,s)}return e.flags|=1,t=Vr(i,r),t.ref=e.ref,t.return=e,e.child=t}function G_(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Bo(i,r)&&t.ref===e.ref)if(Ft=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ft=!0);else return e.lanes=t.lanes,sr(t,e,s)}return Zd(t,e,n,r,s)}function K_(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(Xs,Kt),Kt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Se(Xs,Kt),Kt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Se(Xs,Kt),Kt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Se(Xs,Kt),Kt|=r;return Nt(t,e,s,n),e.child}function Q_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Zd(t,e,n,r,s){var i=zt(n)?fs:Tt.current;return i=hi(e,i),si(e,s),n=yf(t,e,n,r,i,s),r=vf(),t!==null&&!Ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(Re&&r&&sf(e),e.flags|=1,Nt(t,e,n,s),e.child)}function xg(t,e,n,r,s){if(zt(n)){var i=!0;Ql(e)}else i=!1;if(si(e,s),e.stateNode===null)Tl(t,e),H_(e,n,r),Xd(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=ln(d):(d=zt(n)?fs:Tt.current,d=hi(e,d));var h=n.getDerivedStateFromProps,g=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&pg(e,o,r,d),xr=!1;var y=e.memoizedState;o.state=y,eu(e,r,o,s),u=e.memoizedState,l!==r||y!==u||Ut.current||xr?(typeof h=="function"&&(Yd(e,n,h,r),u=e.memoizedState),(l=xr||fg(e,n,l,r,y,u,d))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,b_(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:gn(e.type,l),o.props=d,g=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=ln(u):(u=zt(n)?fs:Tt.current,u=hi(e,u));var C=n.getDerivedStateFromProps;(h=typeof C=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==g||y!==u)&&pg(e,o,r,u),xr=!1,y=e.memoizedState,o.state=y,eu(e,r,o,s);var N=e.memoizedState;l!==g||y!==N||Ut.current||xr?(typeof C=="function"&&(Yd(e,n,C,r),N=e.memoizedState),(d=xr||fg(e,n,d,r,y,N,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,N,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,N,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=N),o.props=r,o.state=N,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return eh(t,e,n,r,i,s)}function eh(t,e,n,r,s,i){Q_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&ig(e,n,!1),sr(t,e,i);r=e.stateNode,IS.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=pi(e,t.child,null,i),e.child=pi(e,null,l,i)):Nt(t,e,l,i),e.memoizedState=r.state,s&&ig(e,n,!0),e.child}function Y_(t){var e=t.stateNode;e.pendingContext?sg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&sg(t,e.context,!1),ff(t,e.containerInfo)}function wg(t,e,n,r,s){return fi(),af(s),e.flags|=256,Nt(t,e,n,r),e.child}var th={dehydrated:null,treeContext:null,retryLane:0};function nh(t){return{baseLanes:t,cachePool:null,transitions:null}}function X_(t,e,n){var r=e.pendingProps,s=Ne.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Se(Ne,s&1),t===null)return Kd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Lu(o,r,0,null),t=cs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=nh(n),e.memoizedState=th,t):wf(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return CS(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Vr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Vr(l,i):(i=cs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?nh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=th,r}return i=t.child,t=i.sibling,r=Vr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function wf(t,e){return e=Lu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function rl(t,e,n,r){return r!==null&&af(r),pi(e,t.child,null,n),t=wf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function CS(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Xc(Error(U(422))),rl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Lu({mode:"visible",children:r.children},s,0,null),i=cs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&pi(e,t.child,null,o),e.child.memoizedState=nh(o),e.memoizedState=th,i);if(!(e.mode&1))return rl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(U(419)),r=Xc(i,r,void 0),rl(t,e,o,r)}if(l=(o&t.childLanes)!==0,Ft||l){if(r=ot,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,rr(t,s),wn(r,t,s,-1))}return Cf(),r=Xc(Error(U(421))),rl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=US.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Qt=kr(s.nextSibling),Yt=e,Re=!0,vn=null,t!==null&&(tn[nn++]=Gn,tn[nn++]=Kn,tn[nn++]=ps,Gn=t.id,Kn=t.overflow,ps=e),e=wf(e,r.children),e.flags|=4096,e)}function Eg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Qd(t.return,e,n)}function Jc(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function J_(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Nt(t,e,r.children,n),r=Ne.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Eg(t,n,e);else if(t.tag===19)Eg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Se(Ne,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&tu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Jc(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&tu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Jc(e,!0,n,null,i);break;case"together":Jc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Tl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Vr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Vr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function AS(t,e,n){switch(e.tag){case 3:Y_(e),fi();break;case 5:S_(e);break;case 1:zt(e.type)&&Ql(e);break;case 4:ff(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Se(Jl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Se(Ne,Ne.current&1),e.flags|=128,null):n&e.child.childLanes?X_(t,e,n):(Se(Ne,Ne.current&1),t=sr(t,e,n),t!==null?t.sibling:null);Se(Ne,Ne.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return J_(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Se(Ne,Ne.current),r)break;return null;case 22:case 23:return e.lanes=0,K_(t,e,n)}return sr(t,e,n)}var Z_,rh,ex,tx;Z_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};rh=function(){};ex=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,os(Dn.current);var i=null;switch(n){case"input":s=Td(t,s),r=Td(t,r),i=[];break;case"select":s=De({},s,{value:void 0}),r=De({},r,{value:void 0}),i=[];break;case"textarea":s=Ad(t,s),r=Ad(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Gl)}Rd(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Oo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Oo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ie("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};tx=function(t,e,n,r){n!==r&&(e.flags|=4)};function so(t,e){if(!Re)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function _t(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function PS(t,e,n){var r=e.pendingProps;switch(of(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(e),null;case 1:return zt(e.type)&&Kl(),_t(e),null;case 3:return r=e.stateNode,mi(),Ae(Ut),Ae(Tt),mf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(tl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vn!==null&&(dh(vn),vn=null))),rh(t,e),_t(e),null;case 5:pf(e);var s=os(Go.current);if(n=e.type,t!==null&&e.stateNode!=null)ex(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return _t(e),null}if(t=os(Dn.current),tl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Nn]=e,r[Wo]=i,t=(e.mode&1)!==0,n){case"dialog":Ie("cancel",r),Ie("close",r);break;case"iframe":case"object":case"embed":Ie("load",r);break;case"video":case"audio":for(s=0;s<mo.length;s++)Ie(mo[s],r);break;case"source":Ie("error",r);break;case"img":case"image":case"link":Ie("error",r),Ie("load",r);break;case"details":Ie("toggle",r);break;case"input":Nm(r,i),Ie("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ie("invalid",r);break;case"textarea":Dm(r,i),Ie("invalid",r)}Rd(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&el(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&el(r.textContent,l,t),s=["children",""+l]):Oo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ie("scroll",r)}switch(n){case"input":qa(r),km(r,i,!0);break;case"textarea":qa(r),jm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Gl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Pv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Nn]=e,t[Wo]=r,Z_(t,e,!1,!1),e.stateNode=t;e:{switch(o=Nd(n,r),n){case"dialog":Ie("cancel",t),Ie("close",t),s=r;break;case"iframe":case"object":case"embed":Ie("load",t),s=r;break;case"video":case"audio":for(s=0;s<mo.length;s++)Ie(mo[s],t);s=r;break;case"source":Ie("error",t),s=r;break;case"img":case"image":case"link":Ie("error",t),Ie("load",t),s=r;break;case"details":Ie("toggle",t),s=r;break;case"input":Nm(t,r),s=Td(t,r),Ie("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=De({},r,{value:void 0}),Ie("invalid",t);break;case"textarea":Dm(t,r),s=Ad(t,r),Ie("invalid",t);break;default:s=r}Rd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?kv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Rv(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Vo(t,u):typeof u=="number"&&Vo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Oo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ie("scroll",t):u!=null&&Hh(t,i,u,o))}switch(n){case"input":qa(t),km(t,r,!1);break;case"textarea":qa(t),jm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+zr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ei(t,!!r.multiple,i,!1):r.defaultValue!=null&&ei(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Gl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _t(e),null;case 6:if(t&&e.stateNode!=null)tx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=os(Go.current),os(Dn.current),tl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Nn]=e,(i=r.nodeValue!==n)&&(t=Yt,t!==null))switch(t.tag){case 3:el(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&el(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Nn]=e,e.stateNode=r}return _t(e),null;case 13:if(Ae(Ne),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Re&&Qt!==null&&e.mode&1&&!(e.flags&128))__(),fi(),e.flags|=98560,i=!1;else if(i=tl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[Nn]=e}else fi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_t(e),i=!1}else vn!==null&&(dh(vn),vn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ne.current&1?Je===0&&(Je=3):Cf())),e.updateQueue!==null&&(e.flags|=4),_t(e),null);case 4:return mi(),rh(t,e),t===null&&$o(e.stateNode.containerInfo),_t(e),null;case 10:return cf(e.type._context),_t(e),null;case 17:return zt(e.type)&&Kl(),_t(e),null;case 19:if(Ae(Ne),i=e.memoizedState,i===null)return _t(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)so(i,!1);else{if(Je!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=tu(t),o!==null){for(e.flags|=128,so(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Se(Ne,Ne.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ue()>yi&&(e.flags|=128,r=!0,so(i,!1),e.lanes=4194304)}else{if(!r)if(t=tu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),so(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Re)return _t(e),null}else 2*Ue()-i.renderingStartTime>yi&&n!==1073741824&&(e.flags|=128,r=!0,so(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ue(),e.sibling=null,n=Ne.current,Se(Ne,r?n&1|2:n&1),e):(_t(e),null);case 22:case 23:return If(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Kt&1073741824&&(_t(e),e.subtreeFlags&6&&(e.flags|=8192)):_t(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function RS(t,e){switch(of(e),e.tag){case 1:return zt(e.type)&&Kl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mi(),Ae(Ut),Ae(Tt),mf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return pf(e),null;case 13:if(Ae(Ne),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));fi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ae(Ne),null;case 4:return mi(),null;case 10:return cf(e.type._context),null;case 22:case 23:return If(),null;case 24:return null;default:return null}}var sl=!1,bt=!1,NS=typeof WeakSet=="function"?WeakSet:Set,H=null;function Ys(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ve(t,e,r)}else n.current=null}function sh(t,e,n){try{n()}catch(r){Ve(t,e,r)}}var bg=!1;function kS(t,e){if(zd=Hl,t=o_(),rf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,h=0,g=t,y=null;t:for(;;){for(var C;g!==n||s!==0&&g.nodeType!==3||(l=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(C=g.firstChild)!==null;)y=g,g=C;for(;;){if(g===t)break t;if(y===n&&++d===s&&(l=o),y===i&&++h===r&&(u=o),(C=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=C}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bd={focusedElem:t,selectionRange:n},Hl=!1,H=e;H!==null;)if(e=H,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,H=t;else for(;H!==null;){e=H;try{var N=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var E=N.memoizedProps,D=N.memoizedState,b=e.stateNode,x=b.getSnapshotBeforeUpdate(e.elementType===e.type?E:gn(e.type,E),D);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(S){Ve(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}return N=bg,bg=!1,N}function Io(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&sh(e,n,i)}s=s.next}while(s!==r)}}function Vu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ih(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function nx(t){var e=t.alternate;e!==null&&(t.alternate=null,nx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Nn],delete e[Wo],delete e[Wd],delete e[pS],delete e[mS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rx(t){return t.tag===5||t.tag===3||t.tag===4}function Sg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function oh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Gl));else if(r!==4&&(t=t.child,t!==null))for(oh(t,e,n),t=t.sibling;t!==null;)oh(t,e,n),t=t.sibling}function ah(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ah(t,e,n),t=t.sibling;t!==null;)ah(t,e,n),t=t.sibling}var ut=null,yn=!1;function mr(t,e,n){for(n=n.child;n!==null;)sx(t,e,n),n=n.sibling}function sx(t,e,n){if(kn&&typeof kn.onCommitFiberUnmount=="function")try{kn.onCommitFiberUnmount(Au,n)}catch{}switch(n.tag){case 5:bt||Ys(n,e);case 6:var r=ut,s=yn;ut=null,mr(t,e,n),ut=r,yn=s,ut!==null&&(yn?(t=ut,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ut.removeChild(n.stateNode));break;case 18:ut!==null&&(yn?(t=ut,n=n.stateNode,t.nodeType===8?Wc(t.parentNode,n):t.nodeType===1&&Wc(t,n),Uo(t)):Wc(ut,n.stateNode));break;case 4:r=ut,s=yn,ut=n.stateNode.containerInfo,yn=!0,mr(t,e,n),ut=r,yn=s;break;case 0:case 11:case 14:case 15:if(!bt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&sh(n,e,o),s=s.next}while(s!==r)}mr(t,e,n);break;case 1:if(!bt&&(Ys(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ve(n,e,l)}mr(t,e,n);break;case 21:mr(t,e,n);break;case 22:n.mode&1?(bt=(r=bt)||n.memoizedState!==null,mr(t,e,n),bt=r):mr(t,e,n);break;default:mr(t,e,n)}}function Tg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new NS),e.forEach(function(r){var s=zS.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function pn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ut=l.stateNode,yn=!1;break e;case 3:ut=l.stateNode.containerInfo,yn=!0;break e;case 4:ut=l.stateNode.containerInfo,yn=!0;break e}l=l.return}if(ut===null)throw Error(U(160));sx(i,o,s),ut=null,yn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ve(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ix(e,t),e=e.sibling}function ix(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pn(e,t),An(t),r&4){try{Io(3,t,t.return),Vu(3,t)}catch(E){Ve(t,t.return,E)}try{Io(5,t,t.return)}catch(E){Ve(t,t.return,E)}}break;case 1:pn(e,t),An(t),r&512&&n!==null&&Ys(n,n.return);break;case 5:if(pn(e,t),An(t),r&512&&n!==null&&Ys(n,n.return),t.flags&32){var s=t.stateNode;try{Vo(s,"")}catch(E){Ve(t,t.return,E)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Cv(s,i),Nd(l,o);var d=Nd(l,i);for(o=0;o<u.length;o+=2){var h=u[o],g=u[o+1];h==="style"?kv(s,g):h==="dangerouslySetInnerHTML"?Rv(s,g):h==="children"?Vo(s,g):Hh(s,h,g,d)}switch(l){case"input":Id(s,i);break;case"textarea":Av(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?ei(s,!!i.multiple,C,!1):y!==!!i.multiple&&(i.defaultValue!=null?ei(s,!!i.multiple,i.defaultValue,!0):ei(s,!!i.multiple,i.multiple?[]:"",!1))}s[Wo]=i}catch(E){Ve(t,t.return,E)}}break;case 6:if(pn(e,t),An(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(E){Ve(t,t.return,E)}}break;case 3:if(pn(e,t),An(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Uo(e.containerInfo)}catch(E){Ve(t,t.return,E)}break;case 4:pn(e,t),An(t);break;case 13:pn(e,t),An(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Sf=Ue())),r&4&&Tg(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(bt=(d=bt)||h,pn(e,t),bt=d):pn(e,t),An(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(H=t,h=t.child;h!==null;){for(g=H=h;H!==null;){switch(y=H,C=y.child,y.tag){case 0:case 11:case 14:case 15:Io(4,y,y.return);break;case 1:Ys(y,y.return);var N=y.stateNode;if(typeof N.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,N.props=e.memoizedProps,N.state=e.memoizedState,N.componentWillUnmount()}catch(E){Ve(r,n,E)}}break;case 5:Ys(y,y.return);break;case 22:if(y.memoizedState!==null){Cg(g);continue}}C!==null?(C.return=y,H=C):Cg(g)}h=h.sibling}e:for(h=null,g=t;;){if(g.tag===5){if(h===null){h=g;try{s=g.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Nv("display",o))}catch(E){Ve(t,t.return,E)}}}else if(g.tag===6){if(h===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(E){Ve(t,t.return,E)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;h===g&&(h=null),g=g.return}h===g&&(h=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:pn(e,t),An(t),r&4&&Tg(t);break;case 21:break;default:pn(e,t),An(t)}}function An(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(rx(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Vo(s,""),r.flags&=-33);var i=Sg(t);ah(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Sg(t);oh(t,l,o);break;default:throw Error(U(161))}}catch(u){Ve(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function DS(t,e,n){H=t,ox(t)}function ox(t,e,n){for(var r=(t.mode&1)!==0;H!==null;){var s=H,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||sl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||bt;l=sl;var d=bt;if(sl=o,(bt=u)&&!d)for(H=s;H!==null;)o=H,u=o.child,o.tag===22&&o.memoizedState!==null?Ag(s):u!==null?(u.return=o,H=u):Ag(s);for(;i!==null;)H=i,ox(i),i=i.sibling;H=s,sl=l,bt=d}Ig(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,H=i):Ig(t)}}function Ig(t){for(;H!==null;){var e=H;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bt||Vu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!bt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:gn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&cg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cg(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var g=h.dehydrated;g!==null&&Uo(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}bt||e.flags&512&&ih(e)}catch(y){Ve(e,e.return,y)}}if(e===t){H=null;break}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}}function Cg(t){for(;H!==null;){var e=H;if(e===t){H=null;break}var n=e.sibling;if(n!==null){n.return=e.return,H=n;break}H=e.return}}function Ag(t){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Vu(4,e)}catch(u){Ve(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ve(e,s,u)}}var i=e.return;try{ih(e)}catch(u){Ve(e,i,u)}break;case 5:var o=e.return;try{ih(e)}catch(u){Ve(e,o,u)}}}catch(u){Ve(e,e.return,u)}if(e===t){H=null;break}var l=e.sibling;if(l!==null){l.return=e.return,H=l;break}H=e.return}}var jS=Math.ceil,su=ur.ReactCurrentDispatcher,Ef=ur.ReactCurrentOwner,on=ur.ReactCurrentBatchConfig,fe=0,ot=null,We=null,ht=0,Kt=0,Xs=Kr(0),Je=0,Xo=null,gs=0,Mu=0,bf=0,Co=null,Lt=null,Sf=0,yi=1/0,Hn=null,iu=!1,lh=null,jr=null,il=!1,Cr=null,ou=0,Ao=0,uh=null,Il=-1,Cl=0;function kt(){return fe&6?Ue():Il!==-1?Il:Il=Ue()}function Or(t){return t.mode&1?fe&2&&ht!==0?ht&-ht:yS.transition!==null?(Cl===0&&(Cl=Hv()),Cl):(t=xe,t!==0||(t=window.event,t=t===void 0?16:Xv(t.type)),t):1}function wn(t,e,n,r){if(50<Ao)throw Ao=0,uh=null,Error(U(185));ua(t,n,r),(!(fe&2)||t!==ot)&&(t===ot&&(!(fe&2)&&(Mu|=n),Je===4&&Er(t,ht)),Bt(t,r),n===1&&fe===0&&!(e.mode&1)&&(yi=Ue()+500,Du&&Qr()))}function Bt(t,e){var n=t.callbackNode;yb(t,e);var r=$l(t,t===ot?ht:0);if(r===0)n!==null&&Mm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Mm(n),e===1)t.tag===0?gS(Pg.bind(null,t)):g_(Pg.bind(null,t)),hS(function(){!(fe&6)&&Qr()}),n=null;else{switch(Wv(r)){case 1:n=Qh;break;case 4:n=Bv;break;case 16:n=Bl;break;case 536870912:n=$v;break;default:n=Bl}n=px(n,ax.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ax(t,e){if(Il=-1,Cl=0,fe&6)throw Error(U(327));var n=t.callbackNode;if(ii()&&t.callbackNode!==n)return null;var r=$l(t,t===ot?ht:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=au(t,r);else{e=r;var s=fe;fe|=2;var i=ux();(ot!==t||ht!==e)&&(Hn=null,yi=Ue()+500,us(t,e));do try{MS();break}catch(l){lx(t,l)}while(!0);uf(),su.current=i,fe=s,We!==null?e=0:(ot=null,ht=0,e=Je)}if(e!==0){if(e===2&&(s=Vd(t),s!==0&&(r=s,e=ch(t,s))),e===1)throw n=Xo,us(t,0),Er(t,r),Bt(t,Ue()),n;if(e===6)Er(t,r);else{if(s=t.current.alternate,!(r&30)&&!OS(s)&&(e=au(t,r),e===2&&(i=Vd(t),i!==0&&(r=i,e=ch(t,i))),e===1))throw n=Xo,us(t,0),Er(t,r),Bt(t,Ue()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:ns(t,Lt,Hn);break;case 3:if(Er(t,r),(r&130023424)===r&&(e=Sf+500-Ue(),10<e)){if($l(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){kt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Hd(ns.bind(null,t,Lt,Hn),e);break}ns(t,Lt,Hn);break;case 4:if(Er(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-xn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ue()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jS(r/1960))-r,10<r){t.timeoutHandle=Hd(ns.bind(null,t,Lt,Hn),r);break}ns(t,Lt,Hn);break;case 5:ns(t,Lt,Hn);break;default:throw Error(U(329))}}}return Bt(t,Ue()),t.callbackNode===n?ax.bind(null,t):null}function ch(t,e){var n=Co;return t.current.memoizedState.isDehydrated&&(us(t,e).flags|=256),t=au(t,e),t!==2&&(e=Lt,Lt=n,e!==null&&dh(e)),t}function dh(t){Lt===null?Lt=t:Lt.push.apply(Lt,t)}function OS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Tn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Er(t,e){for(e&=~bf,e&=~Mu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-xn(e),r=1<<n;t[n]=-1,e&=~r}}function Pg(t){if(fe&6)throw Error(U(327));ii();var e=$l(t,0);if(!(e&1))return Bt(t,Ue()),null;var n=au(t,e);if(t.tag!==0&&n===2){var r=Vd(t);r!==0&&(e=r,n=ch(t,r))}if(n===1)throw n=Xo,us(t,0),Er(t,e),Bt(t,Ue()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ns(t,Lt,Hn),Bt(t,Ue()),null}function Tf(t,e){var n=fe;fe|=1;try{return t(e)}finally{fe=n,fe===0&&(yi=Ue()+500,Du&&Qr())}}function ys(t){Cr!==null&&Cr.tag===0&&!(fe&6)&&ii();var e=fe;fe|=1;var n=on.transition,r=xe;try{if(on.transition=null,xe=1,t)return t()}finally{xe=r,on.transition=n,fe=e,!(fe&6)&&Qr()}}function If(){Kt=Xs.current,Ae(Xs)}function us(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,dS(n)),We!==null)for(n=We.return;n!==null;){var r=n;switch(of(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Kl();break;case 3:mi(),Ae(Ut),Ae(Tt),mf();break;case 5:pf(r);break;case 4:mi();break;case 13:Ae(Ne);break;case 19:Ae(Ne);break;case 10:cf(r.type._context);break;case 22:case 23:If()}n=n.return}if(ot=t,We=t=Vr(t.current,null),ht=Kt=e,Je=0,Xo=null,bf=Mu=gs=0,Lt=Co=null,is!==null){for(e=0;e<is.length;e++)if(n=is[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}is=null}return t}function lx(t,e){do{var n=We;try{if(uf(),bl.current=ru,nu){for(var r=ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}nu=!1}if(ms=0,it=Xe=ke=null,To=!1,Ko=0,Ef.current=null,n===null||n.return===null){Je=1,Xo=e,We=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=ht,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,g=h.tag;if(!(h.mode&1)&&(g===0||g===11||g===15)){var y=h.alternate;y?(h.updateQueue=y.updateQueue,h.memoizedState=y.memoizedState,h.lanes=y.lanes):(h.updateQueue=null,h.memoizedState=null)}var C=gg(o);if(C!==null){C.flags&=-257,yg(C,o,l,i,e),C.mode&1&&mg(i,d,e),e=C,u=d;var N=e.updateQueue;if(N===null){var E=new Set;E.add(u),e.updateQueue=E}else N.add(u);break e}else{if(!(e&1)){mg(i,d,e),Cf();break e}u=Error(U(426))}}else if(Re&&l.mode&1){var D=gg(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),yg(D,o,l,i,e),af(gi(u,l));break e}}i=u=gi(u,l),Je!==4&&(Je=2),Co===null?Co=[i]:Co.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=W_(i,u,e);ug(i,b);break e;case 1:l=u;var x=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(jr===null||!jr.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=q_(i,l,e);ug(i,S);break e}}i=i.return}while(i!==null)}dx(n)}catch(P){e=P,We===n&&n!==null&&(We=n=n.return);continue}break}while(!0)}function ux(){var t=su.current;return su.current=ru,t===null?ru:t}function Cf(){(Je===0||Je===3||Je===2)&&(Je=4),ot===null||!(gs&268435455)&&!(Mu&268435455)||Er(ot,ht)}function au(t,e){var n=fe;fe|=2;var r=ux();(ot!==t||ht!==e)&&(Hn=null,us(t,e));do try{VS();break}catch(s){lx(t,s)}while(!0);if(uf(),fe=n,su.current=r,We!==null)throw Error(U(261));return ot=null,ht=0,Je}function VS(){for(;We!==null;)cx(We)}function MS(){for(;We!==null&&!lb();)cx(We)}function cx(t){var e=fx(t.alternate,t,Kt);t.memoizedProps=t.pendingProps,e===null?dx(t):We=e,Ef.current=null}function dx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=RS(n,e),n!==null){n.flags&=32767,We=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Je=6,We=null;return}}else if(n=PS(n,e,Kt),n!==null){We=n;return}if(e=e.sibling,e!==null){We=e;return}We=e=t}while(e!==null);Je===0&&(Je=5)}function ns(t,e,n){var r=xe,s=on.transition;try{on.transition=null,xe=1,LS(t,e,n,r)}finally{on.transition=s,xe=r}return null}function LS(t,e,n,r){do ii();while(Cr!==null);if(fe&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(vb(t,i),t===ot&&(We=ot=null,ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||il||(il=!0,px(Bl,function(){return ii(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=on.transition,on.transition=null;var o=xe;xe=1;var l=fe;fe|=4,Ef.current=null,kS(t,n),ix(n,t),sS(Bd),Hl=!!zd,Bd=zd=null,t.current=n,DS(n),ub(),fe=l,xe=o,on.transition=i}else t.current=n;if(il&&(il=!1,Cr=t,ou=s),i=t.pendingLanes,i===0&&(jr=null),hb(n.stateNode),Bt(t,Ue()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(iu)throw iu=!1,t=lh,lh=null,t;return ou&1&&t.tag!==0&&ii(),i=t.pendingLanes,i&1?t===uh?Ao++:(Ao=0,uh=t):Ao=0,Qr(),null}function ii(){if(Cr!==null){var t=Wv(ou),e=on.transition,n=xe;try{if(on.transition=null,xe=16>t?16:t,Cr===null)var r=!1;else{if(t=Cr,Cr=null,ou=0,fe&6)throw Error(U(331));var s=fe;for(fe|=4,H=t.current;H!==null;){var i=H,o=i.child;if(H.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(H=d;H!==null;){var h=H;switch(h.tag){case 0:case 11:case 15:Io(8,h,i)}var g=h.child;if(g!==null)g.return=h,H=g;else for(;H!==null;){h=H;var y=h.sibling,C=h.return;if(nx(h),h===d){H=null;break}if(y!==null){y.return=C,H=y;break}H=C}}}var N=i.alternate;if(N!==null){var E=N.child;if(E!==null){N.child=null;do{var D=E.sibling;E.sibling=null,E=D}while(E!==null)}}H=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,H=o;else e:for(;H!==null;){if(i=H,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Io(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,H=b;break e}H=i.return}}var x=t.current;for(H=x;H!==null;){o=H;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,H=v;else e:for(o=x;H!==null;){if(l=H,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Vu(9,l)}}catch(P){Ve(l,l.return,P)}if(l===o){H=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,H=S;break e}H=l.return}}if(fe=s,Qr(),kn&&typeof kn.onPostCommitFiberRoot=="function")try{kn.onPostCommitFiberRoot(Au,t)}catch{}r=!0}return r}finally{xe=n,on.transition=e}}return!1}function Rg(t,e,n){e=gi(n,e),e=W_(t,e,1),t=Dr(t,e,1),e=kt(),t!==null&&(ua(t,1,e),Bt(t,e))}function Ve(t,e,n){if(t.tag===3)Rg(t,t,n);else for(;e!==null;){if(e.tag===3){Rg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(jr===null||!jr.has(r))){t=gi(n,t),t=q_(e,t,1),e=Dr(e,t,1),t=kt(),e!==null&&(ua(e,1,t),Bt(e,t));break}}e=e.return}}function FS(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=kt(),t.pingedLanes|=t.suspendedLanes&n,ot===t&&(ht&n)===n&&(Je===4||Je===3&&(ht&130023424)===ht&&500>Ue()-Sf?us(t,0):bf|=n),Bt(t,e)}function hx(t,e){e===0&&(t.mode&1?(e=Qa,Qa<<=1,!(Qa&130023424)&&(Qa=4194304)):e=1);var n=kt();t=rr(t,e),t!==null&&(ua(t,e,n),Bt(t,n))}function US(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),hx(t,n)}function zS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),hx(t,n)}var fx;fx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ut.current)Ft=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ft=!1,AS(t,e,n);Ft=!!(t.flags&131072)}else Ft=!1,Re&&e.flags&1048576&&y_(e,Xl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Tl(t,e),t=e.pendingProps;var s=hi(e,Tt.current);si(e,n),s=yf(null,e,r,t,s,n);var i=vf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,zt(r)?(i=!0,Ql(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,hf(e),s.updater=Ou,e.stateNode=s,s._reactInternals=e,Xd(e,r,t,n),e=eh(null,e,r,!0,i,n)):(e.tag=0,Re&&i&&sf(e),Nt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Tl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=$S(r),t=gn(r,t),s){case 0:e=Zd(null,e,r,t,n);break e;case 1:e=xg(null,e,r,t,n);break e;case 11:e=vg(null,e,r,t,n);break e;case 14:e=_g(null,e,r,gn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gn(r,s),Zd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gn(r,s),xg(t,e,r,s,n);case 3:e:{if(Y_(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,b_(t,e),eu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=gi(Error(U(423)),e),e=wg(t,e,r,n,s);break e}else if(r!==s){s=gi(Error(U(424)),e),e=wg(t,e,r,n,s);break e}else for(Qt=kr(e.stateNode.containerInfo.firstChild),Yt=e,Re=!0,vn=null,n=w_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fi(),r===s){e=sr(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return S_(e),t===null&&Kd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,$d(r,s)?o=null:i!==null&&$d(r,i)&&(e.flags|=32),Q_(t,e),Nt(t,e,o,n),e.child;case 6:return t===null&&Kd(e),null;case 13:return X_(t,e,n);case 4:return ff(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pi(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gn(r,s),vg(t,e,r,s,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Se(Jl,r._currentValue),r._currentValue=o,i!==null)if(Tn(i.value,o)){if(i.children===s.children&&!Ut.current){e=sr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Zn(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Qd(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Qd(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Nt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,si(e,n),s=ln(s),r=r(s),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,s=gn(r,e.pendingProps),s=gn(r.type,s),_g(t,e,r,s,n);case 15:return G_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gn(r,s),Tl(t,e),e.tag=1,zt(r)?(t=!0,Ql(e)):t=!1,si(e,n),H_(e,r,s),Xd(e,r,s,n),eh(null,e,r,!0,t,n);case 19:return J_(t,e,n);case 22:return K_(t,e,n)}throw Error(U(156,e.tag))};function px(t,e){return zv(t,e)}function BS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(t,e,n,r){return new BS(t,e,n,r)}function Af(t){return t=t.prototype,!(!t||!t.isReactComponent)}function $S(t){if(typeof t=="function")return Af(t)?1:0;if(t!=null){if(t=t.$$typeof,t===qh)return 11;if(t===Gh)return 14}return 2}function Vr(t,e){var n=t.alternate;return n===null?(n=sn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Al(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Af(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case zs:return cs(n.children,s,i,e);case Wh:o=8,s|=8;break;case wd:return t=sn(12,n,e,s|2),t.elementType=wd,t.lanes=i,t;case Ed:return t=sn(13,n,e,s),t.elementType=Ed,t.lanes=i,t;case bd:return t=sn(19,n,e,s),t.elementType=bd,t.lanes=i,t;case Sv:return Lu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ev:o=10;break e;case bv:o=9;break e;case qh:o=11;break e;case Gh:o=14;break e;case _r:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=sn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function cs(t,e,n,r){return t=sn(7,t,r,e),t.lanes=n,t}function Lu(t,e,n,r){return t=sn(22,t,r,e),t.elementType=Sv,t.lanes=n,t.stateNode={isHidden:!1},t}function Zc(t,e,n){return t=sn(6,t,null,e),t.lanes=n,t}function ed(t,e,n){return e=sn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function HS(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jc(0),this.expirationTimes=jc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Pf(t,e,n,r,s,i,o,l,u){return t=new HS(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=sn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hf(i),t}function WS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Us,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function mx(t){if(!t)return Br;t=t._reactInternals;e:{if(Ss(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(zt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(zt(n))return m_(t,n,e)}return e}function gx(t,e,n,r,s,i,o,l,u){return t=Pf(n,r,!0,t,s,i,o,l,u),t.context=mx(null),n=t.current,r=kt(),s=Or(n),i=Zn(r,s),i.callback=e??null,Dr(n,i,s),t.current.lanes=s,ua(t,s,r),Bt(t,r),t}function Fu(t,e,n,r){var s=e.current,i=kt(),o=Or(s);return n=mx(n),e.context===null?e.context=n:e.pendingContext=n,e=Zn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Dr(s,e,o),t!==null&&(wn(t,s,o,i),El(t,s,o)),o}function lu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ng(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Rf(t,e){Ng(t,e),(t=t.alternate)&&Ng(t,e)}function qS(){return null}var yx=typeof reportError=="function"?reportError:function(t){console.error(t)};function Nf(t){this._internalRoot=t}Uu.prototype.render=Nf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));Fu(t,e,null,null)};Uu.prototype.unmount=Nf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ys(function(){Fu(null,t,null,null)}),e[nr]=null}};function Uu(t){this._internalRoot=t}Uu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Kv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wr.length&&e!==0&&e<wr[n].priority;n++);wr.splice(n,0,t),n===0&&Yv(t)}};function kf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function zu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function kg(){}function GS(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=lu(o);i.call(d)}}var o=gx(e,r,t,0,null,!1,!1,"",kg);return t._reactRootContainer=o,t[nr]=o.current,$o(t.nodeType===8?t.parentNode:t),ys(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=lu(u);l.call(d)}}var u=Pf(t,0,!1,null,null,!1,!1,"",kg);return t._reactRootContainer=u,t[nr]=u.current,$o(t.nodeType===8?t.parentNode:t),ys(function(){Fu(e,u,n,r)}),u}function Bu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=lu(o);l.call(u)}}Fu(e,o,t,s)}else o=GS(n,e,t,s,r);return lu(o)}qv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=po(e.pendingLanes);n!==0&&(Yh(e,n|1),Bt(e,Ue()),!(fe&6)&&(yi=Ue()+500,Qr()))}break;case 13:ys(function(){var r=rr(t,1);if(r!==null){var s=kt();wn(r,t,1,s)}}),Rf(t,1)}};Xh=function(t){if(t.tag===13){var e=rr(t,134217728);if(e!==null){var n=kt();wn(e,t,134217728,n)}Rf(t,134217728)}};Gv=function(t){if(t.tag===13){var e=Or(t),n=rr(t,e);if(n!==null){var r=kt();wn(n,t,e,r)}Rf(t,e)}};Kv=function(){return xe};Qv=function(t,e){var n=xe;try{return xe=t,e()}finally{xe=n}};Dd=function(t,e,n){switch(e){case"input":if(Id(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ku(r);if(!s)throw Error(U(90));Iv(r),Id(r,s)}}}break;case"textarea":Av(t,n);break;case"select":e=n.value,e!=null&&ei(t,!!n.multiple,e,!1)}};Ov=Tf;Vv=ys;var KS={usingClientEntryPoint:!1,Events:[da,Ws,ku,Dv,jv,Tf]},io={findFiberByHostInstance:ss,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QS={bundleType:io.bundleType,version:io.version,rendererPackageName:io.rendererPackageName,rendererConfig:io.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ur.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fv(t),t===null?null:t.stateNode},findFiberByHostInstance:io.findFiberByHostInstance||qS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ol=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ol.isDisabled&&ol.supportsFiber)try{Au=ol.inject(QS),kn=ol}catch{}}Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KS;Zt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kf(e))throw Error(U(200));return WS(t,e,null,n)};Zt.createRoot=function(t,e){if(!kf(t))throw Error(U(299));var n=!1,r="",s=yx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Pf(t,1,!1,null,null,n,!1,r,s),t[nr]=e.current,$o(t.nodeType===8?t.parentNode:t),new Nf(e)};Zt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=Fv(e),t=t===null?null:t.stateNode,t};Zt.flushSync=function(t){return ys(t)};Zt.hydrate=function(t,e,n){if(!zu(e))throw Error(U(200));return Bu(null,t,e,!0,n)};Zt.hydrateRoot=function(t,e,n){if(!kf(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=yx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=gx(e,null,t,1,n??null,s,!1,i,o),t[nr]=e.current,$o(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Uu(e)};Zt.render=function(t,e,n){if(!zu(e))throw Error(U(200));return Bu(null,t,e,!1,n)};Zt.unmountComponentAtNode=function(t){if(!zu(t))throw Error(U(40));return t._reactRootContainer?(ys(function(){Bu(null,null,t,!1,function(){t._reactRootContainer=null,t[nr]=null})}),!0):!1};Zt.unstable_batchedUpdates=Tf;Zt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!zu(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return Bu(t,e,n,!1,r)};Zt.version="18.3.1-next-f1338f8080-20240426";function vx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vx)}catch(t){console.error(t)}}vx(),vv.exports=Zt;var fa=vv.exports,Dg=fa;_d.createRoot=Dg.createRoot,_d.hydrateRoot=Dg.hydrateRoot;var jg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},YS=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},xx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,g=(i&3)<<4|l>>4;let y=(l&15)<<2|d>>6,C=d&63;u||(C=64,o||(y=64)),r.push(n[h],n[g],n[y],n[C])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_x(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):YS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||g==null)throw new XS;const y=i<<2|l>>4;if(r.push(y),d!==64){const C=l<<4&240|d>>2;if(r.push(C),g!==64){const N=d<<6&192|g;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JS=function(t){const e=_x(t);return xx.encodeByteArray(e,!0)},uu=function(t){return JS(t).replace(/\./g,"")},wx=function(t){try{return xx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT=()=>ZS().__FIREBASE_DEFAULTS__,tT=()=>{if(typeof process>"u"||typeof jg>"u")return;const t=jg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},nT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&wx(t[1]);return e&&JSON.parse(e)},$u=()=>{try{return eT()||tT()||nT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ex=t=>{var e,n;return(n=(e=$u())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},rT=t=>{const e=Ex(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},bx=()=>{var t;return(t=$u())===null||t===void 0?void 0:t.config},Sx=t=>{var e;return(e=$u())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[uu(JSON.stringify(n)),uu(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(It())}function aT(){var t;const e=(t=$u())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function cT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dT(){const t=It();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function hT(){return!aT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fT(){try{return typeof indexedDB=="object"}catch{return!1}}function pT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="FirebaseError";class cr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=mT,Object.setPrototypeOf(this,cr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pa.prototype.create)}}class pa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?gT(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new cr(s,l,r)}}function gT(t,e){return t.replace(yT,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const yT=/\{\$([^}]+)}/g;function vT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function cu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Og(i)&&Og(o)){if(!cu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Og(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function _T(t,e){const n=new xT(t,e);return n.subscribe.bind(n)}class xT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");wT(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=td),s.error===void 0&&(s.error=td),s.complete===void 0&&(s.complete=td);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function td(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(t){return t&&t._delegate?t._delegate:t}class vs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new sT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ST(e))try{this.getOrInitializeService({instanceIdentifier:rs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=rs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rs){return this.instances.has(e)}getOptions(e=rs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=rs){return this.component?this.component.multipleInstances?e:rs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bT(t){return t===rs?void 0:t}function ST(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ET(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const IT={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},CT=de.INFO,AT={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},PT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=AT[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Df{constructor(e){this.name=e,this._logLevel=CT,this._logHandler=PT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?IT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}const RT=(t,e)=>e.some(n=>t instanceof n);let Vg,Mg;function NT(){return Vg||(Vg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kT(){return Mg||(Mg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tx=new WeakMap,hh=new WeakMap,Ix=new WeakMap,nd=new WeakMap,jf=new WeakMap;function DT(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Mr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Tx.set(n,t)}).catch(()=>{}),jf.set(e,t),e}function jT(t){if(hh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});hh.set(t,e)}let fh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return hh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ix.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Mr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function OT(t){fh=t(fh)}function VT(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(rd(this),e,...n);return Ix.set(r,e.sort?e.sort():[e]),Mr(r)}:kT().includes(t)?function(...e){return t.apply(rd(this),e),Mr(Tx.get(this))}:function(...e){return Mr(t.apply(rd(this),e))}}function MT(t){return typeof t=="function"?VT(t):(t instanceof IDBTransaction&&jT(t),RT(t,NT())?new Proxy(t,fh):t)}function Mr(t){if(t instanceof IDBRequest)return DT(t);if(nd.has(t))return nd.get(t);const e=MT(t);return e!==t&&(nd.set(t,e),jf.set(e,t)),e}const rd=t=>jf.get(t);function LT(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Mr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Mr(o.result),u.oldVersion,u.newVersion,Mr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const FT=["get","getKey","getAll","getAllKeys","count"],UT=["put","add","delete","clear"],sd=new Map;function Lg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(sd.get(e))return sd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=UT.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||FT.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return sd.set(e,i),i}OT(t=>({...t,get:(e,n,r)=>Lg(e,n)||t.get(e,n,r),has:(e,n)=>!!Lg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(BT(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function BT(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ph="@firebase/app",Fg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir=new Df("@firebase/app"),$T="@firebase/app-compat",HT="@firebase/analytics-compat",WT="@firebase/analytics",qT="@firebase/app-check-compat",GT="@firebase/app-check",KT="@firebase/auth",QT="@firebase/auth-compat",YT="@firebase/database",XT="@firebase/data-connect",JT="@firebase/database-compat",ZT="@firebase/functions",eI="@firebase/functions-compat",tI="@firebase/installations",nI="@firebase/installations-compat",rI="@firebase/messaging",sI="@firebase/messaging-compat",iI="@firebase/performance",oI="@firebase/performance-compat",aI="@firebase/remote-config",lI="@firebase/remote-config-compat",uI="@firebase/storage",cI="@firebase/storage-compat",dI="@firebase/firestore",hI="@firebase/vertexai-preview",fI="@firebase/firestore-compat",pI="firebase",mI="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="[DEFAULT]",gI={[ph]:"fire-core",[$T]:"fire-core-compat",[WT]:"fire-analytics",[HT]:"fire-analytics-compat",[GT]:"fire-app-check",[qT]:"fire-app-check-compat",[KT]:"fire-auth",[QT]:"fire-auth-compat",[YT]:"fire-rtdb",[XT]:"fire-data-connect",[JT]:"fire-rtdb-compat",[ZT]:"fire-fn",[eI]:"fire-fn-compat",[tI]:"fire-iid",[nI]:"fire-iid-compat",[rI]:"fire-fcm",[sI]:"fire-fcm-compat",[iI]:"fire-perf",[oI]:"fire-perf-compat",[aI]:"fire-rc",[lI]:"fire-rc-compat",[uI]:"fire-gcs",[cI]:"fire-gcs-compat",[dI]:"fire-fst",[fI]:"fire-fst-compat",[hI]:"fire-vertex","fire-js":"fire-js",[pI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const du=new Map,yI=new Map,gh=new Map;function Ug(t,e){try{t.container.addComponent(e)}catch(n){ir.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function vi(t){const e=t.name;if(gh.has(e))return ir.debug(`There were multiple attempts to register component ${e}.`),!1;gh.set(e,t);for(const n of du.values())Ug(n,t);for(const n of yI.values())Ug(n,t);return!0}function Of(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lr=new pa("app","Firebase",vI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=mI;function Cx(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:mh,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Lr.create("bad-app-name",{appName:String(s)});if(n||(n=bx()),!n)throw Lr.create("no-options");const i=du.get(s);if(i){if(cu(n,i.options)&&cu(r,i.config))return i;throw Lr.create("duplicate-app",{appName:s})}const o=new TT(s);for(const u of gh.values())o.addComponent(u);const l=new _I(n,r,o);return du.set(s,l),l}function Ax(t=mh){const e=du.get(t);if(!e&&t===mh&&bx())return Cx();if(!e)throw Lr.create("no-app",{appName:t});return e}function Fr(t,e,n){var r;let s=(r=gI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ir.warn(l.join(" "));return}vi(new vs(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="firebase-heartbeat-database",wI=1,Jo="firebase-heartbeat-store";let id=null;function Px(){return id||(id=LT(xI,wI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Jo)}catch(n){console.warn(n)}}}}).catch(t=>{throw Lr.create("idb-open",{originalErrorMessage:t.message})})),id}async function EI(t){try{const n=(await Px()).transaction(Jo),r=await n.objectStore(Jo).get(Rx(t));return await n.done,r}catch(e){if(e instanceof cr)ir.warn(e.message);else{const n=Lr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ir.warn(n.message)}}}async function zg(t,e){try{const r=(await Px()).transaction(Jo,"readwrite");await r.objectStore(Jo).put(e,Rx(t)),await r.done}catch(n){if(n instanceof cr)ir.warn(n.message);else{const r=Lr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ir.warn(r.message)}}}function Rx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI=1024,SI=30*24*60*60*1e3;class TI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new CI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Bg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=SI}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ir.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Bg(),{heartbeatsToSend:r,unsentEntries:s}=II(this._heartbeatsCache.heartbeats),i=uu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ir.warn(n),""}}}function Bg(){return new Date().toISOString().substring(0,10)}function II(t,e=bI){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),$g(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),$g(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class CI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fT()?pT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await EI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return zg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return zg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function $g(t){return uu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AI(t){vi(new vs("platform-logger",e=>new zT(e),"PRIVATE")),vi(new vs("heartbeat",e=>new TI(e),"PRIVATE")),Fr(ph,Fg,t),Fr(ph,Fg,"esm2017"),Fr("fire-js","")}AI("");function Vf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Nx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const PI=Nx,kx=new pa("auth","Firebase",Nx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu=new Df("@firebase/auth");function RI(t,...e){hu.logLevel<=de.WARN&&hu.warn(`Auth (${Ri}): ${t}`,...e)}function Pl(t,...e){hu.logLevel<=de.ERROR&&hu.error(`Auth (${Ri}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(t,...e){throw Lf(t,...e)}function En(t,...e){return Lf(t,...e)}function Mf(t,e,n){const r=Object.assign(Object.assign({},PI()),{[e]:n});return new pa("auth","Firebase",r).create(e,{appName:t.name})}function ds(t){return Mf(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function NI(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Mn(t,"argument-error"),Mf(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Lf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return kx.create(t,...e)}function ee(t,e,...n){if(!t)throw Lf(e,...n)}function Yn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Pl(e),new Error(e)}function or(t,e){t||Yn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function kI(){return Hg()==="http:"||Hg()==="https:"}function Hg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kI()||uT()||"connection"in navigator)?navigator.onLine:!0}function jI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,n){this.shortDelay=e,this.longDelay=n,or(n>e,"Short delay should be less than long delay!"),this.isMobile=oT()||cT()}get(){return DI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ff(t,e){or(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI=new ga(3e4,6e4);function Uf(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ni(t,e,n,r,s={}){return jx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=ma(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return lT()||(d.referrerPolicy="no-referrer"),Dx.fetch()(Ox(t,t.config.apiHost,n,l),d)})}async function jx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},OI),e);try{const s=new LI(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw al(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw al(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw al(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw al(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Mf(t,h,d);Mn(t,h)}}catch(s){if(s instanceof cr)throw s;Mn(t,"network-request-failed",{message:String(s)})}}async function MI(t,e,n,r,s={}){const i=await Ni(t,e,n,r,s);return"mfaPendingCredential"in i&&Mn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Ox(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Ff(t.config,s):`${t.config.apiScheme}://${s}`}class LI{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(En(this.auth,"network-request-failed")),VI.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function al(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=En(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FI(t,e){return Ni(t,"POST","/v1/accounts:delete",e)}async function Vx(t,e){return Ni(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UI(t,e=!1){const n=jt(t),r=await n.getIdToken(e),s=zf(r);ee(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Po(od(s.auth_time)),issuedAtTime:Po(od(s.iat)),expirationTime:Po(od(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function od(t){return Number(t)*1e3}function zf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Pl("JWT malformed, contained fewer than 3 sections"),null;try{const s=wx(n);return s?JSON.parse(s):(Pl("Failed to decode base64 JWT payload"),null)}catch(s){return Pl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Wg(t){const e=zf(t);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof cr&&zI(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function zI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Po(this.lastLoginAt),this.creationTime=Po(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Zo(t,Vx(n,{idToken:r}));ee(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Mx(i.providerUserInfo):[],l=HI(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=u?d:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new vh(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,g)}async function $I(t){const e=jt(t);await fu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function HI(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Mx(t){return t.map(e=>{var{providerId:n}=e,r=Vf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WI(t,e){const n=await jx(t,{},async()=>{const r=ma({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=Ox(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Dx.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function qI(t,e){return Ni(t,"POST","/v2/accounts:revokeToken",Uf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const n=Wg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await WI(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new oi;return r&&(ee(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ee(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ee(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new oi,this.toJSON())}_performRefresh(){return Yn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(t,e){ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Vf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new BI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new vh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Zo(this,this.stsTokenManager.getToken(this.auth,e));return ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return UI(this,e)}reload(){return $I(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Xn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await fu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qn(this.auth.app))return Promise.reject(ds(this.auth));const e=await this.getIdToken();return await Zo(this,FI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,u,d,h;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(s=n.email)!==null&&s!==void 0?s:void 0,C=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,N=(o=n.photoURL)!==null&&o!==void 0?o:void 0,E=(l=n.tenantId)!==null&&l!==void 0?l:void 0,D=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,b=(d=n.createdAt)!==null&&d!==void 0?d:void 0,x=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:v,emailVerified:S,isAnonymous:P,providerData:A,stsTokenManager:_}=n;ee(v&&_,e,"internal-error");const p=oi.fromJSON(this.name,_);ee(typeof v=="string",e,"internal-error"),gr(g,e.name),gr(y,e.name),ee(typeof S=="boolean",e,"internal-error"),ee(typeof P=="boolean",e,"internal-error"),gr(C,e.name),gr(N,e.name),gr(E,e.name),gr(D,e.name),gr(b,e.name),gr(x,e.name);const w=new Xn({uid:v,auth:e,email:y,emailVerified:S,displayName:g,isAnonymous:P,photoURL:N,phoneNumber:C,tenantId:E,stsTokenManager:p,createdAt:b,lastLoginAt:x});return A&&Array.isArray(A)&&(w.providerData=A.map(I=>Object.assign({},I))),D&&(w._redirectEventId=D),w}static async _fromIdTokenResponse(e,n,r=!1){const s=new oi;s.updateFromServerResponse(n);const i=new Xn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await fu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ee(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Mx(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new oi;l.updateFromIdToken(r);const u=new Xn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new vh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qg=new Map;function Jn(t){or(t instanceof Function,"Expected a class definition");let e=qg.get(t);return e?(or(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,qg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Lx.type="NONE";const Gg=Lx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(t,e,n){return`firebase:${t}:${e}:${n}`}class ai{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Rl(this.userKey,s.apiKey,i),this.fullPersistenceKey=Rl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ai(Jn(Gg),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Jn(Gg);const o=Rl(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){const g=Xn._fromJSON(e,h);d!==i&&(l=g),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new ai(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new ai(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Bx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Fx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Hx(e))return"Blackberry";if(Wx(e))return"Webos";if(Ux(e))return"Safari";if((e.includes("chrome/")||zx(e))&&!e.includes("edge/"))return"Chrome";if($x(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Fx(t=It()){return/firefox\//i.test(t)}function Ux(t=It()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zx(t=It()){return/crios\//i.test(t)}function Bx(t=It()){return/iemobile/i.test(t)}function $x(t=It()){return/android/i.test(t)}function Hx(t=It()){return/blackberry/i.test(t)}function Wx(t=It()){return/webos/i.test(t)}function Bf(t=It()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function GI(t=It()){var e;return Bf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function KI(){return dT()&&document.documentMode===10}function qx(t=It()){return Bf(t)||$x(t)||Wx(t)||Hx(t)||/windows phone/i.test(t)||Bx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gx(t,e=[]){let n;switch(t){case"Browser":n=Kg(It());break;case"Worker":n=`${Kg(It())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ri}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YI(t,e={}){return Ni(t,"GET","/v2/passwordPolicy",Uf(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI=6;class JI{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:XI,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Qg(this),this.idTokenSubscription=new Qg(this),this.beforeStateQueue=new QI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=kx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Jn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ai.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Vx(this,{idToken:e}),r=await Xn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Qn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await fu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=jI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qn(this.app))return Promise.reject(ds(this));const n=e?jt(e):null;return n&&ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qn(this.app)?Promise.reject(ds(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qn(this.app)?Promise.reject(ds(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YI(this),n=new JI(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new pa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await qI(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Jn(e)||this._popupRedirectResolver;ee(n,this,"argument-error"),this.redirectPersistenceManager=await ai.create(this,[Jn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Gx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&RI(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Hu(t){return jt(t)}class Qg{constructor(e){this.auth=e,this.observer=null,this.addObserver=_T(n=>this.observer=n)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $f={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eC(t){$f=t}function tC(t){return $f.loadJS(t)}function nC(){return $f.gapiScript}function rC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t,e){const n=Of(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(cu(i,e??{}))return s;Mn(s,"already-initialized")}return n.initialize({options:e})}function iC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Jn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function oC(t,e,n){const r=Hu(t);ee(r._canInitEmulator,r,"emulator-config-failed"),ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Kx(e),{host:o,port:l}=aC(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),lC()}function Kx(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function aC(t){const e=Kx(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Yg(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Yg(o)}}}function Yg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function lC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Yn("not implemented")}_getIdTokenResponse(e){return Yn("not implemented")}_linkToIdToken(e,n){return Yn("not implemented")}_getReauthenticationResolver(e){return Yn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function li(t,e){return MI(t,"POST","/v1/accounts:signInWithIdp",Uf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="http://localhost";class _s extends Qx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new _s(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Mn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Vf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new _s(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return li(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,li(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,li(e,n)}buildRequest(){const e={requestUri:uC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ma(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends Hf{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends ya{constructor(){super("facebook.com")}static credential(e){return _s._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return br.credential(e.oauthAccessToken)}catch{return null}}}br.FACEBOOK_SIGN_IN_METHOD="facebook.com";br.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn extends ya{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return _s._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return qn.credential(n,r)}catch{return null}}}qn.GOOGLE_SIGN_IN_METHOD="google.com";qn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr extends ya{constructor(){super("github.com")}static credential(e){return _s._fromParams({providerId:Sr.PROVIDER_ID,signInMethod:Sr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sr.credentialFromTaggedObject(e)}static credentialFromError(e){return Sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sr.credential(e.oauthAccessToken)}catch{return null}}}Sr.GITHUB_SIGN_IN_METHOD="github.com";Sr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr extends ya{constructor(){super("twitter.com")}static credential(e,n){return _s._fromParams({providerId:Tr.PROVIDER_ID,signInMethod:Tr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Tr.credentialFromTaggedObject(e)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Tr.credential(n,r)}catch{return null}}}Tr.TWITTER_SIGN_IN_METHOD="twitter.com";Tr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Xn._fromIdTokenResponse(e,r,s),o=Xg(r);return new _i({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Xg(r);return new _i({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Xg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu extends cr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,pu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new pu(e,n,r,s)}}function Yx(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?pu._fromErrorAndOperation(t,i,e,r):i})}async function cC(t,e,n=!1){const r=await Zo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _i._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dC(t,e,n=!1){const{auth:r}=t;if(Qn(r.app))return Promise.reject(ds(r));const s="reauthenticate";try{const i=await Zo(t,Yx(r,s,e,t),n);ee(i.idToken,r,"internal-error");const o=zf(i.idToken);ee(o,r,"internal-error");const{sub:l}=o;return ee(t.uid===l,r,"user-mismatch"),_i._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Mn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hC(t,e,n=!1){if(Qn(t.app))return Promise.reject(ds(t));const r="signIn",s=await Yx(t,r,e),i=await _i._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function fC(t,e,n,r){return jt(t).onIdTokenChanged(e,n,r)}function pC(t,e,n){return jt(t).beforeAuthStateChanged(e,n)}function mC(t,e,n,r){return jt(t).onAuthStateChanged(e,n,r)}function gC(t){return jt(t).signOut()}const mu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(mu,"1"),this.storage.removeItem(mu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=1e3,vC=10;class Jx extends Xx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);KI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,vC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},yC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Jx.type="LOCAL";const _C=Jx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx extends Xx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Zx.type="SESSION";const e0=Zx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Wu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),u=await xC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=Wf("",20);s.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const y=g;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(y.data.response);break;default:clearTimeout(h),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(){return window}function EC(t){jn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(){return typeof jn().WorkerGlobalScope<"u"&&typeof jn().importScripts=="function"}async function bC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function SC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function TC(){return t0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="firebaseLocalStorageDb",IC=1,gu="firebaseLocalStorage",r0="fbase_key";class va{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function qu(t,e){return t.transaction([gu],e?"readwrite":"readonly").objectStore(gu)}function CC(){const t=indexedDB.deleteDatabase(n0);return new va(t).toPromise()}function _h(){const t=indexedDB.open(n0,IC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(gu,{keyPath:r0})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(gu)?e(r):(r.close(),await CC(),e(await _h()))})})}async function Jg(t,e,n){const r=qu(t,!0).put({[r0]:e,value:n});return new va(r).toPromise()}async function AC(t,e){const n=qu(t,!1).get(e),r=await new va(n).toPromise();return r===void 0?null:r.value}function Zg(t,e){const n=qu(t,!0).delete(e);return new va(n).toPromise()}const PC=800,RC=3;class s0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _h(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>RC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return t0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wu._getInstance(TC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await bC(),!this.activeServiceWorker)return;this.sender=new wC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||SC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _h();return await Jg(e,mu,"1"),await Zg(e,mu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>AC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Zg(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=qu(s,!1).getAll();return new va(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}s0.type="LOCAL";const NC=s0;new ga(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i0(t,e){return e?Jn(e):(ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf extends Qx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return li(e,this._buildIdpRequest())}_linkToIdToken(e,n){return li(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return li(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function kC(t){return hC(t.auth,new qf(t),t.bypassAuthState)}function DC(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),dC(n,new qf(t),t.bypassAuthState)}async function jC(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),cC(n,new qf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kC;case"linkViaPopup":case"linkViaRedirect":return jC;case"reauthViaPopup":case"reauthViaRedirect":return DC;default:Mn(this.auth,"internal-error")}}resolve(e){or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=new ga(2e3,1e4);async function VC(t,e,n){if(Qn(t.app))return Promise.reject(En(t,"operation-not-supported-in-this-environment"));const r=Hu(t);NI(t,e,Hf);const s=i0(r,n);return new as(r,"signInViaPopup",e,s).executeNotNull()}class as extends o0{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,as.currentPopupAction&&as.currentPopupAction.cancel(),as.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){or(this.filter.length===1,"Popup operations only handle one event");const e=Wf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(En(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(En(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,as.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(En(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,OC.get())};e()}}as.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC="pendingRedirect",Nl=new Map;class LC extends o0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Nl.get(this.auth._key());if(!e){try{const r=await FC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Nl.set(this.auth._key(),e)}return this.bypassAuthState||Nl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function FC(t,e){const n=BC(e),r=zC(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function UC(t,e){Nl.set(t._key(),e)}function zC(t){return Jn(t._redirectPersistence)}function BC(t){return Rl(MC,t.config.apiKey,t.name)}async function $C(t,e,n=!1){if(Qn(t.app))return Promise.reject(ds(t));const r=Hu(t),s=i0(r,e),o=await new LC(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC=10*60*1e3;class WC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!a0(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(En(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=HC&&this.cachedEventUids.clear(),this.cachedEventUids.has(ey(e))}saveEventToCache(e){this.cachedEventUids.add(ey(e)),this.lastProcessedEventTime=Date.now()}}function ey(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function a0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qC(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return a0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GC(t,e={}){return Ni(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,QC=/^https?/;async function YC(t){if(t.config.emulator)return;const{authorizedDomains:e}=await GC(t);for(const n of e)try{if(XC(n))return}catch{}Mn(t,"unauthorized-domain")}function XC(t){const e=yh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!QC.test(n))return!1;if(KC.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC=new ga(3e4,6e4);function ty(){const t=jn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function ZC(t){return new Promise((e,n)=>{var r,s,i;function o(){ty(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ty(),n(En(t,"network-request-failed"))},timeout:JC.get()})}if(!((s=(r=jn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=jn().gapi)===null||i===void 0)&&i.load)o();else{const l=rC("iframefcb");return jn()[l]=()=>{gapi.load?o():n(En(t,"network-request-failed"))},tC(`${nC()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw kl=null,e})}let kl=null;function eA(t){return kl=kl||ZC(t),kl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA=new ga(5e3,15e3),nA="__/auth/iframe",rA="emulator/auth/iframe",sA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oA(t){const e=t.config;ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ff(e,rA):`https://${t.config.authDomain}/${nA}`,r={apiKey:e.apiKey,appName:t.name,v:Ri},s=iA.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ma(r).slice(1)}`}async function aA(t){const e=await eA(t),n=jn().gapi;return ee(n,t,"internal-error"),e.open({where:document.body,url:oA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sA,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=En(t,"network-request-failed"),l=jn().setTimeout(()=>{i(o)},tA.get());function u(){jn().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uA=500,cA=600,dA="_blank",hA="http://localhost";class ny{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function fA(t,e,n,r=uA,s=cA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},lA),{width:r.toString(),height:s.toString(),top:i,left:o}),d=It().toLowerCase();n&&(l=zx(d)?dA:n),Fx(d)&&(e=e||hA,u.scrollbars="yes");const h=Object.entries(u).reduce((y,[C,N])=>`${y}${C}=${N},`,"");if(GI(d)&&l!=="_self")return pA(e||"",l),new ny(null);const g=window.open(e||"",l,h);ee(g,t,"popup-blocked");try{g.focus()}catch{}return new ny(g)}function pA(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="__/auth/handler",gA="emulator/auth/handler",yA=encodeURIComponent("fac");async function ry(t,e,n,r,s,i){ee(t.config.authDomain,t,"auth-domain-config-required"),ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ri,eventId:s};if(e instanceof Hf){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",vT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,g]of Object.entries({}))o[h]=g}if(e instanceof ya){const h=e.getScopes().filter(g=>g!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const u=await t._getAppCheckToken(),d=u?`#${yA}=${encodeURIComponent(u)}`:"";return`${vA(t)}?${ma(l).slice(1)}${d}`}function vA({config:t}){return t.emulator?Ff(t,gA):`https://${t.authDomain}/${mA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad="webStorageSupport";class _A{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=e0,this._completeRedirectFn=$C,this._overrideRedirectResult=UC}async _openPopup(e,n,r,s){var i;or((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await ry(e,n,r,yh(),s);return fA(e,o,Wf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await ry(e,n,r,yh(),s);return EC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(or(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await aA(e),r=new WC(e);return n.register("authEvent",s=>(ee(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ad,{type:ad},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[ad];o!==void 0&&n(!!o),Mn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=YC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return qx()||Ux()||Bf()}}const xA=_A;var sy="@firebase/auth",iy="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bA(t){vi(new vs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ee(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Gx(t)},d=new ZI(r,s,i,u);return iC(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),vi(new vs("auth-internal",e=>{const n=Hu(e.getProvider("auth").getImmediate());return(r=>new wA(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fr(sy,iy,EA(t)),Fr(sy,iy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=5*60,TA=Sx("authIdTokenMaxAge")||SA;let oy=null;const IA=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>TA)return;const s=n==null?void 0:n.token;oy!==s&&(oy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function CA(t=Ax()){const e=Of(t,"auth");if(e.isInitialized())return e.getImmediate();const n=sC(t,{popupRedirectResolver:xA,persistence:[NC,_C,e0]}),r=Sx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=IA(i.toString());pC(n,o,()=>o(n.currentUser)),fC(n,l=>o(l))}}const s=Ex("auth");return s&&oC(n,`http://${s}`),n}function AA(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}eC({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=En("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",AA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bA("Browser");var PA="firebase",RA="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fr(PA,RA,"app");var ay=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hs,l0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,p){function w(){}w.prototype=p.prototype,_.D=p.prototype,_.prototype=new w,_.prototype.constructor=_,_.C=function(I,k,j){for(var R=Array(arguments.length-2),q=2;q<arguments.length;q++)R[q-2]=arguments[q];return p.prototype[k].apply(I,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,p,w){w||(w=0);var I=Array(16);if(typeof p=="string")for(var k=0;16>k;++k)I[k]=p.charCodeAt(w++)|p.charCodeAt(w++)<<8|p.charCodeAt(w++)<<16|p.charCodeAt(w++)<<24;else for(k=0;16>k;++k)I[k]=p[w++]|p[w++]<<8|p[w++]<<16|p[w++]<<24;p=_.g[0],w=_.g[1],k=_.g[2];var j=_.g[3],R=p+(j^w&(k^j))+I[0]+3614090360&4294967295;p=w+(R<<7&4294967295|R>>>25),R=j+(k^p&(w^k))+I[1]+3905402710&4294967295,j=p+(R<<12&4294967295|R>>>20),R=k+(w^j&(p^w))+I[2]+606105819&4294967295,k=j+(R<<17&4294967295|R>>>15),R=w+(p^k&(j^p))+I[3]+3250441966&4294967295,w=k+(R<<22&4294967295|R>>>10),R=p+(j^w&(k^j))+I[4]+4118548399&4294967295,p=w+(R<<7&4294967295|R>>>25),R=j+(k^p&(w^k))+I[5]+1200080426&4294967295,j=p+(R<<12&4294967295|R>>>20),R=k+(w^j&(p^w))+I[6]+2821735955&4294967295,k=j+(R<<17&4294967295|R>>>15),R=w+(p^k&(j^p))+I[7]+4249261313&4294967295,w=k+(R<<22&4294967295|R>>>10),R=p+(j^w&(k^j))+I[8]+1770035416&4294967295,p=w+(R<<7&4294967295|R>>>25),R=j+(k^p&(w^k))+I[9]+2336552879&4294967295,j=p+(R<<12&4294967295|R>>>20),R=k+(w^j&(p^w))+I[10]+4294925233&4294967295,k=j+(R<<17&4294967295|R>>>15),R=w+(p^k&(j^p))+I[11]+2304563134&4294967295,w=k+(R<<22&4294967295|R>>>10),R=p+(j^w&(k^j))+I[12]+1804603682&4294967295,p=w+(R<<7&4294967295|R>>>25),R=j+(k^p&(w^k))+I[13]+4254626195&4294967295,j=p+(R<<12&4294967295|R>>>20),R=k+(w^j&(p^w))+I[14]+2792965006&4294967295,k=j+(R<<17&4294967295|R>>>15),R=w+(p^k&(j^p))+I[15]+1236535329&4294967295,w=k+(R<<22&4294967295|R>>>10),R=p+(k^j&(w^k))+I[1]+4129170786&4294967295,p=w+(R<<5&4294967295|R>>>27),R=j+(w^k&(p^w))+I[6]+3225465664&4294967295,j=p+(R<<9&4294967295|R>>>23),R=k+(p^w&(j^p))+I[11]+643717713&4294967295,k=j+(R<<14&4294967295|R>>>18),R=w+(j^p&(k^j))+I[0]+3921069994&4294967295,w=k+(R<<20&4294967295|R>>>12),R=p+(k^j&(w^k))+I[5]+3593408605&4294967295,p=w+(R<<5&4294967295|R>>>27),R=j+(w^k&(p^w))+I[10]+38016083&4294967295,j=p+(R<<9&4294967295|R>>>23),R=k+(p^w&(j^p))+I[15]+3634488961&4294967295,k=j+(R<<14&4294967295|R>>>18),R=w+(j^p&(k^j))+I[4]+3889429448&4294967295,w=k+(R<<20&4294967295|R>>>12),R=p+(k^j&(w^k))+I[9]+568446438&4294967295,p=w+(R<<5&4294967295|R>>>27),R=j+(w^k&(p^w))+I[14]+3275163606&4294967295,j=p+(R<<9&4294967295|R>>>23),R=k+(p^w&(j^p))+I[3]+4107603335&4294967295,k=j+(R<<14&4294967295|R>>>18),R=w+(j^p&(k^j))+I[8]+1163531501&4294967295,w=k+(R<<20&4294967295|R>>>12),R=p+(k^j&(w^k))+I[13]+2850285829&4294967295,p=w+(R<<5&4294967295|R>>>27),R=j+(w^k&(p^w))+I[2]+4243563512&4294967295,j=p+(R<<9&4294967295|R>>>23),R=k+(p^w&(j^p))+I[7]+1735328473&4294967295,k=j+(R<<14&4294967295|R>>>18),R=w+(j^p&(k^j))+I[12]+2368359562&4294967295,w=k+(R<<20&4294967295|R>>>12),R=p+(w^k^j)+I[5]+4294588738&4294967295,p=w+(R<<4&4294967295|R>>>28),R=j+(p^w^k)+I[8]+2272392833&4294967295,j=p+(R<<11&4294967295|R>>>21),R=k+(j^p^w)+I[11]+1839030562&4294967295,k=j+(R<<16&4294967295|R>>>16),R=w+(k^j^p)+I[14]+4259657740&4294967295,w=k+(R<<23&4294967295|R>>>9),R=p+(w^k^j)+I[1]+2763975236&4294967295,p=w+(R<<4&4294967295|R>>>28),R=j+(p^w^k)+I[4]+1272893353&4294967295,j=p+(R<<11&4294967295|R>>>21),R=k+(j^p^w)+I[7]+4139469664&4294967295,k=j+(R<<16&4294967295|R>>>16),R=w+(k^j^p)+I[10]+3200236656&4294967295,w=k+(R<<23&4294967295|R>>>9),R=p+(w^k^j)+I[13]+681279174&4294967295,p=w+(R<<4&4294967295|R>>>28),R=j+(p^w^k)+I[0]+3936430074&4294967295,j=p+(R<<11&4294967295|R>>>21),R=k+(j^p^w)+I[3]+3572445317&4294967295,k=j+(R<<16&4294967295|R>>>16),R=w+(k^j^p)+I[6]+76029189&4294967295,w=k+(R<<23&4294967295|R>>>9),R=p+(w^k^j)+I[9]+3654602809&4294967295,p=w+(R<<4&4294967295|R>>>28),R=j+(p^w^k)+I[12]+3873151461&4294967295,j=p+(R<<11&4294967295|R>>>21),R=k+(j^p^w)+I[15]+530742520&4294967295,k=j+(R<<16&4294967295|R>>>16),R=w+(k^j^p)+I[2]+3299628645&4294967295,w=k+(R<<23&4294967295|R>>>9),R=p+(k^(w|~j))+I[0]+4096336452&4294967295,p=w+(R<<6&4294967295|R>>>26),R=j+(w^(p|~k))+I[7]+1126891415&4294967295,j=p+(R<<10&4294967295|R>>>22),R=k+(p^(j|~w))+I[14]+2878612391&4294967295,k=j+(R<<15&4294967295|R>>>17),R=w+(j^(k|~p))+I[5]+4237533241&4294967295,w=k+(R<<21&4294967295|R>>>11),R=p+(k^(w|~j))+I[12]+1700485571&4294967295,p=w+(R<<6&4294967295|R>>>26),R=j+(w^(p|~k))+I[3]+2399980690&4294967295,j=p+(R<<10&4294967295|R>>>22),R=k+(p^(j|~w))+I[10]+4293915773&4294967295,k=j+(R<<15&4294967295|R>>>17),R=w+(j^(k|~p))+I[1]+2240044497&4294967295,w=k+(R<<21&4294967295|R>>>11),R=p+(k^(w|~j))+I[8]+1873313359&4294967295,p=w+(R<<6&4294967295|R>>>26),R=j+(w^(p|~k))+I[15]+4264355552&4294967295,j=p+(R<<10&4294967295|R>>>22),R=k+(p^(j|~w))+I[6]+2734768916&4294967295,k=j+(R<<15&4294967295|R>>>17),R=w+(j^(k|~p))+I[13]+1309151649&4294967295,w=k+(R<<21&4294967295|R>>>11),R=p+(k^(w|~j))+I[4]+4149444226&4294967295,p=w+(R<<6&4294967295|R>>>26),R=j+(w^(p|~k))+I[11]+3174756917&4294967295,j=p+(R<<10&4294967295|R>>>22),R=k+(p^(j|~w))+I[2]+718787259&4294967295,k=j+(R<<15&4294967295|R>>>17),R=w+(j^(k|~p))+I[9]+3951481745&4294967295,_.g[0]=_.g[0]+p&4294967295,_.g[1]=_.g[1]+(k+(R<<21&4294967295|R>>>11))&4294967295,_.g[2]=_.g[2]+k&4294967295,_.g[3]=_.g[3]+j&4294967295}r.prototype.u=function(_,p){p===void 0&&(p=_.length);for(var w=p-this.blockSize,I=this.B,k=this.h,j=0;j<p;){if(k==0)for(;j<=w;)s(this,_,j),j+=this.blockSize;if(typeof _=="string"){for(;j<p;)if(I[k++]=_.charCodeAt(j++),k==this.blockSize){s(this,I),k=0;break}}else for(;j<p;)if(I[k++]=_[j++],k==this.blockSize){s(this,I),k=0;break}}this.h=k,this.o+=p},r.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var p=1;p<_.length-8;++p)_[p]=0;var w=8*this.o;for(p=_.length-8;p<_.length;++p)_[p]=w&255,w/=256;for(this.u(_),_=Array(16),p=w=0;4>p;++p)for(var I=0;32>I;I+=8)_[w++]=this.g[p]>>>I&255;return _};function i(_,p){var w=l;return Object.prototype.hasOwnProperty.call(w,_)?w[_]:w[_]=p(_)}function o(_,p){this.h=p;for(var w=[],I=!0,k=_.length-1;0<=k;k--){var j=_[k]|0;I&&j==p||(w[k]=j,I=!1)}this.g=w}var l={};function u(_){return-128<=_&&128>_?i(_,function(p){return new o([p|0],0>p?-1:0)}):new o([_|0],0>_?-1:0)}function d(_){if(isNaN(_)||!isFinite(_))return g;if(0>_)return D(d(-_));for(var p=[],w=1,I=0;_>=w;I++)p[I]=_/w|0,w*=4294967296;return new o(p,0)}function h(_,p){if(_.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(_.charAt(0)=="-")return D(h(_.substring(1),p));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=d(Math.pow(p,8)),I=g,k=0;k<_.length;k+=8){var j=Math.min(8,_.length-k),R=parseInt(_.substring(k,k+j),p);8>j?(j=d(Math.pow(p,j)),I=I.j(j).add(d(R))):(I=I.j(w),I=I.add(d(R)))}return I}var g=u(0),y=u(1),C=u(16777216);t=o.prototype,t.m=function(){if(E(this))return-D(this).m();for(var _=0,p=1,w=0;w<this.g.length;w++){var I=this.i(w);_+=(0<=I?I:4294967296+I)*p,p*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(N(this))return"0";if(E(this))return"-"+D(this).toString(_);for(var p=d(Math.pow(_,6)),w=this,I="";;){var k=S(w,p).g;w=b(w,k.j(p));var j=((0<w.g.length?w.g[0]:w.h)>>>0).toString(_);if(w=k,N(w))return j+I;for(;6>j.length;)j="0"+j;I=j+I}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function N(_){if(_.h!=0)return!1;for(var p=0;p<_.g.length;p++)if(_.g[p]!=0)return!1;return!0}function E(_){return _.h==-1}t.l=function(_){return _=b(this,_),E(_)?-1:N(_)?0:1};function D(_){for(var p=_.g.length,w=[],I=0;I<p;I++)w[I]=~_.g[I];return new o(w,~_.h).add(y)}t.abs=function(){return E(this)?D(this):this},t.add=function(_){for(var p=Math.max(this.g.length,_.g.length),w=[],I=0,k=0;k<=p;k++){var j=I+(this.i(k)&65535)+(_.i(k)&65535),R=(j>>>16)+(this.i(k)>>>16)+(_.i(k)>>>16);I=R>>>16,j&=65535,R&=65535,w[k]=R<<16|j}return new o(w,w[w.length-1]&-2147483648?-1:0)};function b(_,p){return _.add(D(p))}t.j=function(_){if(N(this)||N(_))return g;if(E(this))return E(_)?D(this).j(D(_)):D(D(this).j(_));if(E(_))return D(this.j(D(_)));if(0>this.l(C)&&0>_.l(C))return d(this.m()*_.m());for(var p=this.g.length+_.g.length,w=[],I=0;I<2*p;I++)w[I]=0;for(I=0;I<this.g.length;I++)for(var k=0;k<_.g.length;k++){var j=this.i(I)>>>16,R=this.i(I)&65535,q=_.i(k)>>>16,ne=_.i(k)&65535;w[2*I+2*k]+=R*ne,x(w,2*I+2*k),w[2*I+2*k+1]+=j*ne,x(w,2*I+2*k+1),w[2*I+2*k+1]+=R*q,x(w,2*I+2*k+1),w[2*I+2*k+2]+=j*q,x(w,2*I+2*k+2)}for(I=0;I<p;I++)w[I]=w[2*I+1]<<16|w[2*I];for(I=p;I<2*p;I++)w[I]=0;return new o(w,0)};function x(_,p){for(;(_[p]&65535)!=_[p];)_[p+1]+=_[p]>>>16,_[p]&=65535,p++}function v(_,p){this.g=_,this.h=p}function S(_,p){if(N(p))throw Error("division by zero");if(N(_))return new v(g,g);if(E(_))return p=S(D(_),p),new v(D(p.g),D(p.h));if(E(p))return p=S(_,D(p)),new v(D(p.g),p.h);if(30<_.g.length){if(E(_)||E(p))throw Error("slowDivide_ only works with positive integers.");for(var w=y,I=p;0>=I.l(_);)w=P(w),I=P(I);var k=A(w,1),j=A(I,1);for(I=A(I,2),w=A(w,2);!N(I);){var R=j.add(I);0>=R.l(_)&&(k=k.add(w),j=R),I=A(I,1),w=A(w,1)}return p=b(_,k.j(p)),new v(k,p)}for(k=g;0<=_.l(p);){for(w=Math.max(1,Math.floor(_.m()/p.m())),I=Math.ceil(Math.log(w)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),j=d(w),R=j.j(p);E(R)||0<R.l(_);)w-=I,j=d(w),R=j.j(p);N(j)&&(j=y),k=k.add(j),_=b(_,R)}return new v(k,_)}t.A=function(_){return S(this,_).h},t.and=function(_){for(var p=Math.max(this.g.length,_.g.length),w=[],I=0;I<p;I++)w[I]=this.i(I)&_.i(I);return new o(w,this.h&_.h)},t.or=function(_){for(var p=Math.max(this.g.length,_.g.length),w=[],I=0;I<p;I++)w[I]=this.i(I)|_.i(I);return new o(w,this.h|_.h)},t.xor=function(_){for(var p=Math.max(this.g.length,_.g.length),w=[],I=0;I<p;I++)w[I]=this.i(I)^_.i(I);return new o(w,this.h^_.h)};function P(_){for(var p=_.g.length+1,w=[],I=0;I<p;I++)w[I]=_.i(I)<<1|_.i(I-1)>>>31;return new o(w,_.h)}function A(_,p){var w=p>>5;p%=32;for(var I=_.g.length-w,k=[],j=0;j<I;j++)k[j]=0<p?_.i(j+w)>>>p|_.i(j+w+1)<<32-p:_.i(j+w);return new o(k,_.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,l0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,hs=o}).apply(typeof ay<"u"?ay:typeof self<"u"?self:typeof window<"u"?window:{});var ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var u0,go,c0,Dl,xh,d0,h0,f0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,f,m){return a==Array.prototype||a==Object.prototype||(a[f]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ll=="object"&&ll];for(var f=0;f<a.length;++f){var m=a[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(a,f){if(f)e:{var m=r;a=a.split(".");for(var T=0;T<a.length-1;T++){var O=a[T];if(!(O in m))break e;m=m[O]}a=a[a.length-1],T=m[a],f=f(T),f!=T&&f!=null&&e(m,a,{configurable:!0,writable:!0,value:f})}}function i(a,f){a instanceof String&&(a+="");var m=0,T=!1,O={next:function(){if(!T&&m<a.length){var M=m++;return{value:f(M,a[M]),done:!1}}return T=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}s("Array.prototype.values",function(a){return a||function(){return i(this,function(f,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var f=typeof a;return f=f!="object"?f:a?Array.isArray(a)?"array":f:"null",f=="array"||f=="object"&&typeof a.length=="number"}function d(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function h(a,f,m){return a.call.apply(a.bind,arguments)}function g(a,f,m){if(!a)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,T),a.apply(f,O)}}return function(){return a.apply(f,arguments)}}function y(a,f,m){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:g,y.apply(null,arguments)}function C(a,f){var m=Array.prototype.slice.call(arguments,1);return function(){var T=m.slice();return T.push.apply(T,arguments),a.apply(this,T)}}function N(a,f){function m(){}m.prototype=f.prototype,a.aa=f.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(T,O,M){for(var B=Array(arguments.length-2),be=2;be<arguments.length;be++)B[be-2]=arguments[be];return f.prototype[O].apply(T,B)}}function E(a){const f=a.length;if(0<f){const m=Array(f);for(let T=0;T<f;T++)m[T]=a[T];return m}return[]}function D(a,f){for(let m=1;m<arguments.length;m++){const T=arguments[m];if(u(T)){const O=a.length||0,M=T.length||0;a.length=O+M;for(let B=0;B<M;B++)a[O+B]=T[B]}else a.push(T)}}class b{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function x(a){return/^[\s\xa0]*$/.test(a)}function v(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function S(a){return S[" "](a),a}S[" "]=function(){};var P=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function A(a,f,m){for(const T in a)f.call(m,a[T],T,a)}function _(a,f){for(const m in a)f.call(void 0,a[m],m,a)}function p(a){const f={};for(const m in a)f[m]=a[m];return f}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,f){let m,T;for(let O=1;O<arguments.length;O++){T=arguments[O];for(m in T)a[m]=T[m];for(let M=0;M<w.length;M++)m=w[M],Object.prototype.hasOwnProperty.call(T,m)&&(a[m]=T[m])}}function k(a){var f=1;a=a.split(":");const m=[];for(;0<f&&a.length;)m.push(a.shift()),f--;return a.length&&m.push(a.join(":")),m}function j(a){l.setTimeout(()=>{throw a},0)}function R(){var a=K;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class q{constructor(){this.h=this.g=null}add(f,m){const T=ne.get();T.set(f,m),this.h?this.h.next=T:this.g=T,this.h=T}}var ne=new b(()=>new ae,a=>a.reset());class ae{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let re,z=!1,K=new q,Q=()=>{const a=l.Promise.resolve(void 0);re=()=>{a.then(Ee)}};var Ee=()=>{for(var a;a=R();){try{a.h.call(a.g)}catch(m){j(m)}var f=ne;f.j(a),100>f.h&&(f.h++,a.next=f.g,f.g=a)}z=!1};function ve(){this.s=this.s,this.C=this.C}ve.prototype.s=!1,ve.prototype.ma=function(){this.s||(this.s=!0,this.N())},ve.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Pe(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}Pe.prototype.h=function(){this.defaultPrevented=!0};var $=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};l.addEventListener("test",m,f),l.removeEventListener("test",m,f)}catch{}return a}();function X(a,f){if(Pe.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,T=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget){if(P){e:{try{S(f.nodeName);var O=!0;break e}catch{}O=!1}O||(f=null)}}else m=="mouseover"?f=a.fromElement:m=="mouseout"&&(f=a.toElement);this.relatedTarget=f,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:oe[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&X.aa.h.call(this)}}N(X,Pe);var oe={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),_e=0;function Ct(a,f,m,T,O){this.listener=a,this.proxy=null,this.src=f,this.type=m,this.capture=!!T,this.ha=O,this.key=++_e,this.da=this.fa=!1}function At(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ye(a){this.src=a,this.g={},this.h=0}ye.prototype.add=function(a,f,m,T,O){var M=a.toString();a=this.g[M],a||(a=this.g[M]=[],this.h++);var B=et(a,f,T,O);return-1<B?(f=a[B],m||(f.fa=!1)):(f=new Ct(f,this.src,M,!!T,O),f.fa=m,a.push(f)),f};function Le(a,f){var m=f.type;if(m in a.g){var T=a.g[m],O=Array.prototype.indexOf.call(T,f,void 0),M;(M=0<=O)&&Array.prototype.splice.call(T,O,1),M&&(At(f),a.g[m].length==0&&(delete a.g[m],a.h--))}}function et(a,f,m,T){for(var O=0;O<a.length;++O){var M=a[O];if(!M.da&&M.listener==f&&M.capture==!!m&&M.ha==T)return O}return-1}var Ht="closure_lm_"+(1e6*Math.random()|0),dn={};function hn(a,f,m,T,O){if(Array.isArray(f)){for(var M=0;M<f.length;M++)hn(a,f[M],m,T,O);return null}return m=Rs(m),a&&a[ce]?a.K(f,m,d(T)?!!T.capture:!1,O):fc(a,f,m,!1,T,O)}function fc(a,f,m,T,O,M){if(!f)throw Error("Invalid event type");var B=d(O)?!!O.capture:!!O,be=Li(a);if(be||(a[Ht]=be=new ye(a)),m=be.add(f,m,T,B,M),m.proxy)return m;if(T=pc(),m.proxy=T,T.src=a,T.listener=m,a.addEventListener)$||(O=B),O===void 0&&(O=!1),a.addEventListener(f.toString(),T,O);else if(a.attachEvent)a.attachEvent(zn(f.toString()),T);else if(a.addListener&&a.removeListener)a.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return m}function pc(){function a(m){return f.call(a.src,a.listener,m)}const f=Ca;return a}function Mi(a,f,m,T,O){if(Array.isArray(f))for(var M=0;M<f.length;M++)Mi(a,f[M],m,T,O);else T=d(T)?!!T.capture:!!T,m=Rs(m),a&&a[ce]?(a=a.i,f=String(f).toString(),f in a.g&&(M=a.g[f],m=et(M,m,T,O),-1<m&&(At(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete a.g[f],a.h--)))):a&&(a=Li(a))&&(f=a.g[f.toString()],a=-1,f&&(a=et(f,m,T,O)),(m=-1<a?f[a]:null)&&Ps(m))}function Ps(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[ce])Le(f.i,a);else{var m=a.type,T=a.proxy;f.removeEventListener?f.removeEventListener(m,T,a.capture):f.detachEvent?f.detachEvent(zn(m),T):f.addListener&&f.removeListener&&f.removeListener(T),(m=Li(f))?(Le(m,a),m.h==0&&(m.src=null,f[Ht]=null)):At(a)}}}function zn(a){return a in dn?dn[a]:dn[a]="on"+a}function Ca(a,f){if(a.da)a=!0;else{f=new X(f,this);var m=a.listener,T=a.ha||a.src;a.fa&&Ps(a),a=m.call(T,f)}return a}function Li(a){return a=a[Ht],a instanceof ye?a:null}var Yr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rs(a){return typeof a=="function"?a:(a[Yr]||(a[Yr]=function(f){return a.handleEvent(f)}),a[Yr])}function tt(){ve.call(this),this.i=new ye(this),this.M=this,this.F=null}N(tt,ve),tt.prototype[ce]=!0,tt.prototype.removeEventListener=function(a,f,m,T){Mi(this,a,f,m,T)};function nt(a,f){var m,T=a.F;if(T)for(m=[];T;T=T.F)m.push(T);if(a=a.M,T=f.type||f,typeof f=="string")f=new Pe(f,a);else if(f instanceof Pe)f.target=f.target||a;else{var O=f;f=new Pe(T,a),I(f,O)}if(O=!0,m)for(var M=m.length-1;0<=M;M--){var B=f.g=m[M];O=Y(B,T,!0,f)&&O}if(B=f.g=a,O=Y(B,T,!0,f)&&O,O=Y(B,T,!1,f)&&O,m)for(M=0;M<m.length;M++)B=f.g=m[M],O=Y(B,T,!1,f)&&O}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var a=this.i,f;for(f in a.g){for(var m=a.g[f],T=0;T<m.length;T++)At(m[T]);delete a.g[f],a.h--}}this.F=null},tt.prototype.K=function(a,f,m,T){return this.i.add(String(a),f,!1,m,T)},tt.prototype.L=function(a,f,m,T){return this.i.add(String(a),f,!0,m,T)};function Y(a,f,m,T){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();for(var O=!0,M=0;M<f.length;++M){var B=f[M];if(B&&!B.da&&B.capture==m){var be=B.listener,lt=B.ha||B.src;B.fa&&Le(a.i,B),O=be.call(lt,T)!==!1&&O}}return O&&!T.defaultPrevented}function Z(a,f,m){if(typeof a=="function")m&&(a=y(a,m));else if(a&&typeof a.handleEvent=="function")a=y(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:l.setTimeout(a,f||0)}function pe(a){a.g=Z(()=>{a.g=null,a.i&&(a.i=!1,pe(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class Ge extends ve{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:pe(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function at(a){ve.call(this),this.h=a,this.g={}}N(at,ve);var rt=[];function Ke(a){A(a.g,function(f,m){this.g.hasOwnProperty(m)&&Ps(f)},a),a.g={}}at.prototype.N=function(){at.aa.N.call(this),Ke(this)},at.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qe=l.JSON.stringify,Wt=l.JSON.parse,Fi=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Cn(){}Cn.prototype.h=null;function Aa(a){return a.h||(a.h=a.i())}function Ui(){}var dr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function mc(){Pe.call(this,"d")}N(mc,Pe);function gc(){Pe.call(this,"c")}N(gc,Pe);var Xr={},Vp=null;function Pa(){return Vp=Vp||new tt}Xr.La="serverreachability";function Mp(a){Pe.call(this,Xr.La,a)}N(Mp,Pe);function zi(a){const f=Pa();nt(f,new Mp(f))}Xr.STAT_EVENT="statevent";function Lp(a,f){Pe.call(this,Xr.STAT_EVENT,a),this.stat=f}N(Lp,Pe);function Pt(a){const f=Pa();nt(f,new Lp(f,a))}Xr.Ma="timingevent";function Fp(a,f){Pe.call(this,Xr.Ma,a),this.size=f}N(Fp,Pe);function Bi(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},f)}function $i(){this.g=!0}$i.prototype.xa=function(){this.g=!1};function tE(a,f,m,T,O,M){a.info(function(){if(a.g)if(M)for(var B="",be=M.split("&"),lt=0;lt<be.length;lt++){var me=be[lt].split("=");if(1<me.length){var gt=me[0];me=me[1];var yt=gt.split("_");B=2<=yt.length&&yt[1]=="type"?B+(gt+"="+me+"&"):B+(gt+"=redacted&")}}else B=null;else B=M;return"XMLHTTP REQ ("+T+") [attempt "+O+"]: "+f+`
`+m+`
`+B})}function nE(a,f,m,T,O,M,B){a.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+O+"]: "+f+`
`+m+`
`+M+" "+B})}function Ns(a,f,m,T){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+sE(a,m)+(T?" "+T:"")})}function rE(a,f){a.info(function(){return"TIMEOUT: "+f})}$i.prototype.info=function(){};function sE(a,f){if(!a.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var T=m[a];if(!(2>T.length)){var O=T[1];if(Array.isArray(O)&&!(1>O.length)){var M=O[0];if(M!="noop"&&M!="stop"&&M!="close")for(var B=1;B<O.length;B++)O[B]=""}}}}return Qe(m)}catch{return f}}var Ra={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Up={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},yc;function Na(){}N(Na,Cn),Na.prototype.g=function(){return new XMLHttpRequest},Na.prototype.i=function(){return{}},yc=new Na;function hr(a,f,m,T){this.j=a,this.i=f,this.l=m,this.R=T||1,this.U=new at(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new zp}function zp(){this.i=null,this.g="",this.h=!1}var Bp={},vc={};function _c(a,f,m){a.L=1,a.v=Oa(Bn(f)),a.m=m,a.P=!0,$p(a,null)}function $p(a,f){a.F=Date.now(),ka(a),a.A=Bn(a.v);var m=a.A,T=a.R;Array.isArray(T)||(T=[String(T)]),rm(m.i,"t",T),a.C=0,m=a.j.J,a.h=new zp,a.g=wm(a.j,m?f:null,!a.m),0<a.O&&(a.M=new Ge(y(a.Y,a,a.g),a.O)),f=a.U,m=a.g,T=a.ca;var O="readystatechange";Array.isArray(O)||(O&&(rt[0]=O.toString()),O=rt);for(var M=0;M<O.length;M++){var B=hn(m,O[M],T||f.handleEvent,!1,f.h||f);if(!B)break;f.g[B.key]=B}f=a.H?p(a.H):{},a.m?(a.u||(a.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,f)):(a.u="GET",a.g.ea(a.A,a.u,null,f)),zi(),tE(a.i,a.u,a.A,a.l,a.R,a.m)}hr.prototype.ca=function(a){a=a.target;const f=this.M;f&&$n(a)==3?f.j():this.Y(a)},hr.prototype.Y=function(a){try{if(a==this.g)e:{const yt=$n(this.g);var f=this.g.Ba();const js=this.g.Z();if(!(3>yt)&&(yt!=3||this.g&&(this.h.h||this.g.oa()||cm(this.g)))){this.J||yt!=4||f==7||(f==8||0>=js?zi(3):zi(2)),xc(this);var m=this.g.Z();this.X=m;t:if(Hp(this)){var T=cm(this.g);a="";var O=T.length,M=$n(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jr(this),Hi(this);var B="";break t}this.h.i=new l.TextDecoder}for(f=0;f<O;f++)this.h.h=!0,a+=this.h.i.decode(T[f],{stream:!(M&&f==O-1)});T.length=0,this.h.g+=a,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=m==200,nE(this.i,this.u,this.A,this.l,this.R,yt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var be,lt=this.g;if((be=lt.g?lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(be)){var me=be;break t}}me=null}if(m=me)Ns(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wc(this,m);else{this.o=!1,this.s=3,Pt(12),Jr(this),Hi(this);break e}}if(this.P){m=!0;let fn;for(;!this.J&&this.C<B.length;)if(fn=iE(this,B),fn==vc){yt==4&&(this.s=4,Pt(14),m=!1),Ns(this.i,this.l,null,"[Incomplete Response]");break}else if(fn==Bp){this.s=4,Pt(15),Ns(this.i,this.l,B,"[Invalid Chunk]"),m=!1;break}else Ns(this.i,this.l,fn,null),wc(this,fn);if(Hp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),yt!=4||B.length!=0||this.h.h||(this.s=1,Pt(16),m=!1),this.o=this.o&&m,!m)Ns(this.i,this.l,B,"[Invalid Chunked Response]"),Jr(this),Hi(this);else if(0<B.length&&!this.W){this.W=!0;var gt=this.j;gt.g==this&&gt.ba&&!gt.M&&(gt.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),Cc(gt),gt.M=!0,Pt(11))}}else Ns(this.i,this.l,B,null),wc(this,B);yt==4&&Jr(this),this.o&&!this.J&&(yt==4?ym(this.j,this):(this.o=!1,ka(this)))}else EE(this.g),m==400&&0<B.indexOf("Unknown SID")?(this.s=3,Pt(12)):(this.s=0,Pt(13)),Jr(this),Hi(this)}}}catch{}finally{}};function Hp(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function iE(a,f){var m=a.C,T=f.indexOf(`
`,m);return T==-1?vc:(m=Number(f.substring(m,T)),isNaN(m)?Bp:(T+=1,T+m>f.length?vc:(f=f.slice(T,T+m),a.C=T+m,f)))}hr.prototype.cancel=function(){this.J=!0,Jr(this)};function ka(a){a.S=Date.now()+a.I,Wp(a,a.I)}function Wp(a,f){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Bi(y(a.ba,a),f)}function xc(a){a.B&&(l.clearTimeout(a.B),a.B=null)}hr.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(rE(this.i,this.A),this.L!=2&&(zi(),Pt(17)),Jr(this),this.s=2,Hi(this)):Wp(this,this.S-a)};function Hi(a){a.j.G==0||a.J||ym(a.j,a)}function Jr(a){xc(a);var f=a.M;f&&typeof f.ma=="function"&&f.ma(),a.M=null,Ke(a.U),a.g&&(f=a.g,a.g=null,f.abort(),f.ma())}function wc(a,f){try{var m=a.j;if(m.G!=0&&(m.g==a||Ec(m.h,a))){if(!a.K&&Ec(m.h,a)&&m.G==3){try{var T=m.Da.g.parse(f)}catch{T=null}if(Array.isArray(T)&&T.length==3){var O=T;if(O[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)za(m),Fa(m);else break e;Ic(m),Pt(18)}}else m.za=O[1],0<m.za-m.T&&37500>O[2]&&m.F&&m.v==0&&!m.C&&(m.C=Bi(y(m.Za,m),6e3));if(1>=Kp(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else es(m,11)}else if((a.K||m.g==a)&&za(m),!x(f))for(O=m.Da.g.parse(f),f=0;f<O.length;f++){let me=O[f];if(m.T=me[0],me=me[1],m.G==2)if(me[0]=="c"){m.K=me[1],m.ia=me[2];const gt=me[3];gt!=null&&(m.la=gt,m.j.info("VER="+m.la));const yt=me[4];yt!=null&&(m.Aa=yt,m.j.info("SVER="+m.Aa));const js=me[5];js!=null&&typeof js=="number"&&0<js&&(T=1.5*js,m.L=T,m.j.info("backChannelRequestTimeoutMs_="+T)),T=m;const fn=a.g;if(fn){const $a=fn.g?fn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($a){var M=T.h;M.g||$a.indexOf("spdy")==-1&&$a.indexOf("quic")==-1&&$a.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(bc(M,M.h),M.h=null))}if(T.D){const Ac=fn.g?fn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ac&&(T.ya=Ac,Te(T.I,T.D,Ac))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),T=m;var B=a;if(T.qa=xm(T,T.J?T.ia:null,T.W),B.K){Qp(T.h,B);var be=B,lt=T.L;lt&&(be.I=lt),be.B&&(xc(be),ka(be)),T.g=B}else mm(T);0<m.i.length&&Ua(m)}else me[0]!="stop"&&me[0]!="close"||es(m,7);else m.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?es(m,7):Tc(m):me[0]!="noop"&&m.l&&m.l.ta(me),m.v=0)}}zi(4)}catch{}}var oE=class{constructor(a,f){this.g=a,this.map=f}};function qp(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Gp(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Kp(a){return a.h?1:a.g?a.g.size:0}function Ec(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function bc(a,f){a.g?a.g.add(f):a.h=f}function Qp(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}qp.prototype.cancel=function(){if(this.i=Yp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Yp(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const m of a.g.values())f=f.concat(m.D);return f}return E(a.i)}function aE(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var f=[],m=a.length,T=0;T<m;T++)f.push(a[T]);return f}f=[],m=0;for(T in a)f[m++]=a[T];return f}function lE(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var f=[];a=a.length;for(var m=0;m<a;m++)f.push(m);return f}f=[],m=0;for(const T in a)f[m++]=T;return f}}}function Xp(a,f){if(a.forEach&&typeof a.forEach=="function")a.forEach(f,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,f,void 0);else for(var m=lE(a),T=aE(a),O=T.length,M=0;M<O;M++)f.call(void 0,T[M],m&&m[M],a)}var Jp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uE(a,f){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var T=a[m].indexOf("="),O=null;if(0<=T){var M=a[m].substring(0,T);O=a[m].substring(T+1)}else M=a[m];f(M,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function Zr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Zr){this.h=a.h,Da(this,a.j),this.o=a.o,this.g=a.g,ja(this,a.s),this.l=a.l;var f=a.i,m=new Gi;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),Zp(this,m),this.m=a.m}else a&&(f=String(a).match(Jp))?(this.h=!1,Da(this,f[1]||"",!0),this.o=Wi(f[2]||""),this.g=Wi(f[3]||"",!0),ja(this,f[4]),this.l=Wi(f[5]||"",!0),Zp(this,f[6]||"",!0),this.m=Wi(f[7]||"")):(this.h=!1,this.i=new Gi(null,this.h))}Zr.prototype.toString=function(){var a=[],f=this.j;f&&a.push(qi(f,em,!0),":");var m=this.g;return(m||f=="file")&&(a.push("//"),(f=this.o)&&a.push(qi(f,em,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(qi(m,m.charAt(0)=="/"?hE:dE,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",qi(m,pE)),a.join("")};function Bn(a){return new Zr(a)}function Da(a,f,m){a.j=m?Wi(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function ja(a,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);a.s=f}else a.s=null}function Zp(a,f,m){f instanceof Gi?(a.i=f,mE(a.i,a.h)):(m||(f=qi(f,fE)),a.i=new Gi(f,a.h))}function Te(a,f,m){a.i.set(f,m)}function Oa(a){return Te(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Wi(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function qi(a,f,m){return typeof a=="string"?(a=encodeURI(a).replace(f,cE),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function cE(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var em=/[#\/\?@]/g,dE=/[#\?:]/g,hE=/[#\?]/g,fE=/[#\?@]/g,pE=/#/g;function Gi(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function fr(a){a.g||(a.g=new Map,a.h=0,a.i&&uE(a.i,function(f,m){a.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}t=Gi.prototype,t.add=function(a,f){fr(this),this.i=null,a=ks(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(f),this.h+=1,this};function tm(a,f){fr(a),f=ks(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function nm(a,f){return fr(a),f=ks(a,f),a.g.has(f)}t.forEach=function(a,f){fr(this),this.g.forEach(function(m,T){m.forEach(function(O){a.call(f,O,T,this)},this)},this)},t.na=function(){fr(this);const a=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let T=0;T<f.length;T++){const O=a[T];for(let M=0;M<O.length;M++)m.push(f[T])}return m},t.V=function(a){fr(this);let f=[];if(typeof a=="string")nm(this,a)&&(f=f.concat(this.g.get(ks(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)f=f.concat(a[m])}return f},t.set=function(a,f){return fr(this),this.i=null,a=ks(this,a),nm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},t.get=function(a,f){return a?(a=this.V(a),0<a.length?String(a[0]):f):f};function rm(a,f,m){tm(a,f),0<m.length&&(a.i=null,a.g.set(ks(a,f),E(m)),a.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var T=f[m];const M=encodeURIComponent(String(T)),B=this.V(T);for(T=0;T<B.length;T++){var O=M;B[T]!==""&&(O+="="+encodeURIComponent(String(B[T]))),a.push(O)}}return this.i=a.join("&")};function ks(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function mE(a,f){f&&!a.j&&(fr(a),a.i=null,a.g.forEach(function(m,T){var O=T.toLowerCase();T!=O&&(tm(this,T),rm(this,O,m))},a)),a.j=f}function gE(a,f){const m=new $i;if(l.Image){const T=new Image;T.onload=C(pr,m,"TestLoadImage: loaded",!0,f,T),T.onerror=C(pr,m,"TestLoadImage: error",!1,f,T),T.onabort=C(pr,m,"TestLoadImage: abort",!1,f,T),T.ontimeout=C(pr,m,"TestLoadImage: timeout",!1,f,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=a}else f(!1)}function yE(a,f){const m=new $i,T=new AbortController,O=setTimeout(()=>{T.abort(),pr(m,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:T.signal}).then(M=>{clearTimeout(O),M.ok?pr(m,"TestPingServer: ok",!0,f):pr(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(O),pr(m,"TestPingServer: error",!1,f)})}function pr(a,f,m,T,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),T(m)}catch{}}function vE(){this.g=new Fi}function _E(a,f,m){const T=m||"";try{Xp(a,function(O,M){let B=O;d(O)&&(B=Qe(O)),f.push(T+M+"="+encodeURIComponent(B))})}catch(O){throw f.push(T+"type="+encodeURIComponent("_badmap")),O}}function Va(a){this.l=a.Ub||null,this.j=a.eb||!1}N(Va,Cn),Va.prototype.g=function(){return new Ma(this.l,this.j)},Va.prototype.i=function(a){return function(){return a}}({});function Ma(a,f){tt.call(this),this.D=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(Ma,tt),t=Ma.prototype,t.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=f,this.readyState=1,Qi(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(f.body=a),(this.D||l).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ki(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Qi(this)),this.g&&(this.readyState=3,Qi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;sm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function sm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?Ki(this):Qi(this),this.readyState==3&&sm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Ki(this))},t.Qa=function(a){this.g&&(this.response=a,Ki(this))},t.ga=function(){this.g&&Ki(this)};function Ki(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Qi(a)}t.setRequestHeader=function(a,f){this.u.append(a,f)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=f.next();return a.join(`\r
`)};function Qi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ma.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function im(a){let f="";return A(a,function(m,T){f+=T,f+=":",f+=m,f+=`\r
`}),f}function Sc(a,f,m){e:{for(T in m){var T=!1;break e}T=!0}T||(m=im(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):Te(a,f,m))}function Oe(a){tt.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(Oe,tt);var xE=/^https?$/i,wE=["POST","PUT"];t=Oe.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,f,m,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():yc.g(),this.v=this.o?Aa(this.o):Aa(yc),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(M){om(this,M);return}if(a=m||"",m=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var O in T)m.set(O,T[O]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const M of T.keys())m.set(M,T.get(M));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),O=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(wE,f,void 0))||T||O||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,B]of m)this.g.setRequestHeader(M,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{um(this),this.u=!0,this.g.send(a),this.u=!1}catch(M){om(this,M)}};function om(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.m=5,am(a),La(a)}function am(a){a.A||(a.A=!0,nt(a,"complete"),nt(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,nt(this,"complete"),nt(this,"abort"),La(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),La(this,!0)),Oe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?lm(this):this.bb())},t.bb=function(){lm(this)};function lm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||$n(a)!=4||a.Z()!=2)){if(a.u&&$n(a)==4)Z(a.Ea,0,a);else if(nt(a,"readystatechange"),$n(a)==4){a.h=!1;try{const B=a.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var T;if(T=B===0){var O=String(a.D).match(Jp)[1]||null;!O&&l.self&&l.self.location&&(O=l.self.location.protocol.slice(0,-1)),T=!xE.test(O?O.toLowerCase():"")}m=T}if(m)nt(a,"complete"),nt(a,"success");else{a.m=6;try{var M=2<$n(a)?a.g.statusText:""}catch{M=""}a.l=M+" ["+a.Z()+"]",am(a)}}finally{La(a)}}}}function La(a,f){if(a.g){um(a);const m=a.g,T=a.v[0]?()=>{}:null;a.g=null,a.v=null,f||nt(a,"ready");try{m.onreadystatechange=T}catch{}}}function um(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function $n(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<$n(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),Wt(f)}};function cm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function EE(a){const f={};a=(a.g&&2<=$n(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<a.length;T++){if(x(a[T]))continue;var m=k(a[T]);const O=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const M=f[O]||[];f[O]=M,M.push(m)}_(f,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yi(a,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||f}function dm(a){this.Aa=0,this.i=[],this.j=new $i,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yi("baseRetryDelayMs",5e3,a),this.cb=Yi("retryDelaySeedMs",1e4,a),this.Wa=Yi("forwardChannelMaxRetries",2,a),this.wa=Yi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new qp(a&&a.concurrentRequestLimit),this.Da=new vE,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=dm.prototype,t.la=8,t.G=1,t.connect=function(a,f,m,T){Pt(0),this.W=a,this.H=f||{},m&&T!==void 0&&(this.H.OSID=m,this.H.OAID=T),this.F=this.X,this.I=xm(this,null,this.W),Ua(this)};function Tc(a){if(hm(a),a.G==3){var f=a.U++,m=Bn(a.I);if(Te(m,"SID",a.K),Te(m,"RID",f),Te(m,"TYPE","terminate"),Xi(a,m),f=new hr(a,a.j,f),f.L=2,f.v=Oa(Bn(m)),m=!1,l.navigator&&l.navigator.sendBeacon)try{m=l.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&l.Image&&(new Image().src=f.v,m=!0),m||(f.g=wm(f.j,null),f.g.ea(f.v)),f.F=Date.now(),ka(f)}_m(a)}function Fa(a){a.g&&(Cc(a),a.g.cancel(),a.g=null)}function hm(a){Fa(a),a.u&&(l.clearTimeout(a.u),a.u=null),za(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Ua(a){if(!Gp(a.h)&&!a.s){a.s=!0;var f=a.Ga;re||Q(),z||(re(),z=!0),K.add(f,a),a.B=0}}function bE(a,f){return Kp(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=f.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Bi(y(a.Ga,a,f),vm(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const O=new hr(this,this.j,a);let M=this.o;if(this.S&&(M?(M=p(M),I(M,this.S)):M=this.S),this.m!==null||this.O||(O.H=M,M=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var T=this.i[m];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(f+=T,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=pm(this,O,f),m=Bn(this.I),Te(m,"RID",a),Te(m,"CVER",22),this.D&&Te(m,"X-HTTP-Session-Id",this.D),Xi(this,m),M&&(this.O?f="headers="+encodeURIComponent(String(im(M)))+"&"+f:this.m&&Sc(m,this.m,M)),bc(this.h,O),this.Ua&&Te(m,"TYPE","init"),this.P?(Te(m,"$req",f),Te(m,"SID","null"),O.T=!0,_c(O,m,null)):_c(O,m,f),this.G=2}}else this.G==3&&(a?fm(this,a):this.i.length==0||Gp(this.h)||fm(this))};function fm(a,f){var m;f?m=f.l:m=a.U++;const T=Bn(a.I);Te(T,"SID",a.K),Te(T,"RID",m),Te(T,"AID",a.T),Xi(a,T),a.m&&a.o&&Sc(T,a.m,a.o),m=new hr(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),f&&(a.i=f.D.concat(a.i)),f=pm(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),bc(a.h,m),_c(m,T,f)}function Xi(a,f){a.H&&A(a.H,function(m,T){Te(f,T,m)}),a.l&&Xp({},function(m,T){Te(f,T,m)})}function pm(a,f,m){m=Math.min(a.i.length,m);var T=a.l?y(a.l.Na,a.l,a):null;e:{var O=a.i;let M=-1;for(;;){const B=["count="+m];M==-1?0<m?(M=O[0].g,B.push("ofs="+M)):M=0:B.push("ofs="+M);let be=!0;for(let lt=0;lt<m;lt++){let me=O[lt].g;const gt=O[lt].map;if(me-=M,0>me)M=Math.max(0,O[lt].g-100),be=!1;else try{_E(gt,B,"req"+me+"_")}catch{T&&T(gt)}}if(be){T=B.join("&");break e}}}return a=a.i.splice(0,m),f.D=a,T}function mm(a){if(!a.g&&!a.u){a.Y=1;var f=a.Fa;re||Q(),z||(re(),z=!0),K.add(f,a),a.v=0}}function Ic(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Bi(y(a.Fa,a),vm(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,gm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Bi(y(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pt(10),Fa(this),gm(this))};function Cc(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function gm(a){a.g=new hr(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var f=Bn(a.qa);Te(f,"RID","rpc"),Te(f,"SID",a.K),Te(f,"AID",a.T),Te(f,"CI",a.F?"0":"1"),!a.F&&a.ja&&Te(f,"TO",a.ja),Te(f,"TYPE","xmlhttp"),Xi(a,f),a.m&&a.o&&Sc(f,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=Oa(Bn(f)),m.m=null,m.P=!0,$p(m,a)}t.Za=function(){this.C!=null&&(this.C=null,Fa(this),Ic(this),Pt(19))};function za(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function ym(a,f){var m=null;if(a.g==f){za(a),Cc(a),a.g=null;var T=2}else if(Ec(a.h,f))m=f.D,Qp(a.h,f),T=1;else return;if(a.G!=0){if(f.o)if(T==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var O=a.B;T=Pa(),nt(T,new Fp(T,m)),Ua(a)}else mm(a);else if(O=f.s,O==3||O==0&&0<f.X||!(T==1&&bE(a,f)||T==2&&Ic(a)))switch(m&&0<m.length&&(f=a.h,f.i=f.i.concat(m)),O){case 1:es(a,5);break;case 4:es(a,10);break;case 3:es(a,6);break;default:es(a,2)}}}function vm(a,f){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*f}function es(a,f){if(a.j.info("Error code "+f),f==2){var m=y(a.fb,a),T=a.Xa;const O=!T;T=new Zr(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Da(T,"https"),Oa(T),O?gE(T.toString(),m):yE(T.toString(),m)}else Pt(2);a.G=0,a.l&&a.l.sa(f),_m(a),hm(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function _m(a){if(a.G=0,a.ka=[],a.l){const f=Yp(a.h);(f.length!=0||a.i.length!=0)&&(D(a.ka,f),D(a.ka,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.ra()}}function xm(a,f,m){var T=m instanceof Zr?Bn(m):new Zr(m);if(T.g!="")f&&(T.g=f+"."+T.g),ja(T,T.s);else{var O=l.location;T=O.protocol,f=f?f+"."+O.hostname:O.hostname,O=+O.port;var M=new Zr(null);T&&Da(M,T),f&&(M.g=f),O&&ja(M,O),m&&(M.l=m),T=M}return m=a.D,f=a.ya,m&&f&&Te(T,m,f),Te(T,"VER",a.la),Xi(a,T),T}function wm(a,f,m){if(f&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Ca&&!a.pa?new Oe(new Va({eb:m})):new Oe(a.pa),f.Ha(a.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Em(){}t=Em.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ba(){}Ba.prototype.g=function(a,f){return new qt(a,f)};function qt(a,f){tt.call(this),this.g=new dm(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(a?a["X-WebChannel-Client-Profile"]=f.va:a={"X-WebChannel-Client-Profile":f.va}),this.g.S=a,(a=f&&f.Sb)&&!x(a)&&(this.g.m=a),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!x(f)&&(this.g.D=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new Ds(this)}N(qt,tt),qt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qt.prototype.close=function(){Tc(this.g)},qt.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=Qe(a),a=m);f.i.push(new oE(f.Ya++,a)),f.G==3&&Ua(f)},qt.prototype.N=function(){this.g.l=null,delete this.j,Tc(this.g),delete this.g,qt.aa.N.call(this)};function bm(a){mc.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){e:{for(const m in f){a=m;break e}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}N(bm,mc);function Sm(){gc.call(this),this.status=1}N(Sm,gc);function Ds(a){this.g=a}N(Ds,Em),Ds.prototype.ua=function(){nt(this.g,"a")},Ds.prototype.ta=function(a){nt(this.g,new bm(a))},Ds.prototype.sa=function(a){nt(this.g,new Sm)},Ds.prototype.ra=function(){nt(this.g,"b")},Ba.prototype.createWebChannel=Ba.prototype.g,qt.prototype.send=qt.prototype.o,qt.prototype.open=qt.prototype.m,qt.prototype.close=qt.prototype.close,f0=function(){return new Ba},h0=function(){return Pa()},d0=Xr,xh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ra.NO_ERROR=0,Ra.TIMEOUT=8,Ra.HTTP_ERROR=6,Dl=Ra,Up.COMPLETE="complete",c0=Up,Ui.EventType=dr,dr.OPEN="a",dr.CLOSE="b",dr.ERROR="c",dr.MESSAGE="d",tt.prototype.listen=tt.prototype.K,go=Ui,Oe.prototype.listenOnce=Oe.prototype.L,Oe.prototype.getLastError=Oe.prototype.Ka,Oe.prototype.getLastErrorCode=Oe.prototype.Ba,Oe.prototype.getStatus=Oe.prototype.Z,Oe.prototype.getResponseJson=Oe.prototype.Oa,Oe.prototype.getResponseText=Oe.prototype.oa,Oe.prototype.send=Oe.prototype.ea,Oe.prototype.setWithCredentials=Oe.prototype.Ha,u0=Oe}).apply(typeof ll<"u"?ll:typeof self<"u"?self:typeof window<"u"?window:{});const ly="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Et.UNAUTHENTICATED=new Et(null),Et.GOOGLE_CREDENTIALS=new Et("google-credentials-uid"),Et.FIRST_PARTY=new Et("first-party-uid"),Et.MOCK_USER=new Et("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ki="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs=new Df("@firebase/firestore");function oo(){return xs.logLevel}function G(t,...e){if(xs.logLevel<=de.DEBUG){const n=e.map(Gf);xs.debug(`Firestore (${ki}): ${t}`,...n)}}function ar(t,...e){if(xs.logLevel<=de.ERROR){const n=e.map(Gf);xs.error(`Firestore (${ki}): ${t}`,...n)}}function xi(t,...e){if(xs.logLevel<=de.WARN){const n=e.map(Gf);xs.warn(`Firestore (${ki}): ${t}`,...n)}}function Gf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(t="Unexpected state"){const e=`FIRESTORE (${ki}) INTERNAL ASSERTION FAILED: `+t;throw ar(e),new Error(e)}function we(t,e){t||te()}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends cr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class NA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Et.UNAUTHENTICATED))}shutdown(){}}class kA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class DA{constructor(e){this.t=e,this.currentUser=Et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){we(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{G("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(G("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(G("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(we(typeof r.accessToken=="string"),new p0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return we(e===null||typeof e=="string"),new Et(e)}}class jA{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Et.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class OA{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new jA(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Et.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class VA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class MA{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){we(this.o===void 0);const r=i=>{i.error!=null&&G("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,G("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{G("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):G("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(we(typeof n.token=="string"),this.R=n.token,new VA(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=LA(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ge(t,e){return t<e?-1:t>e?1:0}function wi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new W(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ze.fromMillis(Date.now())}static fromDate(e){return Ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ze(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ge(this.nanoseconds,e.nanoseconds):ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.timestamp=e}static fromTimestamp(e){return new se(e)}static min(){return new se(new Ze(0,0))}static max(){return new se(new Ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,n,r){n===void 0?n=0:n>e.length&&te(),r===void 0?r=e.length-n:r>e.length-n&&te(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ea.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ea?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ce extends ea{construct(e,n,r){return new Ce(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ce(n)}static emptyPath(){return new Ce([])}}const FA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends ea{construct(e,n,r){return new dt(e,n,r)}static isValidIdentifier(e){return FA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new dt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new W(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new W(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new W(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dt(n)}static emptyPath(){return new dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.path=e}static fromPath(e){return new J(Ce.fromString(e))}static fromName(e){return new J(Ce.fromString(e).popFirst(5))}static empty(){return new J(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new J(new Ce(e.slice()))}}function UA(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=se.fromTimestamp(r===1e9?new Ze(n+1,0):new Ze(n,r));return new $r(s,J.empty(),e)}function zA(t){return new $r(t.readTime,t.key,-1)}class $r{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new $r(se.min(),J.empty(),-1)}static max(){return new $r(se.max(),J.empty(),-1)}}function BA(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=J.comparator(t.documentKey,e.documentKey),n!==0?n:ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class HA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _a(t){if(t.code!==L.FAILED_PRECONDITION||t.message!==$A)throw t;G("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&te(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(s=>s?F.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new F((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(h=>{o[d]=h,++l,l===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new F((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function WA(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function xa(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Kf.oe=-1;function Gu(t){return t==null}function yu(t){return t===0&&1/t==-1/0}function qA(t){return typeof t=="number"&&Number.isInteger(t)&&!yu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Di(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function g0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,n){this.comparator=e,this.root=n||ct.EMPTY}insert(e,n){return new je(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ct.BLACK,null,null))}remove(e){return new je(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ct.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ul(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ul(this.root,e,this.comparator,!1)}getReverseIterator(){return new ul(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ul(this.root,e,this.comparator,!0)}}class ul{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ct{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ct.RED,this.left=s??ct.EMPTY,this.right=i??ct.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ct(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ct.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ct.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw te();const e=this.left.check();if(e!==this.right.check())throw te();return e+(this.isRed()?0:1)}}ct.EMPTY=null,ct.RED=!0,ct.BLACK=!1;ct.EMPTY=new class{constructor(){this.size=0}get key(){throw te()}get value(){throw te()}get color(){throw te()}get left(){throw te()}get right(){throw te()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ct(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.comparator=e,this.data=new je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new cy(this.data.getIterator())}getIteratorFrom(e){return new cy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ft)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ft(this.comparator);return n.data=e,n}}class cy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.fields=e,e.sort(dt.comparator)}static empty(){return new _n([])}unionWith(e){let n=new ft(dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new _n(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return wi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new y0("Invalid base64 string: "+i):i}}(e);return new mt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new mt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const GA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hr(t){if(we(!!t),typeof t=="string"){let e=0;const n=GA.exec(t);if(we(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Fe(t.seconds),nanos:Fe(t.nanos)}}function Fe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ws(t){return typeof t=="string"?mt.fromBase64String(t):mt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Yf(t){const e=t.mapValue.fields.__previous_value__;return Qf(e)?Yf(e):e}function ta(t){const e=Hr(t.mapValue.fields.__local_write_time__.timestampValue);return new Ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e,n,r,s,i,o,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}class na{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new na("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof na&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl={mapValue:{}};function Es(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qf(t)?4:YA(t)?9007199254740991:QA(t)?10:11:te()}function Ln(t,e){if(t===e)return!0;const n=Es(t);if(n!==Es(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ta(t).isEqual(ta(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Hr(s.timestampValue),l=Hr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ws(s.bytesValue).isEqual(ws(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Fe(s.geoPointValue.latitude)===Fe(i.geoPointValue.latitude)&&Fe(s.geoPointValue.longitude)===Fe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Fe(s.integerValue)===Fe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Fe(s.doubleValue),l=Fe(i.doubleValue);return o===l?yu(o)===yu(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return wi(t.arrayValue.values||[],e.arrayValue.values||[],Ln);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(uy(o)!==uy(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Ln(o[u],l[u])))return!1;return!0}(t,e);default:return te()}}function ra(t,e){return(t.values||[]).find(n=>Ln(n,e))!==void 0}function Ei(t,e){if(t===e)return 0;const n=Es(t),r=Es(e);if(n!==r)return ge(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ge(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Fe(i.integerValue||i.doubleValue),u=Fe(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return dy(t.timestampValue,e.timestampValue);case 4:return dy(ta(t),ta(e));case 5:return ge(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ws(i),u=ws(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const h=ge(l[d],u[d]);if(h!==0)return h}return ge(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=ge(Fe(i.latitude),Fe(o.latitude));return l!==0?l:ge(Fe(i.longitude),Fe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return hy(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,d,h;const g=i.fields||{},y=o.fields||{},C=(l=g.value)===null||l===void 0?void 0:l.arrayValue,N=(u=y.value)===null||u===void 0?void 0:u.arrayValue,E=ge(((d=C==null?void 0:C.values)===null||d===void 0?void 0:d.length)||0,((h=N==null?void 0:N.values)===null||h===void 0?void 0:h.length)||0);return E!==0?E:hy(C,N)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===cl.mapValue&&o===cl.mapValue)return 0;if(i===cl.mapValue)return 1;if(o===cl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let g=0;g<u.length&&g<h.length;++g){const y=ge(u[g],h[g]);if(y!==0)return y;const C=Ei(l[u[g]],d[h[g]]);if(C!==0)return C}return ge(u.length,h.length)}(t.mapValue,e.mapValue);default:throw te()}}function dy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ge(t,e);const n=Hr(t),r=Hr(e),s=ge(n.seconds,r.seconds);return s!==0?s:ge(n.nanos,r.nanos)}function hy(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ei(n[s],r[s]);if(i)return i}return ge(n.length,r.length)}function bi(t){return wh(t)}function wh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Hr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ws(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return J.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=wh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${wh(n.fields[o])}`;return s+"}"}(t.mapValue):te()}function fy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Eh(t){return!!t&&"integerValue"in t}function Xf(t){return!!t&&"arrayValue"in t}function py(t){return!!t&&"nullValue"in t}function my(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function jl(t){return!!t&&"mapValue"in t}function QA(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Ro(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Di(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ro(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ro(t.arrayValue.values[n]);return e}return Object.assign({},t)}function YA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.value=e}static empty(){return new rn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!jl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ro(n)}setAll(e){let n=dt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Ro(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());jl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ln(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];jl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Di(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new rn(Ro(this.value))}}function v0(t){const e=[];return Di(t.fields,(n,r)=>{const s=new dt([n]);if(jl(r)){const i=v0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new _n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new St(e,0,se.min(),se.min(),se.min(),rn.empty(),0)}static newFoundDocument(e,n,r,s){return new St(e,1,n,se.min(),r,s,0)}static newNoDocument(e,n){return new St(e,2,n,se.min(),se.min(),rn.empty(),0)}static newUnknownDocument(e,n){return new St(e,3,n,se.min(),se.min(),rn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof St&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,n){this.position=e,this.inclusive=n}}function gy(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=J.comparator(J.fromName(o.referenceValue),n.key):r=Ei(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function yy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ln(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e,n="asc"){this.field=e,this.dir=n}}function XA(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{}class qe extends _0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new ZA(e,n,r):n==="array-contains"?new nP(e,r):n==="in"?new rP(e,r):n==="not-in"?new sP(e,r):n==="array-contains-any"?new iP(e,r):new qe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new eP(e,r):new tP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ei(n,this.value)):n!==null&&Es(this.value)===Es(n)&&this.matchesComparison(Ei(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return te()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends _0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new In(e,n)}matches(e){return x0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function x0(t){return t.op==="and"}function w0(t){return JA(t)&&x0(t)}function JA(t){for(const e of t.filters)if(e instanceof In)return!1;return!0}function bh(t){if(t instanceof qe)return t.field.canonicalString()+t.op.toString()+bi(t.value);if(w0(t))return t.filters.map(e=>bh(e)).join(",");{const e=t.filters.map(n=>bh(n)).join(",");return`${t.op}(${e})`}}function E0(t,e){return t instanceof qe?function(r,s){return s instanceof qe&&r.op===s.op&&r.field.isEqual(s.field)&&Ln(r.value,s.value)}(t,e):t instanceof In?function(r,s){return s instanceof In&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&E0(o,s.filters[l]),!0):!1}(t,e):void te()}function b0(t){return t instanceof qe?function(n){return`${n.field.canonicalString()} ${n.op} ${bi(n.value)}`}(t):t instanceof In?function(n){return n.op.toString()+" {"+n.getFilters().map(b0).join(" ,")+"}"}(t):"Filter"}class ZA extends qe{constructor(e,n,r){super(e,n,r),this.key=J.fromName(r.referenceValue)}matches(e){const n=J.comparator(e.key,this.key);return this.matchesComparison(n)}}class eP extends qe{constructor(e,n){super(e,"in",n),this.keys=S0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class tP extends qe{constructor(e,n){super(e,"not-in",n),this.keys=S0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function S0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>J.fromName(r.referenceValue))}class nP extends qe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Xf(n)&&ra(n.arrayValue,this.value)}}class rP extends qe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ra(this.value.arrayValue,n)}}class sP extends qe{constructor(e,n){super(e,"not-in",n)}matches(e){if(ra(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ra(this.value.arrayValue,n)}}class iP extends qe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Xf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ra(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function vy(t,e=null,n=[],r=[],s=null,i=null,o=null){return new oP(t,e,n,r,s,i,o)}function Jf(t){const e=ie(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>bh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Gu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>bi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>bi(r)).join(",")),e.ue=n}return e.ue}function Zf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!XA(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!E0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yy(t.startAt,e.startAt)&&yy(t.endAt,e.endAt)}function Sh(t){return J.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function aP(t,e,n,r,s,i,o,l){return new wa(t,e,n,r,s,i,o,l)}function Ku(t){return new wa(t)}function _y(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function T0(t){return t.collectionGroup!==null}function No(t){const e=ie(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new ft(dt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new _u(i,r))}),n.has(dt.keyField().canonicalString())||e.ce.push(new _u(dt.keyField(),r))}return e.ce}function On(t){const e=ie(t);return e.le||(e.le=lP(e,No(t))),e.le}function lP(t,e){if(t.limitType==="F")return vy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new _u(s.field,i)});const n=t.endAt?new vu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new vu(t.startAt.position,t.startAt.inclusive):null;return vy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Th(t,e){const n=t.filters.concat([e]);return new wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ih(t,e,n){return new wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Qu(t,e){return Zf(On(t),On(e))&&t.limitType===e.limitType}function I0(t){return`${Jf(On(t))}|lt:${t.limitType}`}function Ms(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>b0(s)).join(", ")}]`),Gu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>bi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>bi(s)).join(",")),`Target(${r})`}(On(t))}; limitType=${t.limitType})`}function Yu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):J.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of No(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const d=gy(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,No(r),s)||r.endAt&&!function(o,l,u){const d=gy(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,No(r),s))}(t,e)}function uP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function C0(t){return(e,n)=>{let r=!1;for(const s of No(t)){const i=cP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function cP(t,e,n){const r=t.field.isKeyField()?J.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?Ei(u,d):te()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return te()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Di(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return g0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP=new je(J.comparator);function lr(){return dP}const A0=new je(J.comparator);function yo(...t){let e=A0;for(const n of t)e=e.insert(n.key,n);return e}function P0(t){let e=A0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ls(){return ko()}function R0(){return ko()}function ko(){return new ji(t=>t.toString(),(t,e)=>t.isEqual(e))}const hP=new je(J.comparator),fP=new ft(J.comparator);function ue(...t){let e=fP;for(const n of t)e=e.add(n);return e}const pP=new ft(ge);function mP(){return pP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yu(e)?"-0":e}}function N0(t){return{integerValue:""+t}}function gP(t,e){return qA(e)?N0(e):ep(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(){this._=void 0}}function yP(t,e,n){return t instanceof sa?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Qf(i)&&(i=Yf(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof ia?D0(t,e):t instanceof oa?j0(t,e):function(s,i){const o=k0(s,i),l=xy(o)+xy(s.Pe);return Eh(o)&&Eh(s.Pe)?N0(l):ep(s.serializer,l)}(t,e)}function vP(t,e,n){return t instanceof ia?D0(t,e):t instanceof oa?j0(t,e):n}function k0(t,e){return t instanceof xu?function(r){return Eh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class sa extends Xu{}class ia extends Xu{constructor(e){super(),this.elements=e}}function D0(t,e){const n=O0(e);for(const r of t.elements)n.some(s=>Ln(s,r))||n.push(r);return{arrayValue:{values:n}}}class oa extends Xu{constructor(e){super(),this.elements=e}}function j0(t,e){let n=O0(e);for(const r of t.elements)n=n.filter(s=>!Ln(s,r));return{arrayValue:{values:n}}}class xu extends Xu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function xy(t){return Fe(t.integerValue||t.doubleValue)}function O0(t){return Xf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e,n){this.field=e,this.transform=n}}function xP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ia&&s instanceof ia||r instanceof oa&&s instanceof oa?wi(r.elements,s.elements,Ln):r instanceof xu&&s instanceof xu?Ln(r.Pe,s.Pe):r instanceof sa&&s instanceof sa}(t.transform,e.transform)}class wP{constructor(e,n){this.version=e,this.transformResults=n}}class bn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new bn}static exists(e){return new bn(void 0,e)}static updateTime(e){return new bn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ol(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ju{}function V0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new tp(t.key,bn.none()):new Ea(t.key,t.data,bn.none());{const n=t.data,r=rn.empty();let s=new ft(dt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ts(t.key,r,new _n(s.toArray()),bn.none())}}function EP(t,e,n){t instanceof Ea?function(s,i,o){const l=s.value.clone(),u=Ey(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Ts?function(s,i,o){if(!Ol(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Ey(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(M0(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Do(t,e,n,r){return t instanceof Ea?function(i,o,l,u){if(!Ol(i.precondition,o))return l;const d=i.value.clone(),h=by(i.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ts?function(i,o,l,u){if(!Ol(i.precondition,o))return l;const d=by(i.fieldTransforms,u,o),h=o.data;return h.setAll(M0(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,l){return Ol(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function bP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=k0(r.transform,s||null);i!=null&&(n===null&&(n=rn.empty()),n.set(r.field,i))}return n||null}function wy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&wi(r,s,(i,o)=>xP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ea extends Ju{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ts extends Ju{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function M0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Ey(t,e,n){const r=new Map;we(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,vP(o,l,n[s]))}return r}function by(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,yP(i,o,e))}return r}class tp extends Ju{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class SP extends Ju{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&EP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Do(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Do(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=R0();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=V0(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ue())}isEqual(e){return this.batchId===e.batchId&&wi(this.mutations,e.mutations,(n,r)=>wy(n,r))&&wi(this.baseMutations,e.baseMutations,(n,r)=>wy(n,r))}}class np{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){we(e.mutations.length===r.length);let s=function(){return hP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new np(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e,he;function AP(t){switch(t){default:return te();case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0}}function L0(t){if(t===void 0)return ar("GRPC error has no .code"),L.UNKNOWN;switch(t){case $e.OK:return L.OK;case $e.CANCELLED:return L.CANCELLED;case $e.UNKNOWN:return L.UNKNOWN;case $e.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case $e.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case $e.INTERNAL:return L.INTERNAL;case $e.UNAVAILABLE:return L.UNAVAILABLE;case $e.UNAUTHENTICATED:return L.UNAUTHENTICATED;case $e.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case $e.NOT_FOUND:return L.NOT_FOUND;case $e.ALREADY_EXISTS:return L.ALREADY_EXISTS;case $e.PERMISSION_DENIED:return L.PERMISSION_DENIED;case $e.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case $e.ABORTED:return L.ABORTED;case $e.OUT_OF_RANGE:return L.OUT_OF_RANGE;case $e.UNIMPLEMENTED:return L.UNIMPLEMENTED;case $e.DATA_LOSS:return L.DATA_LOSS;default:return te()}}(he=$e||($e={}))[he.OK=0]="OK",he[he.CANCELLED=1]="CANCELLED",he[he.UNKNOWN=2]="UNKNOWN",he[he.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",he[he.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",he[he.NOT_FOUND=5]="NOT_FOUND",he[he.ALREADY_EXISTS=6]="ALREADY_EXISTS",he[he.PERMISSION_DENIED=7]="PERMISSION_DENIED",he[he.UNAUTHENTICATED=16]="UNAUTHENTICATED",he[he.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",he[he.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",he[he.ABORTED=10]="ABORTED",he[he.OUT_OF_RANGE=11]="OUT_OF_RANGE",he[he.UNIMPLEMENTED=12]="UNIMPLEMENTED",he[he.INTERNAL=13]="INTERNAL",he[he.UNAVAILABLE=14]="UNAVAILABLE",he[he.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP=new hs([4294967295,4294967295],0);function Sy(t){const e=PP().encode(t),n=new l0;return n.update(e),new Uint8Array(n.digest())}function Ty(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new hs([n,r],0),new hs([s,i],0)]}class rp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new vo(`Invalid padding: ${n}`);if(r<0)throw new vo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new vo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new vo(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=hs.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(hs.fromNumber(r)));return s.compare(RP)===1&&(s=new hs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Sy(e),[r,s]=Ty(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new rp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Sy(e),[r,s]=Ty(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class vo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ba.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Zu(se.min(),s,new je(ge),lr(),ue())}}class ba{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ba(r,n,ue(),ue(),ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class F0{constructor(e,n){this.targetId=e,this.me=n}}class U0{constructor(e,n,r=mt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Iy{constructor(){this.fe=0,this.ge=Ay(),this.pe=mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ue(),n=ue(),r=ue();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:te()}}),new ba(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Ay()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,we(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class NP{constructor(e){this.Le=e,this.Be=new Map,this.ke=lr(),this.qe=Cy(),this.Qe=new je(ge)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:te()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Sh(i))if(r===0){const o=new J(i.path);this.Ue(n,o,St.newNoDocument(o,se.min()))}else we(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=ws(r).toUint8Array()}catch(u){if(u instanceof y0)return xi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new rp(o,s,i)}catch(u){return xi(u instanceof vo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&Sh(l.target)){const u=new J(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,St.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=ue();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Zu(e,n,this.Qe,this.ke,r);return this.ke=lr(),this.qe=Cy(),this.Qe=new je(ge),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Iy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ft(ge),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||G("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Iy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Cy(){return new je(J.comparator)}function Ay(){return new je(J.comparator)}const kP={asc:"ASCENDING",desc:"DESCENDING"},DP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jP={and:"AND",or:"OR"};class OP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ch(t,e){return t.useProto3Json||Gu(e)?e:{value:e}}function wu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function z0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function VP(t,e){return wu(t,e.toTimestamp())}function Vn(t){return we(!!t),se.fromTimestamp(function(n){const r=Hr(n);return new Ze(r.seconds,r.nanos)}(t))}function sp(t,e){return Ah(t,e).canonicalString()}function Ah(t,e){const n=function(s){return new Ce(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function B0(t){const e=Ce.fromString(t);return we(G0(e)),e}function Ph(t,e){return sp(t.databaseId,e.path)}function ld(t,e){const n=B0(e);if(n.get(1)!==t.databaseId.projectId)throw new W(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new J(H0(n))}function $0(t,e){return sp(t.databaseId,e)}function MP(t){const e=B0(t);return e.length===4?Ce.emptyPath():H0(e)}function Rh(t){return new Ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function H0(t){return we(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Py(t,e,n){return{name:Ph(t,e),fields:n.value.mapValue.fields}}function LP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:te()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(we(h===void 0||typeof h=="string"),mt.fromBase64String(h||"")):(we(h===void 0||h instanceof Buffer||h instanceof Uint8Array),mt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?L.UNKNOWN:L0(d.code);return new W(h,d.message||"")}(o);n=new U0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ld(t,r.document.name),i=Vn(r.document.updateTime),o=r.document.createTime?Vn(r.document.createTime):se.min(),l=new rn({mapValue:{fields:r.document.fields}}),u=St.newFoundDocument(s,i,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Vl(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ld(t,r.document),i=r.readTime?Vn(r.readTime):se.min(),o=St.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Vl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ld(t,r.document),i=r.removedTargetIds||[];n=new Vl([],i,s,null)}else{if(!("filter"in e))return te();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new CP(s,i),l=r.targetId;n=new F0(l,o)}}return n}function FP(t,e){let n;if(e instanceof Ea)n={update:Py(t,e.key,e.value)};else if(e instanceof tp)n={delete:Ph(t,e.key)};else if(e instanceof Ts)n={update:Py(t,e.key,e.data),updateMask:KP(e.fieldMask)};else{if(!(e instanceof SP))return te();n={verify:Ph(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof sa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ia)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof oa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof xu)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw te()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:VP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:te()}(t,e.precondition)),n}function UP(t,e){return t&&t.length>0?(we(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Vn(s.updateTime):Vn(i);return o.isEqual(se.min())&&(o=Vn(i)),new wP(o,s.transformResults||[])}(n,e))):[]}function zP(t,e){return{documents:[$0(t,e.path)]}}function BP(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$0(t,s);const i=function(d){if(d.length!==0)return q0(In.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(y){return{field:Ls(y.field),direction:WP(y.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Ch(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function $P(t){let e=MP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){we(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(g){const y=W0(g);return y instanceof In&&w0(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(y=>function(N){return new _u(Fs(N.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(g){let y;return y=typeof g=="object"?g.value:g,Gu(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,C=g.values||[];return new vu(C,y)}(n.startAt));let d=null;return n.endAt&&(d=function(g){const y=!g.before,C=g.values||[];return new vu(C,y)}(n.endAt)),aP(e,s,o,i,l,"F",u,d)}function HP(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return te()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function W0(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Fs(n.unaryFilter.field);return qe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Fs(n.unaryFilter.field);return qe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Fs(n.unaryFilter.field);return qe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fs(n.unaryFilter.field);return qe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return te()}}(t):t.fieldFilter!==void 0?function(n){return qe.create(Fs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return te()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return In.create(n.compositeFilter.filters.map(r=>W0(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return te()}}(n.compositeFilter.op))}(t):te()}function WP(t){return kP[t]}function qP(t){return DP[t]}function GP(t){return jP[t]}function Ls(t){return{fieldPath:t.canonicalString()}}function Fs(t){return dt.fromServerFormat(t.fieldPath)}function q0(t){return t instanceof qe?function(n){if(n.op==="=="){if(my(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NAN"}};if(py(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(my(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NOT_NAN"}};if(py(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ls(n.field),op:qP(n.op),value:n.value}}}(t):t instanceof In?function(n){const r=n.getFilters().map(s=>q0(s));return r.length===1?r[0]:{compositeFilter:{op:GP(n.op),filters:r}}}(t):te()}function KP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function G0(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,n,r,s,i=se.min(),o=se.min(),l=mt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Ar(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e){this.ct=e}}function YP(t){const e=$P({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ih(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this.un=new JP}addToCollectionParentIndex(e,n){return this.un.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve($r.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve($r.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class JP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ft(Ce.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ft(Ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Si(0)}static kn(){return new Si(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(){this.changes=new ji(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,St.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Do(r.mutation,s,_n.empty(),Ze.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ue()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ue()){const s=ls();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=yo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ls();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ue()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=lr();const o=ko(),l=function(){return ko()}();return n.forEach((u,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Ts)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Do(h.mutation,d,h.mutation.getFieldMask(),Ze.now())):o.set(d.key,_n.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var g;return l.set(d,new eR(h,(g=o.get(d))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=ko();let s=new je((o,l)=>o-l),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||_n.empty();h=l.applyToLocalView(d,h),r.set(u,h);const g=(s.get(l.batchId)||ue()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,h=u.value,g=R0();h.forEach(y=>{if(!i.has(y)){const C=V0(n.get(y),r.get(y));C!==null&&g.set(y,C),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return J.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):T0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):F.resolve(ls());let l=-1,u=i;return o.next(d=>F.forEach(d,(h,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(h)?F.resolve():this.remoteDocumentCache.getEntry(e,h).next(y=>{u=u.insert(h,y)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,ue())).next(h=>({batchId:l,changes:P0(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new J(n)).next(r=>{let s=yo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=yo();return this.indexManager.getCollectionParents(e,i).next(l=>F.forEach(l,u=>{const d=function(g,y){return new wa(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((g,y)=>{o=o.insert(g,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,St.newInvalidDocument(h)))});let l=yo();return o.forEach((u,d)=>{const h=i.get(u);h!==void 0&&Do(h.mutation,d,_n.empty(),Ze.now()),Yu(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return F.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Vn(s.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:YP(s.bundledQuery),readTime:Vn(s.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(){this.overlays=new je(J.comparator),this.Ir=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ls();return F.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const s=ls(),i=n.length+1,o=new J(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return F.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new je((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=ls(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=ls(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=s)););return F.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new IP(n,r));let i=this.Ir.get(n);i===void 0&&(i=ue(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(){this.sessionToken=mt.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(){this.Tr=new ft(st.Er),this.dr=new ft(st.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new st(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new st(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new J(new Ce([])),r=new st(n,e),s=new st(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new J(new Ce([])),r=new st(n,e),s=new st(n,e+1);let i=ue();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new st(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class st{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return J.comparator(e.key,n.key)||ge(e.wr,n.wr)}static Ar(e,n){return ge(e.wr,n.wr)||J.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ft(st.Er)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new TP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new st(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new st(n,0),s=new st(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ft(ge);return n.forEach(s=>{const i=new st(s,0),o=new st(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),F.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;J.isDocumentKey(i)||(i=i.child(""));const o=new st(new J(i),0);let l=new ft(ge);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.wr)),!0)},o),F.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){we(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return F.forEach(n.mutations,s=>{const i=new st(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new st(n,0),s=this.br.firstAfterOrEqual(r);return F.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(e){this.Mr=e,this.docs=function(){return new je(J.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():St.newInvalidDocument(n))}getEntries(e,n){let r=lr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():St.newInvalidDocument(s))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=lr();const o=n.path,l=new J(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||BA(zA(h),r)<=0||(s.has(h.key)||Yu(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,r,s){te()}Or(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new aR(this)}getSize(e){return F.resolve(this.size)}}class aR extends ZP{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e){this.persistence=e,this.Nr=new ji(n=>Jf(n),Zf),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ip,this.targetCount=0,this.kr=Si.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),F.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Si(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.Kn(n),F.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),F.waitFor(i).next(()=>s)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Kf(0),this.Kr=!1,this.Kr=!0,this.$r=new sR,this.referenceDelegate=e(this),this.Ur=new lR(this),this.indexManager=new XP,this.remoteDocumentCache=function(s){return new oR(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new QP(n),this.Gr=new nR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new rR,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new iR(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){G("MemoryPersistence","Starting transaction:",e);const s=new cR(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return F.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class cR extends HA{constructor(e){super(),this.currentSequenceNumber=e}}class op{constructor(e){this.persistence=e,this.Jr=new ip,this.Yr=null}static Zr(e){return new op(e)}get Xr(){if(this.Yr)return this.Yr;throw te()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),F.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.Xr,r=>{const s=J.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,se.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return F.or([()=>F.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ue(),s=ue();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ap(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return hT()?8:WA(It())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new dR;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(oo()<=de.DEBUG&&G("QueryEngine","SDK will not create cache indexes for query:",Ms(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),F.resolve()):(oo()<=de.DEBUG&&G("QueryEngine","Query:",Ms(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(oo()<=de.DEBUG&&G("QueryEngine","The SDK decides to create cache indexes for query:",Ms(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,On(n))):F.resolve())}Yi(e,n){if(_y(n))return F.resolve(null);let r=On(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Ih(n,null,"F"),r=On(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ue(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,l);return this.ns(n,d,o,u.readTime)?this.Yi(e,Ih(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return _y(n)||s.isEqual(se.min())?F.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?F.resolve(null):(oo()<=de.DEBUG&&G("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ms(n)),this.rs(e,o,n,UA(s,-1)).next(l=>l))})}ts(e,n){let r=new ft(C0(e));return n.forEach((s,i)=>{Yu(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return oo()<=de.DEBUG&&G("QueryEngine","Using full collection scan to execute query:",Ms(n)),this.Ji.getDocumentsMatchingQuery(e,n,$r.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new je(ge),this._s=new ji(i=>Jf(i),Zf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tR(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function pR(t,e,n,r){return new fR(t,e,n,r)}async function K0(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=ue();for(const d of s){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function mR(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,h){const g=d.batch,y=g.keys();let C=F.resolve();return y.forEach(N=>{C=C.next(()=>h.getEntry(u,N)).next(E=>{const D=d.docVersions.get(N);we(D!==null),E.version.compareTo(D)<0&&(g.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),h.addEntry(E)))})}),C.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ue();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Q0(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function gR(t,e){const n=ie(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((h,g)=>{const y=s.get(g);if(!y)return;l.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,g)));let C=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?C=C.withResumeToken(mt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):h.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(h.resumeToken,r)),s=s.insert(g,C),function(E,D,b){return E.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(y,C,h)&&l.push(n.Ur.updateTargetData(i,C))});let u=lr(),d=ue();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(yR(i,o,e.documentUpdates).next(h=>{u=h.Ps,d=h.Is})),!r.isEqual(se.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return F.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=s,i))}function yR(t,e,n){let r=ue(),s=ue();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=lr();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(se.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):G("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function vR(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function _R(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,F.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Ar(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Nh(t,e,n){const r=ie(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!xa(o))throw o;G("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Ry(t,e,n){const r=ie(t);let s=se.min(),i=ue();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,h){const g=ie(u),y=g._s.get(h);return y!==void 0?F.resolve(g.os.get(y)):g.Ur.getTargetData(d,h)}(r,o,On(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:se.min(),n?i:ue())).next(l=>(xR(r,uP(e),l),{documents:l,Ts:i})))}function xR(t,e,n){let r=t.us.get(e)||se.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Ny{constructor(){this.activeTargetIds=mP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wR{constructor(){this.so=new Ny,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ny,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){G("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){G("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dl=null;function ud(){return dl===null?dl=function(){return 268435456+Math.round(2147483648*Math.random())}():dl++,"0x"+dl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xt="WebChannelConnection";class TR extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=ud(),u=this.xo(n,r.toUriEncodedString());G("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(n,u,d,s).then(h=>(G("RestConnection",`Received RPC '${n}' ${l}: `,h),h),h=>{throw xi("RestConnection",`RPC '${n}' ${l} failed with error: `,h,"url: ",u,"request:",s),h})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ki}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=bR[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=ud();return new Promise((o,l)=>{const u=new u0;u.setWithCredentials(!0),u.listenOnce(c0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Dl.NO_ERROR:const h=u.getResponseJson();G(xt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Dl.TIMEOUT:G(xt,`RPC '${e}' ${i} timed out`),l(new W(L.DEADLINE_EXCEEDED,"Request time out"));break;case Dl.HTTP_ERROR:const g=u.getStatus();if(G(xt,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const C=y==null?void 0:y.error;if(C&&C.status&&C.message){const N=function(D){const b=D.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(b)>=0?b:L.UNKNOWN}(C.status);l(new W(N,C.message))}else l(new W(L.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new W(L.UNAVAILABLE,"Connection failed."));break;default:te()}}finally{G(xt,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);G(xt,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=ud(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=f0(),l=h0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=i.join("");G(xt,`Creating RPC '${e}' stream ${s}: ${h}`,u);const g=o.createWebChannel(h,u);let y=!1,C=!1;const N=new SR({Io:D=>{C?G(xt,`Not sending because RPC '${e}' stream ${s} is closed:`,D):(y||(G(xt,`Opening RPC '${e}' stream ${s} transport.`),g.open(),y=!0),G(xt,`RPC '${e}' stream ${s} sending:`,D),g.send(D))},To:()=>g.close()}),E=(D,b,x)=>{D.listen(b,v=>{try{x(v)}catch(S){setTimeout(()=>{throw S},0)}})};return E(g,go.EventType.OPEN,()=>{C||(G(xt,`RPC '${e}' stream ${s} transport opened.`),N.yo())}),E(g,go.EventType.CLOSE,()=>{C||(C=!0,G(xt,`RPC '${e}' stream ${s} transport closed`),N.So())}),E(g,go.EventType.ERROR,D=>{C||(C=!0,xi(xt,`RPC '${e}' stream ${s} transport errored:`,D),N.So(new W(L.UNAVAILABLE,"The operation could not be completed")))}),E(g,go.EventType.MESSAGE,D=>{var b;if(!C){const x=D.data[0];we(!!x);const v=x,S=v.error||((b=v[0])===null||b===void 0?void 0:b.error);if(S){G(xt,`RPC '${e}' stream ${s} received error:`,S);const P=S.status;let A=function(w){const I=$e[w];if(I!==void 0)return L0(I)}(P),_=S.message;A===void 0&&(A=L.INTERNAL,_="Unknown error status: "+P+" with message "+S.message),C=!0,N.So(new W(A,_)),g.close()}else G(xt,`RPC '${e}' stream ${s} received:`,x),N.bo(x)}}),E(l,d0.STAT_EVENT,D=>{D.stat===xh.PROXY?G(xt,`RPC '${e}' stream ${s} detected buffering proxy`):D.stat===xh.NOPROXY&&G(xt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}}function cd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(t){return new OP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&G("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,n,r,s,i,o,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Y0(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===L.RESOURCE_EXHAUSTED?(ar(n.toString()),ar("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===L.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new W(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return G("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(G("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IR extends X0{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=LP(this.serializer,e),r=function(i){if(!("targetChange"in i))return se.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?se.min():o.readTime?Vn(o.readTime):se.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Rh(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=Sh(u)?{documents:zP(i,u)}:{query:BP(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=z0(i,o.resumeToken);const d=Ch(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(se.min())>0){l.readTime=wu(i,o.snapshotVersion.toTimestamp());const d=Ch(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=HP(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Rh(this.serializer),n.removeTarget=e,this.a_(n)}}class CR extends X0{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return we(!!e.streamToken),this.lastStreamToken=e.streamToken,we(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){we(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=UP(e.writeResults,e.commitTime),r=Vn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Rh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>FP(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new W(L.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Ah(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(L.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Ah(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(L.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class PR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ar(n),this.D_=!1):G("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Is(this)&&(G("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=ie(u);d.L_.add(4),await Sa(d),d.q_.set("Unknown"),d.L_.delete(4),await tc(d)}(this))})}),this.q_=new PR(r,s)}}async function tc(t){if(Is(t))for(const e of t.B_)await e(!0)}async function Sa(t){for(const e of t.B_)await e(!1)}function J0(t,e){const n=ie(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),dp(n)?cp(n):Oi(n).r_()&&up(n,e))}function lp(t,e){const n=ie(t),r=Oi(n);n.N_.delete(e),r.r_()&&Z0(n,e),n.N_.size===0&&(r.r_()?r.o_():Is(n)&&n.q_.set("Unknown"))}function up(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(se.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Oi(t).A_(e)}function Z0(t,e){t.Q_.xe(e),Oi(t).R_(e)}function cp(t){t.Q_=new NP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Oi(t).start(),t.q_.v_()}function dp(t){return Is(t)&&!Oi(t).n_()&&t.N_.size>0}function Is(t){return ie(t).L_.size===0}function ew(t){t.Q_=void 0}async function NR(t){t.q_.set("Online")}async function kR(t){t.N_.forEach((e,n)=>{up(t,e)})}async function DR(t,e){ew(t),dp(t)?(t.q_.M_(e),cp(t)):t.q_.set("Unknown")}async function jR(t,e,n){if(t.q_.set("Online"),e instanceof U0&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){G("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Eu(t,r)}else if(e instanceof Vl?t.Q_.Ke(e):e instanceof F0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(se.min()))try{const r=await Q0(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=i.N_.get(d);h&&i.N_.set(d,h.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const h=i.N_.get(u);if(!h)return;i.N_.set(u,h.withResumeToken(mt.EMPTY_BYTE_STRING,h.snapshotVersion)),Z0(i,u);const g=new Ar(h.target,u,d,h.sequenceNumber);up(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){G("RemoteStore","Failed to raise snapshot:",r),await Eu(t,r)}}async function Eu(t,e,n){if(!xa(e))throw e;t.L_.add(1),await Sa(t),t.q_.set("Offline"),n||(n=()=>Q0(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{G("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await tc(t)})}function tw(t,e){return e().catch(n=>Eu(t,n,e))}async function nc(t){const e=ie(t),n=Wr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;OR(e);)try{const s=await vR(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,VR(e,s)}catch(s){await Eu(e,s)}nw(e)&&rw(e)}function OR(t){return Is(t)&&t.O_.length<10}function VR(t,e){t.O_.push(e);const n=Wr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function nw(t){return Is(t)&&!Wr(t).n_()&&t.O_.length>0}function rw(t){Wr(t).start()}async function MR(t){Wr(t).p_()}async function LR(t){const e=Wr(t);for(const n of t.O_)e.m_(n.mutations)}async function FR(t,e,n){const r=t.O_.shift(),s=np.from(r,e,n);await tw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await nc(t)}async function UR(t,e){e&&Wr(t).V_&&await async function(r,s){if(function(o){return AP(o)&&o!==L.ABORTED}(s.code)){const i=r.O_.shift();Wr(r).s_(),await tw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await nc(r)}}(t,e),nw(t)&&rw(t)}async function Dy(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),G("RemoteStore","RemoteStore received new credentials");const r=Is(n);n.L_.add(3),await Sa(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await tc(n)}async function zR(t,e){const n=ie(t);e?(n.L_.delete(2),await tc(n)):e||(n.L_.add(2),await Sa(n),n.q_.set("Unknown"))}function Oi(t){return t.K_||(t.K_=function(n,r,s){const i=ie(n);return i.w_(),new IR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:NR.bind(null,t),Ro:kR.bind(null,t),mo:DR.bind(null,t),d_:jR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),dp(t)?cp(t):t.q_.set("Unknown")):(await t.K_.stop(),ew(t))})),t.K_}function Wr(t){return t.U_||(t.U_=function(n,r,s){const i=ie(n);return i.w_(),new CR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:MR.bind(null,t),mo:UR.bind(null,t),f_:LR.bind(null,t),g_:FR.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await nc(t)):(await t.U_.stop(),t.O_.length>0&&(G("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new hp(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fp(t,e){if(ar("AsyncQueue",`${e}: ${t}`),xa(t))return new W(L.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.comparator=e?(n,r)=>e(n,r)||J.comparator(n.key,r.key):(n,r)=>J.comparator(n.key,r.key),this.keyedMap=yo(),this.sortedSet=new je(this.comparator)}static emptySet(e){return new ui(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ui)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ui;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(){this.W_=new je(J.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):te():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ti{constructor(e,n,r,s,i,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Ti(e,n,ui.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class $R{constructor(){this.queries=Oy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ie(n),i=s.queries;s.queries=Oy(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new W(L.ABORTED,"Firestore shutting down"))}}function Oy(){return new ji(t=>I0(t),Qu)}async function pp(t,e){const n=ie(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new BR,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=fp(o,`Initialization of query '${Ms(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&gp(n)}async function mp(t,e){const n=ie(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function HR(t,e){const n=ie(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&gp(n)}function WR(t,e,n){const r=ie(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function gp(t){t.Y_.forEach(e=>{e.next()})}var kh,Vy;(Vy=kh||(kh={})).ea="default",Vy.Cache="cache";class yp{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ti(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ti.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==kh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e){this.key=e}}class iw{constructor(e){this.key=e}}class qR{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ue(),this.mutatedKeys=ue(),this.Aa=C0(e),this.Ra=new ui(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new jy,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,g)=>{const y=s.get(h),C=Yu(this.query,g)?g:null,N=!!y&&this.mutatedKeys.has(y.key),E=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let D=!1;y&&C?y.data.isEqual(C.data)?N!==E&&(r.track({type:3,doc:C}),D=!0):this.ga(y,C)||(r.track({type:2,doc:C}),D=!0,(u&&this.Aa(C,u)>0||d&&this.Aa(C,d)<0)&&(l=!0)):!y&&C?(r.track({type:0,doc:C}),D=!0):y&&!C&&(r.track({type:1,doc:y}),D=!0,(u||d)&&(l=!0)),D&&(C?(o=o.add(C),i=E?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,g)=>function(C,N){const E=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return te()}};return E(C)-E(N)}(h.type,g.type)||this.Aa(h.doc,g.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new Ti(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new jy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ue(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new iw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new sw(r))}),n}ba(e){this.Ta=e.Ts,this.da=ue();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ti.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class GR{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class KR{constructor(e){this.key=e,this.va=!1}}class QR{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ji(l=>I0(l),Qu),this.Ma=new Map,this.xa=new Set,this.Oa=new je(J.comparator),this.Na=new Map,this.La=new ip,this.Ba={},this.ka=new Map,this.qa=Si.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function YR(t,e,n=!0){const r=dw(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await ow(r,e,n,!0),s}async function XR(t,e){const n=dw(t);await ow(n,e,!0,!1)}async function ow(t,e,n,r){const s=await _R(t.localStore,On(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await JR(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&J0(t.remoteStore,s),l}async function JR(t,e,n,r,s){t.Ka=(g,y,C)=>async function(E,D,b,x){let v=D.view.ma(b);v.ns&&(v=await Ry(E.localStore,D.query,!1).then(({documents:_})=>D.view.ma(_,v)));const S=x&&x.targetChanges.get(D.targetId),P=x&&x.targetMismatches.get(D.targetId)!=null,A=D.view.applyChanges(v,E.isPrimaryClient,S,P);return Ly(E,D.targetId,A.wa),A.snapshot}(t,g,y,C);const i=await Ry(t.localStore,e,!0),o=new qR(e,i.Ts),l=o.ma(i.documents),u=ba.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,u);Ly(t,n,d.wa);const h=new GR(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function ZR(t,e,n){const r=ie(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Qu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Nh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&lp(r.remoteStore,s.targetId),Dh(r,s.targetId)}).catch(_a)):(Dh(r,s.targetId),await Nh(r.localStore,s.targetId,!0))}async function eN(t,e){const n=ie(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),lp(n.remoteStore,r.targetId))}async function tN(t,e,n){const r=lN(t);try{const s=await function(o,l){const u=ie(o),d=Ze.now(),h=l.reduce((C,N)=>C.add(N.key),ue());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let N=lr(),E=ue();return u.cs.getEntries(C,h).next(D=>{N=D,N.forEach((b,x)=>{x.isValidDocument()||(E=E.add(b))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,N)).next(D=>{g=D;const b=[];for(const x of l){const v=bP(x,g.get(x.key).overlayedDocument);v!=null&&b.push(new Ts(x.key,v,v0(v.value.mapValue),bn.exists(!0)))}return u.mutationQueue.addMutationBatch(C,d,b,l)}).next(D=>{y=D;const b=D.applyToLocalDocumentSet(g,E);return u.documentOverlayCache.saveOverlays(C,D.batchId,b)})}).then(()=>({batchId:y.batchId,changes:P0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new je(ge)),d=d.insert(l,u),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,n),await Ta(r,s.changes),await nc(r.remoteStore)}catch(s){const i=fp(s,"Failed to persist write");n.reject(i)}}async function aw(t,e){const n=ie(t);try{const r=await gR(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(we(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?we(o.va):s.removedDocuments.size>0&&(we(o.va),o.va=!1))}),await Ta(n,r,e)}catch(r){await _a(r)}}function My(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=ie(o);u.onlineState=l;let d=!1;u.queries.forEach((h,g)=>{for(const y of g.j_)y.Z_(l)&&(d=!0)}),d&&gp(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nN(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new je(J.comparator);o=o.insert(i,St.newNoDocument(i,se.min()));const l=ue().add(i),u=new Zu(se.min(),new Map,new je(ge),o,l);await aw(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),vp(r)}else await Nh(r.localStore,e,!1).then(()=>Dh(r,e,n)).catch(_a)}async function rN(t,e){const n=ie(t),r=e.batch.batchId;try{const s=await mR(n.localStore,e);uw(n,r,null),lw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ta(n,s)}catch(s){await _a(s)}}async function sN(t,e,n){const r=ie(t);try{const s=await function(o,l){const u=ie(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,l).next(g=>(we(g!==null),h=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(r.localStore,e);uw(r,e,n),lw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ta(r,s)}catch(s){await _a(s)}}function lw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function uw(t,e,n){const r=ie(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Dh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||cw(t,r)})}function cw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(lp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),vp(t))}function Ly(t,e,n){for(const r of n)r instanceof sw?(t.La.addReference(r.key,e),iN(t,r)):r instanceof iw?(G("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||cw(t,r.key)):te()}function iN(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(G("SyncEngine","New document in limbo: "+n),t.xa.add(r),vp(t))}function vp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new J(Ce.fromString(e)),r=t.qa.next();t.Na.set(r,new KR(n)),t.Oa=t.Oa.insert(n,r),J0(t.remoteStore,new Ar(On(Ku(n.path)),r,"TargetPurposeLimboResolution",Kf.oe))}}async function Ta(t,e,n){const r=ie(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const g=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(d){s.push(d);const g=ap.Wi(u.targetId,d);i.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,d){const h=ie(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>F.forEach(d,y=>F.forEach(y.$i,C=>h.persistence.referenceDelegate.addReference(g,y.targetId,C)).next(()=>F.forEach(y.Ui,C=>h.persistence.referenceDelegate.removeReference(g,y.targetId,C)))))}catch(g){if(!xa(g))throw g;G("LocalStore","Failed to update sequence numbers: "+g)}for(const g of d){const y=g.targetId;if(!g.fromCache){const C=h.os.get(y),N=C.snapshotVersion,E=C.withLastLimboFreeSnapshotVersion(N);h.os=h.os.insert(y,E)}}}(r.localStore,i))}async function oN(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){G("SyncEngine","User change. New user:",e.toKey());const r=await K0(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new W(L.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ta(n,r.hs)}}function aN(t,e){const n=ie(t),r=n.Na.get(e);if(r&&r.va)return ue().add(r.key);{let s=ue();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function dw(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=aw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nN.bind(null,e),e.Ca.d_=HR.bind(null,e.eventManager),e.Ca.$a=WR.bind(null,e.eventManager),e}function lN(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sN.bind(null,e),e}class bu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ec(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return pR(this.persistence,new hR,e.initialUser,this.serializer)}Ga(e){return new uR(op.Zr,this.serializer)}Wa(e){return new wR}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bu.provider={build:()=>new bu};class jh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>My(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oN.bind(null,this.syncEngine),await zR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $R}()}createDatastore(e){const n=ec(e.databaseInfo.databaseId),r=function(i){return new TR(i)}(e.databaseInfo);return function(i,o,l,u){return new AR(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new RR(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>My(this.syncEngine,n,0),function(){return ky.D()?new ky:new ER}())}createSyncEngine(e,n){return function(s,i,o,l,u,d,h){const g=new QR(s,i,o,l,u,d);return h&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ie(s);G("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Sa(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}jh.provider={build:()=>new jh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ar("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Et.UNAUTHENTICATED,this.clientId=m0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{G("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(G("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=fp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function dd(t,e){t.asyncQueue.verifyOperationInProgress(),G("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await K0(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Fy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await cN(t);G("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Dy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Dy(e.remoteStore,s)),t._onlineComponents=e}async function cN(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){G("FirestoreClient","Using user provided OfflineComponentProvider");try{await dd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===L.FAILED_PRECONDITION||s.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;xi("Error using user provided cache. Falling back to memory cache: "+n),await dd(t,new bu)}}else G("FirestoreClient","Using default OfflineComponentProvider"),await dd(t,new bu);return t._offlineComponents}async function hw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(G("FirestoreClient","Using user provided OnlineComponentProvider"),await Fy(t,t._uninitializedComponentsProvider._online)):(G("FirestoreClient","Using default OnlineComponentProvider"),await Fy(t,new jh))),t._onlineComponents}function dN(t){return hw(t).then(e=>e.syncEngine)}async function Su(t){const e=await hw(t),n=e.eventManager;return n.onListen=YR.bind(null,e.syncEngine),n.onUnlisten=ZR.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=XR.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=eN.bind(null,e.syncEngine),n}function hN(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new _p({next:y=>{h.Za(),o.enqueueAndForget(()=>mp(i,g));const C=y.docs.has(l);!C&&y.fromCache?d.reject(new W(L.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&y.fromCache&&u&&u.source==="server"?d.reject(new W(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new yp(Ku(l.path),h,{includeMetadataChanges:!0,_a:!0});return pp(i,g)}(await Su(t),t.asyncQueue,e,n,r)),r.promise}function fN(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new _p({next:y=>{h.Za(),o.enqueueAndForget(()=>mp(i,g)),y.fromCache&&u.source==="server"?d.reject(new W(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new yp(l,h,{includeMetadataChanges:!0,_a:!0});return pp(i,g)}(await Su(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(t,e,n){if(!n)throw new W(L.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function pN(t,e,n,r){if(e===!0&&r===!0)throw new W(L.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function zy(t){if(!J.isDocumentKey(t))throw new W(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function By(t){if(J.isDocumentKey(t))throw new W(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function rc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":te()}function an(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rc(t);throw new W(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new W(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new W(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new W(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new W(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new W(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $y({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $y(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new NA;switch(r.type){case"firstParty":return new OA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Uy.get(n);r&&(G("ComponentProvider","Removing Datastore"),Uy.delete(n),r.terminate())}(this),Promise.resolve()}}function mN(t,e,n,r={}){var s;const i=(t=an(t,sc))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&xi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=Et.MOCK_USER;else{l=iT(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new W(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Et(d)}t._authCredentials=new kA(new p0(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Cs(this.firestore,e,this._query)}}class Dt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ur(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dt(this.firestore,e,this._key)}}class Ur extends Cs{constructor(e,n,r){super(e,n,Ku(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dt(this.firestore,null,new J(e))}withConverter(e){return new Ur(this.firestore,e,this._path)}}function Sn(t,e,...n){if(t=jt(t),pw("collection","path",e),t instanceof sc){const r=Ce.fromString(e,...n);return By(r),new Ur(t,null,r)}{if(!(t instanceof Dt||t instanceof Ur))throw new W(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return By(r),new Ur(t.firestore,null,r)}}function cn(t,e,...n){if(t=jt(t),arguments.length===1&&(e=m0.newId()),pw("doc","path",e),t instanceof sc){const r=Ce.fromString(e,...n);return zy(r),new Dt(t,null,new J(r))}{if(!(t instanceof Dt||t instanceof Ur))throw new W(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return zy(r),new Dt(t.firestore,t instanceof Ur?t.converter:null,new J(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Y0(this,"async_queue_retry"),this.Vu=()=>{const r=cd();r&&G("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=cd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=cd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new er;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!xa(e))throw e;G("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw ar("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=hp.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&te()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Wy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class qr extends sc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Hy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Hy(e),this._firestoreClient=void 0,await e}}}function gN(t,e){const n=typeof t=="object"?t:Ax(),r=typeof t=="string"?t:"(default)",s=Of(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=rT("firestore");i&&mN(s,...i)}return s}function ic(t){if(t._terminated)throw new W(L.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||yN(t),t._firestoreClient}function yN(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,d,h){return new KA(l,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,fw(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new uN(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ii(mt.fromBase64String(e))}catch(n){throw new W(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ii(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ge(this._lat,e._lat)||ge(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN=/^__.*__$/;class _N{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ts(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ea(e,this.data,n,this.fieldTransforms)}}function mw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw te()}}class Sp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Sp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Tu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(mw(this.Cu)&&vN.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class xN{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ec(e)}Qu(e,n,r,s=!1){return new Sp({Cu:e,methodName:n,qu:r,path:dt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Tp(t){const e=t._freezeSettings(),n=ec(t._databaseId);return new xN(t._databaseId,!!e.ignoreUndefinedProperties,n)}function gw(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);_w("Data must be an object, but it was:",o,r);const l=yw(r,o);let u,d;if(i.merge)u=new _n(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const g of i.mergeFields){const y=EN(e,g,n);if(!o.contains(y))throw new W(L.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);SN(h,y)||h.push(y)}u=new _n(h),d=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=o.fieldTransforms;return new _N(new rn(l),u,d)}class Ip extends wp{_toFieldTransform(e){return new _P(e.path,new sa)}isEqual(e){return e instanceof Ip}}function wN(t,e,n,r=!1){return Cp(n,t.Qu(r?4:3,e))}function Cp(t,e){if(vw(t=jt(t)))return _w("Unsupported field value:",e,t),yw(t,e);if(t instanceof wp)return function(r,s){if(!mw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=Cp(l,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=jt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return gP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ze.fromDate(r);return{timestampValue:wu(s.serializer,i)}}if(r instanceof Ze){const i=new Ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:wu(s.serializer,i)}}if(r instanceof Ep)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ii)return{bytesValue:z0(s.serializer,r._byteString)};if(r instanceof Dt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:sp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof bp)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return ep(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${rc(r)}`)}(t,e)}function yw(t,e){const n={};return g0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Di(t,(r,s)=>{const i=Cp(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function vw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ze||t instanceof Ep||t instanceof Ii||t instanceof Dt||t instanceof wp||t instanceof bp)}function _w(t,e,n){if(!vw(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=rc(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function EN(t,e,n){if((e=jt(e))instanceof xp)return e._internalPath;if(typeof e=="string")return xw(t,e);throw Tu("Field path arguments must be of type string or ",t,!1,void 0,n)}const bN=new RegExp("[~\\*/\\[\\]]");function xw(t,e,n){if(e.search(bN)>=0)throw Tu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new xp(...e.split("."))._internalPath}catch{throw Tu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Tu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new W(L.INVALID_ARGUMENT,l+t+u)}function SN(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ap("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class TN extends ww{data(){return super.data()}}function Ap(t,e){return typeof e=="string"?xw(t,e):e instanceof xp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Pp{}class IN extends Pp{}function Oh(t,e,...n){let r=[];e instanceof Pp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Rp).length,l=i.filter(u=>u instanceof oc).length;if(o>1||o>0&&l>0)throw new W(L.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class oc extends IN{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new oc(e,n,r)}_apply(e){const n=this._parse(e);return bw(e._query,n),new Cs(e.firestore,e.converter,Th(e._query,n))}_parse(e){const n=Tp(e.firestore);return function(i,o,l,u,d,h,g){let y;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new W(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Gy(g,h);const C=[];for(const N of g)C.push(qy(u,i,N));y={arrayValue:{values:C}}}else y=qy(u,i,g)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Gy(g,h),y=wN(l,o,g,h==="in"||h==="not-in");return qe.create(d,h,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function CN(t,e,n){const r=e,s=Ap("where",t);return oc._create(s,r,n)}class Rp extends Pp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Rp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:In.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)bw(o,u),o=Th(o,u)}(e._query,n),new Cs(e.firestore,e.converter,Th(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function qy(t,e,n){if(typeof(n=jt(n))=="string"){if(n==="")throw new W(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!T0(e)&&n.indexOf("/")!==-1)throw new W(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ce.fromString(n));if(!J.isDocumentKey(r))throw new W(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fy(t,new J(r))}if(n instanceof Dt)return fy(t,n._key);throw new W(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rc(n)}.`)}function Gy(t,e){if(!Array.isArray(t)||t.length===0)throw new W(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bw(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(L.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(L.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class AN{convertValue(e,n="none"){switch(Es(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ws(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw te()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Di(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Fe(o.doubleValue));return new bp(i)}convertGeoPoint(e){return new Ep(Fe(e.latitude),Fe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Yf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ta(e));default:return null}}convertTimestamp(e){const n=Hr(e);return new Ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ce.fromString(e);we(G0(r));const s=new na(r.get(1),r.get(3)),i=new J(r.popFirst(5));return s.isEqual(n)||ar(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Tw extends ww{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ml(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ap("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ml extends Tw{data(e={}){return super.data(e)}}class Iw{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new _o(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ml(this._firestore,this._userDataWriter,r.key,r,new _o(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Ml(s._firestore,s._userDataWriter,l.doc.key,l.doc,new _o(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Ml(s._firestore,s._userDataWriter,l.doc.key,l.doc,new _o(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:PN(l.type),doc:u,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function PN(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return te()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(t){t=an(t,Dt);const e=an(t.firestore,qr);return hN(ic(e),t._key).then(n=>Pw(e,t,n))}class Np extends AN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ii(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Dt(this.firestore,null,n)}}function Ll(t){t=an(t,Cs);const e=an(t.firestore,qr),n=ic(e),r=new Np(e);return Ew(t._query),fN(n,t._query).then(s=>new Iw(e,r,t,s))}function Vi(t,e,n){t=an(t,Dt);const r=an(t.firestore,qr),s=Sw(t.converter,e,n);return kp(r,[gw(Tp(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,bn.none())])}function Cw(t){return kp(an(t.firestore,qr),[new tp(t._key,bn.none())])}function Aw(t,e){const n=an(t.firestore,qr),r=cn(t),s=Sw(t.converter,e);return kp(n,[gw(Tp(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,bn.exists(!1))]).then(()=>r)}function ci(t,...e){var n,r,s;t=jt(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Wy(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Wy(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(s=g.complete)===null||s===void 0?void 0:s.bind(g)}let u,d,h;if(t instanceof Dt)d=an(t.firestore,qr),h=Ku(t._key.path),u={next:g=>{e[o]&&e[o](Pw(d,t,g))},error:e[o+1],complete:e[o+2]};else{const g=an(t,Cs);d=an(g.firestore,qr),h=g._query;const y=new Np(d);u={next:C=>{e[o]&&e[o](new Iw(d,y,g,C))},error:e[o+1],complete:e[o+2]},Ew(t._query)}return function(y,C,N,E){const D=new _p(E),b=new yp(C,D,N);return y.asyncQueue.enqueueAndForget(async()=>pp(await Su(y),b)),()=>{D.Za(),y.asyncQueue.enqueueAndForget(async()=>mp(await Su(y),b))}}(ic(d),h,l,u)}function kp(t,e){return function(r,s){const i=new er;return r.asyncQueue.enqueueAndForget(async()=>tN(await dN(r),s,i)),i.promise}(ic(t),e)}function Pw(t,e,n){const r=n.docs.get(e._key),s=new Np(t);return new Tw(t,s,e._key,r,new _o(n.hasPendingWrites,n.fromCache),e.converter)}function NN(){return new Ip("serverTimestamp")}(function(e,n=!0){(function(s){ki=s})(Ri),vi(new vs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new qr(new DA(r.getProvider("auth-internal")),new MA(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new W(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new na(d.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Fr(ly,"4.7.3",e),Fr(ly,"4.7.3","esm2017")})();const kN={apiKey:"AIzaSyDfsK4K4vhOmSSGeVHOlLnJuNlHGNha4LU",authDomain:"storycraft-a5f7e.firebaseapp.com",projectId:"storycraft-a5f7e",storageBucket:"storycraft-a5f7e.firebasestorage.app",messagingSenderId:"727724875985",appId:"1:727724875985:web:97411448885c68c289e5f0",measurementId:"G-JH03Y2NZDK"},Rw=Cx(kN),hd=CA(Rw),ze=gN(Rw),DN="1:727724875985:web:97411448885c68c289e5f0",Nw=V.createContext(),jN=({children:t})=>{const[e,n]=V.useState(null),[r,s]=V.useState(!1),[i,o]=V.useState(!0);V.useEffect(()=>{const h=mC(hd,g=>{n(g),g||(o(!1),s(!1))});return()=>h()},[]),V.useEffect(()=>{if(e){const h=cn(ze,`artifacts2/${DN}/users/${e.uid}`),g=ci(h,async y=>{if(y.exists()){const C=y.data().isMaster===!0;s(C),console.log("%c[DIAGNSTICO AUTH]","color: #00A8E8; font-weight: bold;",{isMaster:C,userData:y.data()})}else try{await Vi(h,{displayName:e.displayName,email:e.email,isMaster:!1}),s(!1)}catch(C){console.error("Erro ao criar o documento do utilizador:",C)}o(!1)},y=>{console.error("Erro ao escutar documento do utilizador:",y),o(!1)});return()=>g()}s(!1)},[e]);const d={user:e,loading:i,isMaster:r,googleSignIn:()=>{const h=new qn;return VC(hd,h)},googleSignOut:()=>gC(hd)};return c.jsx(Nw.Provider,{value:d,children:!i&&t})},Be=()=>{const t=V.useContext(Nw);if(!t)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return t},Ky="1:727724875985:web:97411448885c68c289e5f0",ON=(t,e)=>{const[n,r]=V.useState(null),[s,i]=V.useState(!0);V.useEffect(()=>{if(!t||!e){i(!1);return}const u=cn(ze,`artifacts2/${Ky}/users/${e}/characterSheets/${t}`),d=ci(u,h=>{if(h.exists()){const y={...h.data()};Object.keys(y).forEach(C=>{if(typeof y[C]=="string")try{y[C]=JSON.parse(y[C])}catch{}}),r({id:h.id,...y})}else console.error("Personagem no encontrado!"),r(null);i(!1)},h=>{console.error("Erro ao carregar o personagem:",h),i(!1)});return()=>d()},[t,e]);const o=V.useCallback(async(u,d)=>{if(!t||!e)return;const h=cn(ze,`artifacts2/${Ky}/users/${e}/characterSheets/${t}`),g=typeof d=="object"&&d!==null?JSON.stringify(d):d;try{await Vi(h,{[u]:g},{merge:!0})}catch(y){console.error(`Erro ao atualizar o campo ${u}:`,y)}},[t,e]),l=V.useCallback(u=>{var d;if(n){const h=((d=n.collapsedStates)==null?void 0:d[u])??!1,g={...n.collapsedStates,[u]:!h};o("collapsedStates",g)}},[n,o]);return{character:n,loading:s,updateCharacterField:o,toggleSection:l}},kw=V.createContext(),Ia=()=>V.useContext(kw),VN="1:727724875985:web:97411448885c68c289e5f0",MN=({children:t})=>{const[e,n]=V.useState(null),r=V.useMemo(()=>{switch(e){case"v1":return"artifacts2";case"v2":return"storycraft-v2";default:return"artifacts2"}},[e]),s={currentSystem:e,setCurrentSystem:n,characterDataCollectionRoot:r,GLOBAL_APP_IDENTIFIER:VN};return c.jsx(kw.Provider,{value:s,children:t})},$t=({title:t,isCollapsed:e,toggleSection:n,actions:r,children:s,isComplexTitle:i})=>c.jsxs("section",{className:"mb-8 p-6 bg-bgSurface backdrop-blur-sm rounded-xl shadow-inner border border-bgElement",children:[c.jsxs("div",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2 cursor-pointer flex justify-between items-center",onClick:n,children:[c.jsx("h2",{className:`flex-grow ${i?"":"truncate"}`.trim(),children:t}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{onClick:o=>o.stopPropagation(),children:r}),c.jsx("span",{children:e?"":""})]})]}),!e&&c.jsx("div",{className:"mt-4",children:s})]}),Js=[{name:"Acrobacia",attr:"DES"},{name:"Adestramento*",attr:"CAR"},{name:"Armadilhas*",attr:"INT"},{name:"Atletismo",attr:"FOR"},{name:"Atuao*",attr:"CAR"},{name:"Cavalgar",attr:"DES"},{name:"Cirurgia*",attr:"INT"},{name:"Conhecimento*",attr:"INT"},{name:"Cura",attr:"SAB"},{name:"Diplomacia",attr:"CAR"},{name:"Disfarce*",attr:"CAR"},{name:"Enganao",attr:"CAR"},{name:"Furtividade",attr:"DES"},{name:"Guerra*",attr:"INT"},{name:"Intimidao",attr:"CAR"},{name:"Intuio",attr:"SAB"},{name:"Investigao",attr:"INT"},{name:"Jogatina*",attr:"CAR"},{name:"Ladinagem*",attr:"DES"},{name:"Luta",attr:"FOR"},{name:"Misticismo*",attr:"INT"},{name:"Nobreza*",attr:"INT"},{name:"Ofcio",attr:"INT"},{name:"Percepo",attr:"SAB"},{name:"Pilotagem*",attr:"DES"},{name:"Pontaria",attr:"DES"},{name:"Prestidigitao",attr:"DES"},{name:"Religio*",attr:"SAB"},{name:"Seduo",attr:"CAR"},{name:"Sobrevivncia",attr:"SAB"}],Vh={FOR:"forca",DES:"destreza",CON:"constituicao",INT:"inteligencia",SAB:"sabedoria",CAR:"carisma"},LN=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,onUpdate:s,onExecuteFormula:i,isEditMode:o})=>{const{user:l}=Be(),u=l.uid===t.ownerUid||e,[d,h]=V.useState(t.skillSystem||{});V.useEffect(()=>{if((!t.skillSystem||Js.some(S=>!t.skillSystem[S.name]||!t.skillSystem[S.name].hasOwnProperty("selectedAttr")))&&u){console.log("Inicializando ou atualizando sistema de percias...");const S={...t.skillSystem};Js.forEach(P=>{const A=S[P.name]||{};A.hasOwnProperty("selectedAttr")||(S[P.name]={trained:A.trained||!1,otherBonus:A.otherBonus||0,selectedAttr:P.attr})}),s("skillSystem",S)}h(t.skillSystem||{})},[t.skillSystem,s,u]);const g=V.useMemo(()=>t.mainAttributes||{},[t.mainAttributes]),y=V.useMemo(()=>t.level||0,[t.level]),C=V.useCallback((v,S)=>{if(!S)return 0;const P=S.selectedAttr||v.attr,A=Vh[P],_=g[A]||0;let p=0;S.trained&&(p=2+Math.floor(y/10));const w=parseInt(S.otherBonus,10)||0;return _+p+w},[g,y]),N=v=>{if(!u||!o)return;const S=t.skillSystem||{},P=S[v]||{trained:!1,otherBonus:0},A={...S,[v]:{...P,trained:!P.trained}};s("skillSystem",A)},E=(v,S)=>{if(!u||!o)return;const P=t.skillSystem||{},A=P[v]||{trained:!1,otherBonus:0,selectedAttr:""},_={...P,[v]:{...A,selectedAttr:S}};s("skillSystem",_)},D=(v,S)=>{h(P=>{const A=P[v]||{trained:!1,otherBonus:0};return{...P,[v]:{...A,otherBonus:S}}})},b=v=>{var p,w,I;if(!u||!o)return;const S=(p=d[v])==null?void 0:p.otherBonus,P=(I=(w=t.skillSystem)==null?void 0:w[v])==null?void 0:I.otherBonus,A=parseInt(S,10)||0,_=parseInt(P,10)||0;if(A!==_){const k={...t.skillSystem,...d};k[v].otherBonus=A,s("skillSystem",k)}String(S)!==String(A)&&h(t.skillSystem||{})},x=(v,S)=>{const P=`${S>0?"+":""}${S}`,A={name:`Percia: ${v.name}`,components:[{type:"dice",value:"1d20"},{type:"number",value:S,label:"Bnus Total"}],discordText:`Rolagem de ${v.name} (1d20${P})`};i(A)};return!d||Object.keys(d).length<Js.length?c.jsx($t,{title:"Percias",isCollapsed:n,toggleSection:r,children:c.jsx("p",{className:"text-textSecondary text-center",children:"Carregando percias..."})}):c.jsx($t,{title:"Percias",isCollapsed:n,toggleSection:r,children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Js.map(v=>{const S=d[v.name];if(!S)return null;const P=C(v,S),A=`${P>=0?"+":""}${P}`,_=S.selectedAttr||v.attr;return c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex flex-col gap-2",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center gap-2 flex-grow overflow-hidden",children:[c.jsx("input",{type:"checkbox",id:`trained-${v.name}`,checked:S.trained,onChange:()=>N(v.name),className:"form-checkbox text-btnHighlightBg rounded-sm focus:ring-btnHighlightBg disabled:opacity-50",disabled:!u||!o}),c.jsx("label",{className:"font-semibold text-lg text-textPrimary truncate",title:`${v.name}`,children:v.name})]}),o?c.jsx("select",{value:_,onChange:p=>E(v.name,p.target.value),className:"bg-bgInput text-textPrimary text-sm font-bold rounded-md p-1 border-none focus:ring-2 focus:ring-btnHighlightBg",disabled:!u,children:Object.keys(Vh).map(p=>c.jsx("option",{value:p,children:p},p))}):c.jsxs("span",{className:"font-semibold text-textSecondary text-sm ml-1",children:["(",_,")"]}),c.jsx("span",{className:"font-bold text-lg text-btnHighlightBg whitespace-nowrap ml-2",children:A})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{htmlFor:`other-${v.name}`,className:"text-sm text-textSecondary whitespace-nowrap",children:"Outros:"}),c.jsx("input",{type:"number",id:`other-${v.name}`,value:S.otherBonus===0?"":S.otherBonus,onChange:p=>D(v.name,p.target.value),onBlur:()=>b(v.name),className:"w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center disabled:bg-bgPage",placeholder:"0",disabled:!u||!o}),c.jsx("button",{onClick:()=>x(v,P),className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg text-lg",title:`Rolar ${v.name} (1d20${A})`,children:""})]})]},v.name)})})})},FN=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i})=>{const o=V.useRef(null);return gv.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),c.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i})},UN=({character:t,isMaster:e,isCollapsed:n,toggleSection:r,onOpenActionModal:s,allAttributes:i,onUpdate:o,onExecuteFormula:l,isEditMode:u})=>{const{user:d}=Be();if(!t||!d)return null;const h=d.uid===t.ownerUid||e,[g,y]=V.useState(t.formulaActions||[]);V.useEffect(()=>{y(t.formulaActions||[])},[t.formulaActions]);const C=()=>{const A={id:crypto.randomUUID(),name:"Nova Ao",components:[{id:crypto.randomUUID(),type:"dice",value:"1d6"}],multiplier:1,discordText:"",isCollapsed:!1,costValue:0,costType:"",recoverHP:!1,recoverMP:!1};o("formulaActions",[...t.formulaActions||[],A])},N=A=>{o("formulaActions",(t.formulaActions||[]).filter(_=>_.id!==A))},E=(A,_,p)=>{y(w=>w.map(I=>I.id===A?{...I,[_]:p}:I))},D=V.useCallback((A,_,p)=>{const w=g.find(k=>k.id===A),I=(t.formulaActions||[]).find(k=>k.id===A);if(w&&I){const k=p!==void 0?p:w[_];k!==I[_]&&o("formulaActions",(t.formulaActions||[]).map(j=>j.id===A?{...j,[_]:k}:j))}},[g,t.formulaActions,o]),b=(A,_)=>{let p;_==="dice"?p={id:crypto.randomUUID(),type:_,value:"1d6"}:_==="attribute"?p={id:crypto.randomUUID(),type:_,value:""}:_==="critDice"?p={id:crypto.randomUUID(),type:_,value:"1d6",critValue:6,critBonusAttribute:"",critBonusMultiplier:1}:_==="skillRoll"&&(p={id:crypto.randomUUID(),type:_,skill:"",critMin:19,critFormula:""}),o("formulaActions",(t.formulaActions||[]).map(w=>w.id===A?{...w,components:[...w.components||[],p]}:w))},x=(A,_)=>{o("formulaActions",(t.formulaActions||[]).map(p=>p.id===A?{...p,components:(p.components||[]).filter(w=>w&&w.id!==_)}:p))},v=(A,_,p,w)=>{y(I=>I.map(k=>k.id===A?{...k,components:k.components.map(j=>j.id===_?{...j,[p]:w}:j)}:k))},S=V.useCallback((A,_,p,w)=>{const I=g.find(q=>q.id===A),k=I==null?void 0:I.components.find(q=>q.id===_),j=(t.formulaActions||[]).find(q=>q.id===A),R=j==null?void 0:j.components.find(q=>q.id===_);if(k&&R){const q=w!==void 0?w:k[p];q!==R[p]&&o("formulaActions",(t.formulaActions||[]).map(ne=>ne.id===A?{...ne,components:ne.components.map(ae=>ae.id===_?{...ae,[p]:q}:ae)}:ne))}},[g,t.formulaActions,o]),P=A=>{o("formulaActions",(t.formulaActions||[]).map(_=>_.id===A?{..._,isCollapsed:!_.isCollapsed}:_))};return c.jsx($t,{title:"Aes",isCollapsed:n,toggleSection:r,children:c.jsx(c.Fragment,{children:c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3",children:"Construtor de Aes Rpidas"}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(g||[]).map(A=>A.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>P(A.id),children:A.name||"Ao Sem Nome"}),c.jsx("button",{onClick:()=>l(A),className:"px-4 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap ml-2 text-sm",children:"Usar"})]},A.id):c.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center gap-2 mb-3",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>P(A.id),children:A.name||"Ao Sem Nome"}),c.jsx("button",{onClick:()=>l(A),className:"px-5 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg whitespace-nowrap",children:"Usar"}),h&&u&&c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>P(A.id),children:"Recolher "})]}),h&&u&&c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 border-t border-bgInput pt-3 mt-3 flex-grow",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome da Ao:"}),c.jsx("input",{type:"text",placeholder:"Nome da Ao",value:A.name,onChange:p=>E(A.id,"name",p.target.value),onBlur:()=>D(A.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-3",disabled:!h||!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Componentes da Frmula:"}),c.jsx("div",{className:"space-y-2 mb-3",children:(A.components||[]).filter(Boolean).map(p=>c.jsx("div",{className:"flex flex-col gap-2 p-2 rounded-md border border-dashed border-textSecondary/30",children:p.type==="dice"?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",placeholder:"1d6 ou 10",value:p.value,onChange:w=>v(A.id,p.id,"value",w.target.value),onBlur:()=>S(A.id,p.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Dado/N"}),h&&u&&c.jsx("button",{onClick:()=>x(A.id,p.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}):p.type==="attribute"?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:p.value,onChange:w=>v(A.id,p.id,"value",w.target.value),onBlur:()=>S(A.id,p.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u,children:[c.jsx("option",{value:"",children:"Selecione Atributo"}),i.map(w=>c.jsx("option",{value:w,children:w},w))]}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Atributo"}),h&&u&&c.jsx("button",{onClick:()=>x(A.id,p.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}):p.type==="critDice"?c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",placeholder:"1d6",value:p.value,onChange:w=>v(A.id,p.id,"value",w.target.value),onBlur:()=>S(A.id,p.id,"value"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Dado Crtico"}),h&&u&&c.jsx("button",{onClick:()=>x(A.id,p.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-textSecondary",children:[c.jsx("span",{className:"flex-shrink-0",children:"Crit. "}),c.jsx("input",{type:"number",placeholder:"6",value:p.critValue||"",onChange:w=>v(A.id,p.id,"critValue",w.target.value),onBlur:()=>S(A.id,p.id,"critValue"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsx("span",{className:"flex-shrink-0",children:"Bnus:"}),c.jsxs("select",{value:p.critBonusAttribute||"",onChange:w=>v(A.id,p.id,"critBonusAttribute",w.target.value),onBlur:()=>S(A.id,p.id,"critBonusAttribute"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u,children:[c.jsx("option",{value:"",children:"Nenhum"}),i.map(w=>c.jsx("option",{value:w,children:w},w))]}),c.jsx("span",{className:"flex-shrink-0",children:"x"}),c.jsx("input",{type:"number",placeholder:"1",value:p.critBonusMultiplier||"",onChange:w=>v(A.id,p.id,"critBonusMultiplier",w.target.value),onBlur:()=>S(A.id,p.id,"critBonusMultiplier"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u})]})]}):p.type==="skillRoll"?c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:p.skill,onChange:w=>v(A.id,p.id,"skill",w.target.value),onBlur:()=>S(A.id,p.id,"skill"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u,children:[c.jsx("option",{value:"",children:"Selecione Percia"}),Js.map(w=>c.jsx("option",{value:w.name,children:w.name},w.name))]}),c.jsx("div",{className:"text-textSecondary flex-shrink-0",children:"Percia"}),h&&u&&c.jsx("button",{onClick:()=>x(A.id,p.id),className:"w-6 h-6 bg-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"-"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-textSecondary",children:[c.jsx("span",{className:"flex-shrink-0",children:"Crit. "}),c.jsx("input",{type:"number",placeholder:"19",value:p.critMin||"",onChange:w=>v(A.id,p.id,"critMin",w.target.value),onBlur:()=>S(A.id,p.id,"critMin"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsx("span",{className:"flex-shrink-0",children:"Frmula Crtico:"}),c.jsx("input",{type:"text",placeholder:"Ex: 1d6",value:p.critFormula||"",onChange:w=>v(A.id,p.id,"critFormula",w.target.value),onBlur:()=>S(A.id,p.id,"critFormula"),className:"flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u})]})]}):null},p.id))}),h&&u&&c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsx("button",{onClick:()=>b(A.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Dado/N"}),c.jsx("button",{onClick:()=>b(A.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Atributo"}),c.jsx("button",{onClick:()=>b(A.id,"critDice"),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md",children:"+ Dado Crtico"}),c.jsx("button",{onClick:()=>b(A.id,"skillRoll"),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md",children:"+ Rolagem de Percia"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Multiplicador:"}),c.jsx("input",{type:"number",value:A.multiplier||"",onChange:p=>E(A.id,"multiplier",p.target.value),onBlur:()=>D(A.id,"multiplier"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-3",placeholder:"1",disabled:!h||!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2",children:"Descrio da Ao:"}),c.jsx(FN,{placeholder:"Descrio...",value:A.discordText,onChange:p=>E(A.id,"discordText",p.target.value),onBlur:()=>D(A.id,"discordText"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-sm",disabled:!h||!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-2 mt-3",children:"Custo da Ao:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",placeholder:"Custo",value:A.costValue||"",onChange:p=>E(A.id,"costValue",p.target.value),onBlur:()=>D(A.id,"costValue"),className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u}),c.jsxs("select",{value:A.costType,onChange:p=>E(A.id,"costType",p.target.value),onBlur:()=>D(A.id,"costType"),className:"p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!h||!u,children:[c.jsx("option",{value:"",children:"N/A"}),c.jsx("option",{value:"HP",children:"HP"}),c.jsx("option",{value:"MP",children:"MP"})]})]}),h&&c.jsxs("div",{className:"flex gap-4 mt-4",style:{display:u?"flex":"none"},children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`recover-hp-${A.id}`,checked:A.recoverHP||!1,onChange:p=>D(A.id,"recoverHP",p.target.checked),className:"form-checkbox text-green-500 rounded-sm",disabled:!h}),c.jsx("label",{htmlFor:`recover-hp-${A.id}`,className:"ml-2 text-sm text-textSecondary",children:"Recuperar HP"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`recover-mp-${A.id}`,checked:A.recoverMP||!1,onChange:p=>D(A.id,"recoverMP",p.target.checked),className:"form-checkbox text-blue-500 rounded-sm",disabled:!h}),c.jsx("label",{htmlFor:`recover-mp-${A.id}`,className:"ml-2 text-sm text-textSecondary",children:"Recuperar MP"})]})]})]})]}),h&&u&&c.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>N(A.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Ao",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},A.id))}),h&&u&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:C,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"+ Adicionar Ao Rpida"})})]})})})},zN=({character:t,isMaster:e,onUpdate:n,allAttributes:r,isCollapsed:s,toggleSection:i,isEditMode:o})=>{const{user:l}=Be();if(!t||!l)return c.jsx("div",{className:"p-6 text-center text-textSecondary",children:"A carregar buffs..."});const u=l.uid===t.ownerUid||e,[d,h]=V.useState(t.buffs||[]);V.useEffect(()=>{h(t.buffs||[])},[t.buffs]);const g=()=>{const P={id:crypto.randomUUID(),name:"Novo Buff",effects:[],isActive:!1,isCollapsed:!1,costValue:0,costType:""};n("buffs",[...d,P])},y=P=>n("buffs",(t.buffs||[]).filter(A=>A.id!==P)),C=P=>n("buffs",(t.buffs||[]).map(A=>A.id===P?{...A,isActive:!A.isActive}:A)),N=P=>n("buffs",(t.buffs||[]).map(A=>A.id===P?{...A,isCollapsed:!A.isCollapsed}:A)),E=(P,A,_)=>{h(p=>p.map(w=>w.id===P?{...w,[A]:_}:w))},D=V.useCallback((P,A)=>{const _=d.find(w=>w.id===P),p=(t.buffs||[]).find(w=>w.id===P);if(_&&p&&_[A]!==p[A]){const w=A==="costValue"?parseInt(_[A],10)||0:_[A];n("buffs",(t.buffs||[]).map(I=>I.id===P?{...I,[A]:w}:I))}},[d,t.buffs,n]),b=(P,A)=>{const _={id:crypto.randomUUID(),type:A,target:"",value:A==="attribute"?0:"1d6"};n("buffs",(t.buffs||[]).map(p=>p.id===P?{...p,effects:[...p.effects||[],_]}:p))},x=(P,A)=>{n("buffs",(t.buffs||[]).map(_=>_.id===P?{..._,effects:(_.effects||[]).filter(p=>p.id!==A)}:_))},v=(P,A,_,p)=>{h(w=>w.map(I=>I.id===P?{...I,effects:I.effects.map(k=>{if(k.id===A){const j={...k,[_]:p};return _==="type"&&(j.target="",j.value=p==="attribute"?0:"1d6"),j}return k})}:I))},S=V.useCallback((P,A,_)=>{const p=d.find(j=>j.id===P),w=p==null?void 0:p.effects.find(j=>j.id===A),I=(t.buffs||[]).find(j=>j.id===P),k=I==null?void 0:I.effects.find(j=>j.id===A);w&&k&&w[_]!==k[_]&&n("buffs",(t.buffs||[]).map(j=>j.id===P?{...j,effects:j.effects.map(R=>R.id===A?{...R,[_]:w[_]}:R)}:j))},[d,t.buffs,n]);return c.jsx($t,{title:"Buffs",isCollapsed:s,toggleSection:i,children:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(d||[]).map(P=>P.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(P.id),children:P.name||"Buff Sem Nome"}),c.jsx("label",{className:"flex items-center cursor-pointer ml-2",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"checkbox",checked:P.isActive,onChange:()=>C(P.id),className:"sr-only",disabled:!u}),c.jsx("div",{className:`block w-12 h-6 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),c.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})]})})]},P.id):c.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3 p-4 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow",onClick:()=>N(P.id),children:P.name||"Buff Sem Nome"}),c.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[c.jsx("label",{className:"flex items-center cursor-pointer",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"checkbox",checked:P.isActive,onChange:()=>C(P.id),className:"sr-only",disabled:!u}),c.jsx("div",{className:`block w-14 h-8 rounded-full ${P.isActive?"bg-green-500":"bg-bgInput"}`}),c.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform ${P.isActive?"transform translate-x-6":""}`})]})}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>N(P.id),children:"Recolher "})]})]}),c.jsxs("div",{className:"mt-3 pt-3 border-t border-bgInput/50 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Nome do Buff:"}),c.jsx("input",{type:"text",placeholder:"Nome do Buff",value:P.name,onChange:_=>E(P.id,"name",_.target.value),onBlur:()=>D(P.id,"name"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary font-semibold mb-4",disabled:!u}),c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Custo de Manuteno:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",placeholder:"0",value:P.costValue||"",onChange:_=>E(P.id,"costValue",_.target.value),onBlur:()=>D(P.id,"costValue"),className:"w-20 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u}),c.jsxs("select",{value:P.costType,onChange:_=>E(P.id,"costType",_.target.value),onBlur:()=>D(P.id,"costType"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!u,children:[c.jsx("option",{value:"",children:"N/A"}),c.jsx("option",{value:"HP",children:"HP"}),c.jsx("option",{value:"MP",children:"MP"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-textSecondary block mb-1",children:"Efeitos do Buff:"}),c.jsx("div",{className:"space-y-2",children:(P.effects||[]).map(_=>c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("select",{value:_.type,onChange:p=>v(P.id,_.id,"type",p.target.value),onBlur:()=>S(P.id,_.id,"type"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!u,children:[c.jsx("option",{value:"attribute",children:"Modificar Atributo"}),c.jsx("option",{value:"dice",children:"Adicionar Dado/N"})]}),_.type==="attribute"?c.jsxs("select",{value:_.target,onChange:p=>v(P.id,_.id,"target",p.target.value),onBlur:()=>S(P.id,_.id,"target"),className:"p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary col-span-3 sm:col-span-1",disabled:!u,children:[c.jsx("option",{value:"",children:"Selecione Atributo"}),r.map(p=>c.jsx("option",{value:p,children:p},p))]}):c.jsx("div",{className:"p-2 bg-bgPage border-bgElement rounded-md text-textSecondary text-center italic col-span-3 sm:col-span-1",children:"No aplicvel"}),c.jsxs("div",{className:"flex items-center gap-2 col-span-3 sm:col-span-1",children:[c.jsx("input",{type:"text",placeholder:_.type==="attribute"?"Valor (+/-)":"1d6 ou 6",value:_.value||"",onChange:p=>v(P.id,_.id,"value",p.target.value),onBlur:()=>S(P.id,_.id,"value"),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center",disabled:!u}),u&&c.jsx("button",{onClick:()=>x(P.id,_.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Efeito",children:c.jsx("span",{role:"img","aria-label":"Remover",children:""})})]})]},_.id))}),u&&o&&c.jsxs("div",{className:"flex gap-2 mt-2",children:[c.jsx("button",{onClick:()=>b(P.id,"attribute"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Atributo"}),c.jsx("button",{onClick:()=>b(P.id,"dice"),className:"px-2 py-1 text-xs bg-btnHighlightBg text-btnHighlightText rounded-md",children:"+ Dado/N"})]})]})]}),u&&o&&c.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>y(P.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Buff",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]})]},P.id))}),(d||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum buff criado."}),u&&o&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:g,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})})},Dw=({user:t,onSelectCharacter:e,handleCreateClick:n,handleImportClick:r,handleDeleteClick:s,characters:i,isMaster:o,viewingAll:l,onToggleView:u})=>c.jsxs("div",{className:"bg-bgSurface/80 backdrop-blur-sm p-6 rounded-lg shadow-lg border border-bgElement w-full",children:[c.jsx("h2",{className:"text-2xl font-bold text-textAccent mb-4 border-b-2 border-borderAccent pb-2",children:l?"Todas as Fichas":"Meus Personagens"}),c.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[c.jsx("button",{onClick:n,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Criar Novo Personagem"}),c.jsx("button",{onClick:r,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md",children:"Importar Ficha (JSON)"}),o&&c.jsx("button",{onClick:()=>u(!l),className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-md",children:l?"Ver Apenas Minhas Fichas":"Ver Todas as Fichas"})]}),i.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(d=>c.jsxs("div",{className:"bg-bgElement p-4 rounded-lg shadow-md flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-1",children:d.name}),c.jsxs("p",{className:"text-sm text-textSecondary",children:["Nvel: ",d.level||"1"]}),o&&l&&c.jsxs("p",{className:"text-xs text-textSecondary mt-2 break-all",children:["Dono: ",d.ownerUid]})]}),c.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[c.jsx("button",{onClick:()=>e(d),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-lg",children:"Ver/Editar"}),t&&(t.uid===d.ownerUid||o)&&c.jsx("button",{onClick:()=>s(d),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-lg",children:"Excluir"})]})]},d.id))}):c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum personagem encontrado."})]}),jw=V.createContext(),ac=()=>V.useContext(jw),BN=({children:t})=>{const[e,n]=V.useState([]),r=V.useCallback(o=>{const l={...o,type:"roll",id:Date.now()+Math.random(),timestamp:new Date};n(u=>[l,...u].slice(0,50))},[]),s=V.useCallback(o=>{const l={...o,type:"message",id:Date.now()+Math.random(),timestamp:new Date};n(u=>[l,...u].slice(0,50))},[]),i={feedItems:e,addRollToFeed:r,addMessageToFeed:s};return c.jsx(jw.Provider,{value:i,children:t})},jo="1:727724875985:web:97411448885c68c289e5f0",Ow=async(t,e=!1)=>{if(!t)return[];try{let n=[];if(e){const r=Sn(ze,`artifacts2/${jo}/users`),s=await Ll(r);for(const i of s.docs){const o=Sn(ze,`artifacts2/${jo}/users/${i.id}/characterSheets`),l=Oh(o);(await Ll(l)).forEach(d=>{n.push({id:d.id,ownerUid:i.id,...d.data()})})}}else{const r=Sn(ze,`artifacts2/${jo}/users/${t}/characterSheets`),s=Oh(r);(await Ll(s)).forEach(o=>{n.push({id:o.id,...o.data()})})}return n}catch(n){return console.error("Erro ao buscar personagens:",n),[]}},Vw=async t=>{if(!t)return null;const e=prompt("Qual o nome do novo personagem?");if(!e)return null;try{const n=Sn(ze,`artifacts2/${jo}/users/${t}/characterSheets`),r={name:e,ownerUid:t,createdAt:NN(),level:1,mainAttributes:{hp:{current:100,max:100,temp:0},mp:{current:50,max:50}}};return{id:(await Aw(n,r)).id,...r}}catch(n){return console.error("Erro ao criar novo personagem:",n),null}},Mw=async(t,e)=>{if(!t||!e)return!1;try{const n=cn(ze,`artifacts2/${jo}/users/${t}/characterSheets/${e}`);return await Cw(n),console.log("Ficha deletada com sucesso!"),!0}catch(n){return console.error("Erro ao deletar personagem:",n),!1}},$N="1:727724875985:web:97411448885c68c289e5f0",fd=async t=>{if(!t)return[];try{const e=Sn(ze,"themes"),n=Oh(e,CN("ownerUid","==",t)),r=await Ll(n),s=[];return r.forEach(i=>{s.push({id:i.id,...i.data()})}),s}catch(e){return console.error("Erro ao buscar temas:",e),[]}},Qy=async t=>{if(!t)return null;try{const e=cn(ze,"themes",t),n=await RN(e);return n.exists()?{id:n.id,...n.data()}:null}catch(e){return console.error("Erro ao buscar tema por ID:",e),null}},Yy=async t=>{try{if(t.id){const e=cn(ze,"themes",t.id);return await Vi(e,t,{merge:!0}),t.id}else{const e=Sn(ze,"themes");return(await Aw(e,t)).id}}catch(e){return console.error("Erro ao salvar tema:",e),null}},HN=async t=>{if(!t)return!1;try{const e=cn(ze,"themes",t);return await Cw(e),!0}catch(e){return console.error("Erro ao deletar tema:",e),!1}},WN=async(t,e,n,r)=>{if(!(!t||!e))try{const s=cn(ze,`${r}/${$N}/users/${t}/characterSheets/${e}`);await Vi(s,{activeThemeId:n},{merge:!0})}catch(s){console.error("Erro ao aplicar tema ao personagem:",s)}},Lw=V.createContext(),qN=()=>V.useContext(Lw),GN=({children:t})=>{const{user:e,isMaster:n}=Be(),{characterDataCollectionRoot:r,GLOBAL_APP_IDENTIFIER:s}=Ia(),[i,o]=V.useState([]),[l,u]=V.useState([]),[d,h]=V.useState(!0);V.useEffect(()=>{if(!e){o([]),h(!1);return}h(!0);const N=new Map,E=(D,b)=>{let x=!1;if(D.docChanges().forEach(v=>{const S=v.doc.data();let P=S.mainAttributes;if(typeof P=="string")try{P=JSON.parse(P)}catch(_){console.error(`Erro ao parsear mainAttributes para o personagem ${v.doc.id}:`,_)}const A={id:v.doc.id,ownerUid:b,...S,mainAttributes:P};v.type==="added"||v.type==="modified"?(N.set(A.id,A),x=!0):v.type==="removed"&&(N.delete(A.id),x=!0)}),x){const v=Array.from(N.values());o(v)}h(!1)};if(n){let D=[];const b=Sn(ze,`${r}/${s}/users`),x=ci(b,v=>{if(D.forEach(S=>S()),D=[],v.empty){N.clear(),o([]),h(!1);return}v.docs.forEach(S=>{const P=S.id,A=Sn(ze,`${r}/${s}/users/${P}/characterSheets`),_=ci(A,p=>E(p,P),p=>{console.error(`Erro ao ouvir fichas do usurio ${P}:`,p),h(!1)});D.push(_)})},v=>{console.error("Erro ao ouvir coleo de usurios:",v),h(!1)});return()=>{x(),D.forEach(v=>v())}}else{const D=Sn(ze,`${r}/${s}/users/${e.uid}/characterSheets`),b=ci(D,x=>E(x,e.uid),x=>{console.error("Erro ao ouvir as prprias fichas:",x),h(!1)});return()=>b()}},[e,n,r,s]);const g=V.useMemo(()=>i.filter(N=>l.includes(N.id)),[i,l]),y=V.useCallback(N=>{u(E=>E.includes(N)?E.filter(D=>D!==N):[...E,N])},[]),C={allCharacters:i,selectedCharIds:l,partyHealthData:g,isLoading:d,toggleCharacterSelection:y};return c.jsx(Lw.Provider,{value:C,children:t})},KN=()=>{const{feedItems:t}=ac(),[e,n]=V.useState(!0),r=l=>l?l.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):"",s=l=>c.jsxs("div",{className:"p-3 bg-bgElement rounded-md border border-bgInput mb-2",children:[c.jsxs("div",{className:"flex justify-between items-center text-xs text-textSecondary mb-1",children:[c.jsx("span",{className:"font-bold",children:l.characterName}),c.jsx("span",{children:r(l.timestamp)})]}),l.title&&c.jsx("h4",{className:"font-semibold text-textAccent text-lg mb-1",children:l.title}),c.jsx("p",{className:"text-sm text-textPrimary break-words whitespace-pre-wrap",children:l.description||l.text})]},l.id),i=l=>{const u=l.totalResult,d=l.results.map(h=>h.displayValue).join(" + ");return c.jsxs("div",{className:"p-3 bg-bgElement rounded-md border border-bgInput mb-2",children:[c.jsxs("div",{className:"flex justify-between items-center text-xs text-textSecondary mb-1",children:[c.jsx("span",{children:l.characterName}),c.jsx("span",{children:r(l.timestamp)})]}),c.jsx("p",{className:"font-semibold text-lg text-textPrimary",children:l.rollName}),l.acertoResult&&c.jsxs("div",{className:"mt-2 pt-2 border-t border-bgInput/50",children:[c.jsxs("p",{className:"font-semibold text-textPrimary/90",children:["Acerto:",c.jsx("span",{className:"font-bold text-lg text-textAccent ml-2",children:l.acertoResult.total}),c.jsxs("span",{className:"text-sm text-textSecondary ml-2",children:["(",l.acertoResult.skillName,")"]})]}),c.jsxs("p",{className:"text-sm text-textSecondary mt-1",children:["1d20(",c.jsx("span",{className:l.acertoResult.isCrit?"text-red-400 font-bold":"",children:l.acertoResult.roll}),") + ",l.acertoResult.bonus,l.acertoResult.isCrit&&c.jsx("span",{className:"text-red-400 font-bold ml-2",children:" CRTICO!"})]})]}),(d||!l.acertoResult||l.criticals&&l.criticals.length>0)&&c.jsxs("div",{className:"mt-2 pt-2 border-t border-bgInput/50",children:[c.jsxs("p",{className:"font-semibold text-textPrimary/90",children:[l.acertoResult?"Dano/Resultado:":"Resultado:",c.jsx("span",{className:"font-bold text-3xl text-textAccent ml-2",children:u})]}),d&&c.jsx("p",{className:"text-sm text-textSecondary break-words mt-2",children:d}),l.criticals&&l.criticals.length>0&&c.jsx("p",{className:"text-sm text-red-400 font-semibold whitespace-pre-wrap mt-1",children:l.criticals.filter(h=>!h.startsWith("Acerto Crtico")).join(`
`)})]}),l.discordText&&c.jsxs("p",{className:"text-xs italic text-textSecondary mt-2",children:['"',l.discordText,'"']})]},l.id)},o=l=>{switch(l.type){case"roll":return i(l);case"message":return s(l);default:return null}};return e?c.jsx("div",{className:"fixed bottom-4 left-4 bg-btnHighlightBg text-btnHighlightText p-3 rounded-full shadow-lg cursor-pointer hover:opacity-90 z-50",onClick:()=>n(!1),children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}):c.jsxs("div",{className:"fixed bottom-4 left-4 w-full max-w-sm h-[60vh] bg-bgSurface/90 backdrop-blur-md rounded-lg shadow-2xl border border-bgElement flex flex-col z-50",children:[c.jsxs("div",{className:"flex justify-between items-center p-3 bg-bgElement cursor-pointer",onClick:()=>n(!0),children:[c.jsx("h3",{className:"font-bold text-textAccent",children:"Feed de Rolagens"}),c.jsx("button",{className:"text-textSecondary hover:text-textPrimary",children:""})]}),c.jsxs("div",{className:"flex-grow p-3 overflow-y-auto",children:[t.length===0&&c.jsx("p",{className:"text-textSecondary italic",children:"Nenhuma rolagem ou mensagem ainda..."}),t.map(o)]}),c.jsx(t1,{})]})},QN=({message:t,onConfirm:e,onCancel:n,type:r,showCopyButton:s,copyText:i})=>{const[o,l]=V.useState(""),u=()=>{navigator.clipboard.writeText(i).then(()=>{l("Copiado!"),setTimeout(()=>l(""),2e3)},()=>{l("Falhou em copiar.")})},d=r==="confirm"?"Confirmar":"OK",h=r==="confirm"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700";return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-lg text-textPrimary mb-4 text-center whitespace-pre-wrap",children:t}),s&&c.jsxs("div",{className:"my-4 p-2 bg-bgElement rounded-md text-center",children:[c.jsx("p",{className:"text-textSecondary text-sm mb-1",children:"Comando para Discord/Roll20:"}),c.jsx("code",{className:"text-textAccent break-words",children:i}),c.jsx("button",{onClick:u,className:"ml-4 px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-xs font-bold rounded-md",children:o||"Copiar"})]}),c.jsxs("div",{className:"flex justify-around gap-4 mt-4",children:[c.jsx("button",{onClick:e,className:`px-5 py-2 rounded-lg font-bold shadow-md text-white ${h}`,children:d}),r!=="info"&&c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},YN=({title:t,onConfirm:e,onClose:n,type:r})=>{const[s,i]=V.useState(""),[o,l]=V.useState("HP"),u=()=>{const h=parseInt(s,10);!isNaN(h)&&h>0?e(h,o):console.error("Valor invlido.")},d=h=>{h.key==="Enter"&&u()};return c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center",children:t}),c.jsx("input",{type:"number",value:s,onChange:h=>i(h.target.value),onKeyDown:d,className:"w-full p-2 mb-4 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg focus:ring-btnHighlightBg focus:border-btnHighlightBg",placeholder:"Valor",autoFocus:!0}),c.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"HP",checked:o==="HP",onChange:()=>l("HP"),className:"form-radio text-btnHighlightBg"})," HP"]}),r==="heal"&&c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"HP Bonus",checked:o==="HP Bonus",onChange:()=>l("HP Bonus"),className:"form-radio text-btnHighlightBg"})," HP Bonus"]}),c.jsxs("label",{className:"flex items-center gap-2 text-textPrimary cursor-pointer",children:[c.jsx("input",{type:"radio",name:"target",value:"MP",checked:o==="MP",onChange:()=>l("MP"),className:"form-radio text-btnHighlightBg"})," MP"]})]}),c.jsxs("div",{className:"flex justify-around gap-4",children:[c.jsx("button",{onClick:u,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Confirmar"}),c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},XN=({attributeName:t,onConfirm:e,onClose:n})=>{const[r,s]=V.useState("1d20"),[i,o]=V.useState(""),l=()=>e(r,parseInt(i,10)||0),u=d=>{d.key==="Enter"&&l()};return c.jsxs(c.Fragment,{children:[c.jsxs("h3",{className:"text-xl text-textAccent font-bold mb-4 text-center",children:["Rolar ",t]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{htmlFor:"dice-input",className:"block text-sm font-medium text-textSecondary mb-1",children:"Dado:"}),c.jsx("input",{id:"dice-input",type:"text",value:r,onChange:d=>s(d.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"Ex: 1d20, 2d6",autoFocus:!0})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{htmlFor:"bonus-input",className:"block text-sm font-medium text-textSecondary mb-1",children:"Bnus Adicional:"}),c.jsx("input",{id:"bonus-input",type:"number",value:i,onChange:d=>o(d.target.value),onKeyDown:u,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-lg",placeholder:"0"})]}),c.jsxs("div",{className:"flex justify-around gap-4",children:[c.jsx("button",{onClick:l,className:"px-5 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md",children:"Confirmar"}),c.jsx("button",{onClick:n,className:"px-5 py-2 bg-bgElement hover:opacity-80 text-textPrimary font-bold rounded-lg shadow-md",children:"Cancelar"})]})]})},JN=({attributeName:t,onConfirm:e,onClose:n})=>{const[r,s]=V.useState(""),[i,o]=V.useState("damage"),[l,u]=V.useState(!1),d=()=>{const y=parseInt(r,10);!isNaN(y)&&y>0&&(e(y,t,i,l),n())},h=y=>{y.key==="Enter"&&d()},g=i==="heal"?`Curar ${t}`:`Causar Dano em ${t}`;return c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-4 text-center",children:g}),c.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[c.jsx("button",{onClick:()=>o("damage"),className:`px-4 py-2 rounded-lg font-semibold ${i==="damage"?"bg-red-600 text-white":"bg-bgElement text-textSecondary"}`,children:" Dano"}),c.jsx("button",{onClick:()=>o("heal"),className:`px-4 py-2 rounded-lg font-semibold ${i==="heal"?"bg-green-600 text-white":"bg-bgElement text-textSecondary"}`,children:" Cura"})]}),c.jsx("input",{type:"number",value:r,onChange:y=>s(y.target.value),onKeyDown:h,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-center text-2xl mb-4",placeholder:"Valor",autoFocus:!0}),i==="damage"&&t==="HP"&&c.jsxs("div",{className:"flex items-center justify-center mb-4",children:[c.jsx("input",{type:"checkbox",id:"directDamage",checked:l,onChange:y=>u(y.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),c.jsx("label",{htmlFor:"directDamage",className:"ml-2 block text-sm text-textSecondary",children:"Dano Direto (ignora HP Bnus)"})]}),c.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[c.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg",children:"Cancelar"}),c.jsx("button",{onClick:d,className:"px-4 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",disabled:!r,children:"Confirmar"})]})]})},lc=({modalState:t,closeModal:e})=>{if(!t.type)return null;const n=()=>{const{type:r,props:s}=t;switch(r){case"info":case"confirm":return c.jsx(QN,{...s});case"action":return c.jsx(YN,{...s});case"rollAttribute":return c.jsx(XN,{...s});case"damageHeal":return c.jsx(JN,{...s});default:return null}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",onClick:e,children:c.jsx("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-sm border border-bgElement",onClick:r=>r.stopPropagation(),children:n()})})},pd={name:"Novo Tema",ownerUid:"",isPublic:!1,styles:{backgroundImage:"url('')",fontFamily:"'Roboto', sans-serif",surfaceOpacity:80,colors:{bgPage:"#111827",bgSurface:"#1f2937",bgElement:"#374151",bgInput:"#4b5563",textPrimary:"#f9fafb",textSecondary:"#9ca3af",borderAccent:"#f59e0b",textAccent:"#fcd34d",btnHighlightBg:"#8b5cf6",btnHighlightText:"#ffffff"}}},ZN=["'Roboto', sans-serif","'Merriweather', serif","'Lato', sans-serif","'Noto Sans', sans-serif","'Slabo 27px', serif"],e1=({character:t,setPreviewTheme:e,onClose:n})=>{const{user:r}=Be(),{characterDataCollectionRoot:s}=Ia(),[i,o]=V.useState([]),[l,u]=V.useState(pd),[d,h]=V.useState({type:null,props:{}}),g=()=>h({type:null,props:{}});V.useEffect(()=>{r&&(fd(r.uid).then(o),u(v=>({...pd,ownerUid:r.uid})))},[r]),V.useEffect(()=>{e(l)},[l,e]);const y=v=>{if(v==="new")u({...pd,ownerUid:r.uid});else{const S=i.find(P=>P.id===v);S&&u(S)}},C=(v,S)=>u(P=>({...P,styles:{...P.styles,[v]:S}})),N=(v,S)=>u(P=>({...P,styles:{...P.styles,colors:{...P.styles.colors,[v]:S}}})),E=v=>u(S=>({...S,name:v.target.value})),D=async()=>{const v={...l,ownerUid:r.uid};try{const S=await Yy(v);if(S){h({type:"info",props:{message:"Tema salvo com sucesso!",onConfirm:g}});const P=await fd(r.uid);o(P);const A=P.find(_=>_.id===(v.id||S));A&&u(A)}else throw new Error("Ocorreu um erro desconhecido ao salvar.")}catch(S){console.error("Falha ao salvar o tema:",S),h({type:"info",props:{message:"Falha ao salvar o tema.",onConfirm:g}})}},b=()=>{if(!l.id){h({type:"info",props:{message:"No pode apagar um tema que ainda no foi salvo.",onConfirm:g}});return}h({type:"confirm",props:{message:`Tem a certeza que quer apagar o tema "${l.name}"?`,onConfirm:async()=>{await HN(l.id),g(),fd(r.uid).then(o),y("new")},onCancel:g}})},x=async()=>{if(!t||!l.id){h({type:"info",props:{message:"Precisa ter uma ficha selecionada e um tema salvo para aplicar.",onConfirm:g}});return}await Yy(l),await WN(t.ownerUid,t.id,l.id,s),h({type:"info",props:{message:`Tema "${l.name}" aplicado!`,onConfirm:()=>{g(),n()}}})};return c.jsxs(c.Fragment,{children:[c.jsx(lc,{modalState:d,closeModal:g}),c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-bgSurface rounded-lg shadow-xl p-6 w-full max-w-3xl border border-bgElement max-h-[90vh] flex flex-col",children:[c.jsx("h2",{className:"text-2xl font-bold text-textAccent mb-4",children:"Editor de Temas"}),c.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Tema a Editar"}),c.jsxs("select",{onChange:v=>y(v.target.value),value:l.id||"new",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",children:[c.jsx("option",{value:"new",children:"-- Criar Novo Tema --"}),i.map(v=>c.jsx("option",{value:v.id,children:v.name},v.id))]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Nome do Tema"}),c.jsx("input",{type:"text",value:l.name,onChange:E,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"URL da Imagem de Fundo"}),c.jsx("input",{type:"text",value:l.styles.backgroundImage.replace(/url\(['"]?(.*?)['"]?\)/,"$1"),onChange:v=>C("backgroundImage",`url('${v.target.value}')`),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:"Fonte Principal"}),c.jsx("select",{value:l.styles.fontFamily,onChange:v=>C("fontFamily",v.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",children:ZN.map(v=>c.jsx("option",{value:v,children:v.split(",")[0].replace(/'/g,"")},v))})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-textSecondary mb-1",children:["Transparncia dos Mdulos (",l.styles.surfaceOpacity||80,"%)"]}),c.jsx("input",{type:"range",min:"10",max:"100",step:"5",value:l.styles.surfaceOpacity||80,onChange:v=>C("surfaceOpacity",parseInt(v.target.value)),className:"w-full h-2 bg-bgElement rounded-lg appearance-none cursor-pointer mt-2"})]})]}),c.jsx("h3",{className:"text-lg font-semibold text-textAccent mt-6 mb-2",children:"Cores"}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Object.entries(l.styles.colors).map(([v,S])=>c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-textSecondary capitalize",children:v.replace(/([A-Z])/g," $1")}),c.jsxs("div",{className:"flex items-center gap-2 p-1 bg-bgInput border border-bgElement rounded-md",children:[c.jsx("input",{type:"color",value:S,onChange:P=>N(v,P.target.value),className:"w-8 h-8 rounded border-none bg-transparent cursor-pointer"}),c.jsx("input",{type:"text",value:S,onChange:P=>N(v,P.target.value),className:"w-full bg-transparent text-textPrimary text-sm"})]})]},v))})]}),c.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-6 pt-4 border-t border-bgElement",children:[c.jsxs("div",{children:[c.jsx("button",{onClick:D,className:"px-4 py-2 bg-green-600 text-white font-bold rounded-lg mr-2",children:"Salvar"}),c.jsx("button",{onClick:b,className:"px-4 py-2 bg-red-600 text-white font-bold rounded-lg",children:"Apagar"})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:x,disabled:!t||!l.id,className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg disabled:opacity-50",children:"Aplicar"}),c.jsx("button",{onClick:n,className:"px-4 py-2 bg-textSecondary/50 text-textPrimary font-bold rounded-lg",children:"Fechar"})]})]})]})})]})},t1=({characterName:t})=>{const[e,n]=V.useState(""),{addMessageToFeed:r}=ac(),{user:s}=Be(),i=o=>{o.preventDefault(),e.trim()!==""&&(r({characterName:t||s.displayName||"Usurio",text:e,ownerUid:s.uid}),n(""))};return c.jsx("form",{onSubmit:i,className:"p-3 border-t border-bgElement",children:c.jsxs("div",{className:"flex items-center bg-bgInput rounded-md",children:[c.jsx("input",{type:"text",value:e,onChange:o=>n(o.target.value),placeholder:"Digite uma mensagem...",className:"w-full bg-transparent p-2 text-textPrimary placeholder-textSecondary focus:outline-none"}),c.jsx("button",{type:"submit",className:"p-2 text-textAccent hover:opacity-80 disabled:opacity-50",disabled:!e.trim(),children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",clipRule:"evenodd"})})})]})})},Fw=({onCharacterClick:t})=>{const{isMaster:e}=Be(),{allCharacters:n,selectedCharIds:r,partyHealthData:s,toggleCharacterSelection:i}=qN(),[o,l]=V.useState(!1),[u,d]=V.useState(!1),h=y=>{t&&t(y)},g=y=>{var E,D;const C=((E=y.mainAttributes)==null?void 0:E.hp)||{current:"?",max:"?",temp:0},N=((D=y.mainAttributes)==null?void 0:D.mp)||{current:"?",max:"?"};return c.jsxs("div",{className:"p-2 bg-bgElement rounded-md border border-bgInput cursor-pointer hover:border-btnHighlightBg",onClick:()=>h(y),title:`Clique para ir para a ficha de ${y.name}`,children:[c.jsx("p",{className:"font-bold text-textPrimary truncate",children:y.name}),c.jsxs("div",{className:"text-sm flex justify-between",children:[c.jsxs("span",{className:"text-red-400",children:["HP: ",C.current,"/",C.max," ",C.temp>0?`(+${C.temp})`:""]}),c.jsxs("span",{className:"text-blue-400",children:["MP: ",N.current,"/",N.max]})]})]},y.id)};return o?c.jsx("div",{className:"fixed top-4 left-4 bg-btnHighlightBg text-btnHighlightText p-3 rounded-full shadow-lg cursor-pointer hover:opacity-90 z-50",onClick:()=>l(!1),title:"Expandir Monitor de Grupo",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-5M3 4h5V9"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 16l-4-4M3 8l4 4"})]})}):c.jsxs("div",{className:"fixed top-4 left-4 w-full max-w-xs bg-bgSurface/90 backdrop-blur-md rounded-lg shadow-2xl border border-bgElement flex flex-col z-50",children:[c.jsxs("div",{className:"flex justify-between items-center p-3 bg-bgElement cursor-pointer",onClick:()=>l(!0),children:[c.jsx("h3",{className:"font-bold text-textAccent",children:"Monitor de Grupo"}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{className:"text-textSecondary hover:text-textPrimary mr-2",onClick:y=>{y.stopPropagation(),d(!u)},title:"Selecionar Personagens",children:""}),c.jsx("button",{className:"text-textSecondary hover:text-textPrimary",title:"Recolher",children:""})]})]}),u&&c.jsxs("div",{className:"p-3 border-b border-bgElement max-h-48 overflow-y-auto",children:[c.jsx("h4",{className:"text-sm font-semibold text-textSecondary mb-2",children:"Selecionar Personagens"}),n.length>0?n.map(y=>c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:`char-select-${y.id}`,checked:r.includes(y.id),onChange:()=>i(y.id),className:"form-checkbox h-4 w-4 text-btnHighlightBg bg-bgInput border-bgElement rounded"}),c.jsx("label",{htmlFor:`char-select-${y.id}`,className:"ml-2 text-textPrimary text-sm truncate",children:y.name})]},y.id)):c.jsx("p",{className:"text-xs text-textSecondary italic",children:"Nenhuma ficha encontrada."})]}),c.jsx("div",{className:"flex-grow p-3 overflow-y-auto space-y-2 max-h-[60vh]",children:s.length>0?s.map(g):c.jsx("p",{className:"text-textSecondary italic text-sm text-center py-4",children:"Nenhum personagem selecionado. Clique na engrenagem  para selecionar."})})]})},n1=[2,3,4,6,8,10,12,20,50,100],r1=({character:t})=>{const[e,n]=V.useState(!1),{addRollToFeed:r}=ac(),s=V.useCallback(async(o,l)=>{const u=`${o}
${l}`;if(t&&t.discordWebhookUrl){try{await fetch(t.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[{title:o,description:l.replace(/\*/g,""),color:7506394}]})})}catch(d){return console.error("Failed to send to Discord:",d),null}return u}else return alert(`Webhook do Discord no configurado. Copie o comando:

${u}`),null},[t,r]),i=async o=>{const l=Math.floor(Math.random()*o)+1;n(!1);const u=await s(`Rolagem de d${o}`,`**Resultado: ${l}**`);r({characterName:(t==null?void 0:t.name)||"Narrador",rollName:`Rolagem Rpida de d${o}`,results:[{value:l,displayValue:`d${o} (${l})`}],discordText:u})};return c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>n(!e),title:"Rolagem Rpida",className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600",children:""}),e&&c.jsx("div",{className:"absolute bottom-12 right-0 bg-gray-900 bg-opacity-90 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700 w-40",children:c.jsx("div",{className:"grid grid-cols-2 gap-2",children:n1.map(o=>c.jsxs("button",{onClick:()=>i(o),className:"bg-gray-700 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:["d",o]},o))})})]})},s1=({href:t,title:e,children:n})=>c.jsx("a",{href:t,title:e,className:"bg-gray-800 hover:bg-gray-700 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl shadow-md transition-transform transform hover:scale-110 border border-gray-600",children:n}),i1=({character:t})=>{const e=[{href:"#info",title:"Informaes",icon:""},{href:"#main-attributes",title:"Atributos Principais",icon:""},{href:"#actions",title:"Aes",icon:""},{href:"#buffs",title:"Buffs",icon:""},{href:"#wallet",title:"Carteira",icon:""},{href:"#inventory",title:"Inventrio",icon:""},{href:"#equipped",title:"Equipados",icon:""},{href:"#perks",title:"Vantagens",icon:""},{href:"#skills",title:"Habilidades",icon:""},{href:"#specializations",title:"Especializaes",icon:""},{href:"#story",title:"Histria",icon:""},{href:"#notes",title:"Anotaes",icon:""},{href:"#discord",title:"Discord",icon:""}];return c.jsx("div",{className:"fixed bottom-4 right-4 z-40 bg-gray-900 bg-opacity-80 backdrop-blur-sm p-2 rounded-xl shadow-2xl border border-gray-700",children:c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.map(n=>c.jsx(s1,{href:n.href,title:n.title,children:n.icon},n.href)),c.jsx(r1,{character:t})]})})},o1=({initialValue:t,onConfirm:e,onCancel:n})=>{const[r,s]=V.useState(t),i=()=>{e(r)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50",children:c.jsxs("div",{className:"bg-bgSurface p-6 rounded-lg shadow-xl w-full max-w-md",children:[c.jsx("h3",{className:"text-xl font-bold text-textPrimary mb-4",children:"URL da Imagem do Personagem"}),c.jsx("p",{className:"text-textSecondary mb-4",children:"Cole a nova URL da imagem abaixo:"}),c.jsx("input",{type:"text",value:r,onChange:o=>s(o.target.value),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary focus:ring-btnHighlightBg focus:border-btnHighlightBg",placeholder:"https://exemplo.com/imagem.png",autoFocus:!0}),c.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[c.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg",children:"Cancelar"}),c.jsx("button",{onClick:i,className:"px-4 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Confirmar"})]})]})})},a1=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=Be(),l=o&&(o.uid===t.ownerUid||n),[u,d]=V.useState(!1),[h,g]=V.useState({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""});V.useEffect(()=>{g({name:t.name||"",age:t.age||"",height:t.height||"",gender:t.gender||"",race:t.race||"",class:t.class||"",alignment:t.alignment||"",level:t.level||"",xp:t.xp||""})},[t]);const y=S=>(S=parseInt(S,10),isNaN(S)||S<1?{scale:"N/A",category:"Desconhecida"}:S>=1&&S<=10?{scale:0,category:"Comum"}:S>=11&&S<=20?{scale:1,category:"Lendrio I"}:S>=21&&S<=30?{scale:2,category:"Lendrio II"}:S>=31&&S<=40?{scale:3,category:"Lendrio III"}:S>=41&&S<=45?{scale:4,category:"Colossal I"}:S>=46&&S<=50?{scale:5,category:"Colossal II"}:S>=51&&S<=55?{scale:6,category:"Colossal III"}:S>=56&&S<=59?{scale:7,category:"Titnico"}:S===60?{scale:8,category:"Divino"}:{scale:"N/A",category:"Alm do Divino"}),{scale:C,category:N}=V.useMemo(()=>y(t.level),[t.level]),E=S=>{const{name:P,value:A}=S.target;g(_=>({..._,[P]:A}))},D=V.useCallback(S=>{const P=h[S],A=t[S],p=["age","level","xp"].includes(S)?parseInt(P,10)||0:P;p!==A&&e(S,p)},[h,t,e]),b=()=>{l&&i&&d(!0)},x=S=>{S!==null&&S!==t.photoUrl&&e("photoUrl",S),d(!1)},v=["name","age","height","gender","race","class","alignment","level","xp"];return c.jsxs($t,{title:"Informaes do Personagem",isCollapsed:r,toggleSection:s,children:[u&&c.jsx(o1,{initialValue:t.photoUrl||"",onConfirm:x,onCancel:()=>d(!1)}),c.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[c.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center",children:[c.jsx("div",{className:`rounded-full border-2 border-btnHighlightBg ${l&&i?"cursor-pointer":""}`,onClick:b,children:t.photoUrl?c.jsx("img",{src:t.photoUrl,alt:"Foto",className:"w-48 h-48 object-cover rounded-full",onError:S=>{S.target.onerror=null,S.target.src="https://placehold.co/192x192/1f2937/FFFFFF?text=Erro"}}):c.jsx("div",{className:"w-48 h-48 bg-bgElement rounded-full flex items-center justify-center text-6xl text-textSecondary",children:"+"})}),c.jsxs("div",{className:"text-center mt-2",children:[c.jsx("p",{className:"text-sm font-medium text-textSecondary",children:"Escala de Poder:"}),c.jsx("p",{className:"text-lg font-bold text-textPrimary",children:N})]})]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 flex-grow w-full",children:v.map(S=>c.jsxs("div",{children:[c.jsxs("label",{htmlFor:S,className:"block text-sm font-medium text-textSecondary mb-1 capitalize",children:[S,":"]}),c.jsx("input",{type:["age","level","xp"].includes(S)?"number":"text",id:S,name:S,value:h[S],onChange:E,onBlur:()=>D(S),className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary focus:ring-btnHighlightBg focus:border-btnHighlightBg",disabled:!l||!i&&["race","class","alignment"].includes(S)})]},S))})]})]})},l1=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,buffModifiers:i,isEditMode:o,onAttributeRoll:l})=>{var v,S,P,A,_;const{user:u}=Be();u&&(u.uid,t.ownerUid);const d=u&&(u.uid===t.ownerUid||n),[h,g]=V.useState(t.mainAttributes||{hp:{},mp:{}});V.useEffect(()=>{g(t.mainAttributes||{hp:{},mp:{}})},[t.mainAttributes]);const y=(p,w)=>(parseInt(p,10)||0)+(i&&i[w]||0),C=V.useMemo(()=>y(h==null?void 0:h.destreza,"Destreza"),[h==null?void 0:h.destreza,i]),N=V.useMemo(()=>y(h==null?void 0:h.constituicao,"Constituio"),[h==null?void 0:h.constituicao,i]),E=V.useMemo(()=>y(h==null?void 0:h.sabedoria,"Sabedoria"),[h==null?void 0:h.sabedoria,i]),D=V.useMemo(()=>({FOR:y(h==null?void 0:h.forca,"Fora"),DES:C,CON:N,INT:y(h==null?void 0:h.inteligencia,"Inteligencia"),SAB:E,CAR:y(h==null?void 0:h.carisma,"Carisma")}),[h,C,N,E,i]);parseInt(h==null?void 0:h.fd,10);const b=(p,w)=>{const{name:I,value:k}=p.target,j=k===""?"":parseInt(k,10);g(R=>w==="fd"?{...R,fd:j}:w?{...R,[w]:{...R[w]||{},[I]:j}}:{...R,[I]:j})},x=V.useCallback((p,w)=>{var k;if(!t)return;const I=t.mainAttributes||{};if(w){const j=(k=h==null?void 0:h[w])==null?void 0:k[p],R=I[w]||{},q=R[p],ne=parseInt(j,10)||0;if(ne!==(q||0)){const ae={...R,[p]:ne},re={...I,[w]:ae};e("mainAttributes",re)}}else{const j=h==null?void 0:h[p],R=I[p],q=parseInt(j,10)||0;if(q!==(R||0)){const ne={...I,[p]:q};e("mainAttributes",ne)}}},[h,t,e]);return c.jsx($t,{title:"Atributos",isCollapsed:r,toggleSection:s,children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase",children:"HP"}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",readOnly:!0,name:"current",value:((v=h.hp)==null?void 0:v.current)??"",className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var p;return l("HP",(p=h.hp)==null?void 0:p.current)},title:"Aplicar Dano/Cura no HP"}),c.jsx("span",{className:"text-textSecondary",children:"/"}),c.jsx("input",{type:"number",name:"max",value:((S=h.hp)==null?void 0:S.max)??"",onChange:p=>b(p,"hp"),onBlur:()=>x("max","hp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n}),c.jsx("span",{className:"text-blue-400 font-bold text-xl ml-1",children:"+"}),c.jsx("input",{type:"number",readOnly:!0,title:"HP Temporrio",name:"temp",value:((P=h.hp)==null?void 0:P.temp)??"",className:"w-16 p-2 text-center bg-bgInput border border-blue-400 rounded-md text-blue-300 text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var p;return l("HP Bonus",(p=h.hp)==null?void 0:p.temp)}})]})]}),c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("label",{className:"text-lg font-medium text-textSecondary mb-1 uppercase",children:"MP"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",readOnly:!0,name:"current",value:((A=h.mp)==null?void 0:A.current)??"",className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold cursor-pointer hover:bg-bgElement/50",onClick:()=>{var p;return l("MP",(p=h.mp)==null?void 0:p.current)},title:"Aplicar Dano/Cura no MP"}),c.jsx("span",{className:"text-textSecondary",children:"/"}),c.jsx("input",{type:"number",name:"max",value:((_=h.mp)==null?void 0:_.max)??"",onChange:p=>b(p,"mp"),onBlur:()=>x("max","mp"),className:"w-16 p-2 text-center bg-bgInput border border-bgElement rounded-md text-textPrimary text-xl font-bold",disabled:!n})]})]})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:["Fora","Destreza","Constituio","Inteligencia","Sabedoria","Carisma"].map(p=>{const w=p.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),I=(h==null?void 0:h[w])??"",k=y(I,p);return c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(p,k),title:`Clique para rolar ${p} (Valor: ${k})`,children:k}),c.jsx("input",{type:"number",id:p,name:w,value:I,onChange:b,onBlur:()=>x(w),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!d,"aria-label":`${p} Base`}),c.jsx("label",{htmlFor:p,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:p})]},p)})}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 auto-rows-fr",children:[["Iniciativa","FA","FM","MD","Acerto","ME"].map(p=>{const w=p.toLowerCase();let I,k;return p==="Iniciativa"?(I=(h==null?void 0:h[w])??"",k=(parseInt(I,10)||0)+C+(i.Iniciativa||0)):p==="MD"?(I=(h==null?void 0:h.fd)??"",k=(parseInt(I,10)||0)+N+(i.MD||0)):(I=(h==null?void 0:h[w])??"",k=y((h==null?void 0:h[w])||0,p.toUpperCase())),c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md",children:[c.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(p,k),title:`Clique para rolar ${p} (Valor: ${k})`,children:k}),c.jsx("input",{type:"number",id:p,name:w,value:I,onChange:j=>b(j,p==="MD"?"fd":void 0),onBlur:()=>x(p==="MD"?"fd":w),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!d,"aria-label":`${p} Base`}),c.jsx("label",{htmlFor:p,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:p})]},p)}),[{key:"Fortitude",defaultAttr:"CON"},{key:"Reflexo",defaultAttr:"DES"},{key:"Vontade",defaultAttr:"SAB"}].map(({key:p,defaultAttr:w})=>{const I=p.toLowerCase(),k=`${I}Attr`,j=t[k]||w,R=D[j]||0,q=(h==null?void 0:h[I])??"",ne=(parseInt(q,10)||0)+R+(i[p]||0),ae=re=>{e(k,re)};return c.jsxs("div",{className:"flex flex-col items-center p-2 bg-bgElement rounded-md col-span-2 justify-between",children:[c.jsx("span",{className:"text-4xl font-bold text-textPrimary cursor-pointer hover:text-btnHighlightBg",onClick:()=>l(p,ne),title:`Clique para rolar ${p} (Valor: ${ne})`,children:ne}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",id:p,name:I,value:q,onChange:b,onBlur:()=>x(I),className:"w-16 p-1 text-center bg-bgInput border border-bgElement rounded-md text-textSecondary text-lg",disabled:!d||!o,"aria-label":`${p} Base`}),o?c.jsx("select",{value:j,onChange:re=>ae(re.target.value),className:"bg-bgInput text-textPrimary text-sm font-bold rounded-md p-1 border-none focus:ring-2 focus:ring-btnHighlightBg",disabled:!d,children:Object.keys(D).map(re=>c.jsx("option",{value:re,children:re},re))}):c.jsxs("span",{className:"font-semibold text-textSecondary text-sm ml-1",children:["(",j,")"]})]}),c.jsx("label",{htmlFor:p,className:"uppercase font-bold text-sm text-textSecondary mt-1",children:p})]},p)})]})]})})},u1=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{var x,v;const{user:o}=Be(),[l,u]=V.useState(0),d=((x=t.wallet)==null?void 0:x.zeni)||0,h=((v=t.wallet)==null?void 0:v.inspiration)||0,g=o&&(o.uid===t.ownerUid||e),y=(S,P)=>{const A={...t.wallet,[S]:Math.max(0,P)};n("wallet",A)},C=()=>{y("zeni",d+l),u(0)},N=()=>{y("zeni",d-l),u(0)},E=()=>y("inspiration",h+1),D=()=>y("inspiration",h-1),b=c.jsxs("div",{className:"flex justify-between items-center w-full",children:[c.jsxs("span",{children:["Zeni: ",d]}),c.jsxs("span",{className:"text-textPrimary text-base",children:["Inspirao: ",h]})]});return c.jsx($t,{title:b,isCollapsed:r,toggleSection:s,isComplexTitle:!0,children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"hidden sm:inline font-semibold text-textSecondary",children:"Zeni:"}),c.jsx("input",{type:"number",value:l===0?"":l,onChange:S=>u(parseInt(S.target.value,10)||0),className:"w-24 p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary text-lg",placeholder:"Valor",disabled:!g}),c.jsx("button",{onClick:C,className:"px-3 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg text-sm",disabled:!g,children:"+"}),c.jsx("button",{onClick:N,className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm",disabled:!g,children:"-"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"hidden sm:inline font-semibold text-textSecondary",children:"Inspirao:"}),c.jsx("button",{onClick:E,className:"px-3 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg text-sm",disabled:!g,children:"+1"}),c.jsx("button",{onClick:D,className:"px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-lg text-sm",disabled:!g,children:"-1"})]})]})})},c1=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=Be(),l=o&&(o.uid===t.ownerUid||n),[u,d]=V.useState(t.discordWebhookUrl||"");V.useEffect(()=>{d(t.discordWebhookUrl||"")},[t.discordWebhookUrl]);const h=y=>{d(y.target.value)},g=V.useCallback(()=>{u!==t.discordWebhookUrl&&e("discordWebhookUrl",u)},[u,t.discordWebhookUrl,e]);return c.jsx($t,{title:"Integrao com Discord",isCollapsed:r,toggleSection:s,children:c.jsxs("div",{children:[c.jsx("label",{htmlFor:"discordWebhookUrl",className:"block text-sm font-medium text-textSecondary mb-1",children:"URL do Webhook do Canal:"}),c.jsx("input",{type:"text",id:"discordWebhookUrl",name:"discordWebhookUrl",value:u,onChange:h,onBlur:g,className:"w-full p-2 bg-bgInput border border-bgElement rounded-md focus:ring-btnHighlightBg focus:border-btnHighlightBg text-textPrimary",placeholder:"Cole a URL do Webhook do seu canal do Discord aqui",disabled:!l||!i}),c.jsx("p",{className:"text-xs text-textSecondary mt-2",children:"Com a URL do Webhook configurada, os comandos de rolagem sero enviados diretamente para o seu canal do Discord."})]})})},aa=({value:t,onChange:e,onBlur:n,placeholder:r,className:s,disabled:i,name:o})=>{const l=V.useRef(null);return V.useEffect(()=>{l.current&&(l.current.style.height="auto",l.current.style.height=`${l.current.scrollHeight}px`)},[t]),c.jsx("textarea",{ref:l,value:t,onChange:e,onBlur:n,placeholder:r,className:`${s} resize-none overflow-hidden`,rows:"1",disabled:i,name:o})},d1=({character:t,onUpdate:e,isMaster:n,isCollapsed:r,toggleSection:s,onShowDiscord:i})=>{const{user:o}=Be(),l=o.uid===t.ownerUid||n,[u,d]=V.useState(t.inventory||[]);V.useEffect(()=>{d(t.inventory||[])},[t.inventory]);const h=()=>e("inventory",[...t.inventory||[],{id:crypto.randomUUID(),name:"",description:"",isCollapsed:!1}]),g=E=>e("inventory",(t.inventory||[]).filter(D=>D.id!==E)),y=(E,D,b)=>{d(x=>x.map(v=>v.id===E?{...v,[D]:b}:v))},C=V.useCallback((E,D)=>{const b=u.find(v=>v.id===E),x=(t.inventory||[]).find(v=>v.id===E);b&&x&&b[D]!==x[D]&&e("inventory",(t.inventory||[]).map(v=>v.id===E?{...v,[D]:b[D]}:v))},[u,t.inventory,e]),N=E=>{u.find(b=>b.id===E)&&e("inventory",(t.inventory||[]).map(b=>b.id===E?{...b,isCollapsed:!b.isCollapsed}:b))};return c.jsxs($t,{title:"Inventrio",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(E=>E.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(E.id),children:E.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>i(E.name,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},E.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(E.id),children:E.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>i(E.name,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-4",children:"Mostrar no Feed"})]}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer self-end",onClick:()=>N(E.id),children:"Recolher "}),c.jsx("input",{type:"text",value:E.name,onChange:b=>y(E.id,"name",b.target.value),onBlur:()=>C(E.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome do Item",disabled:!l}),c.jsx(aa,{name:"description",value:E.description,onChange:b=>y(E.id,"description",b.target.value),onBlur:()=>C(E.id,"description"),placeholder:"Descrio do item",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(E.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Item",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},E.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhum item no inventrio."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:h,className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white text-2xl font-bold rounded-full shadow-lg flex items-center justify-center",children:"+"})})]})},h1=({character:t,isMaster:e,onUpdate:n,onShowDiscord:r,isCollapsed:s,toggleSection:i})=>{const{user:o}=Be(),l=o.uid===t.ownerUid||e,[u,d]=V.useState(t.equippedItems||[]);V.useEffect(()=>{d(t.equippedItems||[])},[t.equippedItems]);const h=()=>n("equippedItems",[...t.equippedItems||[],{id:crypto.randomUUID(),name:"",description:"",attributes:"",isCollapsed:!1}]),g=E=>n("equippedItems",(t.equippedItems||[]).filter(D=>D.id!==E)),y=(E,D,b)=>{d(x=>x.map(v=>v.id===E?{...v,[D]:b}:v))},C=V.useCallback((E,D)=>{const b=u.find(v=>v.id===E),x=(t.equippedItems||[]).find(v=>v.id===E);b&&x&&b[D]!==x[D]&&n("equippedItems",(t.equippedItems||[]).map(v=>v.id===E?{...v,[D]:b[D]}:v))},[u,t.equippedItems,n]),N=E=>n("equippedItems",(t.equippedItems||[]).map(D=>D.id===E?{...D,isCollapsed:!D.isCollapsed}:D));return c.jsxs($t,{title:"Itens Equipados",isCollapsed:s,toggleSection:i,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(E=>E.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(E.id),children:E.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>r(E.name,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},E.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm border border-bgInput",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(E.id),children:E.name||"Item Sem Nome"}),c.jsx("button",{onClick:()=>r(E.name,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-4",children:"Mostrar no Feed"})]}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer self-end",onClick:()=>N(E.id),children:"Recolher "}),c.jsx("input",{type:"text",value:E.name,onChange:b=>y(E.id,"name",b.target.value),onBlur:()=>C(E.id,"name"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Nome",disabled:!l}),c.jsx(aa,{value:E.description,onChange:b=>y(E.id,"description",b.target.value),onBlur:()=>C(E.id,"description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md mb-2",disabled:!l}),c.jsx(aa,{value:E.attributes,onChange:b=>y(E.id,"attributes",b.target.value),onBlur:()=>C(E.id,"attributes"),placeholder:"Atributos/Efeitos",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-sm text-textPrimary",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(E.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Item",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},E.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhum item equipado."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:h,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})},f1=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,onShowDiscord:i})=>{const{user:o}=Be(),l=o.uid===t.ownerUid||e,[u,d]=V.useState(t.abilities||[]);V.useEffect(()=>{d(t.abilities||[])},[t.abilities]);const h=()=>n("abilities",[...t.abilities||[],{id:crypto.randomUUID(),title:"",description:"",isCollapsed:!1}]),g=E=>n("abilities",(t.abilities||[]).filter(D=>D.id!==E)),y=(E,D,b)=>{d(x=>x.map(v=>v.id===E?{...v,[D]:b}:v))},C=V.useCallback((E,D)=>{const b=u.find(v=>v.id===E),x=(t.abilities||[]).find(v=>v.id===E);b&&x&&b[D]!==x[D]&&n("abilities",(t.abilities||[]).map(v=>v.id===E?{...v,[D]:b[D]}:v))},[u,t.abilities,n]),N=E=>n("abilities",(t.abilities||[]).map(D=>D.id===E?{...D,isCollapsed:!D.isCollapsed}:D));return c.jsxs($t,{title:"Habilidades",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(u||[]).map(E=>E.isCollapsed!==!1?c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-lg cursor-pointer text-textPrimary flex-grow truncate",onClick:()=>N(E.id),children:E.title||"Habilidade Sem Ttulo"}),c.jsx("button",{onClick:()=>i(E.title,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]},E.id):c.jsxs("div",{className:"col-span-1 sm:grid-cols-2 lg:col-span-3 flex flex-col p-3 bg-bgElement rounded-md shadow-sm",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>N(E.id),children:E.title||"Habilidade Sem Ttulo"}),c.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[c.jsx("button",{onClick:()=>i(E.title,E.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap",children:"Mostrar no Feed"}),c.jsx("span",{className:"text-textSecondary text-xs whitespace-nowrap cursor-pointer",onClick:()=>N(E.id),children:"Recolher "})]})]}),c.jsx("input",{type:"text",value:E.title,onChange:b=>y(E.id,"title",b.target.value),onBlur:()=>C(E.id,"title"),className:"font-semibold text-lg w-full p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary mb-2",placeholder:"Ttulo",disabled:!l}),c.jsx(aa,{value:E.description,onChange:b=>y(E.id,"description",b.target.value),onBlur:()=>C(E.id,"description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!l}),l&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>g(E.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:"Remover Habilidade",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]},E.id))}),(u||[]).length===0&&c.jsx("p",{className:"text-textSecondary italic mt-4",children:"Nenhuma habilidade adicionada."}),l&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx("button",{onClick:h,className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})},p1=({character:t,onUpdate:e,isCollapsed:n,toggleSection:r,onShowDiscord:s})=>{const o=g=>e(g,[...t[g]||[],{id:crypto.randomUUID(),name:"",description:"",origin:{class:!1,race:!1,manual:!0},value:0,isCollapsed:!1}]),l=(g,y)=>e(g,(t[g]||[]).filter(C=>C.id!==y)),u=(g,y,C)=>e(g,(t[g]||[]).map(N=>N.id===y?{...N,origin:{...N.origin,[C]:!N.origin[C]}}:N)),d=(g,y,C,N)=>e(g,(t[g]||[]).map(E=>E.id===y?{...E,[C]:N}:E)),h=(g,y)=>e(g,(t[g]||[]).map(C=>C.id===y?{...C,isCollapsed:!C.isCollapsed}:C));return c.jsx($t,{title:"Vantagens e Desvantagens",isCollapsed:n,toggleSection:r,children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1",children:"Vantagens"}),c.jsxs("div",{className:"space-y-2",children:[(t.advantages||[]).map(g=>c.jsx(Xy,{perk:g,type:"advantages",canEdit:!0,onRemove:l,onChange:d,onOriginChange:u,onToggleCollapse:h,onShowDiscord:s},g.id)),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("button",{onClick:()=>o("advantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-textAccent/80 mb-3 border-b border-borderAccent/50 pb-1",children:"Desvantagens"}),c.jsxs("div",{className:"space-y-2",children:[(t.disadvantages||[]).map(g=>c.jsx(Xy,{perk:g,type:"disadvantages",canEdit:!0,onRemove:l,onChange:d,onOriginChange:u,onToggleCollapse:h,onShowDiscord:s},g.id)),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("button",{onClick:()=>o("disadvantages"),className:"w-10 h-10 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-2xl font-bold rounded-full shadow-lg",children:"+"})})]})]})]})})},Xy=({perk:t,type:e,canEdit:n,onRemove:r,onChange:s,onOriginChange:i,onToggleCollapse:o,onShowDiscord:l})=>{const[u,d]=V.useState(t);V.useEffect(()=>{d(t)},[t.id]);const h=y=>{const{name:C,value:N,type:E}=y.target,D=E==="number"?parseInt(N,10)||0:N;d(b=>({...b,[C]:D}))},g=V.useCallback(y=>{u[y]!==t[y]&&s(e,u.id,y,u[y])},[u,t,e,s]);return c.jsxs("div",{className:"flex flex-col p-3 bg-bgElement rounded-md shadow-sm",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsxs("span",{className:"font-semibold text-lg w-full cursor-pointer text-textPrimary",onClick:()=>o(e,t.id),children:[u.name||"Sem Nome"," ",t.isCollapsed?"...":""]}),c.jsx("button",{onClick:()=>l(u.name,u.description),title:"Mostrar no Feed",className:"px-3 py-1 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText text-sm font-bold rounded-md whitespace-nowrap ml-2",children:"Mostrar no Feed"})]}),!t.isCollapsed&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("input",{type:"text",name:"name",value:u.name,onChange:h,onBlur:()=>g("name"),className:"font-semibold text-lg flex-grow p-1 bg-bgInput border border-bgElement rounded-md text-textPrimary",placeholder:"Nome",disabled:!n}),c.jsx("input",{type:"number",name:"value",value:u.value===0?"":u.value,onChange:h,onBlur:()=>g("value"),className:"w-12 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary",placeholder:"Valor",disabled:!n})]}),c.jsx(aa,{name:"description",value:u.description,onChange:h,onBlur:()=>g("description"),placeholder:"Descrio",className:"text-sm text-textSecondary italic w-full p-1 bg-bgInput border border-bgElement rounded-md",disabled:!n}),c.jsx("div",{className:"flex gap-3 text-sm text-textSecondary mt-2",children:["class","race","manual"].map(y=>{var C;return c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"checkbox",checked:((C=t.origin)==null?void 0:C[y])||!1,onChange:()=>i(e,t.id,y),className:"form-checkbox text-btnHighlightBg rounded",disabled:!n}),y.charAt(0).toUpperCase()+y.slice(1)]},y)})}),n&&c.jsx("div",{className:"flex justify-end mt-2 pt-2 border-t border-bgInput/50",children:c.jsx("button",{onClick:()=>r(e,t.id),className:"p-2 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white",title:`Remover ${e==="advantages"?"Vantagem":"Desvantagem"}`,children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-xl",children:""})})})]})]})},m1=({value:t,onChange:e,placeholder:n,className:r,disabled:s,onBlur:i})=>{const o=V.useRef(null);return V.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[t]),c.jsx("textarea",{ref:o,value:t,onChange:e,onBlur:i,placeholder:n,className:`${r} resize-none overflow-hidden`,rows:"1",disabled:s})},g1=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=Be(),l=o.uid===t.ownerUid||e,u=g=>{const y=g==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(g==="image"){const C=prompt("Cole a URL da imagem:");C&&n("history",[...t.history||[],{...y,value:C}])}else n("history",[...t.history||[],y])},d=(g,y,C)=>n("history",(t.history||[]).map(N=>N.id===g?{...N,[y]:C}:N)),h=g=>n("history",(t.history||[]).filter(y=>y.id!==g));return c.jsxs($t,{title:"Histria do Personagem",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"space-y-4 mb-4",children:(t.history||[]).length===0?c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum bloco de histria adicionado."}):t.history.map(g=>Uw(g,l,d,h))}),l&&i&&c.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 justify-center",children:[c.jsx("button",{onClick:()=>u("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Texto"}),c.jsx("button",{onClick:()=>u("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Imagem"})]})]})},y1=({character:t,isMaster:e,onUpdate:n,isCollapsed:r,toggleSection:s,isEditMode:i})=>{const{user:o}=Be(),l=o.uid===t.ownerUid||e,u=g=>{const y=g==="text"?{id:crypto.randomUUID(),type:"text",value:"",isCollapsed:!1}:{id:crypto.randomUUID(),type:"image",value:"",width:"",height:"",fitWidth:!0,isCollapsed:!1};if(g==="image"){const C=prompt("Cole a URL da imagem para a anotao:");C&&n("notes",[...t.notes||[],{...y,value:C}])}else n("notes",[...t.notes||[],y])},d=(g,y,C)=>n("notes",(t.notes||[]).map(N=>N.id===g?{...N,[y]:C}:N)),h=g=>n("notes",(t.notes||[]).filter(y=>y.id!==g));return c.jsxs($t,{title:"Anotaes",isCollapsed:r,toggleSection:s,children:[c.jsx("div",{className:"space-y-4 mb-4",children:(t.notes||[]).length===0?c.jsx("p",{className:"text-textSecondary italic",children:"Nenhum bloco de anotao adicionado."}):t.notes.map(g=>Uw(g,l,d,h))}),l&&i&&c.jsxs("div",{className:"flex flex-wrap gap-4 mt-4 justify-center",children:[c.jsx("button",{onClick:()=>u("text"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Texto"}),c.jsx("button",{onClick:()=>u("image"),className:"px-6 py-2 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg",children:"Adicionar Imagem"})]})]})},Uw=(t,e,n,r)=>c.jsxs("div",{className:"p-3 bg-bgElement rounded-md shadow-sm border border-bgInput relative",children:[e&&c.jsx("button",{onClick:()=>r(t.id),className:"absolute top-2 right-2 p-1 rounded-md text-textSecondary hover:bg-red-600/50 hover:text-white z-10",title:"Remover Bloco",children:c.jsx("span",{role:"img","aria-label":"Remover",className:"text-lg",children:""})}),t.type==="text"?c.jsx(v1,{block:t,canEdit:e,updateBlock:n}):c.jsx(_1,{block:t,canEdit:e,updateBlock:n})]},t.id),v1=({block:t,canEdit:e,updateBlock:n})=>{const[r,s]=V.useState(t.value||"");V.useEffect(()=>{s(t.value||"")},[t.value]);const i=V.useCallback(()=>{r!==t.value&&n(t.id,"value",r)},[r,t.value,t.id,n]);return t.isCollapsed?c.jsxs("div",{className:"cursor-pointer",onClick:()=>n(t.id,"isCollapsed",!1),children:[c.jsx("p",{className:"text-lg font-semibold mb-1 text-textPrimary",children:"Bloco de Texto"}),c.jsx("p",{className:"text-sm italic text-textSecondary truncate",children:t.value||"Vazio..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(m1,{value:r,onChange:o=>s(o.target.value),onBlur:i,placeholder:"Digite aqui...",className:"w-full p-2 bg-bgInput border border-bgElement rounded-md text-textPrimary",disabled:!e}),c.jsx("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary",children:"Ocultar "})]})},_1=({block:t,canEdit:e,updateBlock:n})=>{const[r,s]=V.useState(t.width===0?"":t.width),[i,o]=V.useState(t.height===0?"":t.height),[l,u]=V.useState(t.fitWidth);V.useEffect(()=>{s(t.width===0?"":t.width),o(t.height===0?"":t.height),u(t.fitWidth)},[t.width,t.height,t.fitWidth]);const d=V.useCallback(()=>n(t.id,"width",parseInt(r)||0),[t.id,n,r]),h=V.useCallback(()=>n(t.id,"height",parseInt(i)||0),[t.id,n,i]),g=V.useCallback(y=>n(t.id,"fitWidth",y.target.checked),[t.id,n]);return t.isCollapsed?c.jsx("div",{className:"cursor-pointer text-center py-2",onClick:()=>n(t.id,"isCollapsed",!1),children:c.jsx("p",{className:"text-lg font-semibold text-textPrimary",children:"Mostrar Imagem"})}):c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("img",{src:t.value,alt:"Imagem",className:"max-w-full h-auto rounded-md shadow-md",style:{width:l?"100%":r?`${r}px`:"auto",height:l?"auto":i?`${i}px`:"auto",objectFit:"contain"},onError:y=>{y.target.onerror=null,y.target.src="https://placehold.co/300x200/1f2937/FFFFFF?text=Erro"}}),e&&c.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 mt-2 text-sm text-textSecondary",children:[c.jsxs("label",{children:["Ajustar  Largura: ",c.jsx("input",{type:"checkbox",checked:l,onChange:y=>{u(y.target.checked),g(y)},className:"form-checkbox text-btnHighlightBg rounded"})]}),!l&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Largura (px): ",c.jsx("input",{type:"number",value:r,onChange:y=>s(y.target.value),onBlur:d,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})]}),c.jsxs("label",{children:["Altura (px): ",c.jsx("input",{type:"number",value:i,onChange:y=>o(y.target.value),onBlur:h,className:"w-20 p-1 bg-bgInput border border-bgElement rounded-md text-center text-textPrimary"})]})]})]}),c.jsx("div",{onClick:()=>n(t.id,"isCollapsed",!0),className:"mt-2 w-full text-center p-1 bg-bgInput hover:opacity-80 text-xs font-bold rounded-md cursor-pointer text-textSecondary",children:"Ocultar "})]})},x1=({character:t,onBack:e,isMaster:n})=>{var k,j,R,q,ne,ae,re,z,K,Q,Ee,ve,Pe;const{character:r,loading:s,updateCharacterField:i,toggleSection:o}=ON(t.id,t.ownerUid),{addRollToFeed:l,addMessageToFeed:u}=ac(),{user:d}=Be(),[h,g]=V.useState(!1),y=n||d&&d.uid===(r==null?void 0:r.ownerUid),[C,N]=V.useState({type:null,props:{}}),E=()=>N({type:null,props:{}}),D=V.useMemo(()=>r?["Iniciativa","FA","FM","FD","Acerto","MD","ME","Fora","Destreza","Constituio","Inteligencia","Sabedoria","Carisma","Fortitude","Reflexo","Vontade"]:[],[r]),b=V.useMemo(()=>{const $={attributes:{},dice:[]};return r!=null&&r.buffs&&r.buffs.forEach(X=>{X.isActive&&X.effects&&X.effects.forEach(oe=>{if(oe.type==="attribute"&&oe.target){const ce=parseInt(oe.value,10)||0;$.attributes[oe.target]=($.attributes[oe.target]||0)+ce}else oe.type==="dice"&&oe.value&&$.dice.push({name:X.name,value:oe.value})})}),$},[r==null?void 0:r.buffs]),x=async($,X,oe=[],ce="",_e="",Ct=!1)=>{if(!r)return;Ct||u({characterName:r.name||"Narrador",title:$,description:X||"Nenhuma descrio."});const At={author:{name:r.name||"Personagem",icon_url:r.photoUrl||""},title:$||"Sem Ttulo",description:X||"Sem Descrio.",fields:oe,color:8141549,footer:ce?{text:ce}:void 0};if(r.discordWebhookUrl)try{await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[At]})}),_e&&await fetch(r.discordWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:_e})})}catch(ye){N({type:"info",props:{message:`Falha ao enviar para o Discord: ${ye.message}`,onConfirm:E}})}else{const ye=`**${$||"Sem Ttulo"}**
${X||"Sem Descrio."}`;N({type:"info",props:{message:"Webhook do Discord no configurado. Copie e cole no Discord:",copyText:ye,showCopyButton:!0,onConfirm:E}})}},v=($,X,oe,ce=!1)=>{if(!(r!=null&&r.mainAttributes))return;let _e="";const Ct=r.name||"Personagem",At=JSON.parse(JSON.stringify(r.mainAttributes)),ye=At.hp,Le=At.mp;if(oe==="heal")switch(X){case"HP":ye.current=Math.min(ye.max,ye.current+$),_e=`${Ct} recuperou ${$} de HP.`;break;case"HP Bonus":ye.temp=(ye.temp||0)+$,_e=`${Ct} recebeu ${$} de HP Bnus.`;break;case"MP":Le.current=Math.min(Le.max,Le.current+$),_e=`${Ct} recuperou ${$} de MP.`;break}else switch(X){case"HP":let et=$;if(ce)ye.current-=et,_e=`${Ct} sofreu ${$} de dano direto no HP.`;else{const Ht=Math.min(et,ye.temp||0);ye.temp-=Ht,et-=Ht,et>0&&(ye.current-=et),_e=`${Ct} sofreu ${$} de dano.`}break;case"HP Bonus":ye.temp=Math.max(0,(ye.temp||0)-$),_e=`${Ct} perdeu ${$} de HP Bnus.`;break;case"MP":Le.current=Math.max(0,Le.current-$),_e=`${Ct} perdeu ${$} de MP.`;break}ye.current=Math.max(0,ye.current),i("mainAttributes",At),x(oe==="heal"?" Cura / Restaurao":" Dano Sofrido",_e),E()},S=$=>{N({type:"damageHeal",props:{attributeName:$,onConfirm:v,onClose:E}})},P=($,X)=>{if(!r)return;const oe={name:`Rolagem de ${$}`,components:[{type:"dice",value:"1d20"},{type:"number",value:X,label:"Bnus"}],discordText:`Rolagem de ${$} (1d20${X>=0?"+":""}${X})`};p(oe)},A=($,X)=>{["HP","HP Bonus","MP"].includes($)?S($):P($,X)},_=V.useCallback(($,X)=>{var Ht,dn;const oe=Js.find(hn=>hn.name===$),ce=(Ht=X.skillSystem)==null?void 0:Ht[$];if(!oe||!ce)return 0;const _e=ce.selectedAttr||oe.attr,Ct=Vh[_e],At=((dn=X.mainAttributes)==null?void 0:dn[Ct])||0,ye=X.level||0;let Le=0;ce.trained&&(Le=2+Math.floor(ye/10));const et=parseInt(ce.otherBonus,10)||0;return At+Le+et},[]),p=async $=>{var nt;if(!$)return;let X=0,oe=null,ce=[],_e=[];const Ct=$.multiplier||1,At=Y=>{let Z=0;if(!Y)return 0;const pe=(Y||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.mainAttributes&&r.mainAttributes.hasOwnProperty(pe)?Z=r.mainAttributes[pe]||0:r.mainAttributes&&r.mainAttributes.hasOwnProperty(pe.toLowerCase())&&(Z=r.mainAttributes[pe.toLowerCase()]||0),Z+=b.attributes[Y]||0,Z},ye=(nt=$.components)==null?void 0:nt.find(Y=>Y.type==="skillRoll");if(ye&&ye.skill){const Y=Math.floor(Math.random()*20)+1,Z=_(ye.skill,r),pe=Y+Z,Ge=parseInt(ye.critMin,10)||19,at=Y>=Ge;if(oe={roll:Y,bonus:Z,total:pe,isCrit:at,skillName:ye.skill},at){_e.push(`Acerto Crtico no d20 (${Y})!`);const rt=ye.critFormula||"",Ke=rt.match(/(\d+)d(\d+)/i);if(Ke){const Qe=parseInt(Ke[1],10),Wt=parseInt(Ke[2],10);let Fi=[],Cn=0;for(let Ui=0;Ui<Qe;Ui++){const dr=Math.floor(Math.random()*Wt)+1;Fi.push(dr),Cn+=dr}X+=Cn;const Aa=`Crtico(${rt}: ${Fi.join("+")}) = ${Cn}`;_e.push(Aa)}else if(!isNaN(parseInt(rt,10))&&rt.trim()!==""){const Qe=parseInt(rt,10);X+=Qe;const Wt=`Crtico(Bnus: ${Qe})`;ce.push({type:"number",value:Qe,displayValue:Wt}),_e.push(Wt)}}}else if(!($.components||[]).some(Z=>Z.type==="dice"||Z.type==="critDice")){const Z=Math.floor(Math.random()*20)+1;X+=Z,ce.push({type:"dice",value:Z,displayValue:`1d20(${Z})`})}for(let Y=0;Y<Ct;Y++)for(const Z of $.components||[])if(Z.type==="attribute"){const pe=Z.value,Ge=At(pe);X+=Ge,ce.push({type:"attribute",value:Ge,displayValue:`${pe}(${Ge})`})}else if(Z.type==="critDice"){const pe=String(Z.value||"").match(/(\d+)d(\d+)/i);if(pe){const Ge=parseInt(pe[1],10),at=parseInt(pe[2],10);let rt=[],Ke=0;for(let Qe=0;Qe<Ge;Qe++){const Wt=Math.floor(Math.random()*at)+1;if(rt.push(Wt),Ke+=Wt,Wt>=(Z.critValue||at)){const Cn=At(Z.critBonusAttribute)*(Z.critBonusMultiplier||1);Ke+=Cn,_e.push(`Crtico no ${Wt}! Adiciona ${Z.critBonusAttribute} (${Cn})`)}}X+=Ke,ce.push({type:"dice",value:Ke,displayValue:`${Z.value}(${rt.join("+")})`})}else{const Ge=parseInt(Z.value,10)||0;X+=Ge,ce.push({type:"number",value:Ge,displayValue:`${Ge}`})}}else if(Z.type==="dice"){const pe=String(Z.value||"").match(/(\d+)d(\d+)/i);if(pe){const Ge=parseInt(pe[1],10),at=parseInt(pe[2],10);let rt=[];for(let Qe=0;Qe<Ge;Qe++)rt.push(Math.floor(Math.random()*at)+1);const Ke=rt.reduce((Qe,Wt)=>Qe+Wt,0);X+=Ke,ce.push({type:"dice",value:Ke,displayValue:`${Z.value}(${rt.join("+")})`})}else isNaN(parseInt(Z.value,10))}else if(Z.type==="number"){const pe=parseInt(Z.value,10)||0;X+=pe;const Ge=Z.label?`${Z.label}(${pe>=0?"+":""}${pe})`:`${pe}`;ce.push({type:"number",value:pe,displayValue:Ge})}else Z.type;b.dice.forEach(Y=>{const Z=(Y.value||"").match(/(\d+)d(\d+)/i);if(Z){const pe=parseInt(Z[1],10),Ge=parseInt(Z[2],10);let at=[];for(let Ke=0;Ke<pe;Ke++)at.push(Math.floor(Math.random()*Ge)+1);const rt=at.reduce((Ke,Qe)=>Ke+Qe,0);X+=rt,ce.push({type:"dice",value:rt,displayValue:`${Y.name}(${at.join("+")})`})}else{const pe=parseInt(Y.value,10)||0;X+=pe,ce.push({type:"number",value:pe,displayValue:`${Y.name}(${pe})`})}});const Le={HP:0,MP:0};let et=[];const Ht=(r.buffs||[]).filter(Y=>Y.isActive),dn=$.costType&&$.costIsRollResult?-X:parseInt($.costValue,10)||0;$.costType&&dn!==0&&(Le[$.costType]+=dn,et.push(`Ao: ${dn>=0?"+":""}${dn} ${$.costType}`));const hn={HP:0,MP:0};$.recoverHP&&(hn.HP=X,et.push(`Recupera: ${X} HP`)),$.recoverMP&&(hn.MP=X,et.push(`Recupera: ${X} MP`)),Ht.forEach(Y=>{if(Y.costType&&Y.costValue!==void 0){const Z=parseInt(Y.costValue,10)||0;Z!==0&&(Le[Y.costType]+=Z,et.push(`${Y.name}: ${Z>=0?"+":""}${Z} ${Y.costType}`))}});const fc=Math.abs(Math.min(0,Le.HP)),pc=Math.abs(Math.min(0,Le.MP));if(r.mainAttributes.hp.current<fc||r.mainAttributes.mp.current<pc){N({type:"info",props:{message:"Custo de HP/MP insuficiente!",onConfirm:E}});return}const Mi=/(https?:\/\/[^\s]+)/i;let Ps="",zn=$.discordText||"";const Ca=zn.match(Mi);if(Ca&&(Ps=Ca[0],zn=zn.replace(Mi,"").trim()),Le.HP!==0||Le.MP!==0||hn.HP>0||hn.MP>0){const Y={...r.mainAttributes};Y.hp.current=Y.hp.current-Le.HP+hn.HP,Y.mp.current=Y.mp.current-Le.MP+hn.MP,Y.hp.current=Math.min(Y.hp.current,Y.hp.max),Y.hp.current=Math.max(Y.hp.current,0),Y.mp.current=Math.min(Y.mp.current,Y.mp.max),Y.mp.current=Math.max(Y.mp.current,0),await i("mainAttributes",Y)}let Li=ce.map(Y=>Y.displayValue).join(" + "),Yr;if(oe){const Y=`**Acerto (${oe.skillName}):** ${oe.total} (d20:${oe.roll} + Bnus:${oe.bonus})`;Yr=`${zn}
${Y}

**Dano/Resultado: ${X}**`}else Yr=`${zn}

**Resultado Final: ${X}**`;const Rs=[{name:"Detalhes da Rolagem",value:Li||"N/A",inline:!1}];_e.length>0&&Rs.push({name:"Crticos",value:_e.join(`
`),inline:!1}),Ht.length>0&&Rs.push({name:"Buffs Ativos",value:Ht.map(Y=>Y.name).join(", "),inline:!1});const tt=et.length>0?`Custo Total: ${et.join(" | ")}`:"";x($.name,Yr,Rs,tt,Ps,!0),l({characterId:r.id,characterName:r.name,ownerUid:d.uid,rollName:$.name,results:ce,totalResult:X,acertoResult:oe,criticals:_e,discordText:zn})},w=()=>{N({type:"confirm",props:{message:`Tem a certeza que deseja resetar PERMANENTEMENTE a ficha de "${r.name}"?`,onConfirm:async()=>{const $={photoUrl:"",age:"",height:"",gender:"",race:"",class:"",alignment:"",level:1,xp:0,mainAttributes:{hp:{current:10,max:10,temp:0},mp:{current:10,max:10},fa:0,fm:0,fd:0,acerto:0,me:0,forca:0,destreza:0,constituicao:0,inteligencia:0,sabedoria:0,carisma:0,fortitude:0,reflexo:0,vontade:0},attributes:[],inventory:[],wallet:{zeni:0,inspiration:0},fortitude:0,reflexo:0,vontade:0,advantages:[],disadvantages:[],abilities:[],equippedItems:[],history:[],notes:[],buffs:[],formulaActions:[],discordWebhookUrl:"",fortitudeAttr:"CON",reflexoAttr:"DES",vontadeAttr:"SAB",skillSystem:{}};for(const[X,oe]of Object.entries($))await i(X,oe);E()},onCancel:E}})},I=()=>{const{collapsedStates:$,...X}=r,oe=JSON.stringify(X,null,2),ce=new Blob([oe],{type:"application/json"}),_e=document.createElement("a");_e.href=URL.createObjectURL(ce),_e.download=`${r.name||"ficha"}.json`,document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),URL.revokeObjectURL(_e.href)};return s?c.jsx("div",{className:"text-center p-8",children:c.jsx("p",{className:"text-xl text-textSecondary",children:"A carregar ficha..."})}):r?c.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4",children:[c.jsx(lc,{modalState:C,closeModal:E}),c.jsx(i1,{character:r}),c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("button",{onClick:e,className:"px-4 py-2 bg-bgSurface hover:opacity-80 text-textPrimary font-bold rounded-lg",children:" Voltar para a Lista"}),y&&c.jsx("button",{onClick:()=>g(!h),className:"px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg shadow-lg",children:h?" Sair do Modo Edio":" Entrar no Modo Edio"})]}),c.jsx("div",{id:"info",children:c.jsx(a1,{character:r,onUpdate:i,isMaster:n,isEditMode:h,isCollapsed:(k=r.collapsedStates)==null?void 0:k.info,toggleSection:()=>o("info")})}),c.jsx("div",{id:"main-attributes",children:c.jsx(l1,{character:r,onUpdate:i,isMaster:n,isEditMode:h,buffModifiers:b.attributes,isCollapsed:(j=r.collapsedStates)==null?void 0:j.main,toggleSection:()=>o("main"),onAttributeRoll:A})}),c.jsx("div",{id:"actions",children:c.jsx(UN,{character:r,isMaster:n,isCollapsed:(R=r.collapsedStates)==null?void 0:R.actions,toggleSection:()=>o("actions"),allAttributes:D,onUpdate:i,onExecuteFormula:p,isEditMode:h})}),c.jsx("div",{id:"buffs",children:c.jsx(zN,{character:r,isMaster:n,onUpdate:i,allAttributes:D,isCollapsed:(q=r.collapsedStates)==null?void 0:q.buffs,toggleSection:()=>o("buffs"),isEditMode:h})}),c.jsx("div",{id:"wallet",children:c.jsx(u1,{character:r,isMaster:n,onUpdate:i,isCollapsed:(ne=r.collapsedStates)==null?void 0:ne.wallet,toggleSection:()=>o("wallet"),isEditMode:h})}),c.jsx("div",{id:"inventory",children:c.jsx(d1,{character:r,onUpdate:i,isMaster:n,onShowDiscord:x,isCollapsed:(ae=r.collapsedStates)==null?void 0:ae.inventory,toggleSection:()=>o("inventory"),isEditMode:h})}),c.jsx("div",{id:"equipped",children:c.jsx(h1,{character:r,onUpdate:i,isMaster:n,onShowDiscord:x,isCollapsed:(re=r.collapsedStates)==null?void 0:re.equipped,toggleSection:()=>o("equipped"),isEditMode:h})}),c.jsx("div",{id:"perks",children:c.jsx(p1,{character:r,onUpdate:i,onShowDiscord:x,isCollapsed:(z=r.collapsedStates)==null?void 0:z.perks,toggleSection:()=>o("perks"),isEditMode:h})}),c.jsx("div",{id:"skills",children:c.jsx(f1,{character:r,onUpdate:i,isMaster:n,onShowDiscord:x,isCollapsed:(K=r.collapsedStates)==null?void 0:K.skills,toggleSection:()=>o("skills"),isEditMode:h})}),c.jsx("div",{id:"specializations",children:c.jsx(LN,{character:r,onUpdate:i,isMaster:n,isCollapsed:(Q=r.collapsedStates)==null?void 0:Q.specializations,toggleSection:()=>o("specializations"),onExecuteFormula:p,isEditMode:h})}),c.jsx("div",{id:"story",children:c.jsx(g1,{character:r,onUpdate:i,isMaster:n,isCollapsed:(Ee=r.collapsedStates)==null?void 0:Ee.story,toggleSection:()=>o("story"),isEditMode:h})}),c.jsx("div",{id:"notes",children:c.jsx(y1,{character:r,onUpdate:i,isMaster:n,isCollapsed:(ve=r.collapsedStates)==null?void 0:ve.notes,toggleSection:()=>o("notes"),isEditMode:h})}),c.jsx("div",{id:"discord",children:c.jsx(c1,{character:r,onUpdate:i,isMaster:n,isCollapsed:(Pe=r.collapsedStates)==null?void 0:Pe.discord,toggleSection:()=>o("discord"),isEditMode:h})}),c.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mt-8 p-4 bg-bgSurface/80 backdrop-blur-sm rounded-xl border border-bgElement",children:[c.jsx("button",{onClick:I,className:"px-6 py-3 bg-btnHighlightBg hover:opacity-80 text-btnHighlightText font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!r,children:"Exportar Ficha (JSON)"}),c.jsx("button",{onClick:w,className:"px-8 py-3 bg-red-700 hover:bg-red-800 text-white font-bold rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!r,children:"Resetar Ficha"})]})]}):c.jsx("div",{className:"text-center p-8",children:c.jsx("p",{className:"text-xl text-red-400",children:"Erro: Personagem no encontrado."})})},w1=({activeTheme:t,setActiveTheme:e,setPreviewTheme:n})=>{const{user:r,googleSignOut:s,isMaster:i}=Be(),[o,l]=V.useState(null),[u,d]=V.useState([]),h=V.useRef(null),[g,y]=V.useState(!1),[C,N]=V.useState(!1),{currentSystem:E,setCurrentSystem:D,characterDataCollectionRoot:b,GLOBAL_APP_IDENTIFIER:x}=Ia(),[v,S]=V.useState({type:null,props:{}}),P=()=>S({type:null,props:{}});V.useEffect(()=>{if(o!=null&&o.id&&(o!=null&&o.ownerUid)){const q=ci(cn(ze,`${b}/${x}/users/${o.ownerUid}/characterSheets/${o.id}`),async ne=>{if(ne.exists()){const ae=ne.data();if(ae.activeThemeId){const re=await Qy(ae.activeThemeId);e(re)}else e(null)}});return()=>q()}else e(null)},[o,e,b,x,ze,Qy]);const A=()=>{N(!1),n(null)},_=q=>{l(q)},p=async()=>{if(r){console.log("%c[DIAGNSTICO DASHBOARD]","color: #00A8E8; font-weight: bold;",`Buscando fichas. isMaster: ${i}, viewingAll: ${g}`);const q=await Ow(r.uid,i&&g);d(q)}};V.useEffect(()=>{p()},[r,g,i,b,x]);const w=async()=>{await Vw(r.uid)&&p()},I=()=>{h.current.click()},k=q=>{const ne=q.target.files[0];if(!ne)return;const ae=new FileReader;ae.onload=re=>{try{const z=JSON.parse(re.target.result);if(!z.name)throw new Error("Ficheiro JSON invlido ou incompatvel.");S({type:"confirm",props:{message:`Deseja criar um novo personagem para o sistema ${E.toUpperCase()} com os dados de "${z.name}"?`,onConfirm:async()=>{const K=cn(Sn(ze,`${b}/${x}/users/${r.uid}/characterSheets`)),Q={...z,ownerUid:r.uid,system:E};delete Q.id,await Vi(K,Q),p(),P()},onCancel:P}})}catch(z){S({type:"info",props:{message:`Erro ao ler arquivo: ${z.message}`,onConfirm:P}})}},ae.readAsText(ne),q.target.value=null},j=q=>{const ne=q.ownerUid||r.uid;S({type:"confirm",props:{message:`Tem a certeza que deseja excluir permanentemente a ficha de "${q.name}" do sistema ${E.toUpperCase()}?`,onConfirm:async()=>{await Mw(ne,q.id)?d(re=>re.filter(z=>z.id!==q.id)):alert("No foi possvel excluir a ficha."),P()},onCancel:P}})},R=c.jsx(Fw,{onCharacterClick:_});return c.jsxs(c.Fragment,{children:[R,c.jsx("button",{onClick:()=>N(!0),className:"fixed top-4 right-4 z-[60] px-4 py-2 bg-btnHighlightBg text-btnHighlightText font-bold rounded-lg shadow-lg",children:"Editor de Temas"}),C&&c.jsx(e1,{character:o,originalTheme:t,setPreviewTheme:n,onClose:A}),o?c.jsx(x1,{character:o,onBack:()=>l(null),isMaster:i}):c.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 md:p-8",children:[c.jsx(lc,{modalState:v,closeModal:P}),c.jsx("input",{type:"file",ref:h,onChange:k,accept:".json",className:"hidden"}),c.jsxs("header",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-textPrimary",children:"Painel StoryCraft V1"}),c.jsxs("p",{className:"text-textSecondary",children:["Bem-vindo, ",r.displayName,"!"]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>D(null),className:"px-4 py-2 bg-bgElement hover:bg-opacity-80 text-textPrimary font-semibold rounded-lg shadow-lg",children:"Trocar Sistema"}),c.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg",children:"Sair"})]})]}),c.jsx("main",{children:c.jsx(Dw,{user:r,onSelectCharacter:l,handleImportClick:I,handleDeleteClick:j,handleCreateClick:w,characters:u,isMaster:i,viewingAll:g,onToggleView:y})})]})]})};var uc={exports:{}},zw={},Bw={exports:{}},E1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",b1=E1,S1=b1;function $w(){}function Hw(){}Hw.resetWarningCache=$w;var T1=function(){function t(r,s,i,o,l,u){if(u!==S1){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Hw,resetWarningCache:$w};return n.PropTypes=n,n};Bw.exports=T1();var Ww=Bw.exports;function qw(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=qw(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Jy(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=qw(t))&&(r&&(r+=" "),r+=e);return r}const I1=Object.freeze(Object.defineProperty({__proto__:null,clsx:Jy,default:Jy},Symbol.toStringTag,{value:"Module"})),C1=SE(I1);var Me={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});Fn.dontSetMe=k1;Fn.findInArray=A1;Fn.int=N1;Fn.isFunction=P1;Fn.isNum=R1;function A1(t,e){for(let n=0,r=t.length;n<r;n++)if(e.apply(e,[t[n],n,t]))return t[n]}function P1(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function R1(t){return typeof t=="number"&&!isNaN(t)}function N1(t){return parseInt(t,10)}function k1(t,e,n){if(t[e])return new Error("Invalid prop ".concat(e," passed to ").concat(n," - do not set this, set it on the child."))}var As={};Object.defineProperty(As,"__esModule",{value:!0});As.browserPrefixToKey=Kw;As.browserPrefixToStyle=D1;As.default=void 0;As.getPrefix=Gw;const md=["Moz","Webkit","O","ms"];function Gw(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const n=(t=window.document)===null||t===void 0||(t=t.documentElement)===null||t===void 0?void 0:t.style;if(!n||e in n)return"";for(let r=0;r<md.length;r++)if(Kw(e,md[r])in n)return md[r];return""}function Kw(t,e){return e?"".concat(e).concat(j1(t)):t}function D1(t,e){return e?"-".concat(e.toLowerCase(),"-").concat(t):t}function j1(t){let e="",n=!0;for(let r=0;r<t.length;r++)n?(e+=t[r].toUpperCase(),n=!1):t[r]==="-"?n=!0:e+=t[r];return e}As.default=Gw();Object.defineProperty(Me,"__esModule",{value:!0});Me.addClassName=Xw;Me.addEvent=M1;Me.addUserSelectStyles=K1;Me.createCSSTransform=H1;Me.createSVGTransform=W1;Me.getTouch=q1;Me.getTouchIdentifier=G1;Me.getTranslation=Dp;Me.innerHeight=z1;Me.innerWidth=B1;Me.matchesSelector=Yw;Me.matchesSelectorAndParentsTo=V1;Me.offsetXYFromParent=$1;Me.outerHeight=F1;Me.outerWidth=U1;Me.removeClassName=Jw;Me.removeEvent=L1;Me.removeUserSelectStyles=Q1;var Xt=Fn,Zy=O1(As);function Qw(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Qw=function(r){return r?n:e})(t)}function O1(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Qw(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}let hl="";function Yw(t,e){return hl||(hl=(0,Xt.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,Xt.isFunction)(t[n])})),(0,Xt.isFunction)(t[hl])?t[hl](e):!1}function V1(t,e,n){let r=t;do{if(Yw(r,e))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function M1(t,e,n,r){if(!t)return;const s={capture:!0,...r};t.addEventListener?t.addEventListener(e,n,s):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}function L1(t,e,n,r){if(!t)return;const s={capture:!0,...r};t.removeEventListener?t.removeEventListener(e,n,s):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}function F1(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,Xt.int)(n.borderTopWidth),e+=(0,Xt.int)(n.borderBottomWidth),e}function U1(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,Xt.int)(n.borderLeftWidth),e+=(0,Xt.int)(n.borderRightWidth),e}function z1(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,Xt.int)(n.paddingTop),e-=(0,Xt.int)(n.paddingBottom),e}function B1(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,Xt.int)(n.paddingLeft),e-=(0,Xt.int)(n.paddingRight),e}function $1(t,e,n){const s=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),i=(t.clientX+e.scrollLeft-s.left)/n,o=(t.clientY+e.scrollTop-s.top)/n;return{x:i,y:o}}function H1(t,e){const n=Dp(t,e,"px");return{[(0,Zy.browserPrefixToKey)("transform",Zy.default)]:n}}function W1(t,e){return Dp(t,e,"")}function Dp(t,e,n){let{x:r,y:s}=t,i="translate(".concat(r).concat(n,",").concat(s).concat(n,")");if(e){const o="".concat(typeof e.x=="string"?e.x:e.x+n),l="".concat(typeof e.y=="string"?e.y:e.y+n);i="translate(".concat(o,", ").concat(l,")")+i}return i}function q1(t,e){return t.targetTouches&&(0,Xt.findInArray)(t.targetTouches,n=>e===n.identifier)||t.changedTouches&&(0,Xt.findInArray)(t.changedTouches,n=>e===n.identifier)}function G1(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function K1(t){if(!t)return;let e=t.getElementById("react-draggable-style-el");e||(e=t.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(e)),t.body&&Xw(t.body,"react-draggable-transparent-selection")}function Q1(t){if(t)try{if(t.body&&Jw(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{const e=(t.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function Xw(t,e){t.classList?t.classList.add(e):t.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(t.className+=" ".concat(e))}function Jw(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var Un={};Object.defineProperty(Un,"__esModule",{value:!0});Un.canDragX=J1;Un.canDragY=Z1;Un.createCoreData=tk;Un.createDraggableData=nk;Un.getBoundPosition=Y1;Un.getControlPosition=ek;Un.snapToGrid=X1;var Gt=Fn,Zs=Me;function Y1(t,e,n){if(!t.props.bounds)return[e,n];let{bounds:r}=t.props;r=typeof r=="string"?r:rk(r);const s=jp(t);if(typeof r=="string"){const{ownerDocument:i}=s,o=i.defaultView;let l;if(r==="parent"?l=s.parentNode:l=i.querySelector(r),!(l instanceof o.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const u=l,d=o.getComputedStyle(s),h=o.getComputedStyle(u);r={left:-s.offsetLeft+(0,Gt.int)(h.paddingLeft)+(0,Gt.int)(d.marginLeft),top:-s.offsetTop+(0,Gt.int)(h.paddingTop)+(0,Gt.int)(d.marginTop),right:(0,Zs.innerWidth)(u)-(0,Zs.outerWidth)(s)-s.offsetLeft+(0,Gt.int)(h.paddingRight)-(0,Gt.int)(d.marginRight),bottom:(0,Zs.innerHeight)(u)-(0,Zs.outerHeight)(s)-s.offsetTop+(0,Gt.int)(h.paddingBottom)-(0,Gt.int)(d.marginBottom)}}return(0,Gt.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,Gt.isNum)(r.bottom)&&(n=Math.min(n,r.bottom)),(0,Gt.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,Gt.isNum)(r.top)&&(n=Math.max(n,r.top)),[e,n]}function X1(t,e,n){const r=Math.round(e/t[0])*t[0],s=Math.round(n/t[1])*t[1];return[r,s]}function J1(t){return t.props.axis==="both"||t.props.axis==="x"}function Z1(t){return t.props.axis==="both"||t.props.axis==="y"}function ek(t,e,n){const r=typeof e=="number"?(0,Zs.getTouch)(t,e):null;if(typeof e=="number"&&!r)return null;const s=jp(n),i=n.props.offsetParent||s.offsetParent||s.ownerDocument.body;return(0,Zs.offsetXYFromParent)(r||t,i,n.props.scale)}function tk(t,e,n){const r=!(0,Gt.isNum)(t.lastX),s=jp(t);return r?{node:s,deltaX:0,deltaY:0,lastX:e,lastY:n,x:e,y:n}:{node:s,deltaX:e-t.lastX,deltaY:n-t.lastY,lastX:t.lastX,lastY:t.lastY,x:e,y:n}}function nk(t,e){const n=t.props.scale;return{node:e.node,x:t.state.x+e.deltaX/n,y:t.state.y+e.deltaY/n,deltaX:e.deltaX/n,deltaY:e.deltaY/n,lastX:t.state.x,lastY:t.state.y}}function rk(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function jp(t){const e=t.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var cc={},dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.default=sk;function sk(){}Object.defineProperty(cc,"__esModule",{value:!0});cc.default=void 0;var gd=ok(V),Mt=Op(Ww),ik=Op(fa),wt=Me,yr=Un,yd=Fn,ao=Op(dc);function Op(t){return t&&t.__esModule?t:{default:t}}function Zw(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Zw=function(r){return r?n:e})(t)}function ok(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Zw(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}function Rt(t,e,n){return e=ak(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ak(t){var e=lk(t,"string");return typeof e=="symbol"?e:String(e)}function lk(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mn={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let vr=mn.mouse,hc=class extends gd.Component{constructor(){super(...arguments),Rt(this,"dragging",!1),Rt(this,"lastX",NaN),Rt(this,"lastY",NaN),Rt(this,"touchIdentifier",null),Rt(this,"mounted",!1),Rt(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=n;if(this.props.disabled||!(e.target instanceof r.defaultView.Node)||this.props.handle&&!(0,wt.matchesSelectorAndParentsTo)(e.target,this.props.handle,n)||this.props.cancel&&(0,wt.matchesSelectorAndParentsTo)(e.target,this.props.cancel,n))return;e.type==="touchstart"&&e.preventDefault();const s=(0,wt.getTouchIdentifier)(e);this.touchIdentifier=s;const i=(0,yr.getControlPosition)(e,s,this);if(i==null)return;const{x:o,y:l}=i,u=(0,yr.createCoreData)(this,o,l);(0,ao.default)("DraggableCore: handleDragStart: %j",u),(0,ao.default)("calling",this.props.onStart),!(this.props.onStart(e,u)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,wt.addUserSelectStyles)(r),this.dragging=!0,this.lastX=o,this.lastY=l,(0,wt.addEvent)(r,vr.move,this.handleDrag),(0,wt.addEvent)(r,vr.stop,this.handleDragStop))}),Rt(this,"handleDrag",e=>{const n=(0,yr.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:s}=n;if(Array.isArray(this.props.grid)){let l=r-this.lastX,u=s-this.lastY;if([l,u]=(0,yr.snapToGrid)(this.props.grid,l,u),!l&&!u)return;r=this.lastX+l,s=this.lastY+u}const i=(0,yr.createCoreData)(this,r,s);if((0,ao.default)("DraggableCore: handleDrag: %j",i),this.props.onDrag(e,i)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const u=document.createEvent("MouseEvents");u.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(u)}return}this.lastX=r,this.lastY=s}),Rt(this,"handleDragStop",e=>{if(!this.dragging)return;const n=(0,yr.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:s}=n;if(Array.isArray(this.props.grid)){let u=r-this.lastX||0,d=s-this.lastY||0;[u,d]=(0,yr.snapToGrid)(this.props.grid,u,d),r=this.lastX+u,s=this.lastY+d}const i=(0,yr.createCoreData)(this,r,s);if(this.props.onStop(e,i)===!1||this.mounted===!1)return!1;const l=this.findDOMNode();l&&this.props.enableUserSelectHack&&(0,wt.removeUserSelectStyles)(l.ownerDocument),(0,ao.default)("DraggableCore: handleDragStop: %j",i),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,l&&((0,ao.default)("DraggableCore: Removing handlers"),(0,wt.removeEvent)(l.ownerDocument,vr.move,this.handleDrag),(0,wt.removeEvent)(l.ownerDocument,vr.stop,this.handleDragStop))}),Rt(this,"onMouseDown",e=>(vr=mn.mouse,this.handleDragStart(e))),Rt(this,"onMouseUp",e=>(vr=mn.mouse,this.handleDragStop(e))),Rt(this,"onTouchStart",e=>(vr=mn.touch,this.handleDragStart(e))),Rt(this,"onTouchEnd",e=>(vr=mn.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,wt.addEvent)(e,mn.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:n}=e;(0,wt.removeEvent)(n,mn.mouse.move,this.handleDrag),(0,wt.removeEvent)(n,mn.touch.move,this.handleDrag),(0,wt.removeEvent)(n,mn.mouse.stop,this.handleDragStop),(0,wt.removeEvent)(n,mn.touch.stop,this.handleDragStop),(0,wt.removeEvent)(e,mn.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,wt.removeUserSelectStyles)(n)}}findDOMNode(){var e,n;return(e=this.props)!==null&&e!==void 0&&e.nodeRef?(n=this.props)===null||n===void 0||(n=n.nodeRef)===null||n===void 0?void 0:n.current:ik.default.findDOMNode(this)}render(){return gd.cloneElement(gd.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};cc.default=hc;Rt(hc,"displayName","DraggableCore");Rt(hc,"propTypes",{allowAnyClick:Mt.default.bool,children:Mt.default.node.isRequired,disabled:Mt.default.bool,enableUserSelectHack:Mt.default.bool,offsetParent:function(t,e){if(t[e]&&t[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Mt.default.arrayOf(Mt.default.number),handle:Mt.default.string,cancel:Mt.default.string,nodeRef:Mt.default.object,onStart:Mt.default.func,onDrag:Mt.default.func,onStop:Mt.default.func,onMouseDown:Mt.default.func,scale:Mt.default.number,className:yd.dontSetMe,style:yd.dontSetMe,transform:yd.dontSetMe});Rt(hc,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var e=y(V),n=h(Ww),r=h(fa),s=h(C1),i=Me,o=Un,l=Fn,u=h(cc),d=h(dc);function h(x){return x&&x.__esModule?x:{default:x}}function g(x){if(typeof WeakMap!="function")return null;var v=new WeakMap,S=new WeakMap;return(g=function(P){return P?S:v})(x)}function y(x,v){if(x&&x.__esModule)return x;if(x===null||typeof x!="object"&&typeof x!="function")return{default:x};var S=g(v);if(S&&S.has(x))return S.get(x);var P={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in x)if(_!=="default"&&Object.prototype.hasOwnProperty.call(x,_)){var p=A?Object.getOwnPropertyDescriptor(x,_):null;p&&(p.get||p.set)?Object.defineProperty(P,_,p):P[_]=x[_]}return P.default=x,S&&S.set(x,P),P}function C(){return C=Object.assign?Object.assign.bind():function(x){for(var v=1;v<arguments.length;v++){var S=arguments[v];for(var P in S)Object.prototype.hasOwnProperty.call(S,P)&&(x[P]=S[P])}return x},C.apply(this,arguments)}function N(x,v,S){return v=E(v),v in x?Object.defineProperty(x,v,{value:S,enumerable:!0,configurable:!0,writable:!0}):x[v]=S,x}function E(x){var v=D(x,"string");return typeof v=="symbol"?v:String(v)}function D(x,v){if(typeof x!="object"||x===null)return x;var S=x[Symbol.toPrimitive];if(S!==void 0){var P=S.call(x,v);if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(v==="string"?String:Number)(x)}class b extends e.Component{static getDerivedStateFromProps(v,S){let{position:P}=v,{prevPropsPosition:A}=S;return P&&(!A||P.x!==A.x||P.y!==A.y)?((0,d.default)("Draggable: getDerivedStateFromProps %j",{position:P,prevPropsPosition:A}),{x:P.x,y:P.y,prevPropsPosition:{...P}}):null}constructor(v){super(v),N(this,"onDragStart",(S,P)=>{if((0,d.default)("Draggable: onDragStart: %j",P),this.props.onStart(S,(0,o.createDraggableData)(this,P))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),N(this,"onDrag",(S,P)=>{if(!this.state.dragging)return!1;(0,d.default)("Draggable: onDrag: %j",P);const A=(0,o.createDraggableData)(this,P),_={x:A.x,y:A.y,slackX:0,slackY:0};if(this.props.bounds){const{x:w,y:I}=_;_.x+=this.state.slackX,_.y+=this.state.slackY;const[k,j]=(0,o.getBoundPosition)(this,_.x,_.y);_.x=k,_.y=j,_.slackX=this.state.slackX+(w-_.x),_.slackY=this.state.slackY+(I-_.y),A.x=_.x,A.y=_.y,A.deltaX=_.x-this.state.x,A.deltaY=_.y-this.state.y}if(this.props.onDrag(S,A)===!1)return!1;this.setState(_)}),N(this,"onDragStop",(S,P)=>{if(!this.state.dragging||this.props.onStop(S,(0,o.createDraggableData)(this,P))===!1)return!1;(0,d.default)("Draggable: onDragStop: %j",P);const _={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:w,y:I}=this.props.position;_.x=w,_.y=I}this.setState(_)}),this.state={dragging:!1,dragged:!1,x:v.position?v.position.x:v.defaultPosition.x,y:v.position?v.position.y:v.defaultPosition.y,prevPropsPosition:{...v.position},slackX:0,slackY:0,isElementSVG:!1},v.position&&!(v.onDrag||v.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var v,S;return(v=(S=this.props)===null||S===void 0||(S=S.nodeRef)===null||S===void 0?void 0:S.current)!==null&&v!==void 0?v:r.default.findDOMNode(this)}render(){const{axis:v,bounds:S,children:P,defaultPosition:A,defaultClassName:_,defaultClassNameDragging:p,defaultClassNameDragged:w,position:I,positionOffset:k,scale:j,...R}=this.props;let q={},ne=null;const re=!!!I||this.state.dragging,z=I||A,K={x:(0,o.canDragX)(this)&&re?this.state.x:z.x,y:(0,o.canDragY)(this)&&re?this.state.y:z.y};this.state.isElementSVG?ne=(0,i.createSVGTransform)(K,k):q=(0,i.createCSSTransform)(K,k);const Q=(0,s.default)(P.props.className||"",_,{[p]:this.state.dragging,[w]:this.state.dragged});return e.createElement(u.default,C({},R,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(P),{className:Q,style:{...P.props.style,...q},transform:ne}))}}t.default=b,N(b,"displayName","Draggable"),N(b,"propTypes",{...u.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),N(b,"defaultProps",{...u.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(zw);const{default:eE,DraggableCore:uk}=zw;uc.exports=eE;uc.exports.default=eE;uc.exports.DraggableCore=uk;var ck=uc.exports;const dk=iv(ck);var He=function(){return He=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},He.apply(this,arguments)},ev={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},tv={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},fl={width:"20px",height:"20px",position:"absolute",zIndex:1},hk={top:He(He({},ev),{top:"-5px"}),right:He(He({},tv),{left:void 0,right:"-5px"}),bottom:He(He({},ev),{top:void 0,bottom:"-5px"}),left:He(He({},tv),{left:"-5px"}),topRight:He(He({},fl),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:He(He({},fl),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:He(He({},fl),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:He(He({},fl),{left:"-10px",top:"-10px",cursor:"nw-resize"})},fk=V.memo(function(t){var e=t.onResizeStart,n=t.direction,r=t.children,s=t.replaceStyles,i=t.className,o=V.useCallback(function(d){e(d,n)},[e,n]),l=V.useCallback(function(d){e(d,n)},[e,n]),u=V.useMemo(function(){return He(He({position:"absolute",userSelect:"none"},hk[n]),s??{})},[s,n]);return c.jsx("div",{className:i||void 0,style:u,onMouseDown:o,onTouchStart:l,children:r})}),pk=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rn=function(){return Rn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Rn.apply(this,arguments)},mk={width:"auto",height:"auto"},pl=function(t,e,n){return Math.max(Math.min(t,n),e)},nv=function(t,e,n){var r=Math.round(t/e);return r*e+n*(r-1)},Vs=function(t,e){return new RegExp(t,"i").test(e)},ml=function(t){return!!(t.touches&&t.touches.length)},gk=function(t){return!!((t.clientX||t.clientX===0)&&(t.clientY||t.clientY===0))},rv=function(t,e,n){n===void 0&&(n=0);var r=e.reduce(function(i,o,l){return Math.abs(o-t)<Math.abs(e[i]-t)?l:i},0),s=Math.abs(e[r]-t);return n===0||s<n?e[r]:t},vd=function(t){return t=t.toString(),t==="auto"||t.endsWith("px")||t.endsWith("%")||t.endsWith("vh")||t.endsWith("vw")||t.endsWith("vmax")||t.endsWith("vmin")?t:"".concat(t,"px")},gl=function(t,e,n,r){if(t&&typeof t=="string"){if(t.endsWith("px"))return Number(t.replace("px",""));if(t.endsWith("%")){var s=Number(t.replace("%",""))/100;return e*s}if(t.endsWith("vw")){var s=Number(t.replace("vw",""))/100;return n*s}if(t.endsWith("vh")){var s=Number(t.replace("vh",""))/100;return r*s}}return t},yk=function(t,e,n,r,s,i,o){return r=gl(r,t.width,e,n),s=gl(s,t.height,e,n),i=gl(i,t.width,e,n),o=gl(o,t.height,e,n),{maxWidth:typeof r>"u"?void 0:Number(r),maxHeight:typeof s>"u"?void 0:Number(s),minWidth:typeof i>"u"?void 0:Number(i),minHeight:typeof o>"u"?void 0:Number(o)}},vk=function(t){return Array.isArray(t)?t:[t,t]},_k=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],sv="__resizable_base__",xk=function(t){pk(e,t);function e(n){var r,s,i,o,l=t.call(this,n)||this;return l.ratio=1,l.resizable=null,l.parentLeft=0,l.parentTop=0,l.resizableLeft=0,l.resizableRight=0,l.resizableTop=0,l.resizableBottom=0,l.targetLeft=0,l.targetTop=0,l.delta={width:0,height:0},l.appendBase=function(){if(!l.resizable||!l.window)return null;var u=l.parentNode;if(!u)return null;var d=l.window.document.createElement("div");return d.style.width="100%",d.style.height="100%",d.style.position="absolute",d.style.transform="scale(0, 0)",d.style.left="0",d.style.flex="0 0 100%",d.classList?d.classList.add(sv):d.className+=sv,u.appendChild(d),d},l.removeBase=function(u){var d=l.parentNode;d&&d.removeChild(u)},l.state={isResizing:!1,width:(s=(r=l.propsSize)===null||r===void 0?void 0:r.width)!==null&&s!==void 0?s:"auto",height:(o=(i=l.propsSize)===null||i===void 0?void 0:i.height)!==null&&o!==void 0?o:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},l.onResizeStart=l.onResizeStart.bind(l),l.onMouseMove=l.onMouseMove.bind(l),l.onMouseUp=l.onMouseUp.bind(l),l}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||mk},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var n=0,r=0;if(this.resizable&&this.window){var s=this.resizable.offsetWidth,i=this.resizable.offsetHeight,o=this.resizable.style.position;o!=="relative"&&(this.resizable.style.position="relative"),n=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:s,r=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:i,this.resizable.style.position=o}return{width:n,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sizeStyle",{get:function(){var n=this,r=this.props.size,s=function(l){var u;if(typeof n.state[l]>"u"||n.state[l]==="auto")return"auto";if(n.propsSize&&n.propsSize[l]&&(!((u=n.propsSize[l])===null||u===void 0)&&u.toString().endsWith("%"))){if(n.state[l].toString().endsWith("%"))return n.state[l].toString();var d=n.getParentSize(),h=Number(n.state[l].toString().replace("px","")),g=h/d[l]*100;return"".concat(g,"%")}return vd(n.state[l])},i=r&&typeof r.width<"u"&&!this.state.isResizing?vd(r.width):s("width"),o=r&&typeof r.height<"u"&&!this.state.isResizing?vd(r.height):s("height");return{width:i,height:o}},enumerable:!1,configurable:!0}),e.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var n=this.appendBase();if(!n)return{width:0,height:0};var r=!1,s=this.parentNode.style.flexWrap;s!=="wrap"&&(r=!0,this.parentNode.style.flexWrap="wrap"),n.style.position="relative",n.style.minWidth="100%",n.style.minHeight="100%";var i={width:n.offsetWidth,height:n.offsetHeight};return r&&(this.parentNode.style.flexWrap=s),this.removeBase(n),i},e.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},e.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},e.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var n=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:n.flexBasis!=="auto"?n.flexBasis:void 0})}},e.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},e.prototype.createSizeForCssProperty=function(n,r){var s=this.propsSize&&this.propsSize[r];return this.state[r]==="auto"&&this.state.original[r]===n&&(typeof s>"u"||s==="auto")?"auto":n},e.prototype.calculateNewMaxFromBoundary=function(n,r){var s=this.props.boundsByDirection,i=this.state.direction,o=s&&Vs("left",i),l=s&&Vs("top",i),u,d;if(this.props.bounds==="parent"){var h=this.parentNode;h&&(u=o?this.resizableRight-this.parentLeft:h.offsetWidth+(this.parentLeft-this.resizableLeft),d=l?this.resizableBottom-this.parentTop:h.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(u=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,d=l?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(u=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),d=l?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return u&&Number.isFinite(u)&&(n=n&&n<u?n:u),d&&Number.isFinite(d)&&(r=r&&r<d?r:d),{maxWidth:n,maxHeight:r}},e.prototype.calculateNewSizeFromDirection=function(n,r){var s=this.props.scale||1,i=vk(this.props.resizeRatio||1),o=i[0],l=i[1],u=this.state,d=u.direction,h=u.original,g=this.props,y=g.lockAspectRatio,C=g.lockAspectRatioExtraHeight,N=g.lockAspectRatioExtraWidth,E=h.width,D=h.height,b=C||0,x=N||0;return Vs("right",d)&&(E=h.width+(n-h.x)*o/s,y&&(D=(E-x)/this.ratio+b)),Vs("left",d)&&(E=h.width-(n-h.x)*o/s,y&&(D=(E-x)/this.ratio+b)),Vs("bottom",d)&&(D=h.height+(r-h.y)*l/s,y&&(E=(D-b)*this.ratio+x)),Vs("top",d)&&(D=h.height-(r-h.y)*l/s,y&&(E=(D-b)*this.ratio+x)),{newWidth:E,newHeight:D}},e.prototype.calculateNewSizeFromAspectRatio=function(n,r,s,i){var o=this.props,l=o.lockAspectRatio,u=o.lockAspectRatioExtraHeight,d=o.lockAspectRatioExtraWidth,h=typeof i.width>"u"?10:i.width,g=typeof s.width>"u"||s.width<0?n:s.width,y=typeof i.height>"u"?10:i.height,C=typeof s.height>"u"||s.height<0?r:s.height,N=u||0,E=d||0;if(l){var D=(y-N)*this.ratio+E,b=(C-N)*this.ratio+E,x=(h-E)/this.ratio+N,v=(g-E)/this.ratio+N,S=Math.max(h,D),P=Math.min(g,b),A=Math.max(y,x),_=Math.min(C,v);n=pl(n,S,P),r=pl(r,A,_)}else n=pl(n,h,g),r=pl(r,y,C);return{newWidth:n,newHeight:r}},e.prototype.setBoundingClientRect=function(){var n=1/(this.props.scale||1);if(this.props.bounds==="parent"){var r=this.parentNode;if(r){var s=r.getBoundingClientRect();this.parentLeft=s.left*n,this.parentTop=s.top*n}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left*n,this.targetTop=i.top*n}if(this.resizable){var o=this.resizable.getBoundingClientRect(),l=o.left,u=o.top,d=o.right,h=o.bottom;this.resizableLeft=l*n,this.resizableRight=d*n,this.resizableTop=u*n,this.resizableBottom=h*n}},e.prototype.onResizeStart=function(n,r){if(!(!this.resizable||!this.window)){var s=0,i=0;if(n.nativeEvent&&gk(n.nativeEvent)?(s=n.nativeEvent.clientX,i=n.nativeEvent.clientY):n.nativeEvent&&ml(n.nativeEvent)&&(s=n.nativeEvent.touches[0].clientX,i=n.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var o=this.props.onResizeStart(n,r,this.resizable);if(o===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var l,u=this.window.getComputedStyle(this.resizable);if(u.flexBasis!=="auto"){var d=this.parentNode;if(d){var h=this.window.getComputedStyle(d).flexDirection;this.flexDir=h.startsWith("row")?"row":"column",l=u.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var g={original:{x:s,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:Rn(Rn({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(n.target).cursor||"auto"}),direction:r,flexBasis:l};this.setState(g)}},e.prototype.onMouseMove=function(n){var r=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&ml(n))try{n.preventDefault(),n.stopPropagation()}catch{}var s=this.props,i=s.maxWidth,o=s.maxHeight,l=s.minWidth,u=s.minHeight,d=ml(n)?n.touches[0].clientX:n.clientX,h=ml(n)?n.touches[0].clientY:n.clientY,g=this.state,y=g.direction,C=g.original,N=g.width,E=g.height,D=this.getParentSize(),b=yk(D,this.window.innerWidth,this.window.innerHeight,i,o,l,u);i=b.maxWidth,o=b.maxHeight,l=b.minWidth,u=b.minHeight;var x=this.calculateNewSizeFromDirection(d,h),v=x.newHeight,S=x.newWidth,P=this.calculateNewMaxFromBoundary(i,o);this.props.snap&&this.props.snap.x&&(S=rv(S,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(v=rv(v,this.props.snap.y,this.props.snapGap));var A=this.calculateNewSizeFromAspectRatio(S,v,{width:P.maxWidth,height:P.maxHeight},{width:l,height:u});if(S=A.newWidth,v=A.newHeight,this.props.grid){var _=nv(S,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),p=nv(v,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),w=this.props.snapGap||0,I=w===0||Math.abs(_-S)<=w?_:S,k=w===0||Math.abs(p-v)<=w?p:v;S=I,v=k}var j={width:S-C.width,height:v-C.height};if(this.delta=j,N&&typeof N=="string"){if(N.endsWith("%")){var R=S/D.width*100;S="".concat(R,"%")}else if(N.endsWith("vw")){var q=S/this.window.innerWidth*100;S="".concat(q,"vw")}else if(N.endsWith("vh")){var ne=S/this.window.innerHeight*100;S="".concat(ne,"vh")}}if(E&&typeof E=="string"){if(E.endsWith("%")){var R=v/D.height*100;v="".concat(R,"%")}else if(E.endsWith("vw")){var q=v/this.window.innerWidth*100;v="".concat(q,"vw")}else if(E.endsWith("vh")){var ne=v/this.window.innerHeight*100;v="".concat(ne,"vh")}}var ae={width:this.createSizeForCssProperty(S,"width"),height:this.createSizeForCssProperty(v,"height")};this.flexDir==="row"?ae.flexBasis=ae.width:this.flexDir==="column"&&(ae.flexBasis=ae.height);var re=this.state.width!==ae.width,z=this.state.height!==ae.height,K=this.state.flexBasis!==ae.flexBasis,Q=re||z||K;Q&&fa.flushSync(function(){r.setState(ae)}),this.props.onResize&&Q&&this.props.onResize(n,y,this.resizable,j)}},e.prototype.onMouseUp=function(n){var r,s,i=this.state,o=i.isResizing,l=i.direction;i.original,!(!o||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(n,l,this.resizable,this.delta),this.props.size&&this.setState({width:(r=this.props.size.width)!==null&&r!==void 0?r:"auto",height:(s=this.props.size.height)!==null&&s!==void 0?s:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:Rn(Rn({},this.state.backgroundStyle),{cursor:"auto"})}))},e.prototype.updateSize=function(n){var r,s;this.setState({width:(r=n.width)!==null&&r!==void 0?r:"auto",height:(s=n.height)!==null&&s!==void 0?s:"auto"})},e.prototype.renderResizer=function(){var n=this,r=this.props,s=r.enable,i=r.handleStyles,o=r.handleClasses,l=r.handleWrapperStyle,u=r.handleWrapperClass,d=r.handleComponent;if(!s)return null;var h=Object.keys(s).map(function(g){return s[g]!==!1?c.jsx(fk,{direction:g,onResizeStart:n.onResizeStart,replaceStyles:i&&i[g],className:o&&o[g],children:d&&d[g]?d[g]:null},g):null});return c.jsx("div",{className:u,style:l,children:h})},e.prototype.render=function(){var n=this,r=Object.keys(this.props).reduce(function(o,l){return _k.indexOf(l)!==-1||(o[l]=n.props[l]),o},{}),s=Rn(Rn(Rn({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(s.flexBasis=this.state.flexBasis);var i=this.props.as||"div";return c.jsxs(i,Rn({style:s,className:this.props.className},r,{ref:function(o){o&&(n.resizable=o)},children:[this.state.isResizing&&c.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},e.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},e}(V.PureComponent);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Mh=function(t,e){return Mh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},Mh(t,e)};function wk(t,e){Mh(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ye=function(){return Ye=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ye.apply(this,arguments)};function Ek(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}var bk={width:"auto",height:"auto",display:"inline-block",position:"absolute",top:0,left:0},Sk=function(t){return{bottom:t,bottomLeft:t,bottomRight:t,left:t,right:t,top:t,topLeft:t,topRight:t}},Tk=function(t){wk(e,t);function e(n){var r=t.call(this,n)||this;return r.resizingPosition={x:0,y:0},r.offsetFromParent={left:0,top:0},r.resizableElement={current:null},r.originalPosition={x:0,y:0},r.state={resizing:!1,bounds:{top:0,right:0,bottom:0,left:0},maxWidth:n.maxWidth,maxHeight:n.maxHeight},r.onResizeStart=r.onResizeStart.bind(r),r.onResize=r.onResize.bind(r),r.onResizeStop=r.onResizeStop.bind(r),r.onDragStart=r.onDragStart.bind(r),r.onDrag=r.onDrag.bind(r),r.onDragStop=r.onDragStop.bind(r),r.getMaxSizesFromProps=r.getMaxSizesFromProps.bind(r),r}return e.prototype.componentDidMount=function(){this.updateOffsetFromParent();var n=this.offsetFromParent,r=n.left,s=n.top,i=this.getDraggablePosition(),o=i.x,l=i.y;this.draggable.setState({x:o-r,y:l-s}),this.forceUpdate()},e.prototype.getDraggablePosition=function(){var n=this.draggable.state,r=n.x,s=n.y;return{x:r,y:s}},e.prototype.getParent=function(){return this.resizable&&this.resizable.parentNode},e.prototype.getParentSize=function(){return this.resizable.getParentSize()},e.prototype.getMaxSizesFromProps=function(){var n=typeof this.props.maxWidth>"u"?Number.MAX_SAFE_INTEGER:this.props.maxWidth,r=typeof this.props.maxHeight>"u"?Number.MAX_SAFE_INTEGER:this.props.maxHeight;return{maxWidth:n,maxHeight:r}},e.prototype.getSelfElement=function(){return this.resizable&&this.resizable.resizable},e.prototype.getOffsetHeight=function(n){var r=this.props.scale;switch(this.props.bounds){case"window":return window.innerHeight/r;case"body":return document.body.offsetHeight/r;default:return n.offsetHeight}},e.prototype.getOffsetWidth=function(n){var r=this.props.scale;switch(this.props.bounds){case"window":return window.innerWidth/r;case"body":return document.body.offsetWidth/r;default:return n.offsetWidth}},e.prototype.onDragStart=function(n,r){this.props.onDragStart&&this.props.onDragStart(n,r);var s=this.getDraggablePosition();if(this.originalPosition=s,!!this.props.bounds){var i=this.getParent(),o=this.props.scale,l;if(this.props.bounds==="parent")l=i;else if(this.props.bounds==="body"){var u=i.getBoundingClientRect(),d=u.left,h=u.top,g=document.body.getBoundingClientRect(),y=-(d-i.offsetLeft*o-g.left)/o,C=-(h-i.offsetTop*o-g.top)/o,N=(document.body.offsetWidth-this.resizable.size.width*o)/o+y,E=(document.body.offsetHeight-this.resizable.size.height*o)/o+C;return this.setState({bounds:{top:C,right:N,bottom:E,left:y}})}else if(this.props.bounds==="window"){if(!this.resizable)return;var D=i.getBoundingClientRect(),b=D.left,x=D.top,v=-(b-i.offsetLeft*o)/o,S=-(x-i.offsetTop*o)/o,N=(window.innerWidth-this.resizable.size.width*o)/o+v,E=(window.innerHeight-this.resizable.size.height*o)/o+S;return this.setState({bounds:{top:S,right:N,bottom:E,left:v}})}else typeof this.props.bounds=="string"?l=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(l=this.props.bounds);if(!(!(l instanceof HTMLElement)||!(i instanceof HTMLElement))){var P=l.getBoundingClientRect(),A=P.left,_=P.top,p=i.getBoundingClientRect(),w=p.left,I=p.top,k=(A-w)/o,j=_-I;if(this.resizable){this.updateOffsetFromParent();var R=this.offsetFromParent;this.setState({bounds:{top:j-R.top,right:k+(l.offsetWidth-this.resizable.size.width)-R.left/o,bottom:j+(l.offsetHeight-this.resizable.size.height)-R.top,left:k-R.left/o}})}}}},e.prototype.onDrag=function(n,r){if(this.props.onDrag){var s=this.offsetFromParent,i=s.left,o=s.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDrag(n,Ye(Ye({},r),{x:r.x+i,y:r.y+o}));if(this.props.dragAxis==="x")return this.props.onDrag(n,Ye(Ye({},r),{x:r.x+i,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDrag(n,Ye(Ye({},r),{x:this.originalPosition.x+i,y:r.y+o,deltaX:0}))}},e.prototype.onDragStop=function(n,r){if(this.props.onDragStop){var s=this.offsetFromParent,i=s.left,o=s.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDragStop(n,Ye(Ye({},r),{x:r.x+i,y:r.y+o}));if(this.props.dragAxis==="x")return this.props.onDragStop(n,Ye(Ye({},r),{x:r.x+i,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDragStop(n,Ye(Ye({},r),{x:this.originalPosition.x+i,y:r.y+o,deltaX:0}))}},e.prototype.onResizeStart=function(n,r,s){n.stopPropagation(),this.setState({resizing:!0});var i=this.props.scale,o=this.offsetFromParent,l=this.getDraggablePosition();if(this.resizingPosition={x:l.x+o.left,y:l.y+o.top},this.originalPosition=l,this.props.bounds){var u=this.getParent(),d=void 0;this.props.bounds==="parent"?d=u:this.props.bounds==="body"?d=document.body:this.props.bounds==="window"?d=window:typeof this.props.bounds=="string"?d=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(d=this.props.bounds);var h=this.getSelfElement();if(h instanceof Element&&(d instanceof HTMLElement||d===window)&&u instanceof HTMLElement){var g=this.getMaxSizesFromProps(),y=g.maxWidth,C=g.maxHeight,N=this.getParentSize();if(y&&typeof y=="string")if(y.endsWith("%")){var E=Number(y.replace("%",""))/100;y=N.width*E}else y.endsWith("px")&&(y=Number(y.replace("px","")));if(C&&typeof C=="string")if(C.endsWith("%")){var E=Number(C.replace("%",""))/100;C=N.height*E}else C.endsWith("px")&&(C=Number(C.replace("px","")));var D=h.getBoundingClientRect(),b=D.left,x=D.top,v=this.props.bounds==="window"?{left:0,top:0}:d.getBoundingClientRect(),S=v.left,P=v.top,A=this.getOffsetWidth(d),_=this.getOffsetHeight(d),p=r.toLowerCase().endsWith("left"),w=r.toLowerCase().endsWith("right"),I=r.startsWith("top"),k=r.startsWith("bottom");if((p||I)&&this.resizable){var j=(b-S)/i+this.resizable.size.width;this.setState({maxWidth:j>Number(y)?y:j})}if(w||this.props.lockAspectRatio&&!p&&!I){var j=A+(S-b)/i;this.setState({maxWidth:j>Number(y)?y:j})}if((I||p)&&this.resizable){var j=(x-P)/i+this.resizable.size.height;this.setState({maxHeight:j>Number(C)?C:j})}if(k||this.props.lockAspectRatio&&!I&&!p){var j=_+(P-x)/i;this.setState({maxHeight:j>Number(C)?C:j})}}}else this.setState({maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight});this.props.onResizeStart&&this.props.onResizeStart(n,r,s)},e.prototype.onResize=function(n,r,s,i){var o=this,l={x:this.originalPosition.x,y:this.originalPosition.y},u=-i.width,d=-i.height,h=["top","left","topLeft","bottomLeft","topRight"];h.includes(r)&&(r==="bottomLeft"?l.x+=u:(r==="topRight"||(l.x+=u),l.y+=d));var g=this.draggable.state;(l.x!==g.x||l.y!==g.y)&&fa.flushSync(function(){o.draggable.setState(l)}),this.updateOffsetFromParent();var y=this.offsetFromParent,C=this.getDraggablePosition().x+y.left,N=this.getDraggablePosition().y+y.top;this.resizingPosition={x:C,y:N},this.props.onResize&&this.props.onResize(n,r,s,i,{x:C,y:N})},e.prototype.onResizeStop=function(n,r,s,i){this.setState({resizing:!1});var o=this.getMaxSizesFromProps(),l=o.maxWidth,u=o.maxHeight;this.setState({maxWidth:l,maxHeight:u}),this.props.onResizeStop&&this.props.onResizeStop(n,r,s,i,this.resizingPosition)},e.prototype.updateSize=function(n){this.resizable&&this.resizable.updateSize({width:n.width,height:n.height})},e.prototype.updatePosition=function(n){this.draggable.setState(n)},e.prototype.updateOffsetFromParent=function(){var n=this.props.scale,r=this.getParent(),s=this.getSelfElement();if(!r||s===null)return{top:0,left:0};var i=r.getBoundingClientRect(),o=i.left,l=i.top,u=s.getBoundingClientRect(),d=this.getDraggablePosition(),h=r.scrollLeft,g=r.scrollTop;this.offsetFromParent={left:u.left-o+h-d.x*n,top:u.top-l+g-d.y*n}},e.prototype.render=function(){var n=this,r=this.props,s=r.disableDragging,i=r.style,o=r.dragHandleClassName,l=r.position,u=r.onMouseDown,d=r.onMouseUp,h=r.dragAxis,g=r.dragGrid,y=r.bounds,C=r.enableUserSelectHack,N=r.cancel,E=r.children;r.onResizeStart,r.onResize,r.onResizeStop,r.onDragStart,r.onDrag,r.onDragStop;var D=r.resizeHandleStyles,b=r.resizeHandleClasses,x=r.resizeHandleComponent,v=r.enableResizing,S=r.resizeGrid,P=r.resizeHandleWrapperClass,A=r.resizeHandleWrapperStyle,_=r.scale,p=r.allowAnyClick,w=r.dragPositionOffset,I=Ek(r,["disableDragging","style","dragHandleClassName","position","onMouseDown","onMouseUp","dragAxis","dragGrid","bounds","enableUserSelectHack","cancel","children","onResizeStart","onResize","onResizeStop","onDragStart","onDrag","onDragStop","resizeHandleStyles","resizeHandleClasses","resizeHandleComponent","enableResizing","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","scale","allowAnyClick","dragPositionOffset"]),k=this.props.default?Ye({},this.props.default):void 0;delete I.default;var j=s||o?{cursor:"auto"}:{cursor:"move"},R=Ye(Ye(Ye({},bk),j),i),q=this.offsetFromParent,ne=q.left,ae=q.top,re;l&&(re={x:l.x-ne,y:l.y-ae});var z=this.state.resizing?void 0:re,K=this.state.resizing?"both":h;return V.createElement(dk,{ref:function(Q){Q&&(n.draggable=Q)},handle:o?".".concat(o):void 0,defaultPosition:k,onMouseDown:u,onMouseUp:d,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,axis:K,disabled:s,grid:g,bounds:y?this.state.bounds:void 0,position:z,enableUserSelectHack:C,cancel:N,scale:_,allowAnyClick:p,nodeRef:this.resizableElement,positionOffset:w},V.createElement(xk,Ye({},I,{ref:function(Q){Q&&(n.resizable=Q,n.resizableElement.current=Q.resizable)},defaultSize:k,size:this.props.size,enable:typeof v=="boolean"?Sk(v):v,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,style:R,minWidth:this.props.minWidth,minHeight:this.props.minHeight,maxWidth:this.state.resizing?this.state.maxWidth:this.props.maxWidth,maxHeight:this.state.resizing?this.state.maxHeight:this.props.maxHeight,grid:S,handleWrapperClass:P,handleWrapperStyle:A,lockAspectRatio:this.props.lockAspectRatio,lockAspectRatioExtraWidth:this.props.lockAspectRatioExtraWidth,lockAspectRatioExtraHeight:this.props.lockAspectRatioExtraHeight,handleStyles:D,handleClasses:b,handleComponent:x,scale:this.props.scale}),E))},e.defaultProps={maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,scale:1,onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},onDragStart:function(){},onDrag:function(){},onDragStop:function(){}},e}(V.PureComponent);const Ik="/assets/storycraft-bg-classic-DHho0FOo.png",Iu={input:{name:"Campo de Input (Texto)",color:"rgba(3, 169, 244, 0.4)",borderColor:"#03a9f4"},textarea:{name:"rea de Texto (Grande)",color:"rgba(76, 175, 80, 0.4)",borderColor:"#4caf50"},rollable:{name:"rea Clicvel (Roll)",color:"rgba(244, 67, 54, 0.4)",borderColor:"#f44336"},label:{name:"Texto Calculado (Label)",color:"rgba(255, 152, 0, 0.4)",borderColor:"#ff9800"},image:{name:"Zona de Imagem (Foto)",color:"rgba(156, 39, 176, 0.4)",borderColor:"#9c27b0"}},lo=827,uo=1170,Ck=({id:t,data:e,onUpdate:n,onSelect:r,isSelected:s})=>{const{type:i,top:o,left:l,width:u,height:d}=e,h=Iu[i]||Iu.input,g={border:`2px solid ${s?h.borderColor:"transparent"}`,backgroundColor:h.color,boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontFamily:"monospace",fontSize:"12px",textShadow:"0 0 2px black"};return c.jsx(Tk,{style:g,size:{width:u,height:d},position:{x:l,y:o},onDragStart:r,onDragStop:(y,C)=>{n(t,{top:C.y,left:C.x})},onResizeStop:(y,C,N,E,D)=>{n(t,{width:parseInt(N.style.width,10),height:parseInt(N.style.height,10),...D})},onClick:y=>{y.stopPropagation(),r()},className:"z-10",children:t})},Ak=({onBack:t})=>{const[e,n]=V.useState({}),[r,s]=V.useState(null),i=V.useRef(null),o=V.useMemo(()=>r?e[r]:null,[r,e]),l=E=>{if(!E)return;const D=prompt('Digite o ID nico para este elemento (ex: "name", "attr_for", "roll_des"):');if(D){if(e[D]){alert("Erro: Este ID j est em uso.");return}n(b=>({...b,[D]:{type:E,top:10,left:10,width:150,height:30}})),s(D)}},u=(E,D)=>{n(b=>({...b,[E]:{...b[E],...D}}))},d=E=>{if(!r)return;const{name:D,value:b}=E.target;u(r,{[D]:parseInt(b,10)||0})},h=E=>{const D=E.target.value.trim();if(!(!D||D===r)){if(e[D]){console.warn(`ID "${D}" j existe.`);return}n(b=>{const{[r]:x,...v}=b;return{...v,[D]:x}}),s(D)}},g=E=>{if(!r)return;const{value:D}=E.target;u(r,{type:D})},y=()=>{if(!r||!e[r])return;const E=e[r];let D=prompt("Digite o NOVO ID nico para a cpia:",`${r}_copia`);if(!D)return;for(;e[D];)if(alert(`Erro: O ID "${D}" j est em uso.`),D=prompt("Por favor, digite um ID DIFERENTE:",`${D}_2`),!D)return;const b={...E,top:E.top,left:E.left+20};n(x=>({...x,[D]:b})),s(D)},C=()=>{const E={};Object.entries(e).forEach(([S,P])=>{E[S]={type:P.type,top:P.top/uo*100,left:P.left/lo*100,width:P.width/lo*100,height:P.height/uo*100}});const D=JSON.stringify(E,null,2),b=new Blob([D],{type:"application/json"}),x=URL.createObjectURL(b),v=document.createElement("a");v.href=x,v.download="sheet_layout.json",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(x)},N=E=>{const D=E.target.files[0];if(!D)return;const b=new FileReader;b.onload=x=>{try{const v=JSON.parse(x.target.result),S={};Object.entries(v).forEach(([P,A])=>{if(!A.type||A.top==null)throw new Error(`Elemento "${P}"  invlido.`);S[P]={type:A.type,top:A.top/100*uo,left:A.left/100*lo,width:A.width/100*lo,height:A.height/100*uo}}),n(S)}catch(v){console.error("Erro ao importar JSON:",v),alert(`Arquivo JSON invlido: ${v.message}`)}},b.readAsText(D),E.target.value=null};return c.jsxs("div",{className:"w-full min-h-screen bg-gray-900 text-white",children:[c.jsx("input",{type:"file",ref:i,onChange:N,accept:".json",className:"hidden"}),c.jsxs("header",{className:"p-2 bg-gray-800 flex items-center gap-4 sticky top-0 z-50",children:[c.jsx("button",{onClick:t,className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 rounded",children:" Voltar"}),c.jsxs("select",{onChange:E=>{l(E.target.value),E.target.value=""},className:"bg-gray-700 text-white px-3 py-1 rounded",value:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Adicionar Zona..."}),Object.entries(Iu).map(([E,D])=>c.jsx("option",{value:E,children:D.name},E))]}),c.jsx("button",{onClick:()=>i.current.click(),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded",children:"Importar JSON"}),c.jsx("button",{onClick:C,className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded",children:"Exportar JSON (%)"}),r&&c.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[c.jsx("button",{onClick:y,className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded",title:`Copiar ${r}`,children:"Copiar"}),c.jsx("button",{onClick:()=>{if(window.confirm(`Tem certeza que quer remover o elemento "${r}"?`)){const{[r]:E,...D}=e;n(D),s(null)}},className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded",title:`Remover ${r}`,children:"Remover"})]})]}),c.jsxs("div",{className:"flex",style:{height:"calc(100vh - 48px)"},children:[c.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-900",children:c.jsx("div",{className:"mx-auto",style:{position:"relative",width:`${lo}px`,height:`${uo}px`,backgroundImage:`url(${Ik})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"},onClick:()=>s(null),children:Object.entries(e).map(([E,D])=>c.jsx(Ck,{id:E,data:D,onUpdate:u,onSelect:()=>s(E),isSelected:E===r},E))})}),c.jsxs("aside",{className:"w-64 bg-gray-800 p-4 overflow-y-auto",children:[c.jsx("h2",{className:"text-lg font-bold mb-4",children:"Propriedades"}),o?c.jsxs("div",{className:"space-y-2",children:[c.jsxs("fieldset",{className:"border border-gray-600 p-2 rounded",children:[c.jsx("legend",{className:"text-sm px-1",children:"Elemento"}),c.jsx(co,{label:"ID",name:"id",value:r,onChange:h,onBlur:h,type:"text"}),c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("label",{htmlFor:"type",className:"text-sm text-gray-300",children:"Tipo:"}),c.jsx("select",{id:"type",name:"type",value:o.type,onChange:g,className:"w-2/3 p-1 rounded bg-gray-700 text-white",children:Object.entries(Iu).map(([E,D])=>c.jsx("option",{value:E,children:D.name},E))})]})]}),c.jsxs("fieldset",{className:"border border-gray-600 p-2 rounded",children:[c.jsx("legend",{className:"text-sm px-1",children:"Posio (em pixels)"}),c.jsx(co,{label:"Top",name:"top",value:o.top,onChange:d}),c.jsx(co,{label:"Left",name:"left",value:o.left,onChange:d}),c.jsx(co,{label:"Width",name:"width",value:o.width,onChange:d}),c.jsx(co,{label:"Height",name:"height",value:o.height,onChange:d})]})]}):c.jsx("p",{className:"text-gray-400",children:"Selecione um elemento ou adicione uma nova zona."})]})]})]})},co=({label:t,name:e,value:n,onChange:r,onBlur:s,readOnly:i=!1,type:o="number"})=>c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsxs("label",{htmlFor:e,className:"text-sm text-gray-300",children:[t,":"]}),c.jsx("input",{type:o,id:e,name:e,value:n,onChange:r,onBlur:s,readOnly:i,className:`w-2/3 p-1 rounded ${i?"bg-gray-600 text-gray-400":"bg-gray-700 text-white"}`})]}),Pk=({activeTheme:t,setActiveTheme:e,setPreviewTheme:n})=>{const{user:r,googleSignOut:s,isMaster:i}=Be(),[o,l]=V.useState(null),[u,d]=V.useState([]),h=V.useRef(null),[g,y]=V.useState(!1),[C,N]=V.useState(!1),{currentSystem:E,setCurrentSystem:D,characterDataCollectionRoot:b,GLOBAL_APP_IDENTIFIER:x}=Ia(),[v,S]=V.useState({type:null,props:{}}),P=()=>S({type:null,props:{}}),A=R=>{l(R)},_=async()=>{if(r){console.log("%c[DIAGNSTICO DASHBOARD V2]","color: #f59e0b; font-weight: bold;",`Buscando fichas V2. isMaster: ${i}, viewingAll: ${g}`);const R=await Ow(r.uid,i&&g);d(R)}};V.useEffect(()=>{_()},[r,g,i,b,x]);const p=async()=>{await Vw(r.uid)&&_()},w=()=>{h.current.click()},I=R=>{const q=R.target.files[0];if(!q)return;const ne=new FileReader;ne.onload=ae=>{try{const re=JSON.parse(ae.target.result);if(!re.name)throw new Error("Ficheiro JSON invlido ou incompatvel.");S({type:"confirm",props:{message:`Deseja criar um novo personagem para o sistema ${E.toUpperCase()} com os dados de "${re.name}"?`,onConfirm:async()=>{const z=cn(Sn(ze,`${b}/${x}/users/${r.uid}/characterSheets`)),K={...re,ownerUid:r.uid,system:E};delete K.id,await Vi(z,K),_(),P()},onCancel:P}})}catch(re){S({type:"info",props:{message:`Erro ao ler arquivo: ${re.message}`,onConfirm:P}})}},ne.readAsText(q),R.target.value=null},k=R=>{const q=R.ownerUid||r.uid;S({type:"confirm",props:{message:`Tem a certeza que deseja excluir permanentemente a ficha de "${R.name}" do sistema ${E.toUpperCase()}?`,onConfirm:async()=>{await Mw(q,R.id)?d(ae=>ae.filter(re=>re.id!==R.id)):alert("No foi possvel excluir a ficha."),P()},onCancel:P}})},j=c.jsx(Fw,{onCharacterClick:A});return c.jsxs(c.Fragment,{children:[j,o?c.jsx(Ak,{onBack:()=>l(null)}):c.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 md:p-8",children:[c.jsx(lc,{modalState:v,closeModal:P}),c.jsx("input",{type:"file",ref:h,onChange:I,accept:".json",className:"hidden"}),c.jsxs("header",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-textPrimary",children:"Painel StoryCraft V2 (Clssico)"}),c.jsxs("p",{className:"text-textSecondary",children:["Bem-vindo, ",r.displayName,"!"]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>D(null),className:"px-4 py-2 bg-bgElement hover:bg-opacity-80 text-textPrimary font-semibold rounded-lg shadow-lg",children:"Trocar Sistema"}),c.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg",children:"Sair"})]})]}),c.jsx("main",{children:c.jsx(Dw,{user:r,onSelectCharacter:l,handleImportClick:w,handleDeleteClick:k,handleCreateClick:p,characters:u,isMaster:i,viewingAll:g,onToggleView:y})})]})]})},Rk=t=>{const{currentSystem:e,setCurrentSystem:n}=Ia();return e?c.jsxs(c.Fragment,{children:[e==="v1"&&c.jsx(w1,{...t}),e==="v2"&&c.jsx(Pk,{...t})]}):c.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-bgPage p-4",children:[c.jsx("h1",{className:"text-4xl font-bold text-textPrimary mb-10",children:"Selecione o Sistema"}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[c.jsxs("div",{onClick:()=>n("v1"),className:"bg-bgSurface border-2 border-borderAccent rounded-lg p-8 w-80 h-60 flex flex-col justify-center items-center text-center cursor-pointer transform hover:scale-105 transition-transform duration-300 shadow-lg",children:[c.jsx("h2",{className:"text-3xl font-bold text-textAccent mb-2",children:"StoryCraft V1"}),c.jsx("p",{className:"text-textSecondary",children:"A experincia clssica com temas personalizveis."})]}),c.jsxs("div",{onClick:()=>n("v2"),className:"bg-bgSurface border-2 border-borderAccent rounded-lg p-8 w-80 h-60 flex flex-col justify-center items-center text-center cursor-pointer transform hover:scale-105 transition-transform duration-300 shadow-lg",children:[c.jsx("h2",{className:"text-3xl font-bold text-textAccent mb-2",children:"StoryCraft V2"}),c.jsx("p",{className:"text-textSecondary",children:"O novo sistema com regras de Escala de Poder."})]})]})]})},Nk=()=>{const{googleSignIn:t}=Be(),e=async()=>{try{await t()}catch(n){console.error("Erro ao fazer login com o Google:",n)}};return c.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background p-4",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-5xl font-bold text-primary mb-2",children:"StoryCraft V2"}),c.jsx("p",{className:"text-xl text-secondary mb-8",children:"Sua ficha de RPG, do seu jeito."}),c.jsx("button",{onClick:e,className:"px-8 py-4 bg-highlight hover:bg-opacity-80 text-primary font-bold rounded-lg shadow-lg text-lg",children:"Entrar com Google"})]})})};function kk(t){if(!t)return"55, 65, 81";const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?`${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)}`:"55, 65, 81"}const Dk=t=>{const e=document.documentElement;t?(e.style.setProperty("--background-image",t.backgroundImage||"none"),e.style.setProperty("--font-family",t.fontFamily||"ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb",kk(t.colors.bgSurface)),e.style.setProperty("--surface-opacity",(t.surfaceOpacity||80)/100),e.style.setProperty("--color-bgPage",t.colors.bgPage),e.style.setProperty("--color-bgElement",t.colors.bgElement),e.style.setProperty("--color-bgInput",t.colors.bgInput),e.style.setProperty("--color-textPrimary",t.colors.textPrimary),e.style.setProperty("--color-textSecondary",t.colors.textSecondary),e.style.setProperty("--color-borderAccent",t.colors.borderAccent),e.style.setProperty("--color-textAccent",t.colors.textAccent),e.style.setProperty("--color-btnHighlightBg",t.colors.btnHighlightBg),e.style.setProperty("--color-btnHighlightText",t.colors.btnHighlightText)):(e.style.setProperty("--background-image","none"),e.style.setProperty("--font-family","ui-sans-serif"),e.style.setProperty("--color-bgSurface-rgb","55, 65, 81"),e.style.setProperty("--surface-opacity","0.8"),e.style.setProperty("--color-bgPage","#111827"),e.style.setProperty("--color-bgElement","#374151"),e.style.setProperty("--color-bgInput","#4b5563"),e.style.setProperty("--color-textPrimary","#f9fafb"),e.style.setProperty("--color-textSecondary","#9ca3af"),e.style.setProperty("--color-borderAccent","#f59e0b"),e.style.setProperty("--color-textAccent","#fcd34d"),e.style.setProperty("--color-btnHighlightBg","#8b5cf6"),e.style.setProperty("--color-btnHighlightText","#ffffff"))};function jk(){const{user:t,loading:e}=Be(),[n,r]=V.useState(null),[s,i]=V.useState(null);return V.useEffect(()=>{const o=s||n;Dk(o?o.styles:null)},[n,s]),e?c.jsx("div",{className:"bg-bgPage text-textPrimary min-h-screen flex items-center justify-center",children:c.jsx("h1",{className:"text-3xl",children:"A carregar StoryCraft..."})}):c.jsxs("div",{className:"bg-bgPage bg-theme bg-cover bg-center bg-fixed text-textPrimary min-h-screen",children:[t?c.jsxs(c.Fragment,{children:[c.jsx(Rk,{activeTheme:n,setActiveTheme:r,previewTheme:s,setPreviewTheme:i}),c.jsx(KN,{})," "]}):c.jsx(Nk,{})," "]})}_d.createRoot(document.getElementById("root")).render(c.jsx(gv.StrictMode,{children:c.jsx(MN,{children:c.jsx(jN,{children:c.jsx(GN,{children:c.jsxs(BN,{children:[c.jsx(jk,{})," "]})})})})}));
